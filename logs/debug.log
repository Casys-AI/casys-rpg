2024-12-30 17:22:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:23:01 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-30 17:23:01 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-30 17:23:01 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-30 17:23:01 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-30 17:23:01 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-30 17:23:01 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-30 17:23:01 | INFO     | __main__:<module>:39 - DÃ©marrage du serveur sur 127.0.0.1:8000
2024-12-30 17:23:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:23:03 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:23:03 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:23:03 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:23:03 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:23:03 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:23:03 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:23:03 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:23:03 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:23:03 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:23:03 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:23:03 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:23:03 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:23:03 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:23:03 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:23:03 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:23:03 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:23:03 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:23:04 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:23:04 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:23:04 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:23:04 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:23:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:23:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:23:04 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:04 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:23:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:23:04 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:04 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:23:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:23:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:23:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:23:12 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:23:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:13 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:23:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:23:14 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:23:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:23:14 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:14 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:23:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:17 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:23:17 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:23:17 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:23:17 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:23:17 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:23:17 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 813bcb1d-a134-40a8-a635-21b754ca8c4a
2024-12-30 17:23:17 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 813bcb1d-a134-40a8-a635-21b754ca8c4a
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\traces
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters
2024-12-30 17:23:17 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 813bcb1d-a134-40a8-a635-21b754ca8c4a
2024-12-30 17:23:17 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: e0647f4f-faa4-460a-ae09-6cac6f1e1b6c
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:23:17 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'e0647f4f-faa4-460a-ae09-6cac6f1e1b6c', 'game_id': '813bcb1d-a134-40a8-a635-21b754ca8c4a', 'last_update': '2024-12-30T17:23:17.621145', 'character_id': 'current'}
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:17 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:23:17 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:23:17 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:23:17 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:23:17 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 53a2e521-35fc-4660-872b-cdfcf07adaa7
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:23:17 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '53a2e521-35fc-4660-872b-cdfcf07adaa7', 'game_id': '813bcb1d-a134-40a8-a635-21b754ca8c4a', 'last_update': '2024-12-30T17:23:17.651064', 'character_id': 'current'}
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:17 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 53a2e521-35fc-4660-872b-cdfcf07adaa7 and game_id: 813bcb1d-a134-40a8-a635-21b754ca8c4a
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:17 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 53a2e521-35fc-4660-872b-cdfcf07adaa7 and section_number: 1
2024-12-30 17:23:17 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:23:17 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:23:17 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:23:17 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:23:17 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:23:17 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:23:17 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:23:17 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:23:17 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:23:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:23:17 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:23:17 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:23:17 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:23:17 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:23:17 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:23:17 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:23:17 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:23:17 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:23:17 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:23:17 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:23:17 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:23:17 | ERROR    | agents.story_graph:_process_decision:222 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=37176, pipe_handle=1144)
                                      â           â <function spawn_main at 0x00000299F88C0860>
                                      â <function spawn_main at 0x00000299F88C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 592
               â     â 3
               â <function _main at 0x00000299F88C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 592
           â    â <function BaseProcess._bootstrap at 0x00000299F8806A20>
           â <SpawnProcess name='SpawnProcess-1' parent=37176 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x00000299F8805F80>
    â <SpawnProcess name='SpawnProcess-1' parent=37176 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x00000299FDDAF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-1' parent=37176 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-1' parent=37176 started>
    â    â <function subprocess_started at 0x00000299FE00E700>
    â <SpawnProcess name='SpawnProcess-1' parent=37176 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=720, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x00000299FDDAF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=720, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x00000299FE00D9E0>
           â       â   â <uvicorn.server.Server object at 0x00000299FDDAF4D0>
           â       â <function run at 0x00000299F8E063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x00000299FE002420>
           â      â <function Runner.run at 0x00000299F8E704A0>
           â <asyncio.runners.Runner object at 0x00000299FE038050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x00000299F8E69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x00000299FE038050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x00000299F8E69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x00000299F8E6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x00000299F8DED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000299FE4A2C80>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000299FE4A2C80>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000299FE4A2C80>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000299FE4A2C80>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x00000299FDC531A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)
2024-12-30 17:23:17 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:23:17 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:17 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:17 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-30 17:23:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:23:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='e0647f4f-faa4-460a-ae09-6cac6f1e1b6c' game_id='813bcb1d-a134-40a8-a635-21b754ca8c4a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 23, 17, 695717), last_update=datetime.datetime(2024, 12, 30, 17, 23, 17, 695734)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:23:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='e0647f4f-faa4-460a-ae09-6cac6f1e1b6c' game_id='813bcb1d-a134-40a8-a635-21b754ca8c4a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 23, 17, 695717), last_update=datetime.datetime(2024, 12, 30, 17, 23, 17, 695734)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:23:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:23:21 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '813bcb1d-a134-40a8-a635-21b754ca8c4a', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:23:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='813bcb1d-a134-40a8-a635-21b754ca8c4a' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:23:21 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 17:23:21 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:23:21 | DEBUG    | managers.agent_manager:process_game_state:162 - No state provided, getting current state
2024-12-30 17:23:21 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:23:21 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='e0647f4f-faa4-460a-ae09-6cac6f1e1b6c' game_id='813bcb1d-a134-40a8-a635-21b754ca8c4a' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 23, 17, 695717), last_update=datetime.datetime(2024, 12, 30, 17, 23, 17, 695734)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:23:21 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:23:21 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:23:21 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 23, 17, 695717), last_update=datetime.datetime(2024, 12, 30, 17, 23, 17, 695734)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:23:21 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:23:21 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:23:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: f8817732-8e68-4758-ac86-682e34e9a36d
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\characters\current.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:23:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'f8817732-8e68-4758-ac86-682e34e9a36d', 'game_id': '813bcb1d-a134-40a8-a635-21b754ca8c4a', 'last_update': '2024-12-30T17:23:21.825994', 'character_id': 'current'}
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:21 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: f8817732-8e68-4758-ac86-682e34e9a36d and game_id: 813bcb1d-a134-40a8-a635-21b754ca8c4a
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:21 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: f8817732-8e68-4758-ac86-682e34e9a36d and section_number: 1
2024-12-30 17:23:21 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:23:21 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:23:21 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:23:21 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:23:21 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:23:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:23:21 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:23:21 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:23:21 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:23:21 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:23:21 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:23:21 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:23:21 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:23:21 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:23:21 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:23:21 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:23:21 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:23:21 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:23:21 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:23:21 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:23:21 | DEBUG    | agents.story_graph:_process_decision:189 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:23:21 | DEBUG    | agents.decision_agent:ainvoke:170 - Processing decision for state: session=, section=1
2024-12-30 17:23:21 | DEBUG    | agents.decision_agent:ainvoke:190 - Decision processed successfully
2024-12-30 17:23:21 | ERROR    | agents.story_graph:_process_decision:204 - Decision missing next_section
2024-12-30 17:23:21 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:23:21 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:23:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:23:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:23:21 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:23:21 | ERROR    | managers.agent_manager:process_game_state:182 - No valid result from workflow
2024-12-30 17:23:21 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: No valid result
2024-12-30 17:23:21 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No valid result
2024-12-30 17:24:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:24:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:24:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:24:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:24:07 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:24:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:24:07 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:24:07 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-30 17:24:07 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:24:07 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 23, 17, 695717), last_update=datetime.datetime(2024, 12, 30, 17, 23, 17, 695734)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:bb505274-5a6f-3336-a98b-d1cf02eefb35'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current in namespace state
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:24:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:24:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current.json
2024-12-30 17:24:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_current
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1 in namespace state
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:24:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:24:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:24:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\813bcb1d-a134-40a8-a635-21b754ca8c4a\states\game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1.json
2024-12-30 17:24:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_813bcb1d-a134-40a8-a635-21b754ca8c4a_section_1
2024-12-30 17:24:07 | INFO     | managers.agent_manager:stop_game:335 - Final game state saved successfully
2024-12-30 17:24:07 | INFO     | managers.agent_manager:stop_game:337 - Game stopped successfully
2024-12-30 17:24:07 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:24:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:24:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:24:15 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:24:15 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:24:15 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:24:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:24:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:24:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:24:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:24:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:24:15 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:24:15 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:24:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:24:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:24:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:24:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:24:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:24:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:24:17 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:24:17 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:24:17 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:24:17 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:24:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:24:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:24:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:24:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:24:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:24:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:24:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:24:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:24:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:24:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:24:42 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:24:42 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:25:20 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:25:20 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:25:20 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:25:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:25:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:25:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:25:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:25:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:25:49 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-30 17:25:49 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-30 17:25:49 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-30 17:25:49 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-30 17:25:49 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-30 17:25:49 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-30 17:25:49 | INFO     | __main__:<module>:39 - DÃ©marrage du serveur sur 127.0.0.1:8000
2024-12-30 17:25:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:25:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:25:51 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:25:52 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:25:52 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:25:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:25:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:25:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:25:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:25:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:25:52 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:25:52 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:25:52 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:25:52 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:25:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:25:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:25:52 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:25:52 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:25:52 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:25:52 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:25:52 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:25:52 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:25:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:25:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:25:52 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:25:52 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:25:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:25:57 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:25:57 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:25:57 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:25:57 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:25:57 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:25:57 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 47a3be78-2578-4904-bee6-d9cc524e2a28
2024-12-30 17:25:57 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 47a3be78-2578-4904-bee6-d9cc524e2a28
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\traces
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters
2024-12-30 17:25:57 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 47a3be78-2578-4904-bee6-d9cc524e2a28
2024-12-30 17:25:57 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 104f6641-f028-46af-8958-ff331871d090
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:25:57 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '104f6641-f028-46af-8958-ff331871d090', 'game_id': '47a3be78-2578-4904-bee6-d9cc524e2a28', 'last_update': '2024-12-30T17:25:57.113508', 'character_id': 'current'}
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:25:57 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:25:57 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:25:57 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:25:57 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:25:57 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ac451b39-ed3b-438a-8072-6ca73502d642
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:25:57 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ac451b39-ed3b-438a-8072-6ca73502d642', 'game_id': '47a3be78-2578-4904-bee6-d9cc524e2a28', 'last_update': '2024-12-30T17:25:57.132901', 'character_id': 'current'}
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:25:57 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: ac451b39-ed3b-438a-8072-6ca73502d642 and game_id: 47a3be78-2578-4904-bee6-d9cc524e2a28
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:25:57 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: ac451b39-ed3b-438a-8072-6ca73502d642 and section_number: 1
2024-12-30 17:25:57 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:25:57 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:25:57 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:25:57 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:25:57 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:25:57 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:25:57 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:25:57 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:25:57 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:25:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:25:57 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:25:57 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:25:57 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:25:57 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:25:57 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:25:57 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:25:57 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:25:57 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:25:57 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:25:57 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:25:57 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:25:57 | ERROR    | agents.story_graph:_process_decision:222 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=1240)
                                      â           â <function spawn_main at 0x00000284B68C0860>
                                      â <function spawn_main at 0x00000284B68C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 604
               â     â 3
               â <function _main at 0x00000284B68C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 604
           â    â <function BaseProcess._bootstrap at 0x00000284B6806A20>
           â <SpawnProcess name='SpawnProcess-1' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x00000284B6805F80>
    â <SpawnProcess name='SpawnProcess-1' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x00000284BBCAF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-1' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-1' parent=48440 started>
    â    â <function subprocess_started at 0x00000284BBD0E700>
    â <SpawnProcess name='SpawnProcess-1' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=752, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x00000284BBCAF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=752, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x00000284BBD0D9E0>
           â       â   â <uvicorn.server.Server object at 0x00000284BBCAF4D0>
           â       â <function run at 0x00000284B6D063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x00000284BBD06420>
           â      â <function Runner.run at 0x00000284B6D704A0>
           â <asyncio.runners.Runner object at 0x00000284BBD38050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x00000284B6D69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x00000284BBD38050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x00000284B6D69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x00000284B6D6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x00000284B6CED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284BC1056C0>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284BC1056C0>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284BC1056C0>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x00000284BC1056C0>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x00000284BB9671A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)
2024-12-30 17:25:57 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:25:57 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:25:57 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:25:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:25:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:25:57 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-30 17:25:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:25:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:25:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='104f6641-f028-46af-8958-ff331871d090' game_id='47a3be78-2578-4904-bee6-d9cc524e2a28' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:25:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:25:57 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='104f6641-f028-46af-8958-ff331871d090' game_id='47a3be78-2578-4904-bee6-d9cc524e2a28' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:26:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:26:06 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:26:06 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='104f6641-f028-46af-8958-ff331871d090' game_id='47a3be78-2578-4904-bee6-d9cc524e2a28' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:26:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:26:12 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '47a3be78-2578-4904-bee6-d9cc524e2a28', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:26:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='47a3be78-2578-4904-bee6-d9cc524e2a28' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:26:12 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 17:26:12 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:26:12 | DEBUG    | managers.agent_manager:process_game_state:162 - No state provided, getting current state
2024-12-30 17:26:12 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:26:12 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='104f6641-f028-46af-8958-ff331871d090' game_id='47a3be78-2578-4904-bee6-d9cc524e2a28' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:26:12 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:26:12 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:26:12 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:26:12 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:26:12 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:26:12 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 3c3b6705-0ff4-4366-b561-337622cac39e
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\characters\current.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:26:12 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '3c3b6705-0ff4-4366-b561-337622cac39e', 'game_id': '47a3be78-2578-4904-bee6-d9cc524e2a28', 'last_update': '2024-12-30T17:26:12.200388', 'character_id': 'current'}
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:26:12 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 3c3b6705-0ff4-4366-b561-337622cac39e and game_id: 47a3be78-2578-4904-bee6-d9cc524e2a28
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:26:12 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 3c3b6705-0ff4-4366-b561-337622cac39e and section_number: 1
2024-12-30 17:26:12 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:26:12 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:26:12 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:26:12 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:26:12 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:26:12 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:26:12 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:26:12 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:26:12 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:26:12 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:26:12 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:26:12 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:26:12 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:26:12 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:26:12 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:26:12 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:26:12 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:26:12 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:26:12 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:26:12 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:26:12 | DEBUG    | agents.story_graph:_process_decision:189 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:26:12 | DEBUG    | agents.decision_agent:ainvoke:170 - Processing decision for state: session=, section=1
2024-12-30 17:26:12 | DEBUG    | agents.decision_agent:ainvoke:190 - Decision processed successfully
2024-12-30 17:26:12 | ERROR    | agents.story_graph:_process_decision:204 - Decision missing next_section
2024-12-30 17:26:12 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:26:12 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:26:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:26:12 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:26:12 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:26:12 | ERROR    | managers.agent_manager:process_game_state:182 - No valid result from workflow
2024-12-30 17:26:12 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: No valid result
2024-12-30 17:26:12 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No valid result
2024-12-30 17:31:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:31:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:31:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:31:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:31:09 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:31:09 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:09 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:31:09 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-30 17:31:09 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:09 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 25, 57, 169811), last_update=datetime.datetime(2024, 12, 30, 17, 25, 57, 169822)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:845a91ac-1cf3-aeaa-a410-c57d1088a985'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:31:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_current in namespace state
2024-12-30 17:31:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:31:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:31:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_current.json
2024-12-30 17:31:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_current
2024-12-30 17:31:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1 in namespace state
2024-12-30 17:31:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:31:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:31:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\47a3be78-2578-4904-bee6-d9cc524e2a28\states\game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1.json
2024-12-30 17:31:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_47a3be78-2578-4904-bee6-d9cc524e2a28_section_1
2024-12-30 17:31:10 | INFO     | managers.agent_manager:stop_game:335 - Final game state saved successfully
2024-12-30 17:31:10 | INFO     | managers.agent_manager:stop_game:337 - Game stopped successfully
2024-12-30 17:31:10 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:31:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:31:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:31:20 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:31:20 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:31:20 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:31:20 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:31:20 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:31:20 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:31:20 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:31:20 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:31:20 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:31:20 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:31:20 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:31:20 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:31:20 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:31:20 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:31:20 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:31:20 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:31:21 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:31:21 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:31:21 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:31:21 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:31:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:31:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:31:21 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:21 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:31:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:31:21 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:21 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:31:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:31:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:31:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:31:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:29 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:31:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:31:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:31:30 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:30 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:31:32 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:33 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:31:33 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:31:33 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:31:33 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:31:33 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:31:33 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc
2024-12-30 17:31:33 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\traces
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters
2024-12-30 17:31:33 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc
2024-12-30 17:31:33 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 026f30e8-ac4d-451b-9afb-218ae577e947
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:31:33 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '026f30e8-ac4d-451b-9afb-218ae577e947', 'game_id': 'f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc', 'last_update': '2024-12-30T17:31:33.028977', 'character_id': 'current'}
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:33 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:31:33 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:31:33 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:31:33 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:31:33 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 402eec1a-d27f-41fa-b8e1-e4608af6e805
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:31:33 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '402eec1a-d27f-41fa-b8e1-e4608af6e805', 'game_id': 'f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc', 'last_update': '2024-12-30T17:31:33.054685', 'character_id': 'current'}
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:33 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 402eec1a-d27f-41fa-b8e1-e4608af6e805 and game_id: f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:33 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 402eec1a-d27f-41fa-b8e1-e4608af6e805 and section_number: 1
2024-12-30 17:31:33 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:31:33 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:31:33 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:31:33 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:31:33 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:31:33 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:31:33 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:31:33 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:31:33 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:31:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:31:33 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:31:33 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:31:33 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:31:33 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:31:33 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:31:33 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:31:33 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:31:33 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:31:33 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:31:33 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:31:33 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:31:33 | ERROR    | agents.story_graph:_process_decision:223 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=1288)
                                      â           â <function spawn_main at 0x00000296366C0860>
                                      â <function spawn_main at 0x00000296366C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 612
               â     â 3
               â <function _main at 0x00000296366C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 612
           â    â <function BaseProcess._bootstrap at 0x0000029636606A20>
           â <SpawnProcess name='SpawnProcess-2' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x0000029636605F80>
    â <SpawnProcess name='SpawnProcess-2' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x000002963BBAF0E0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-2' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-2' parent=48440 started>
    â    â <function subprocess_started at 0x000002963BE12700>
    â <SpawnProcess name='SpawnProcess-2' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=912, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x000002963BBAF230>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=912, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000002963BE119E0>
           â       â   â <uvicorn.server.Server object at 0x000002963BBAF230>
           â       â <function run at 0x0000029636C063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x000002963BE06420>
           â      â <function Runner.run at 0x0000029636C704A0>
           â <asyncio.runners.Runner object at 0x000002963BBAFCB0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x0000029636C69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x000002963BBAFCB0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x0000029636C69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x0000029636C6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x0000029636BED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002963BFA1F60>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002963BFA1F60>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002963BFA1F60>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002963BFA1F60>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x000002963BAFF1A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)
2024-12-30 17:31:33 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:31:33 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:33 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:33 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-30 17:31:33 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:31:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='026f30e8-ac4d-451b-9afb-218ae577e947' game_id='f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 31, 33, 105838), last_update=datetime.datetime(2024, 12, 30, 17, 31, 33, 105874)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:31:33 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:33 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='026f30e8-ac4d-451b-9afb-218ae577e947' game_id='f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 31, 33, 105838), last_update=datetime.datetime(2024, 12, 30, 17, 31, 33, 105874)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:31:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:31:35 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:31:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:31:35 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 17:31:35 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:31:35 | DEBUG    | managers.agent_manager:process_game_state:162 - No state provided, getting current state
2024-12-30 17:31:35 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:31:35 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='026f30e8-ac4d-451b-9afb-218ae577e947' game_id='f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 31, 33, 105838), last_update=datetime.datetime(2024, 12, 30, 17, 31, 33, 105874)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:31:35 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:31:35 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:31:35 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 31, 33, 105838), last_update=datetime.datetime(2024, 12, 30, 17, 31, 33, 105874)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:31:35 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:31:35 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:31:35 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8c38339f-b30a-4530-9ace-a2b4fbe66335
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\characters\current.json
2024-12-30 17:31:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:31:35 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8c38339f-b30a-4530-9ace-a2b4fbe66335', 'game_id': 'f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc', 'last_update': '2024-12-30T17:31:35.993273', 'character_id': 'current'}
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:36 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 8c38339f-b30a-4530-9ace-a2b4fbe66335 and game_id: f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:36 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 8c38339f-b30a-4530-9ace-a2b4fbe66335 and section_number: 1
2024-12-30 17:31:36 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:31:36 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:31:36 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:31:36 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:31:36 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:31:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:31:36 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:31:36 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:31:36 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:31:36 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:31:36 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:31:36 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:31:36 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:31:36 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:31:36 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:31:36 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:31:36 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:31:36 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:31:36 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:31:36 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:31:36 | DEBUG    | agents.story_graph:_process_decision:189 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:31:36 | DEBUG    | agents.decision_agent:ainvoke:170 - Processing decision for state: session=, section=1
2024-12-30 17:31:36 | DEBUG    | agents.decision_agent:ainvoke:190 - Decision processed successfully
2024-12-30 17:31:36 | DEBUG    | agents.story_graph:_process_decision:214 - Decision processed: next_section=None
2024-12-30 17:31:36 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:31:36 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:31:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:31:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:31:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:31:36 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:31:36 | ERROR    | managers.agent_manager:process_game_state:182 - No valid result from workflow
2024-12-30 17:31:36 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: No valid result
2024-12-30 17:31:36 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No valid result
2024-12-30 17:34:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:34:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:34:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:34:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:34:22 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:34:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:34:22 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:34:22 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-30 17:34:22 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:34:22 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 31, 33, 105838), last_update=datetime.datetime(2024, 12, 30, 17, 31, 33, 105874)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=DecisionModel(section_number=1, next_section=None, error=None, awaiting_action=<ActionType.DICE_ROLL: 'dice_roll'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 17, 31, 36, 38266)) error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:247bad4b-600a-fe2e-760b-b2e47b455a57'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current in namespace state
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:34:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:34:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current.json
2024-12-30 17:34:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_current
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1 in namespace state
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:34:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:34:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:34:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc\states\game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1.json
2024-12-30 17:34:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc_section_1
2024-12-30 17:34:22 | INFO     | managers.agent_manager:stop_game:335 - Final game state saved successfully
2024-12-30 17:34:22 | INFO     | managers.agent_manager:stop_game:337 - Game stopped successfully
2024-12-30 17:34:22 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:34:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:34:30 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:34:30 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:34:30 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:34:30 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:34:30 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:34:30 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:34:30 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:34:30 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:34:30 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:34:30 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:34:30 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:34:30 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:34:30 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:34:30 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:34:30 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:34:30 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:34:30 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:34:32 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:34:32 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:34:32 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:34:32 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:34:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:34:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:34:32 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:34:32 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:34:32 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:34:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:34:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:34:32 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:34:32 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:36:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:36:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:36:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:36:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:36:17 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:36:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:36:17 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:36:17 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-30 17:36:17 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-30 17:36:17 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:36:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:36:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:36:27 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:36:27 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:36:27 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:36:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:36:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:36:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:36:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:36:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:36:27 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:36:27 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:36:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:36:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:36:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:36:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:36:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:36:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:36:28 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:36:28 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:36:28 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:36:28 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:36:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:36:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:36:28 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:36:28 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:36:28 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:36:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:36:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:36:28 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:36:28 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:38:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:38:50 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:38:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='f631fa4a-7ec5-453b-bf9c-bb9c8e1aa6bc' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:38:50 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 17:38:50 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:38:50 | ERROR    | managers.agent_manager:process_game_state:157 - Story graph not initialized
2024-12-30 17:38:50 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: Story graph not initialized
2024-12-30 17:38:50 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Story graph not initialized
2024-12-30 17:39:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:34 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:39:34 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:39:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:47 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:39:47 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:39:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:39:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:39:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:39:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:39:56 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:39:56 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:39:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:57 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:39:57 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:39:57 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:39:57 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:39:57 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:39:57 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: a049d985-4cbc-4a35-bba5-50926e5e506c
2024-12-30 17:39:57 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: a049d985-4cbc-4a35-bba5-50926e5e506c
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\traces
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters
2024-12-30 17:39:57 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: a049d985-4cbc-4a35-bba5-50926e5e506c
2024-12-30 17:39:57 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 9fcdbc25-8b22-43e4-b60e-5e8616f10562
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:39:57 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '9fcdbc25-8b22-43e4-b60e-5e8616f10562', 'game_id': 'a049d985-4cbc-4a35-bba5-50926e5e506c', 'last_update': '2024-12-30T17:39:57.455918', 'character_id': 'current'}
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:39:57 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:39:57 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:39:57 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:39:57 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:39:57 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: fc2ff464-17f5-45fe-9021-7c31c5433615
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\characters\current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:39:57 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'fc2ff464-17f5-45fe-9021-7c31c5433615', 'game_id': 'a049d985-4cbc-4a35-bba5-50926e5e506c', 'last_update': '2024-12-30T17:39:57.532268', 'character_id': 'current'}
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:39:57 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: fc2ff464-17f5-45fe-9021-7c31c5433615 and game_id: a049d985-4cbc-4a35-bba5-50926e5e506c
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:39:57 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: fc2ff464-17f5-45fe-9021-7c31c5433615 and section_number: 1
2024-12-30 17:39:57 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:39:57 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:39:57 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:39:57 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:39:57 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:39:57 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:39:57 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:39:57 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:39:57 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:39:57 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:39:57 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:39:57 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:39:57 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:39:57 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:39:57 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:39:57 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:39:57 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:39:57 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:39:57 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:39:57 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:39:57 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:39:57 | ERROR    | agents.story_graph:_process_decision:223 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:6bf08c08-8945-1804-4f2d-cb86f5d99571'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=1452)
                                      â           â <function spawn_main at 0x000002B72C8C0860>
                                      â <function spawn_main at 0x000002B72C8C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 612
               â     â 3
               â <function _main at 0x000002B72C8C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 612
           â    â <function BaseProcess._bootstrap at 0x000002B72C806A20>
           â <SpawnProcess name='SpawnProcess-4' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x000002B72C805F80>
    â <SpawnProcess name='SpawnProcess-4' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x000002B731DAF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-4' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-4' parent=48440 started>
    â    â <function subprocess_started at 0x000002B73200E700>
    â <SpawnProcess name='SpawnProcess-4' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=708, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x000002B731DAF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=708, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000002B73200D9E0>
           â       â   â <uvicorn.server.Server object at 0x000002B731DAF4D0>
           â       â <function run at 0x000002B72CD063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x000002B732002420>
           â      â <function Runner.run at 0x000002B72CD704A0>
           â <asyncio.runners.Runner object at 0x000002B732038050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x000002B72CD69E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x000002B732038050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x000002B72CD69DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x000002B72CD6BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x000002B72CCED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002B7321A6C20>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002B7321A6C20>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002B7321A6C20>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000002B7321A6C20>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x000002B73191F1A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:6bf08c08-8945-1804-4f2d-cb86f5d99571'], when='during'),)
2024-12-30 17:39:57 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:39:57 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:39:57 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:39:57 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:39:57 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:39:57 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-30 17:39:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:39:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='9fcdbc25-8b22-43e4-b60e-5e8616f10562' game_id='a049d985-4cbc-4a35-bba5-50926e5e506c' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 39, 57, 594480), last_update=datetime.datetime(2024, 12, 30, 17, 39, 57, 594821)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:6bf08c08-8945-1804-4f2d-cb86f5d99571'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:39:57 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:39:57 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='9fcdbc25-8b22-43e4-b60e-5e8616f10562' game_id='a049d985-4cbc-4a35-bba5-50926e5e506c' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 39, 57, 594480), last_update=datetime.datetime(2024, 12, 30, 17, 39, 57, 594821)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:6bf08c08-8945-1804-4f2d-cb86f5d99571'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:42:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:42:08 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:42:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:42:08 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:42:08 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-30 17:42:08 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:42:08 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='9fcdbc25-8b22-43e4-b60e-5e8616f10562' game_id='a049d985-4cbc-4a35-bba5-50926e5e506c' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 39, 57, 594480), last_update=datetime.datetime(2024, 12, 30, 17, 39, 57, 594821)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:6bf08c08-8945-1804-4f2d-cb86f5d99571'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_current in namespace state
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:42:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:42:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_current.json
2024-12-30 17:42:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_current
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1 in namespace state
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:42:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:42:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:42:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a049d985-4cbc-4a35-bba5-50926e5e506c\states\game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1.json
2024-12-30 17:42:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_a049d985-4cbc-4a35-bba5-50926e5e506c_section_1
2024-12-30 17:42:08 | INFO     | managers.agent_manager:stop_game:340 - Final game state saved successfully
2024-12-30 17:42:08 | INFO     | managers.agent_manager:stop_game:342 - Game stopped successfully
2024-12-30 17:42:08 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:42:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:42:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:42:16 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:42:16 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:42:16 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:42:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:42:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:42:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:42:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:42:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:42:16 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:42:16 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:42:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:42:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:42:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:42:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:42:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:42:17 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:42:17 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:42:17 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:42:17 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:42:17 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:42:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:42:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:42:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:42:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:43:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:43:48 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:43:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:43:48 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:43:48 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-30 17:43:48 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-30 17:43:48 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:43:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:43:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:43:57 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:43:58 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:43:58 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:43:58 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:43:58 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:43:58 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:43:58 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:43:58 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:43:58 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:43:58 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:43:58 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:43:58 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:43:58 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:43:58 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:43:58 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:44:00 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:44:00 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:44:00 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:44:00 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:44:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:44:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:44:00 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:04 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:44:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:04 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:44:04 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:44:04 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:44:04 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:44:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:44:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:44:11 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:44:12 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:44:12 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:44:12 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:44:12 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:12 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:44:12 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:44:12 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:12 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:44:12 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:44:12 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:44:12 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:44:12 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:44:12 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:44:12 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:44:12 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:44:13 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:44:13 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:44:13 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:44:13 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:13 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:44:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:44:47 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:44:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:47 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:44:47 | INFO     | managers.agent_manager:stop_game:319 - Stopping game...
2024-12-30 17:44:47 | DEBUG    | managers.agent_manager:stop_game:324 - No game ID set, nothing to save
2024-12-30 17:44:47 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:44:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:44:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:44:52 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:44:52 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:44:52 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:44:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:44:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:44:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:44:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:44:52 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:44:52 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:44:52 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:44:52 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:44:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:44:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:44:52 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:44:52 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:44:53 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:44:53 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:44:53 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:44:53 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:53 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:53 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:44:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:53 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:44:58 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'a049d985-4cbc-4a35-bba5-50926e5e506c', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:44:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='a049d985-4cbc-4a35-bba5-50926e5e506c' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:44:58 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:44:58 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:44:58 | ERROR    | managers.agent_manager:process_game_state:172 - Error processing game state: No game state available
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=2836)
                                      â           â <function spawn_main at 0x0000027F1E0C0860>
                                      â <function spawn_main at 0x0000027F1E0C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 560
               â     â 3
               â <function _main at 0x0000027F1E0C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 560
           â    â <function BaseProcess._bootstrap at 0x0000027F1E006A20>
           â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x0000027F1E005F80>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x0000027F234B3380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â <function subprocess_started at 0x0000027F2350E5C0>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x0000027F234B34D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x0000027F2350D8A0>
           â       â   â <uvicorn.server.Server object at 0x0000027F234B34D0>
           â       â <function run at 0x0000027F1E5063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000027F234FE500>
           â      â <function Runner.run at 0x0000027F1E5704A0>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x0000027F1E569E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x0000027F1E569DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x0000027F1E56BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x0000027F1E4ED3A0>
    â <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle Task.task_wakeup()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle Task.task_wakeup()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle Task.task_wakeup()>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\protocols\websockets\wsproto_impl.py", line 235, in run_asgi
    result = await self.app(self.scope, self.receive, self.send)  # type: ignore[func-returns-value]
                   â    â   â    â      â    â        â    â <function WSProtocol.send at 0x0000027F235CB2E0>
                   â    â   â    â      â    â        â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>
                   â    â   â    â      â    â <function WSProtocol.receive at 0x0000027F235CB380>
                   â    â   â    â      â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>
                   â    â   â    â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                   â    â   â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>
                   â    â <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027F1E6B38C0>
                   â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
                 â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
                 â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                 â    â <fastapi.applications.FastAPI object at 0x0000027F23087770>
                 â <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027F1E6B38C0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
                           â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
                           â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          â    â                â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â                â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â                â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027F1E6B2270>
          â <fastapi.applications.FastAPI object at 0x0000027F23087770>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
          â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.cors.CORSMiddleware object at 0x0000027F1E6B30E0>
          â <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027F1E6B2270>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
          â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027F1E6B2CF0>
          â <starlette.middleware.cors.CORSMiddleware object at 0x0000027F1E6B30E0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          â                            â    â    â     â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â                            â    â    â     â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â                            â    â    â     â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â                            â    â    â <starlette.websockets.WebSocket object at 0x0000027F235DB6F0>
          â                            â    â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
          â                            â <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027F1E6B2CF0>
          â <function wrap_app_handling_exceptions at 0x0000027F210BD260>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239045E0>
          â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          â    â                â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239045E0>
          â    â                â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â                â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000027F230805A0>>
          â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          â     â      â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239045E0>
          â     â      â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â     â      â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â     â <function WebSocketRoute.handle at 0x0000027F210BEF20>
          â APIWebSocketRoute(path='/api/ws/game', name='game_websocket_endpoint')
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
          â    â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239045E0>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <function websocket_session.<locals>.app at 0x0000027F234916C0>
          â APIWebSocketRoute(path='/api/ws/game', name='game_websocket_endpoint')
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
          â                            â    â        â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239045E0>
          â                            â    â        â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â                            â    â        â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â                            â    â <starlette.websockets.WebSocket object at 0x0000027F238CE450>
          â                            â <function websocket_session.<locals>.app.<locals>.app at 0x0000027F239047C0>
          â <function wrap_app_handling_exceptions at 0x0000027F210BD260>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F23904900>
          â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F23910E10>>
          â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â <function websocket_session.<locals>.app.<locals>.app at 0x0000027F239047C0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
          â    â <starlette.websockets.WebSocket object at 0x0000027F238CE450>
          â <function get_websocket_app.<locals>.app at 0x0000027F23491620>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
          â         â      â             â {'agent_mgr': <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>, 'websocket': <starlette.websockets.WebSocke...
          â         â      â SolvedDependency(values={'agent_mgr': <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>, 'websocket': <starl...
          â         â <function game_websocket_endpoint at 0x0000027F22C42520>
          â Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[Dependant(path_p...

  File "C:\Users\erpes\Desktop\casys-rpg\api\routes\ws\game_route_ws.py", line 137, in game_websocket_endpoint
    new_state = await agent_mgr.process_game_state(
                      â         â <function AgentManager.process_game_state at 0x0000027F22C40540>
                      â <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>

> File "C:\Users\erpes\Desktop\casys-rpg\managers\agent_manager.py", line 149, in process_game_state
    raise GameError("No game state available")
          â <class 'models.errors_model.GameError'>

models.errors_model.GameError: No game state available
2024-12-30 17:44:58 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No game state available
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:45:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:45:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:07 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:45:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:180 - Current state: None
2024-12-30 17:45:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:08 | INFO     | managers.agent_manager:initialize_game:196 - Initializing game
2024-12-30 17:45:08 | INFO     | managers.agent_manager:get_story_workflow:247 - Getting story workflow
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_story_workflow:251 - Story graph not configured, configuring now
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_story_workflow:260 - Compiling workflow
2024-12-30 17:45:08 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:45:08 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:45:08 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:45:08 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 2416d142-0007-42b8-923f-55e74bff0ccf
2024-12-30 17:45:08 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 2416d142-0007-42b8-923f-55e74bff0ccf
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\traces
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters
2024-12-30 17:45:08 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 2416d142-0007-42b8-923f-55e74bff0ccf
2024-12-30 17:45:08 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 3be4bced-3c0b-4192-823b-59a698f6de2b
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:45:08 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '3be4bced-3c0b-4192-823b-59a698f6de2b', 'game_id': '2416d142-0007-42b8-923f-55e74bff0ccf', 'last_update': '2024-12-30T17:45:08.306687', 'character_id': 'current'}
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:08 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:45:08 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:45:08 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:45:08 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:45:08 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 188a22cf-6192-446d-91af-2a963429f1eb
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:45:08 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '188a22cf-6192-446d-91af-2a963429f1eb', 'game_id': '2416d142-0007-42b8-923f-55e74bff0ccf', 'last_update': '2024-12-30T17:45:08.327069', 'character_id': 'current'}
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:08 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 188a22cf-6192-446d-91af-2a963429f1eb and game_id: 2416d142-0007-42b8-923f-55e74bff0ccf
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:08 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 188a22cf-6192-446d-91af-2a963429f1eb and section_number: 1
2024-12-30 17:45:08 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:45:08 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:45:08 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:45:08 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:45:08 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:45:08 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:45:08 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:45:08 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:45:08 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:45:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:45:08 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:45:08 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:45:08 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:45:08 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:45:08 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:45:08 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:45:08 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:45:08 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:45:08 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:45:08 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:45:08 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:45:08 | ERROR    | agents.story_graph:_process_decision:228 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=2836)
                                      â           â <function spawn_main at 0x0000027F1E0C0860>
                                      â <function spawn_main at 0x0000027F1E0C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 560
               â     â 3
               â <function _main at 0x0000027F1E0C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 560
           â    â <function BaseProcess._bootstrap at 0x0000027F1E006A20>
           â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x0000027F1E005F80>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x0000027F234B3380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â <function subprocess_started at 0x0000027F2350E5C0>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x0000027F234B34D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x0000027F2350D8A0>
           â       â   â <uvicorn.server.Server object at 0x0000027F234B34D0>
           â       â <function run at 0x0000027F1E5063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000027F234FE500>
           â      â <function Runner.run at 0x0000027F1E5704A0>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x0000027F1E569E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x0000027F1E569DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x0000027F1E56BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x0000027F1E4ED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027F239003D0>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027F239003D0>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027F239003D0>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000027F239003D0>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x0000027F231671A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)
2024-12-30 17:45:08 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:45:08 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:08 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:08 | INFO     | managers.agent_manager:initialize_game:224 - Game initialization completed successfully
2024-12-30 17:45:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:180 - Current state: session_id='3be4bced-3c0b-4192-823b-59a698f6de2b' game_id='2416d142-0007-42b8-923f-55e74bff0ccf' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:45:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:08 | DEBUG    | managers.agent_manager:get_state:180 - Current state: session_id='3be4bced-3c0b-4192-823b-59a698f6de2b' game_id='2416d142-0007-42b8-923f-55e74bff0ccf' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:45:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 17:45:11 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '2416d142-0007-42b8-923f-55e74bff0ccf', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 17:45:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='2416d142-0007-42b8-923f-55e74bff0ccf' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 17:45:11 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:11 | DEBUG    | managers.agent_manager:get_state:180 - Current state: session_id='3be4bced-3c0b-4192-823b-59a698f6de2b' game_id='2416d142-0007-42b8-923f-55e74bff0ccf' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:45:11 | DEBUG    | managers.agent_manager:process_game_state:151 - Processing game state: session_id='3be4bced-3c0b-4192-823b-59a698f6de2b' game_id='2416d142-0007-42b8-923f-55e74bff0ccf' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:45:11 | INFO     | managers.agent_manager:get_story_workflow:247 - Getting story workflow
2024-12-30 17:45:11 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:45:11 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:45:11 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:45:11 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:45:11 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: d6798332-c21a-45c1-8bcb-98a6c2407124
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\characters\current.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:45:11 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd6798332-c21a-45c1-8bcb-98a6c2407124', 'game_id': '2416d142-0007-42b8-923f-55e74bff0ccf', 'last_update': '2024-12-30T17:45:11.047031', 'character_id': 'current'}
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:11 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: d6798332-c21a-45c1-8bcb-98a6c2407124 and game_id: 2416d142-0007-42b8-923f-55e74bff0ccf
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:11 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: d6798332-c21a-45c1-8bcb-98a6c2407124 and section_number: 1
2024-12-30 17:45:11 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:45:11 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:45:11 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:45:11 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:45:11 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:45:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:45:11 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:45:11 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:45:11 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:45:11 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:45:11 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:45:11 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:45:11 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:45:11 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:45:11 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 17:45:11 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:45:11 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:45:11 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:45:11 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:45:11 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:45:11 | DEBUG    | agents.story_graph:_process_decision:189 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 17:45:11 | DEBUG    | agents.decision_agent:ainvoke:170 - Processing decision for state: session=, section=1
2024-12-30 17:45:11 | DEBUG    | agents.decision_agent:ainvoke:190 - Decision processed successfully
2024-12-30 17:45:11 | DEBUG    | agents.story_graph:_process_decision:214 - Decision processed: next_section=None
2024-12-30 17:45:11 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:45:11 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:11 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:45:11 | ERROR    | managers.agent_manager:process_game_state:168 - No valid result from workflow
2024-12-30 17:45:11 | ERROR    | managers.agent_manager:process_game_state:172 - Error processing game state: No valid result
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=48440, pipe_handle=2836)
                                      â           â <function spawn_main at 0x0000027F1E0C0860>
                                      â <function spawn_main at 0x0000027F1E0C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 560
               â     â 3
               â <function _main at 0x0000027F1E0C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 560
           â    â <function BaseProcess._bootstrap at 0x0000027F1E006A20>
           â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x0000027F1E005F80>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x0000027F234B3380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
    â    â <function subprocess_started at 0x0000027F2350E5C0>
    â <SpawnProcess name='SpawnProcess-8' parent=48440 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x0000027F234B34D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=644, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x0000027F2350D8A0>
           â       â   â <uvicorn.server.Server object at 0x0000027F234B34D0>
           â       â <function run at 0x0000027F1E5063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000027F234FE500>
           â      â <function Runner.run at 0x0000027F1E5704A0>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x0000027F1E569E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000027F23534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x0000027F1E569DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x0000027F1E56BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x0000027F1E4ED3A0>
    â <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle Task.task_wakeup()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle Task.task_wakeup()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle Task.task_wakeup()>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\protocols\websockets\wsproto_impl.py", line 235, in run_asgi
    result = await self.app(self.scope, self.receive, self.send)  # type: ignore[func-returns-value]
                   â    â   â    â      â    â        â    â <function WSProtocol.send at 0x0000027F235CB2E0>
                   â    â   â    â      â    â        â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>
                   â    â   â    â      â    â <function WSProtocol.receive at 0x0000027F235CB380>
                   â    â   â    â      â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>
                   â    â   â    â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                   â    â   â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>
                   â    â <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027F1E6B38C0>
                   â <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
                 â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
                 â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
                 â    â <fastapi.applications.FastAPI object at 0x0000027F23087770>
                 â <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000027F1E6B38C0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
                           â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
                           â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          â    â                â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â                â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â                â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027F1E6B2270>
          â <fastapi.applications.FastAPI object at 0x0000027F23087770>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\errors.py", line 152, in __call__
    await self.app(scope, receive, send)
          â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.cors.CORSMiddleware object at 0x0000027F1E6B30E0>
          â <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000027F1E6B2270>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\cors.py", line 77, in __call__
    await self.app(scope, receive, send)
          â    â   â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027F1E6B2CF0>
          â <starlette.middleware.cors.CORSMiddleware object at 0x0000027F1E6B30E0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          â                            â    â    â     â      â        â <bound method WSProtocol.send of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â                            â    â    â     â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â                            â    â    â     â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â                            â    â    â <starlette.websockets.WebSocket object at 0x0000027F2394D8B0>
          â                            â    â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
          â                            â <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000027F1E6B2CF0>
          â <function wrap_app_handling_exceptions at 0x0000027F210BD260>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239040E0>
          â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          â    â                â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239040E0>
          â    â                â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â                â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000027F230805A0>>
          â <fastapi.routing.APIRouter object at 0x0000027F230805A0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          â     â      â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239040E0>
          â     â      â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â     â      â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â     â <function WebSocketRoute.handle at 0x0000027F210BEF20>
          â APIWebSocketRoute(path='/api/ws/game', name='game_websocket_endpoint')
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 362, in handle
    await self.app(scope, receive, send)
          â    â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239040E0>
          â    â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â    â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â    â <function websocket_session.<locals>.app at 0x0000027F234916C0>
          â APIWebSocketRoute(path='/api/ws/game', name='game_websocket_endpoint')
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 95, in app
    await wrap_app_handling_exceptions(app, session)(scope, receive, send)
          â                            â    â        â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F239040E0>
          â                            â    â        â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â                            â    â        â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â                            â    â <starlette.websockets.WebSocket object at 0x0000027F2394DB80>
          â                            â <function websocket_session.<locals>.app.<locals>.app at 0x0000027F239047C0>
          â <function wrap_app_handling_exceptions at 0x0000027F210BD260>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          â   â      â        â <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000027F23904900>
          â   â      â <bound method WSProtocol.receive of <uvicorn.protocols.websockets.wsproto_impl.WSProtocol object at 0x0000027F238CD910>>
          â   â {'type': 'websocket', 'asgi': {'version': '3.0', 'spec_version': '2.4'}, 'http_version': '1.1', 'scheme': 'ws', 'server': ('1...
          â <function websocket_session.<locals>.app.<locals>.app at 0x0000027F239047C0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 93, in app
    await func(session)
          â    â <starlette.websockets.WebSocket object at 0x0000027F2394DB80>
          â <function get_websocket_app.<locals>.app at 0x0000027F23491620>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\fastapi\routing.py", line 383, in app
    await dependant.call(**solved_result.values)
          â         â      â             â {'agent_mgr': <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>, 'websocket': <starlette.websockets.WebSocke...
          â         â      â SolvedDependency(values={'agent_mgr': <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>, 'websocket': <starl...
          â         â <function game_websocket_endpoint at 0x0000027F22C42520>
          â Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[], dependencies=[Dependant(path_p...

  File "C:\Users\erpes\Desktop\casys-rpg\api\routes\ws\game_route_ws.py", line 137, in game_websocket_endpoint
    new_state = await agent_mgr.process_game_state(
                      â         â <function AgentManager.process_game_state at 0x0000027F22C40540>
                      â <managers.agent_manager.AgentManager object at 0x0000027F238FFCB0>

> File "C:\Users\erpes\Desktop\casys-rpg\managers\agent_manager.py", line 169, in process_game_state
    raise GameError("No valid result")
          â <class 'models.errors_model.GameError'>

models.errors_model.GameError: No valid result
2024-12-30 17:45:11 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No valid result
2024-12-30 17:45:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:42 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:45:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:42 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:45:42 | INFO     | managers.agent_manager:stop_game:319 - Stopping game...
2024-12-30 17:45:42 | DEBUG    | managers.agent_manager:get_state:178 - Fetching current game state
2024-12-30 17:45:42 | DEBUG    | managers.agent_manager:get_state:180 - Current state: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 45, 8, 367246), last_update=datetime.datetime(2024, 12, 30, 17, 45, 8, 367257)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=DecisionModel(section_number=1, next_section=None, error=None, awaiting_action=<ActionType.DICE_ROLL: 'dice_roll'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 17, 45, 11, 121106)) error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:21697fe5-eefc-78dc-2331-f98f51d8fe85'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_current in namespace state
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:42 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:42 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_current.json
2024-12-30 17:45:42 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_current
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1 in namespace state
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:45:42 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:42 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:42 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2416d142-0007-42b8-923f-55e74bff0ccf\states\game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1.json
2024-12-30 17:45:42 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_2416d142-0007-42b8-923f-55e74bff0ccf_section_1
2024-12-30 17:45:42 | INFO     | managers.agent_manager:stop_game:331 - Final game state saved successfully
2024-12-30 17:45:42 | INFO     | managers.agent_manager:stop_game:333 - Game stopped successfully
2024-12-30 17:45:42 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:45:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:45:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:45:49 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:45:50 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:45:50 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:45:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:45:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:45:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:45:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:50 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:45:50 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:45:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:45:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:45:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:45:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:45:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:45:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:45:51 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:45:51 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:45:51 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:45:51 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:51 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:45:51 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:45:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:51 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:45:51 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:45:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:45:51 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:45:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:51 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:45:51 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:45:51 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:45:51 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:45:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:45:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:45:57 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:45:57 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:45:57 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:45:57 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:45:57 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:45:57 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:45:57 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:45:57 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:45:57 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:45:57 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:45:57 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:45:57 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:45:57 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:45:57 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:45:57 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:45:57 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:45:57 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:45:57 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:45:57 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:45:57 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:45:57 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:45:57 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:45:57 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:45:57 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:45:57 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:45:57 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:45:58 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:45:58 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:45:58 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:45:58 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:45:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:58 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:45:58 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:45:58 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:45:58 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:45:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:58 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 17:45:58 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 17:45:58 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:45:58 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:45:58 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:45:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:58 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 17:45:58 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 17:45:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:45:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:45:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:45:59 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:45:59 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:46:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:46:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:46:06 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:46:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:46:06 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:46:06 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:46:06 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:46:06 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:46:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:46:13 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-30 17:46:13 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-30 17:46:13 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-30 17:46:13 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-30 17:46:13 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-30 17:46:13 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-30 17:46:13 | INFO     | __main__:<module>:39 - DÃ©marrage du serveur sur 127.0.0.1:8000
2024-12-30 17:46:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:46:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:46:14 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:46:15 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:46:15 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:46:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:46:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:46:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:46:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:46:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:46:15 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:46:15 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:46:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:46:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:46:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:46:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:46:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:46:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:46:15 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:46:15 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:46:15 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:46:15 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:46:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:46:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:46:15 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:46:15 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:46:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:46:21 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:46:21 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:46:21 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:46:21 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:46:21 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:46:21 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:46:21 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:46:21 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: d2a72714-b0cc-4fb0-9212-f05d998797fc
2024-12-30 17:46:21 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: d2a72714-b0cc-4fb0-9212-f05d998797fc
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\traces
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters
2024-12-30 17:46:21 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: d2a72714-b0cc-4fb0-9212-f05d998797fc
2024-12-30 17:46:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 351939d8-7c3e-4290-9157-ab3a94df637a
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:46:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '351939d8-7c3e-4290-9157-ab3a94df637a', 'game_id': 'd2a72714-b0cc-4fb0-9212-f05d998797fc', 'last_update': '2024-12-30T17:46:21.861333', 'character_id': 'current'}
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:46:21 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:46:21 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:46:21 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:46:21 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:46:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 7c02d248-c6f5-4b43-9e83-30cdb7b51c94
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\characters\current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:46:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '7c02d248-c6f5-4b43-9e83-30cdb7b51c94', 'game_id': 'd2a72714-b0cc-4fb0-9212-f05d998797fc', 'last_update': '2024-12-30T17:46:21.886950', 'character_id': 'current'}
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:46:21 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 7c02d248-c6f5-4b43-9e83-30cdb7b51c94 and game_id: d2a72714-b0cc-4fb0-9212-f05d998797fc
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:46:21 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 7c02d248-c6f5-4b43-9e83-30cdb7b51c94 and section_number: 1
2024-12-30 17:46:21 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:46:21 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:46:21 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:46:21 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:46:21 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:46:21 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:46:21 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:46:21 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:46:21 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:46:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:46:21 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:46:21 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:46:21 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:46:21 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:46:21 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:46:21 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:46:21 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:46:21 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:46:21 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:46:21 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:46:21 | INFO     | agents.story_graph:_process_decision:185 - Waiting for user input in section 1
2024-12-30 17:46:21 | ERROR    | agents.story_graph:_process_decision:228 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:b9ec0e90-b284-1196-1588-734e388a0535'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=9856, pipe_handle=1144)
                                      â           â <function spawn_main at 0x000001E9B5FC0860>
                                      â <function spawn_main at 0x000001E9B5FC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 588
               â     â 3
               â <function _main at 0x000001E9B5FC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 588
           â    â <function BaseProcess._bootstrap at 0x000001E9B5F06A20>
           â <SpawnProcess name='SpawnProcess-1' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x000001E9B5F05F80>
    â <SpawnProcess name='SpawnProcess-1' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x000001E9BB4AF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-1' parent=9856 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-1' parent=9856 started>
    â    â <function subprocess_started at 0x000001E9BB50A700>
    â <SpawnProcess name='SpawnProcess-1' parent=9856 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=700, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x000001E9BB4AF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=700, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000001E9BB5099E0>
           â       â   â <uvicorn.server.Server object at 0x000001E9BB4AF4D0>
           â       â <function run at 0x000001E9B64063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x000001E9BB502500>
           â      â <function Runner.run at 0x000001E9B64704A0>
           â <asyncio.runners.Runner object at 0x000001E9BB534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x000001E9B6469E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x000001E9BB534050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x000001E9B6469DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x000001E9B646BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x000001E9B63ED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001E9BBAA1FC0>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001E9BBAA1FC0>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001E9BBAA1FC0>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x000001E9BBAA1FC0>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 186, in _process_decision
    return interrupt("Waiting for user input")
           â <function interrupt at 0x000001E9BB1671A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:b9ec0e90-b284-1196-1588-734e388a0535'], when='during'),)
2024-12-30 17:46:21 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 17:46:21 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:46:21 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:46:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:46:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:46:21 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-30 17:46:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:46:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:46:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:46:21 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:46:21 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='351939d8-7c3e-4290-9157-ab3a94df637a' game_id='d2a72714-b0cc-4fb0-9212-f05d998797fc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 46, 21, 924225), last_update=datetime.datetime(2024, 12, 30, 17, 46, 21, 924236)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:b9ec0e90-b284-1196-1588-734e388a0535'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:46:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:46:22 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:46:22 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='351939d8-7c3e-4290-9157-ab3a94df637a' game_id='d2a72714-b0cc-4fb0-9212-f05d998797fc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 46, 21, 924225), last_update=datetime.datetime(2024, 12, 30, 17, 46, 21, 924236)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:b9ec0e90-b284-1196-1588-734e388a0535'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:47:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:47:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:47:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:47:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:47:46 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:47:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:47:46 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:47:46 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:47:46 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:47:46 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='351939d8-7c3e-4290-9157-ab3a94df637a' game_id='d2a72714-b0cc-4fb0-9212-f05d998797fc' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 17, 46, 21, 924225), last_update=datetime.datetime(2024, 12, 30, 17, 46, 21, 924236)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:b9ec0e90-b284-1196-1588-734e388a0535'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current in namespace state
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:47:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:47:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current.json
2024-12-30 17:47:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_current
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1 in namespace state
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:47:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:47:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:47:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d2a72714-b0cc-4fb0-9212-f05d998797fc\states\game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1.json
2024-12-30 17:47:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_d2a72714-b0cc-4fb0-9212-f05d998797fc_section_1
2024-12-30 17:47:46 | INFO     | managers.agent_manager:stop_game:345 - Final game state saved successfully
2024-12-30 17:47:46 | INFO     | managers.agent_manager:stop_game:347 - Game stopped successfully
2024-12-30 17:47:46 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:47:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:47:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:48:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:48:00 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:48:01 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:48:01 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:48:01 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:48:01 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:01 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:48:01 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:48:01 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:01 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:48:01 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:48:01 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:48:01 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:48:01 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:48:01 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:48:01 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:48:01 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:48:02 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:48:02 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:48:02 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:48:02 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:48:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:48:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:48:02 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:48:02 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:48:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:48:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:48:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:48:02 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:48:02 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:48:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:48:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:48:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:48:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:48:20 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:48:20 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:48:20 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:48:20 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:48:20 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:48:20 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:48:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:48:26 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:48:26 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:48:26 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:48:26 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:48:26 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:48:26 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:26 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:48:26 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:48:26 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:48:26 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:48:26 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:48:26 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:48:26 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:48:26 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:48:26 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:48:26 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:48:26 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:48:27 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:48:27 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:48:27 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:48:27 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:48:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:48:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:48:27 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:48:27 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:48:27 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:48:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:48:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:48:27 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:48:27 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:49:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:49:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:49:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:49:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:49:35 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:49:35 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:49:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:49:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:49:35 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:49:35 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:49:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:49:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:49:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:49:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:49:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:49:36 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:49:36 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:49:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:49:37 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 17:49:37 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-30 17:49:37 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-30 17:49:37 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-30 17:49:37 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 17:49:37 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 17:49:37 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 17:49:37 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 9b89bd00-561b-4acd-ad84-c71d18373b94
2024-12-30 17:49:37 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 9b89bd00-561b-4acd-ad84-c71d18373b94
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\traces
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters
2024-12-30 17:49:37 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 9b89bd00-561b-4acd-ad84-c71d18373b94
2024-12-30 17:49:37 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 063682be-bbb2-4e32-9e0b-6eed03d145a1
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:49:37 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '063682be-bbb2-4e32-9e0b-6eed03d145a1', 'game_id': '9b89bd00-561b-4acd-ad84-c71d18373b94', 'last_update': '2024-12-30T17:49:37.400877', 'character_id': 'current'}
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_current in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_current
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1 in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1
2024-12-30 17:49:37 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 17:49:37 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:49:37 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 17:49:37 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 17:49:37 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b4d56dae-ba0a-4cab-b07c-56ae3c769f48
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\characters\current.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 17:49:37 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b4d56dae-ba0a-4cab-b07c-56ae3c769f48', 'game_id': '9b89bd00-561b-4acd-ad84-c71d18373b94', 'last_update': '2024-12-30T17:49:37.502268', 'character_id': 'current'}
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_current in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_current
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1 in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1
2024-12-30 17:49:37 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: b4d56dae-ba0a-4cab-b07c-56ae3c769f48 and game_id: 9b89bd00-561b-4acd-ad84-c71d18373b94
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_current in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_current
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1 in namespace state
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:49:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1
2024-12-30 17:49:37 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: b4d56dae-ba0a-4cab-b07c-56ae3c769f48 and section_number: 1
2024-12-30 17:49:37 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 17:49:37 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 17:49:37 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 17:49:37 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 17:49:37 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 17:49:37 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 17:49:37 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 17:49:37 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 17:49:37 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 17:49:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 17:49:37 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 17:49:37 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 17:49:37 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 17:49:37 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 17:49:37 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 17:49:37 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 17:49:37 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 17:49:37 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 17:49:37 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 17:49:37 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 17:49:37 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 17:49:37 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 17:49:37 | INFO     | agents.story_graph:_process_decision:184 - Waiting for user input in section 1
2024-12-30 17:49:37 | ERROR    | managers.agent_manager:initialize_game:245 - Error initializing game: catching classes that do not inherit from BaseException is not allowed
2024-12-30 17:49:37 | ERROR    | api.routes.rest.game_route_rest:initialize_game:35 - Failed to initialize game: Failed to initialize game: catching classes that do not inherit from BaseException is not allowed
2024-12-30 17:50:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:50:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:50:54 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:50:54 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:50:54 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:50:54 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:50:54 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:50:54 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='b4d56dae-ba0a-4cab-b07c-56ae3c769f48' game_id='9b89bd00-561b-4acd-ad84-c71d18373b94' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_current in namespace state
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:50:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:50:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_current.json
2024-12-30 17:50:54 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_current
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1 in namespace state
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 17:50:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:50:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:50:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b89bd00-561b-4acd-ad84-c71d18373b94\states\game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1.json
2024-12-30 17:50:54 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_9b89bd00-561b-4acd-ad84-c71d18373b94_section_1
2024-12-30 17:50:54 | INFO     | managers.agent_manager:stop_game:345 - Final game state saved successfully
2024-12-30 17:50:54 | INFO     | managers.agent_manager:stop_game:347 - Game stopped successfully
2024-12-30 17:50:54 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:50:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:51:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:51:02 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:51:03 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:51:03 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:51:03 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:51:03 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:03 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:51:03 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:51:03 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:03 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:51:03 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:51:03 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:51:03 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:51:03 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:51:03 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:51:03 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:51:03 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:51:05 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:51:05 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:51:05 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:51:05 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:51:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:51:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:51:05 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:51:05 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:51:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:51:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:51:09 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:51:09 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:51:09 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:51:09 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:51:09 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:51:09 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:51:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:51:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:51:13 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:51:13 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:51:13 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:51:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:51:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:51:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:51:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:51:13 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:51:13 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:51:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:51:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:51:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:51:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:51:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:51:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:51:15 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:51:15 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:51:15 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:51:15 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:51:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:51:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:51:15 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 17:51:15 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 17:53:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 17:53:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 17:53:46 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 17:53:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 17:53:46 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 17:53:46 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 17:53:46 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 17:53:46 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 17:53:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:53:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 17:53:54 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 17:53:55 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 17:53:55 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 17:53:55 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 17:53:55 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:53:55 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 17:53:55 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 17:53:55 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 17:53:55 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 17:53:55 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 17:53:55 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 17:53:55 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 17:53:55 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 17:53:55 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 17:53:55 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 17:53:55 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 17:53:56 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 17:53:56 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 17:53:56 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 17:53:56 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 17:53:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 17:53:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 17:53:56 | DEBUG    | managers.agent_manager:get_state:212 - Fetching current game state
2024-12-30 17:53:56 | DEBUG    | managers.agent_manager:get_state:214 - Current state: None
2024-12-30 18:02:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:02:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:02:38 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:02:38 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:02:38 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:02:38 | INFO     | managers.agent_manager:stop_game:353 - Stopping game...
2024-12-30 18:02:38 | DEBUG    | managers.agent_manager:stop_game:358 - No game ID set, nothing to save
2024-12-30 18:02:38 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:02:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:02:45 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:02:45 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:02:45 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:02:45 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:02:45 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:02:45 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:02:45 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:02:45 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:02:45 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:02:45 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:02:45 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:02:45 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:02:45 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:02:45 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:02:45 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:02:45 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:02:45 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:02:46 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:02:46 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:02:46 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:02:46 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:02:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:02:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:02:46 | DEBUG    | managers.agent_manager:get_state:212 - Fetching current game state
2024-12-30 18:02:46 | DEBUG    | managers.agent_manager:get_state:214 - Current state: None
2024-12-30 18:04:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:04:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:04:03 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:04:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:04:03 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:04:03 | INFO     | managers.agent_manager:stop_game:347 - Stopping game...
2024-12-30 18:04:03 | DEBUG    | managers.agent_manager:stop_game:352 - No game ID set, nothing to save
2024-12-30 18:04:03 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:04:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:04:08 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:04:08 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:04:08 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:04:08 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:04:08 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:04:08 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:08 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:04:08 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:04:08 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:08 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:04:08 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:04:08 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:04:08 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:04:08 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:04:08 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:04:08 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:04:08 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:04:09 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:04:09 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:04:09 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:04:09 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:04:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:04:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:04:09 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:04:09 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:04:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:04:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:04:45 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:04:45 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:04:45 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:04:45 | INFO     | managers.agent_manager:stop_game:333 - Stopping game...
2024-12-30 18:04:45 | DEBUG    | managers.agent_manager:stop_game:338 - No game ID set, nothing to save
2024-12-30 18:04:45 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:04:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:04:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:04:50 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:04:50 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:04:50 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:04:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:04:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:04:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:04:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:04:50 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:04:50 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:04:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:04:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:04:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:04:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:04:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:04:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:04:50 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:04:50 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:04:50 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:04:50 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:04:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:04:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:04:50 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:04:50 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:05:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:05:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:05:00 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:05:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:05:00 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:05:00 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:05:00 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:05:00 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:05:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:05:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:05:05 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:05:05 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:05:05 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:05:05 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:05:05 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:05:05 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:05:05 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:05:05 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:05:05 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:05:05 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:05:05 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:05:05 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:05:05 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:05:05 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:05:05 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:05:05 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:05:06 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:05:06 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:05:06 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:05:06 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:05:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:05:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:05:06 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:05:06 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:13:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:13:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:13:22 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:13:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:13:22 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:13:22 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:13:22 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:13:22 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:13:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:13:26 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:13:26 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:13:27 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:13:27 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:13:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:13:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:13:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:13:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:13:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:13:27 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:13:27 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:13:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:13:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:13:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:13:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:13:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:13:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:13:28 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:13:28 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:13:28 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:13:28 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:13:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:13:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:13:28 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:13:28 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:14:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:14:19 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 18:14:19 | INFO     | managers.agent_manager:get_story_workflow:264 - Getting story workflow
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_story_workflow:268 - Story graph not configured, configuring now
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_story_workflow:277 - Compiling workflow
2024-12-30 18:14:19 | INFO     | agents.story_graph:_setup_workflow:68 - Setting up LangGraph workflow with parallel processing
2024-12-30 18:14:19 | SUCCESS  | agents.story_graph:_setup_workflow:93 - Workflow setup completed
2024-12-30 18:14:19 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 18:14:19 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:19 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\traces
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters
2024-12-30 18:14:19 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:19 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: d8cf9c0e-bead-4686-a78f-46c4ac337286
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:14:19 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd8cf9c0e-bead-4686-a78f-46c4ac337286', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:14:19.448038', 'character_id': 'current'}
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:19 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:14:19 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:14:19 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:14:19 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:14:19 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: d7bc19d8-f56c-44e0-9c6c-503d4f92b734
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:14:19 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd7bc19d8-f56c-44e0-9c6c-503d4f92b734', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:14:19.480007', 'character_id': 'current'}
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:19 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: d7bc19d8-f56c-44e0-9c6c-503d4f92b734 and game_id: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:19 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: d7bc19d8-f56c-44e0-9c6c-503d4f92b734 and section_number: 1
2024-12-30 18:14:19 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 18:14:19 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:14:19 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:14:19 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:14:19 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 18:14:19 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:14:19 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:14:19 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:14:19 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:14:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:14:19 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:14:19 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:14:19 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:14:19 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:14:19 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 18:14:19 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:14:19 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:14:19 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:14:19 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:14:19 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 18:14:19 | INFO     | agents.story_graph:_process_decision:184 - Waiting for user input in section 1
2024-12-30 18:14:19 | ERROR    | agents.story_graph:_process_decision:221 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=9856, pipe_handle=1500)
                                      â           â <function spawn_main at 0x00000226FAEC0860>
                                      â <function spawn_main at 0x00000226FAEC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 624
               â     â 3
               â <function _main at 0x00000226FAEC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 624
           â    â <function BaseProcess._bootstrap at 0x00000226FAE06A20>
           â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x00000226FAE05F80>
    â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x00000226801AF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
    â    â <function subprocess_started at 0x000002268060E480>
    â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=660, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x00000226801AF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=660, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000002268060D760>
           â       â   â <uvicorn.server.Server object at 0x00000226801AF4D0>
           â       â <function run at 0x00000226FB3063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000022680602420>
           â      â <function Runner.run at 0x00000226FB3704A0>
           â <asyncio.runners.Runner object at 0x0000022680634050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x00000226FB369E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000022680634050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x00000226FB369DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x00000226FB36BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x00000226FB2ED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680AA2E60>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680AA2E60>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680AA2E60>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680AA2E60>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 185, in _process_decision
    return interrupt("Waiting for user input")  # Retourne une interruption au lieu de la lever
           â <function interrupt at 0x00000226800371A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)
2024-12-30 18:14:19 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 18:14:19 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:19 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:19 | INFO     | managers.agent_manager:initialize_game:241 - Game initialization completed successfully
2024-12-30 18:14:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:14:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:14:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='d8cf9c0e-bead-4686-a78f-46c4ac337286' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:14:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:14:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='d8cf9c0e-bead-4686-a78f-46c4ac337286' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:14:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 18:14:22 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 18:14:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 18:14:22 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 18:14:22 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 18:14:22 | DEBUG    | managers.agent_manager:process_game_state:162 - No state provided, getting current state
2024-12-30 18:14:22 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:14:22 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='d8cf9c0e-bead-4686-a78f-46c4ac337286' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:14:22 | INFO     | managers.agent_manager:get_story_workflow:264 - Getting story workflow
2024-12-30 18:14:22 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:14:22 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 18:14:22 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:14:22 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:14:22 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 280b8954-4230-4b02-9a2d-20fe3b16f81b
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:14:22 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '280b8954-4230-4b02-9a2d-20fe3b16f81b', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:14:22.273322', 'character_id': 'current'}
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:22 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 280b8954-4230-4b02-9a2d-20fe3b16f81b and game_id: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:22 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 280b8954-4230-4b02-9a2d-20fe3b16f81b and section_number: 1
2024-12-30 18:14:22 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 18:14:22 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:14:22 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:14:22 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:14:22 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:14:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:14:22 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:14:22 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:14:22 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:14:22 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:14:22 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 18:14:22 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 18:14:22 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:14:22 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:14:22 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:14:22 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:14:22 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:14:22 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:14:22 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:14:22 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 18:14:22 | DEBUG    | agents.story_graph:_process_decision:188 - Processing user input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 18:14:22 | DEBUG    | agents.decision_agent:ainvoke:170 - Processing decision for state: session=, section=1
2024-12-30 18:14:22 | DEBUG    | agents.decision_agent:ainvoke:190 - Decision processed successfully
2024-12-30 18:14:22 | DEBUG    | agents.story_graph:_process_decision:212 - Decision processed: next_section=None
2024-12-30 18:14:22 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 18:14:22 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:22 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 18:14:22 | ERROR    | managers.agent_manager:process_game_state:182 - No valid result from workflow
2024-12-30 18:14:22 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: No valid result
2024-12-30 18:14:22 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: No valid result
2024-12-30 18:14:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 18:14:52 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 18:14:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 18:14:52 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-30 18:14:52 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 18:14:52 | DEBUG    | managers.agent_manager:process_game_state:162 - No state provided, getting current state
2024-12-30 18:14:52 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:14:52 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=DecisionModel(section_number=1, next_section=None, error=None, awaiting_action=<ActionType.DICE_ROLL: 'dice_roll'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 18, 14, 22, 328400)) error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 18:14:52 | INFO     | managers.agent_manager:get_story_workflow:264 - Getting story workflow
2024-12-30 18:14:52 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:14:52 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 14, 19, 536920), last_update=datetime.datetime(2024, 12, 30, 18, 14, 19, 536949)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=DecisionModel(section_number=1, next_section=None, error=None, awaiting_action=<ActionType.DICE_ROLL: 'dice_roll'>, conditions=[], timestamp=datetime.datetime(2024, 12, 30, 18, 14, 22, 328400)) error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1a86bd85-68f6-f10b-5681-fcf196d30ec0'], when='during'),)" section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 18:14:52 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:14:52 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:14:52 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ff33e322-9229-4d18-9c0f-bd720ea63262
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:14:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:14:52 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ff33e322-9229-4d18-9c0f-bd720ea63262', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:14:52.208295', 'character_id': 'current'}
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:52 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: ff33e322-9229-4d18-9c0f-bd720ea63262 and game_id: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:14:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:14:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:14:52 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: ff33e322-9229-4d18-9c0f-bd720ea63262 and section_number: 1
2024-12-30 18:14:52 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 18:14:52 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:14:52 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:14:52 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:14:52 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:14:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:14:52 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:14:52 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:14:52 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:14:52 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:14:52 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 18:14:52 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 18:14:52 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:14:52 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:14:52 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:14:52 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:14:52 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:14:52 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:14:52 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:14:52 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:14:52 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 18:14:52 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: At key 'decision': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-30 18:14:52 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: At key 'decision': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-30 18:18:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:18:42 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:18:42 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:13 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:13 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:19:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:19:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:19:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:19:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:19:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:19:18 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:18 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:18 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:18 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:19:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:19:29 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:29 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:29 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:29 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:19:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:19:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:19:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:19:39 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:39 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ff33e322-9229-4d18-9c0f-bd720ea63262' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:43 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:43 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-30 18:19:43 | INFO     | managers.agent_manager:get_story_workflow:264 - Getting story workflow
2024-12-30 18:19:43 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 7902c210-2a5a-4d03-a2d8-913e32316317
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:19:43 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '7902c210-2a5a-4d03-a2d8-913e32316317', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:19:43.922567', 'character_id': 'current'}
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:19:43 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:19:43 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:19:43 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:19:43 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:19:43 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 88716c40-b35a-4994-afd1-34ae829e258c
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\characters\current.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:19:43 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '88716c40-b35a-4994-afd1-34ae829e258c', 'game_id': '93f7e918-2a93-4ef3-ac84-6fc6a2894ddb', 'last_update': '2024-12-30T18:19:43.981478', 'character_id': 'current'}
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:19:43 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 88716c40-b35a-4994-afd1-34ae829e258c and game_id: 93f7e918-2a93-4ef3-ac84-6fc6a2894ddb
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:19:44 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 88716c40-b35a-4994-afd1-34ae829e258c and section_number: 1
2024-12-30 18:19:44 | INFO     | agents.story_graph:_process_rules:104 - Processing rules for section 1
2024-12-30 18:19:44 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:19:44 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:19:44 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:19:44 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:19:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:19:44 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:19:44 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:19:44 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:19:44 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:19:44 | DEBUG    | agents.story_graph:_process_rules:120 - Rules processing completed for section 1
2024-12-30 18:19:44 | INFO     | agents.story_graph:_process_narrative:138 - Processing narrative for section 1
2024-12-30 18:19:44 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:19:44 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:19:44 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-30 18:19:44 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:19:44 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:19:44 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:19:44 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:19:44 | DEBUG    | agents.story_graph:_process_narrative:158 - Narrative processing completed for section 1
2024-12-30 18:19:44 | INFO     | agents.story_graph:_process_decision:184 - Waiting for user input in section 1
2024-12-30 18:19:44 | ERROR    | agents.story_graph:_process_decision:221 - Error in decision processing: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:4388d331-9214-66d6-93f1-706c7c994361'], when='during'),)
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=9856, pipe_handle=1500)
                                      â           â <function spawn_main at 0x00000226FAEC0860>
                                      â <function spawn_main at 0x00000226FAEC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               â     â   â 624
               â     â 3
               â <function _main at 0x00000226FAEC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           â    â          â 624
           â    â <function BaseProcess._bootstrap at 0x00000226FAE06A20>
           â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    â    â <function BaseProcess.run at 0x00000226FAE05F80>
    â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    â    â        â    â        â    â {'config': <uvicorn.config.Config object at 0x00000226801AF380>, 'target': <bound method Server.run of <uvicorn.server.Server...
    â    â        â    â        â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
    â    â        â    â ()
    â    â        â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
    â    â <function subprocess_started at 0x000002268060E480>
    â <SpawnProcess name='SpawnProcess-12' parent=9856 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    â              â [<socket.socket fd=660, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    â <bound method Server.run of <uvicorn.server.Server object at 0x00000226801AF4D0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           â       â   â    â             â [<socket.socket fd=660, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           â       â   â    â <function Server.serve at 0x000002268060D760>
           â       â   â <uvicorn.server.Server object at 0x00000226801AF4D0>
           â       â <function run at 0x00000226FB3063E0>
           â <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           â      â   â <coroutine object Server.serve at 0x0000022680602420>
           â      â <function Runner.run at 0x00000226FB3704A0>
           â <asyncio.runners.Runner object at 0x0000022680634050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           â    â     â                  â <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           â    â     â <function BaseEventLoop.run_until_complete at 0x00000226FB369E40>
           â    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
           â <asyncio.runners.Runner object at 0x0000022680634050>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    â    â <function BaseEventLoop.run_forever at 0x00000226FB369DA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    â    â <function BaseEventLoop._run_once at 0x00000226FB36BBA0>
    â <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    â      â <function Handle._run at 0x00000226FB2ED3A0>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680B3AE90>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    â    â            â    â           â    â <member '_args' of 'Handle' objects>
    â    â            â    â           â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680B3AE90>()>
    â    â            â    â <member '_callback' of 'Handle' objects>
    â    â            â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680B3AE90>()>
    â    â <member '_context' of 'Handle' objects>
    â <Handle <_asyncio.TaskStepMethWrapper object at 0x0000022680B3AE90>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 185, in _process_decision
    return interrupt("Waiting for user input")  # Retourne une interruption au lieu de la lever
           â <function interrupt at 0x00000226800371A0>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\types.py", line 485, in interrupt
    raise GraphInterrupt(
          â <class 'langgraph.errors.GraphInterrupt'>

langgraph.errors.GraphInterrupt: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:4388d331-9214-66d6-93f1-706c7c994361'], when='during'),)
2024-12-30 18:19:44 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-30 18:19:44 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:19:44 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:19:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:19:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:19:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:19:44 | INFO     | managers.agent_manager:initialize_game:241 - Game initialization completed successfully
2024-12-30 18:19:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:19:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:19:44 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:44 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='7902c210-2a5a-4d03-a2d8-913e32316317' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 19, 44, 35973), last_update=datetime.datetime(2024, 12, 30, 18, 19, 44, 36006)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:4388d331-9214-66d6-93f1-706c7c994361'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:19:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:19:44 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:19:44 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='7902c210-2a5a-4d03-a2d8-913e32316317' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 19, 44, 35973), last_update=datetime.datetime(2024, 12, 30, 18, 19, 44, 36006)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:4388d331-9214-66d6-93f1-706c7c994361'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:30:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:30:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:30:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:30:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:30:28 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:30:28 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:30:28 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:30:28 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:30:28 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:30:28 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='7902c210-2a5a-4d03-a2d8-913e32316317' game_id='93f7e918-2a93-4ef3-ac84-6fc6a2894ddb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 19, 44, 35973), last_update=datetime.datetime(2024, 12, 30, 18, 19, 44, 36006)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error="(Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:4388d331-9214-66d6-93f1-706c7c994361'], when='during'),)" section_number=1 player_input=None content=None
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current in namespace state
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:30:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:30:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current.json
2024-12-30 18:30:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_current
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1 in namespace state
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:30:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:30:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:30:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\93f7e918-2a93-4ef3-ac84-6fc6a2894ddb\states\game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1.json
2024-12-30 18:30:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_93f7e918-2a93-4ef3-ac84-6fc6a2894ddb_section_1
2024-12-30 18:30:28 | INFO     | managers.agent_manager:stop_game:348 - Final game state saved successfully
2024-12-30 18:30:28 | INFO     | managers.agent_manager:stop_game:350 - Game stopped successfully
2024-12-30 18:30:28 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:30:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:30:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:30:35 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:30:36 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:30:36 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:30:36 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:30:36 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:30:36 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:30:36 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:30:36 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:30:36 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:30:36 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:30:36 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:30:36 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:30:36 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:30:36 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:30:36 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:30:36 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:30:37 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:30:37 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:30:37 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:30:37 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:30:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:30:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:30:37 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:30:37 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:30:37 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:30:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:30:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:30:37 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:30:37 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:31:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:31:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:31:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:31:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:31:10 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:31:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:31:10 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:31:10 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:31:10 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:31:10 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:31:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:31:46 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:31:46 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:31:46 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:31:46 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:31:46 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:31:46 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:31:46 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:31:46 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:31:46 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:31:46 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:31:46 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:31:46 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:31:46 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:31:46 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:31:46 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:31:46 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:31:47 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:31:47 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:31:47 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:31:47 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:31:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:31:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:31:47 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:31:47 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:31:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:31:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:31:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:31:47 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:31:47 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:04 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:32:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:04 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:32:04 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:32:04 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:32:04 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:32:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:09 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:32:09 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:32:09 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:32:09 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:32:09 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:09 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:32:09 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:32:09 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:09 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:32:09 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:32:09 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:32:09 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:32:09 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:32:09 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:32:09 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:32:09 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:32:10 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:32:10 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:32:10 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:32:10 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:32:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:10 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:10 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:10 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:10 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:44 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:44 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:32:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:44 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:32:44 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:32:44 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:32:44 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:32:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:48 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:32:48 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:32:48 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:32:48 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:32:48 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:48 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:32:48 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:32:48 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:48 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:32:48 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:32:48 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:32:48 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:32:48 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:32:48 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:32:48 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:32:48 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:32:50 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:32:50 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:32:50 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:32:50 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:32:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:50 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:50 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:50 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:50 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:50 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:32:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:32:53 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:32:53 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:53 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:32:53 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:32:53 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:32:53 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:32:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:58 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:32:58 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:32:58 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:32:58 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:32:58 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:32:58 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:58 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:32:58 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:32:58 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:32:58 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:32:58 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:32:58 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:32:58 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:32:58 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:32:58 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:32:58 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:32:58 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:32:59 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:32:59 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:32:59 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:32:59 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:32:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:59 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:59 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:32:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:32:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:32:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:32:59 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:32:59 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:33:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:33:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:33:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:33:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:33:58 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:33:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:33:58 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:33:58 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:33:58 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:33:58 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:33:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:34:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:34:04 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:34:04 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:34:04 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:34:04 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:34:04 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:04 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:34:04 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:34:04 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:04 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:34:04 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:34:04 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:34:04 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:34:04 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:34:04 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:34:04 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:34:04 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:34:05 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:34:05 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:34:05 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:34:05 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:34:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:34:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:34:05 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:34:05 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:34:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:34:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:34:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:34:05 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:34:05 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:34:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:34:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:34:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:34:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:34:31 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:34:31 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:34:31 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:34:31 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:34:31 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:34:31 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:34:34 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:34:38 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:34:38 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:34:38 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:34:38 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:34:38 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:34:38 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:38 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:34:38 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:34:38 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:34:38 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:34:38 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:34:38 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:34:38 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:34:38 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:34:38 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:34:38 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:34:38 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:34:39 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:34:39 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:34:39 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:34:39 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:34:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:34:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:34:39 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:34:39 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:34:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:34:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:34:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:34:39 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:34:39 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:09 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:35:09 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:09 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:35:09 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:35:09 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:35:09 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:35:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:16 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:35:16 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:35:16 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:35:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:35:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:35:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:35:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:16 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:35:16 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:35:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:35:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:35:17 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:35:17 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:35:17 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:35:17 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:35:17 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:35:17 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:35:17 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:35:17 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:35:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:19 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:35:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:19 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:35:19 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:35:19 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:35:19 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:35:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:25 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:35:25 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:35:25 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:35:25 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:35:25 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:35:25 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:35:25 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:25 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:35:25 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:35:25 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:35:25 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:35:25 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:35:25 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:35:25 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:35:25 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:35:26 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:35:26 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:35:26 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:35:26 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:35:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:26 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:26 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:26 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:26 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:35:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:35:34 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:35:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:34 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:35:34 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:35:34 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:35:34 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:35:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:35:39 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:35:40 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:35:40 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:35:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:35:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:35:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:35:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:35:40 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:35:40 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:35:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:35:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:35:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:35:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:35:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:35:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:35:41 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:35:41 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:35:41 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:35:41 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:35:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:41 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:41 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:35:41 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:35:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:35:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:35:41 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:35:41 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:37:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:02 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:37:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:02 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:37:02 | INFO     | managers.agent_manager:stop_game:336 - Stopping game...
2024-12-30 18:37:02 | DEBUG    | managers.agent_manager:stop_game:341 - No game ID set, nothing to save
2024-12-30 18:37:02 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:37:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:11 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:37:12 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:37:12 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:37:12 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:37:12 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:12 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:37:12 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:37:12 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:12 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:37:12 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:37:12 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:37:12 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:37:12 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:37:12 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:37:12 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:37:12 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:37:13 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:37:13 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:37:13 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:37:13 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:37:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:13 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 18:37:13 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 18:37:13 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:37:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:13 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:37:13 | INFO     | managers.agent_manager:stop_game:345 - Stopping game...
2024-12-30 18:37:13 | DEBUG    | managers.agent_manager:stop_game:350 - No game ID set, nothing to save
2024-12-30 18:37:13 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:37:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:18 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:37:19 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:37:19 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:37:19 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:37:19 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:19 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:37:19 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:37:19 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:19 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:37:19 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:37:19 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:37:19 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:37:19 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:37:19 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:37:19 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:37:19 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:37:19 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:37:19 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-30 18:37:19 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-30 18:37:19 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:37:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:37:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:37:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-30 18:37:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-30 18:37:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:32 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:37:32 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:32 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:37:32 | INFO     | managers.agent_manager:stop_game:345 - Stopping game...
2024-12-30 18:37:32 | DEBUG    | managers.agent_manager:stop_game:350 - No game ID set, nothing to save
2024-12-30 18:37:32 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:37:34 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:37 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:37:37 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:37:37 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:37:37 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:37:37 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:37 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:37:37 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:37:37 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:37 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:37:37 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:37:37 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:37:37 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:37:37 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:37:37 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:37:37 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:37:37 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:37:38 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:37:38 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:37:38 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:37:38 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:37:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:38 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:38 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:38 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:38 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:38 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:40 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:37:40 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:40 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:37:40 | INFO     | managers.agent_manager:stop_game:348 - Stopping game...
2024-12-30 18:37:40 | DEBUG    | managers.agent_manager:stop_game:353 - No game ID set, nothing to save
2024-12-30 18:37:40 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:37:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:37:44 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:37:45 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:37:45 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:37:45 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:37:45 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:45 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:37:45 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:37:45 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:37:45 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:37:45 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:37:45 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:37:45 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:37:45 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:37:45 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:37:45 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:37:45 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:37:46 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:37:46 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:37:46 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:37:46 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:46 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:46 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:46 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:46 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:58 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:37:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:37:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:37:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:37:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:37:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:37:59 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:37:59 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:38:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:38:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:38:06 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:38:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:38:06 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:38:06 | INFO     | managers.agent_manager:stop_game:348 - Stopping game...
2024-12-30 18:38:06 | DEBUG    | managers.agent_manager:stop_game:353 - No game ID set, nothing to save
2024-12-30 18:38:06 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:38:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:38:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:38:10 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:38:10 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:38:10 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:38:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:38:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:38:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:38:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:38:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:38:10 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:38:10 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:38:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:38:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:38:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:38:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:38:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:38:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:38:11 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:38:11 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:38:11 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:38:11 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:38:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:38:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:38:11 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:38:11 | DEBUG    | managers.agent_manager:get_state:197 - Current state: None
2024-12-30 18:38:16 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:38:16 | INFO     | managers.agent_manager:initialize_game:213 - Initializing game
2024-12-30 18:38:16 | INFO     | managers.agent_manager:get_story_workflow:276 - Getting story workflow
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_story_workflow:280 - Story graph not configured, configuring now
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_story_workflow:289 - Compiling workflow
2024-12-30 18:38:16 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 18:38:16 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 18:38:16 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 18:38:16 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 5142fd61-07b1-4933-b67e-cb3f419c0360
2024-12-30 18:38:16 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 5142fd61-07b1-4933-b67e-cb3f419c0360
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\traces
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters
2024-12-30 18:38:16 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 5142fd61-07b1-4933-b67e-cb3f419c0360
2024-12-30 18:38:16 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8391e3a4-2940-4cbd-a6f8-b1ad21e48bec
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:38:16 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8391e3a4-2940-4cbd-a6f8-b1ad21e48bec', 'game_id': '5142fd61-07b1-4933-b67e-cb3f419c0360', 'last_update': '2024-12-30T18:38:16.859672', 'character_id': 'current'}
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_current in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_current
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1 in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1
2024-12-30 18:38:16 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:38:16 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:38:16 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:38:16 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:38:16 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: c06b4684-c604-473c-8214-d4a26809e1f4
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\characters\current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:38:16 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'c06b4684-c604-473c-8214-d4a26809e1f4', 'game_id': '5142fd61-07b1-4933-b67e-cb3f419c0360', 'last_update': '2024-12-30T18:38:16.884661', 'character_id': 'current'}
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_current in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_current
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1 in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1
2024-12-30 18:38:16 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: c06b4684-c604-473c-8214-d4a26809e1f4 and game_id: 5142fd61-07b1-4933-b67e-cb3f419c0360
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_current in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_current
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1 in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1
2024-12-30 18:38:16 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: c06b4684-c604-473c-8214-d4a26809e1f4 and section_number: 1
2024-12-30 18:38:16 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 18:38:16 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:38:16 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:38:16 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:38:16 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 18:38:16 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:38:16 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:38:16 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:38:16 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:38:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:38:16 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:38:16 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:38:16 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:38:16 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:38:16 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 18:38:16 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:38:16 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:38:16 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:38:16 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:38:16 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 18:38:16 | INFO     | agents.story_graph:_process_decision:187 - Waiting for user input in section 1
2024-12-30 18:38:16 | INFO     | agents.story_graph:_process_decision:218 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:5cb1ebd9-b4c5-cda2-65d6-319c49c0330a'], when='during'),)
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_current in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_current
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1 in namespace state
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:38:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:38:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1
2024-12-30 18:38:16 | INFO     | managers.agent_manager:initialize_game:252 - Game initialization completed successfully
2024-12-30 18:38:16 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:38:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:38:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_state:197 - Current state: session_id='8391e3a4-2940-4cbd-a6f8-b1ad21e48bec' game_id='5142fd61-07b1-4933-b67e-cb3f419c0360' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 38, 16, 921545), last_update=datetime.datetime(2024, 12, 30, 18, 38, 16, 921561)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:38:16 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:38:16 | DEBUG    | managers.agent_manager:get_state:197 - Current state: session_id='8391e3a4-2940-4cbd-a6f8-b1ad21e48bec' game_id='5142fd61-07b1-4933-b67e-cb3f419c0360' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 38, 16, 921545), last_update=datetime.datetime(2024, 12, 30, 18, 38, 16, 921561)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:38:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 18:38:33 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '5142fd61-07b1-4933-b67e-cb3f419c0360', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 18:38:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='5142fd61-07b1-4933-b67e-cb3f419c0360' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 18:38:33 | INFO     | managers.agent_manager:process_game_state:156 - Starting game state processing
2024-12-30 18:38:33 | DEBUG    | managers.agent_manager:process_game_state:157 - Input state: None, User input: Engager la procÃ©dure d'Ã©vasion
2024-12-30 18:38:33 | DEBUG    | managers.agent_manager:process_game_state:165 - No state provided, getting current state
2024-12-30 18:38:33 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:38:33 | DEBUG    | managers.agent_manager:get_state:197 - Current state: session_id='8391e3a4-2940-4cbd-a6f8-b1ad21e48bec' game_id='5142fd61-07b1-4933-b67e-cb3f419c0360' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 38, 16, 921545), last_update=datetime.datetime(2024, 12, 30, 18, 38, 16, 921561)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:38:33 | INFO     | managers.agent_manager:get_story_workflow:276 - Getting story workflow
2024-12-30 18:38:33 | ERROR    | managers.agent_manager:process_game_state:189 - Error processing game state: Checkpointer requires one or more of the following 'configurable' keys: ['thread_id', 'checkpoint_ns', 'checkpoint_id']
2024-12-30 18:38:33 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Checkpointer requires one or more of the following 'configurable' keys: ['thread_id', 'checkpoint_ns', 'checkpoint_id']
2024-12-30 18:45:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:45:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:45:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:45:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:45:20 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:45:20 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:45:20 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:45:20 | INFO     | managers.agent_manager:stop_game:348 - Stopping game...
2024-12-30 18:45:20 | DEBUG    | managers.agent_manager:get_state:195 - Fetching current game state
2024-12-30 18:45:20 | DEBUG    | managers.agent_manager:get_state:197 - Current state: session_id='8391e3a4-2940-4cbd-a6f8-b1ad21e48bec' game_id='5142fd61-07b1-4933-b67e-cb3f419c0360' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 38, 16, 921545), last_update=datetime.datetime(2024, 12, 30, 18, 38, 16, 921561)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_current in namespace state
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:45:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:45:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_current.json
2024-12-30 18:45:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_current
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1 in namespace state
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:45:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:45:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:45:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\5142fd61-07b1-4933-b67e-cb3f419c0360\states\game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1.json
2024-12-30 18:45:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_5142fd61-07b1-4933-b67e-cb3f419c0360_section_1
2024-12-30 18:45:20 | INFO     | managers.agent_manager:stop_game:360 - Final game state saved successfully
2024-12-30 18:45:20 | INFO     | managers.agent_manager:stop_game:362 - Game stopped successfully
2024-12-30 18:45:20 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:45:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:45:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:45:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:45:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:45:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:39 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:46:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:46:44 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:46:44 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:46:44 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:46:44 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:46:44 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:46:44 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:46:44 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:46:44 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:46:44 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:46:44 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:46:44 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:46:44 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:46:44 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:46:44 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:46:44 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:46:44 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:46:45 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:46:45 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:46:45 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:46:45 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:46:45 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:46:45 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:46:45 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:46:45 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:46:45 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:47:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:47:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:47:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:47:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:47:52 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:47:52 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:47:52 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:47:52 | INFO     | managers.agent_manager:stop_game:346 - Stopping game...
2024-12-30 18:47:52 | DEBUG    | managers.agent_manager:stop_game:351 - No game ID set, nothing to save
2024-12-30 18:47:52 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:47:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:02 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:48:02 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:48:02 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:48:02 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:48:02 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:02 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:48:02 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:48:02 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:02 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:48:02 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:48:02 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:48:02 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:48:02 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:48:02 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:48:02 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:48:02 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:48:05 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:48:05 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:48:05 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:48:05 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:48:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:05 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:48:05 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:48:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:48:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:05 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:48:05 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:48:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:48:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:48:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:48:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:48:08 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:48:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:48:08 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:48:08 | INFO     | managers.agent_manager:stop_game:346 - Stopping game...
2024-12-30 18:48:08 | DEBUG    | managers.agent_manager:stop_game:351 - No game ID set, nothing to save
2024-12-30 18:48:08 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:48:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:13 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:48:13 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:48:13 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:48:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:48:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:48:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:48:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:13 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:48:13 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:48:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:48:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:48:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:48:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:48:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:48:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:48:14 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:48:14 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:48:14 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:48:14 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:48:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:14 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:48:14 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:48:14 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:48:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:14 | DEBUG    | managers.agent_manager:get_state:193 - Fetching current game state
2024-12-30 18:48:14 | DEBUG    | managers.agent_manager:get_state:195 - Current state: None
2024-12-30 18:48:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:48:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:48:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:48:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:48:38 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:48:38 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:48:38 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:48:38 | INFO     | managers.agent_manager:stop_game:346 - Stopping game...
2024-12-30 18:48:38 | DEBUG    | managers.agent_manager:stop_game:351 - No game ID set, nothing to save
2024-12-30 18:48:38 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:48:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:48:46 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:48:46 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:48:46 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:48:46 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:48:46 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:46 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:48:46 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:48:46 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:48:46 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:48:46 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:48:46 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:48:46 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:48:46 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:48:46 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:48:46 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:48:46 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:48:47 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:48:47 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:48:47 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:48:47 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:48:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:47 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:48:47 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:48:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:48:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:48:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:48:47 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:48:47 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:49:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:49:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:49:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:49:01 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:49:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:01 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:49:01 | INFO     | managers.agent_manager:stop_game:350 - Stopping game...
2024-12-30 18:49:01 | DEBUG    | managers.agent_manager:stop_game:355 - No game ID set, nothing to save
2024-12-30 18:49:01 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:49:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:49:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:49:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:49:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:49:21 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:49:21 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:49:21 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:49:21 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:49:21 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:49:21 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:49:21 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:49:21 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:49:21 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:49:21 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:49:21 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:49:21 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:49:21 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:49:21 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:49:21 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:49:21 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:49:22 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:49:22 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:49:22 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:49:22 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:49:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:49:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:49:22 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:22 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:49:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:49:22 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:22 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:49 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:49 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:49 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:49:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:49:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:49:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:49:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:49:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:49:59 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:49:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:49:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:50:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:50:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:50:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:50:00 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:50:00 | DEBUG    | managers.agent_manager:get_state:199 - Current state: None
2024-12-30 18:50:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:50:02 | INFO     | managers.agent_manager:initialize_game:215 - Initializing game
2024-12-30 18:50:02 | INFO     | managers.agent_manager:get_story_workflow:282 - Getting story workflow
2024-12-30 18:50:02 | DEBUG    | managers.agent_manager:get_story_workflow:286 - Story graph not configured, configuring now
2024-12-30 18:50:02 | DEBUG    | managers.agent_manager:get_story_workflow:295 - Compiling workflow
2024-12-30 18:50:02 | INFO     | agents.story_graph:_setup_workflow:71 - Setting up LangGraph workflow with parallel processing
2024-12-30 18:50:02 | SUCCESS  | agents.story_graph:_setup_workflow:96 - Workflow setup completed
2024-12-30 18:50:02 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-30 18:50:02 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 06e586a5-7eee-411b-8909-532f848b3537
2024-12-30 18:50:02 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 06e586a5-7eee-411b-8909-532f848b3537
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\traces
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters
2024-12-30 18:50:02 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 06e586a5-7eee-411b-8909-532f848b3537
2024-12-30 18:50:02 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8bccb1e2-43b7-465a-86f6-d79aadaa144a
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:50:02 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8bccb1e2-43b7-465a-86f6-d79aadaa144a', 'game_id': '06e586a5-7eee-411b-8909-532f848b3537', 'last_update': '2024-12-30T18:50:02.850849', 'character_id': 'current'}
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:02 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:50:02 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:50:02 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:50:02 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:50:02 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b9a157d1-82f5-4d1b-a2d4-2dc1b2f8651b
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:50:02 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b9a157d1-82f5-4d1b-a2d4-2dc1b2f8651b', 'game_id': '06e586a5-7eee-411b-8909-532f848b3537', 'last_update': '2024-12-30T18:50:02.908344', 'character_id': 'current'}
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:02 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: b9a157d1-82f5-4d1b-a2d4-2dc1b2f8651b and game_id: 06e586a5-7eee-411b-8909-532f848b3537
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:02 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: b9a157d1-82f5-4d1b-a2d4-2dc1b2f8651b and section_number: 1
2024-12-30 18:50:02 | INFO     | agents.story_graph:_process_rules:107 - Processing rules for section 1
2024-12-30 18:50:02 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-30 18:50:02 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-30 18:50:02 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-30 18:50:02 | INFO     | agents.story_graph:_process_narrative:141 - Processing narrative for section 1
2024-12-30 18:50:02 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-30 18:50:02 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-30 18:50:02 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procÃ©dure d'Ã©vasion'
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-30 18:50:02 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-30 18:50:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-30 18:50:02 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-30 18:50:02 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-30 18:50:02 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-30 18:50:02 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-30 18:50:02 | DEBUG    | agents.story_graph:_process_rules:123 - Rules processing completed for section 1
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-30 18:50:02 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-30 18:50:02 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-30 18:50:02 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-30 18:50:02 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-30 18:50:02 | DEBUG    | agents.story_graph:_process_narrative:161 - Narrative processing completed for section 1
2024-12-30 18:50:02 | INFO     | agents.story_graph:_process_decision:187 - Waiting for user input in section 1
2024-12-30 18:50:02 | INFO     | agents.story_graph:_process_decision:218 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:e818c01d-b8cc-5bd4-24d7-77780b20397e'], when='during'),)
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:02 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:03 | INFO     | managers.agent_manager:initialize_game:254 - Game initialization completed successfully
2024-12-30 18:50:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:50:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:50:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:50:03 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:50:03 | DEBUG    | managers.agent_manager:get_state:199 - Current state: session_id='8bccb1e2-43b7-465a-86f6-d79aadaa144a' game_id='06e586a5-7eee-411b-8909-532f848b3537' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 50, 2, 974894), last_update=datetime.datetime(2024, 12, 30, 18, 50, 2, 974921)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:50:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:50:03 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:50:03 | DEBUG    | managers.agent_manager:get_state:199 - Current state: session_id='8bccb1e2-43b7-465a-86f6-d79aadaa144a' game_id='06e586a5-7eee-411b-8909-532f848b3537' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 50, 2, 974894), last_update=datetime.datetime(2024, 12, 30, 18, 50, 2, 974921)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:50:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2024-12-30 18:50:13 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '06e586a5-7eee-411b-8909-532f848b3537', 'choice_id': '48', 'choice_text': "Engager la procÃ©dure d'Ã©vasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2024-12-30 18:50:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='06e586a5-7eee-411b-8909-532f848b3537' choice_id='48' choice_text="Engager la procÃ©dure d'Ã©vasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2024-12-30 18:50:13 | INFO     | managers.agent_manager:process_game_state:145 - Starting game state processing
2024-12-30 18:50:13 | DEBUG    | managers.agent_manager:process_game_state:154 - No state provided, getting current state
2024-12-30 18:50:13 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:50:13 | DEBUG    | managers.agent_manager:get_state:199 - Current state: session_id='8bccb1e2-43b7-465a-86f6-d79aadaa144a' game_id='06e586a5-7eee-411b-8909-532f848b3537' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 50, 2, 974894), last_update=datetime.datetime(2024, 12, 30, 18, 50, 2, 974921)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:50:13 | INFO     | managers.agent_manager:get_story_workflow:282 - Getting story workflow
2024-12-30 18:50:13 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-30 18:50:13 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siÃ¨ge antigravitationnel, face aux commandes de votre vaisseau spatial. AprÃ¨s avoir vÃ©rifiÃ© le systÃ¨me de sÃ©curitÃ©, vous examinez attentivement le tableau de bord. Il ne prÃ©sente aucune complexitÃ© : une simple console d'ordinateur reliÃ©e Ã  un terminal de liaison et quelques Ã©crans.\n\nLe circuit micro-Ã©lectronique du systÃ¨me alpha ziridium est profondÃ©ment enfoui dans les entrailles du vaisseau, et vous n'aurez jamais Ã  vous en prÃ©occuper le moins du monde. Si une panne quelconque venait Ã  se dÃ©clarer, ou s'il se produisait le moindre incident, votre ingÃ©nieur robot interviendrait sur-le-champ.\n\nLa prÃ©programmation de votre voyage a Ã©tÃ© Ã©tablie pour vous mener en premier lieu sur Tropos. Vous entamez les procÃ©dures de dÃ©part : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitÃ´t : Â« VÃ©rifications effectuÃ©es. Fonctionnement optimal. Â»\n\nPuis vous passez Ã  la deuxiÃ¨me opÃ©ration : contact avec la tour de contrÃ´le. ParÃ© au dÃ©collage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus Ã  l'accÃ©lÃ©ration s'estompent : vous quittez l'exosphÃ¨re terrienne et pÃ©nÃ©trez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe gÃ©nÃ©rateur gravitationnel est automatiquement enclenchÃ© de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'Ã  vos robots, de vous dÃ©placer librement. Vous allumez l'Ã©cran de vision rÃ©trospective pour observer une derniÃ¨re fois la Terre qui rÃ©trÃ©cit et s'Ã©loigne, des bancs de nuages glissent paresseusement et le soleil se rÃ©flÃ©chit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait Ã©tÃ© donnÃ©e Ã  maintes reprises de contempler ce spectacle au cours de vos voyages vers VÃ©nus ou vers Mercure, vous ressentez toujours, Ã  sa vue, un petit pincement au cÅur et une Ã©motion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'Ã©paules, vous chassez ces pensÃ©es car seul, compte, dÃ©sormais, votre mission.\n\nDes heures s'Ã©coulent, uniformes et lentes. Puis votre Ã©cran revient soudain Ã  la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la mÃªme trajectoire que vous tout en maintenant soigneusement un Ã©cart constant. Cela ressemble Ã  s'y mÃ©prendre Ã  une filature.\n\nAllez-vous donner l'ordre Ã  votre ordinateur d'engager la procÃ©dure d'Ã©vasion (rendez-vous au [[48]]) ou prÃ©fÃ©rez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 30, 18, 50, 2, 974894), last_update=datetime.datetime(2024, 12, 30, 18, 50, 2, 974921)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procÃ©dure d'Ã©vasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procÃ©dure d'Ã©vasion ou continuer sa route, sans lancer de dÃ©s.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input="Engager la procÃ©dure d'Ã©vasion" content=None
2024-12-30 18:50:13 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-30 18:50:13 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-30 18:50:13 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8800558d-ee70-44c6-87be-8e4dda7b352d
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\characters\current.json
2024-12-30 18:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-30 18:50:13 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8800558d-ee70-44c6-87be-8e4dda7b352d', 'game_id': '06e586a5-7eee-411b-8909-532f848b3537', 'last_update': '2024-12-30T18:50:13.281916', 'character_id': 'current'}
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:13 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 8800558d-ee70-44c6-87be-8e4dda7b352d and game_id: 06e586a5-7eee-411b-8909-532f848b3537
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:50:13 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 8800558d-ee70-44c6-87be-8e4dda7b352d and section_number: 1
2024-12-30 18:50:13 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: 2 validation errors for GameState
session_id
  Field required [type=missing, input_value={'node_start': {'session_...', 'section_number': 1}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
game_id
  Field required [type=missing, input_value={'node_start': {'session_...', 'section_number': 1}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2024-12-30 18:50:13 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Failed to process game state: 2 validation errors for GameState
session_id
  Field required [type=missing, input_value={'node_start': {'session_...', 'section_number': 1}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
game_id
  Field required [type=missing, input_value={'node_start': {'session_...', 'section_number': 1}}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2024-12-30 18:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:51:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:51:27 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:51:27 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:51:27 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:51:27 | INFO     | managers.agent_manager:stop_game:354 - Stopping game...
2024-12-30 18:51:27 | DEBUG    | managers.agent_manager:get_state:197 - Fetching current game state
2024-12-30 18:51:27 | DEBUG    | managers.agent_manager:get_state:199 - Current state: session_id='8800558d-ee70-44c6-87be-8e4dda7b352d' game_id='06e586a5-7eee-411b-8909-532f848b3537' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_current in namespace state
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:51:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:51:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_current.json
2024-12-30 18:51:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_current
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_06e586a5-7eee-411b-8909-532f848b3537_section_1 in namespace state
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-30 18:51:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:51:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:51:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\06e586a5-7eee-411b-8909-532f848b3537\states\game_06e586a5-7eee-411b-8909-532f848b3537_section_1.json
2024-12-30 18:51:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_06e586a5-7eee-411b-8909-532f848b3537_section_1
2024-12-30 18:51:27 | INFO     | managers.agent_manager:stop_game:366 - Final game state saved successfully
2024-12-30 18:51:27 | INFO     | managers.agent_manager:stop_game:368 - Game stopped successfully
2024-12-30 18:51:27 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:51:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:51:38 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:51:38 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:51:38 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:51:38 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:51:38 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:51:38 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:38 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:51:38 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:51:38 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:38 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:51:38 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:51:38 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:51:38 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:51:38 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:51:38 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:51:38 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:51:38 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:51:41 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:51:41 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:51:41 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:51:41 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:51:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:51:41 | ERROR    | api.routes.ws.game_route_ws:connect:28 - Error accepting WebSocket connection: Expected ASGI message 'websocket.send' or 'websocket.close', but got 'websocket.accept'.
2024-12-30 18:51:41 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:74 - Failed to establish WebSocket connection
2024-12-30 18:51:41 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:51:41 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:51:41 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:51:41 | INFO     | managers.agent_manager:stop_game:354 - Stopping game...
2024-12-30 18:51:41 | DEBUG    | managers.agent_manager:stop_game:359 - No game ID set, nothing to save
2024-12-30 18:51:41 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:51:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:51:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:51:47 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:51:48 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:51:48 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:51:48 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:51:48 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:48 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:51:48 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:51:48 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:51:48 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:51:48 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:51:48 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:51:48 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:51:48 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:51:48 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:51:48 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:51:48 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:51:49 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:51:49 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:51:49 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:51:49 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:51:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:51:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:51:49 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:51:49 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 18:51:49 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:51:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:51:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:51:49 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:51:49 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 18:58:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:58:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:58:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:58:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:58:34 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:58:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:58:34 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:58:34 | INFO     | managers.agent_manager:stop_game:357 - Stopping game...
2024-12-30 18:58:34 | DEBUG    | managers.agent_manager:stop_game:362 - No game ID set, nothing to save
2024-12-30 18:58:34 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:58:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:58:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:58:40 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:58:40 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:58:40 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:58:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:58:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:58:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:58:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:40 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:58:40 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:58:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:58:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:58:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:58:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:58:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:58:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:58:41 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:58:41 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:58:41 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:58:41 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:58:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:58:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:58:41 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:58:41 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 18:58:41 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:58:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:58:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:58:41 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:58:41 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 18:58:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:58:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:58:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 18:58:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 18:58:47 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 18:58:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:58:47 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 18:58:47 | INFO     | managers.agent_manager:stop_game:357 - Stopping game...
2024-12-30 18:58:47 | DEBUG    | managers.agent_manager:stop_game:362 - No game ID set, nothing to save
2024-12-30 18:58:47 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 18:58:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:58:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 18:58:50 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 18:58:50 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 18:58:50 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 18:58:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 18:58:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 18:58:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 18:58:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 18:58:50 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 18:58:50 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 18:58:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 18:58:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 18:58:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 18:58:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 18:58:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 18:58:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 18:58:51 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 18:58:51 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 18:58:51 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 18:58:51 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 18:58:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:58:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:58:51 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:58:51 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 18:58:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 18:58:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 18:58:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 18:58:51 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 18:58:51 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 19:01:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:01:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:01:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:01:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:01:18 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 19:01:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:01:18 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 19:01:18 | INFO     | managers.agent_manager:stop_game:357 - Stopping game...
2024-12-30 19:01:18 | DEBUG    | managers.agent_manager:stop_game:362 - No game ID set, nothing to save
2024-12-30 19:01:18 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 19:01:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:01:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:01:28 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 19:01:28 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 19:01:28 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 19:01:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 19:01:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:01:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 19:01:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 19:01:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:01:28 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 19:01:28 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 19:01:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 19:01:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 19:01:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 19:01:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 19:01:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 19:01:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 19:01:30 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 19:01:30 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 19:01:30 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 19:01:30 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 19:01:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:01:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:01:30 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 19:01:30 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 19:01:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:01:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:01:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:01:30 | DEBUG    | managers.agent_manager:get_state:200 - Fetching current game state
2024-12-30 19:01:30 | DEBUG    | managers.agent_manager:get_state:202 - Current state: None
2024-12-30 19:04:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:04:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:04:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:04:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:04:24 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 19:04:24 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:04:24 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 19:04:24 | INFO     | managers.agent_manager:stop_game:357 - Stopping game...
2024-12-30 19:04:24 | DEBUG    | managers.agent_manager:stop_game:362 - No game ID set, nothing to save
2024-12-30 19:04:24 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 19:04:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:04:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:04:36 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 19:04:37 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 19:04:37 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 19:04:37 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 19:04:37 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:04:37 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 19:04:37 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 19:04:37 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:04:37 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 19:04:37 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 19:04:37 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 19:04:37 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 19:04:37 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 19:04:37 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 19:04:37 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 19:04:37 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-30 19:04:39 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-30 19:04:39 | INFO     | managers.agent_manager:__init__:124 - Initializing AgentManager
2024-12-30 19:04:39 | INFO     | managers.agent_manager:__init__:136 - AgentManager initialization completed
2024-12-30 19:04:39 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-30 19:04:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:04:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:04:39 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:04:39 | DEBUG    | managers.agent_manager:get_state:211 - Current state: None
2024-12-30 19:04:39 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:04:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2024-12-30 19:04:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2024-12-30 19:04:39 | DEBUG    | managers.agent_manager:get_state:209 - Fetching current game state
2024-12-30 19:04:39 | DEBUG    | managers.agent_manager:get_state:211 - Current state: None
2024-12-30 19:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2024-12-30 19:06:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2024-12-30 19:06:37 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-30 19:06:37 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-30 19:06:37 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-30 19:06:37 | INFO     | managers.agent_manager:stop_game:366 - Stopping game...
2024-12-30 19:06:37 | DEBUG    | managers.agent_manager:stop_game:371 - No game ID set, nothing to save
2024-12-30 19:06:37 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-30 19:06:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:06:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-30 19:06:48 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-30 19:06:49 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-30 19:06:49 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-30 19:06:49 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-30 19:06:49 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:06:49 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-30 19:06:49 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-30 19:06:49 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-30 19:06:49 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-30 19:06:49 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-30 19:06:49 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-30 19:06:49 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-30 19:06:49 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-30 19:06:49 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-30 19:06:49 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-30 19:06:49 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
