2025-01-06 11:03:23 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:03:26 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2025-01-06 11:03:26 | DEBUG    | config.logging_config:log_env_variables:82 - Environment variables:
2025-01-06 11:03:26 | DEBUG    | config.logging_config:log_env_variables:85 - CASYS_HOST: None
2025-01-06 11:03:26 | DEBUG    | config.logging_config:log_env_variables:85 - CASYS_PORT: 8000
2025-01-06 11:03:26 | DEBUG    | config.logging_config:log_env_variables:85 - CASYS_RELOAD: None
2025-01-06 11:03:26 | DEBUG    | config.logging_config:log_env_variables:85 - LOG_LEVEL: DEBUG
2025-01-06 11:03:26 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2025-01-06 11:03:26 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:03:28 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:03:28 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:03:28 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:07:30 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:07:30 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:07:30 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:07:30 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:07:30 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:07:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:07:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:07:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:07:30 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:07:30 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:07:30 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:07:30 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:07:30 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:07:30 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:07:30 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:07:30 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:07:30 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:07:30 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:07:30 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:07:30 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:07:30 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:07:30 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:07:32 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:07:32 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:07:32 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:07:32 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:07:32 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:07:32 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:07:32 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:07:32 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:07:33 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:07:36 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:07:36 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:07:36 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:08:11 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:08:11 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:08:11 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:08:11 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:08:11 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:08:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:08:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:08:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:08:11 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:08:11 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:08:11 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:08:11 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:08:11 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:08:11 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:08:11 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:08:11 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:08:11 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:08:11 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:08:11 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:08:11 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:08:11 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:08:11 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:08:12 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:08:12 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:08:12 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:08:12 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:08:12 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:08:12 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:08:12 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:08:12 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:08:15 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:08:17 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2025-01-06 11:08:17 | DEBUG    | config.logging_config:log_env_variables:82 - Environment variables:
2025-01-06 11:08:17 | DEBUG    | config.logging_config:log_env_variables:85 - CASYS_HOST: None
2025-01-06 11:08:17 | DEBUG    | config.logging_config:log_env_variables:85 - CASYS_PORT: 8000
2025-01-06 11:08:17 | DEBUG    | config.logging_config:log_env_variables:85 - CASYS_RELOAD: None
2025-01-06 11:08:17 | DEBUG    | config.logging_config:log_env_variables:85 - LOG_LEVEL: DEBUG
2025-01-06 11:08:17 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2025-01-06 11:08:17 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:08:19 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:08:19 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:08:19 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:08:52 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:08:52 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:08:52 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:08:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:08:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:08:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:08:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:08:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:08:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:08:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:08:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:08:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:08:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:08:52 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:08:52 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:08:52 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:08:52 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:08:52 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:08:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:08:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:08:53 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:08:53 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:08:53 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:08:53 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:08:53 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:08:53 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:08:53 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:08:53 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:08:53 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:08:53 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:08:54 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:08:57 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:08:57 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:08:57 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:10:12 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:10:12 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:10:12 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:10:12 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:10:12 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:10:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:10:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:10:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:10:12 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:10:12 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:10:12 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:10:12 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:10:12 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:10:12 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:10:12 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:10:12 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:10:12 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:10:12 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:10:12 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:10:12 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:10:12 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:10:12 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:10:13 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:10:13 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:10:13 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:10:13 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:10:13 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:10:13 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:10:13 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:10:13 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:10:15 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:10:17 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2025-01-06 11:10:17 | DEBUG    | config.logging_config:log_env_variables:82 - Environment variables:
2025-01-06 11:10:17 | DEBUG    | config.logging_config:log_env_variables:85 - CASYS_HOST: None
2025-01-06 11:10:17 | DEBUG    | config.logging_config:log_env_variables:85 - CASYS_PORT: 8000
2025-01-06 11:10:17 | DEBUG    | config.logging_config:log_env_variables:85 - CASYS_RELOAD: None
2025-01-06 11:10:17 | DEBUG    | config.logging_config:log_env_variables:85 - LOG_LEVEL: DEBUG
2025-01-06 11:10:17 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2025-01-06 11:10:17 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:10:19 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:10:19 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:10:19 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:11:05 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:11:05 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:11:05 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:11:05 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:11:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:11:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:11:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:11:05 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:11:05 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:11:05 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:11:05 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:11:05 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:11:05 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:11:05 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:11:05 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:11:05 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:11:05 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:11:05 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:11:05 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:11:05 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:11:05 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:11:06 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:11:06 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:11:06 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:11:06 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:11:06 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 11:11:06 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:11:06 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: 930c5376-86c6-421e-87c3-cc226844b3a9
2025-01-06 11:11:06 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: 930c5376-86c6-421e-87c3-cc226844b3a9
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\traces
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\characters
2025-01-06 11:11:06 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: 930c5376-86c6-421e-87c3-cc226844b3a9
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='114d4ccc-a2d2-4299-878e-5813a1d46898' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='114d4ccc-a2d2-4299-878e-5813a1d46898' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': '114d4ccc-a2d2-4299-878e-5813a1d46898', 'game_id': '930c5376-86c6-421e-87c3-cc226844b3a9', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:11:06 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 11:11:06 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 11:11:06 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '930c5376-86c6-421e-87c3-cc226844b3a9'}}
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': '114d4ccc-a2d2-4299-878e-5813a1d46898', 'game_id': '930c5376-86c6-421e-87c3-cc226844b3a9', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:11:06 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 11:11:06 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:11:06 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=114d4ccc-a2d2-4299-878e-5813a1d46898
2025-01-06 11:11:06 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='114d4ccc-a2d2-4299-878e-5813a1d46898' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='114d4ccc-a2d2-4299-878e-5813a1d46898' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': '114d4ccc-a2d2-4299-878e-5813a1d46898', 'game_id': '930c5376-86c6-421e-87c3-cc226844b3a9', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='114d4ccc-a2d2-4299-878e-5813a1d46898' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:11:06 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=114d4ccc-a2d2-4299-878e-5813a1d46898, section=930c5376-86c6-421e-87c3-cc226844b3a9
2025-01-06 11:11:06 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 11:11:06 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 11:11:06 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=114d4ccc-a2d2-4299-878e-5813a1d46898, section=1
2025-01-06 11:11:06 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 11:11:06 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 11:11:06 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 11:11:06 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 11:11:06 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=114d4ccc-a2d2-4299-878e-5813a1d46898, section=1
2025-01-06 11:11:06 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 11:11:06 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 11:11:06 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 11:11:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 11:11:06 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 11:11:06 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 11:11:06 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 11:11:06 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=114d4ccc-a2d2-4299-878e-5813a1d46898
2025-01-06 11:11:06 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:11:06 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 11:11:06 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 11:11:06 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 11:11:06 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 11:11:06 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 11:11:06 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 11:11:06 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=114d4ccc-a2d2-4299-878e-5813a1d46898
2025-01-06 11:11:06 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:11:06 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 11:11:06 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 11:11:06 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 11:11:06 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:453fd357-e197-11d1-b589-901c9cdc311c'], when='during'),)
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': '114d4ccc-a2d2-4299-878e-5813a1d46898', 'game_id': '930c5376-86c6-421e-87c3-cc226844b3a9', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='114d4ccc-a2d2-4299-878e-5813a1d46898' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:11:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:11:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:11:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:11:06 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:11:06 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 11:11:37 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:11:37 | INFO     | managers.agent_manager:get_feedback:377 - Getting user feedback
2025-01-06 11:11:37 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:11:37 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='114d4ccc-a2d2-4299-878e-5813a1d46898' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:11:37 | DEBUG    | managers.agent_manager:get_feedback:379 - Current state for feedback: session_id='114d4ccc-a2d2-4299-878e-5813a1d46898' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:11:37 | ERROR    | managers.agent_manager:get_feedback:386 - Error getting user feedback: object str can't be used in 'await' expression
2025-01-06 11:11:38 | ERROR    | api.routes.rest.game_route_rest:get_feedback:109 - Failed to get feedback: object str can't be used in 'await' expression
2025-01-06 11:11:49 | INFO     | api.routes.rest.health_route_rest:health_check:23 - Health check requested - Type: None
2025-01-06 11:11:53 | INFO     | api.routes.rest.health_route_rest:health_check:23 - Health check requested - Type: None
2025-01-06 11:13:02 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:13:02 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 11:13:02 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': '0c1727f8-22c5-499a-b536-93f7e7955f06', 'game_id': '930c5376-86c6-421e-87c3-cc226844b3a9', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:13:02 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '930c5376-86c6-421e-87c3-cc226844b3a9'}}
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': '0c1727f8-22c5-499a-b536-93f7e7955f06', 'game_id': '930c5376-86c6-421e-87c3-cc226844b3a9', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:13:02 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 11:13:02 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:13:02 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=0c1727f8-22c5-499a-b536-93f7e7955f06
2025-01-06 11:13:02 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata=None narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata=None narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': '0c1727f8-22c5-499a-b536-93f7e7955f06', 'game_id': '930c5376-86c6-421e-87c3-cc226844b3a9', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), 'last_update': datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=0c1727f8-22c5-499a-b536-93f7e7955f06, section=930c5376-86c6-421e-87c3-cc226844b3a9
2025-01-06 11:13:02 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 11:13:02 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:13:02 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=0c1727f8-22c5-499a-b536-93f7e7955f06, section=1
2025-01-06 11:13:02 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 11:13:02 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 11:13:02 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 11:13:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 11:13:02 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 11:13:02 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 11:13:02 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 11:13:02 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=0c1727f8-22c5-499a-b536-93f7e7955f06
2025-01-06 11:13:02 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:13:02 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 11:13:02 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:13:02 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 11:13:02 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 11:13:02 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:13:02 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:13:02 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=0c1727f8-22c5-499a-b536-93f7e7955f06, section=1
2025-01-06 11:13:02 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 11:13:02 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 11:13:02 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 11:13:02 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 11:13:02 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 11:13:02 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=0c1727f8-22c5-499a-b536-93f7e7955f06
2025-01-06 11:13:02 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:13:02 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 11:13:02 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 11:13:02 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 11:13:02 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:c0b5bc87-984e-4c81-f106-cc5a764bf3f2'], when='during'),)
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': '0c1727f8-22c5-499a-b536-93f7e7955f06', 'game_id': '930c5376-86c6-421e-87c3-cc226844b3a9', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:13:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:13:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:13:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:13:02 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:13:02 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 11:13:02 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:13:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:13:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:13:02 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:13:02 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:14:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 11:14:25 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '930c5376-86c6-421e-87c3-cc226844b3a9', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 11:14:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='930c5376-86c6-421e-87c3-cc226844b3a9' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 11:14:25 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 11:14:25 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:14:25 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:14:25 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:14:25 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=0c1727f8-22c5-499a-b536-93f7e7955f06
2025-01-06 11:14:25 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:14:25 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 11:14:25 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:14:25 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=0c1727f8-22c5-499a-b536-93f7e7955f06
2025-01-06 11:14:25 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:25 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:25 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': '0c1727f8-22c5-499a-b536-93f7e7955f06', 'game_id': '930c5376-86c6-421e-87c3-cc226844b3a9', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), 'last_update': datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:25 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:25 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:14:25 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=0c1727f8-22c5-499a-b536-93f7e7955f06, section=930c5376-86c6-421e-87c3-cc226844b3a9
2025-01-06 11:14:25 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 11:14:25 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:14:25 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=0c1727f8-22c5-499a-b536-93f7e7955f06, section=1
2025-01-06 11:14:25 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 11:14:25 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 11:14:25 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 11:14:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 11:14:25 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 11:14:25 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 11:14:25 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 11:14:25 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=0c1727f8-22c5-499a-b536-93f7e7955f06
2025-01-06 11:14:25 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:14:25 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 11:14:25 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:14:25 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 11:14:25 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 11:14:25 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:14:25 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:14:25 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=0c1727f8-22c5-499a-b536-93f7e7955f06, section=1
2025-01-06 11:14:25 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 11:14:25 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 11:14:25 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 11:14:25 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 11:14:25 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 11:14:25 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 11:14:25 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=0c1727f8-22c5-499a-b536-93f7e7955f06
2025-01-06 11:14:25 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:14:25 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:25 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 11:14:25 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 11:14:25 | DEBUG    | agents.story_graph:_process_decision:216 - Processing user input: Engager la procédure d'évasion
2025-01-06 11:14:25 | DEBUG    | agents.decision_agent:ainvoke:177 - Full state in decision: {'session_id': '0c1727f8-22c5-499a-b536-93f7e7955f06', 'game_id': '930c5376-86c6-421e-87c3-cc226844b3a9', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), 'last_update': datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 11:14:25 | INFO     | agents.decision_agent:ainvoke:178 - Starting decision processing: session=0c1727f8-22c5-499a-b536-93f7e7955f06, game=930c5376-86c6-421e-87c3-cc226844b3a9, section=1, input=Engager la procédure d'évasion
2025-01-06 11:14:25 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procédure d'évasion
2025-01-06 11:14:25 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=NextActionType.USER_FIRST
2025-01-06 11:14:25 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2025-01-06 11:14:28 | INFO     | agents.decision_agent:_process_decision:153 - Analysis complete: current_section=1, next_section=48
2025-01-06 11:14:28 | INFO     | agents.decision_agent:ainvoke:197 - Decision processed successfully: next_section=48
2025-01-06 11:14:28 | INFO     | agents.story_graph:_process_decision:236 - Decision processed: current_section=1, next_section=48
2025-01-06 11:14:28 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=0c1727f8-22c5-499a-b536-93f7e7955f06
2025-01-06 11:14:28 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:14:28 | INFO     | managers.workflow_manager:end_workflow:156 - Ending workflow with output: session=0c1727f8-22c5-499a-b536-93f7e7955f06, game=930c5376-86c6-421e-87c3-cc226844b3a9, section=1
2025-01-06 11:14:28 | DEBUG    | managers.workflow_manager:end_workflow:162 - Saving final state
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 14, 28, 625082), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:28 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:28 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | INFO     | managers.workflow_manager:end_workflow:165 - Workflow ended successfully
2025-01-06 11:14:28 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=0c1727f8-22c5-499a-b536-93f7e7955f06
2025-01-06 11:14:28 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 14, 28, 625082), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:14:28 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:14:28 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:14:28 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:14:28 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:14:28 | INFO     | managers.agent_manager:process_game_state:324 - Game state processed successfully
2025-01-06 11:14:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2025-01-06 11:19:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:19:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:19:22 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:19:22 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:19:22 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:19:22 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:19:22 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:19:22 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 14, 28, 625082), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:19:22 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:22 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='0c1727f8-22c5-499a-b536-93f7e7955f06' game_id='930c5376-86c6-421e-87c3-cc226844b3a9' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 11, 6, 780646), last_update=datetime.datetime(2025, 1, 6, 11, 11, 6, 780673)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 14, 28, 625082), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:19:22 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:22 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:22 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:22 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:22 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:22 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:22 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_current in namespace state
2025-01-06 11:19:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:19:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:19:22 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:19:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:19:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_current.json
2025-01-06 11:19:22 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_current
2025-01-06 11:19:22 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:19:22 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1 in namespace state
2025-01-06 11:19:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:19:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:19:22 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:19:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:19:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\930c5376-86c6-421e-87c3-cc226844b3a9\states\game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1.json
2025-01-06 11:19:22 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_930c5376-86c6-421e-87c3-cc226844b3a9_section_1
2025-01-06 11:19:22 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:19:22 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:22 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 11:19:22 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 11:19:22 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:19:23 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:19:27 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:19:27 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:19:27 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:19:28 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:19:28 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:19:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:19:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:19:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:19:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:19:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:19:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:19:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:19:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:19:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:19:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:19:28 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:19:28 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:19:28 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:19:28 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:19:28 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:19:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:19:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:19:28 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:19:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:19:28 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:19:28 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:19:28 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:19:28 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:19:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:19:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:19:28 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:19:28 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:19:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:19:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:19:29 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:19:29 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:19:29 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:19:29 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:19:29 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:19:29 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:19:29 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:19:29 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:19:29 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:19:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:19:30 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:19:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:19:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:19:30 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:19:30 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:19:36 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:19:36 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 11:19:36 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:19:36 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: ea5c323a-2ef6-4ede-bf6d-a82e0da195e8
2025-01-06 11:19:36 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: ea5c323a-2ef6-4ede-bf6d-a82e0da195e8
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\traces
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\characters
2025-01-06 11:19:36 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: ea5c323a-2ef6-4ede-bf6d-a82e0da195e8
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current in namespace state
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1 in namespace state
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': 'b43681c1-70a9-4ea8-8d57-065c5d0a9139', 'game_id': 'ea5c323a-2ef6-4ede-bf6d-a82e0da195e8', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:19:36 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 11:19:36 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 11:19:36 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': 'ea5c323a-2ef6-4ede-bf6d-a82e0da195e8'}}
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': 'b43681c1-70a9-4ea8-8d57-065c5d0a9139', 'game_id': 'ea5c323a-2ef6-4ede-bf6d-a82e0da195e8', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:19:36 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 11:19:36 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:19:36 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=b43681c1-70a9-4ea8-8d57-065c5d0a9139
2025-01-06 11:19:36 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current in namespace state
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1 in namespace state
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'b43681c1-70a9-4ea8-8d57-065c5d0a9139', 'game_id': 'ea5c323a-2ef6-4ede-bf6d-a82e0da195e8', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current in namespace state
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1 in namespace state
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:19:36 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=b43681c1-70a9-4ea8-8d57-065c5d0a9139, section=ea5c323a-2ef6-4ede-bf6d-a82e0da195e8
2025-01-06 11:19:36 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 11:19:36 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 11:19:36 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=b43681c1-70a9-4ea8-8d57-065c5d0a9139, section=1
2025-01-06 11:19:36 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 11:19:36 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 11:19:36 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 11:19:36 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 11:19:36 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=b43681c1-70a9-4ea8-8d57-065c5d0a9139, section=1
2025-01-06 11:19:36 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 11:19:36 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 11:19:36 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 11:19:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 11:19:36 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 11:19:36 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 11:19:36 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 11:19:36 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=b43681c1-70a9-4ea8-8d57-065c5d0a9139
2025-01-06 11:19:36 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:19:36 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 11:19:36 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 11:19:36 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 11:19:36 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 11:19:36 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 11:19:36 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 11:19:36 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=b43681c1-70a9-4ea8-8d57-065c5d0a9139
2025-01-06 11:19:36 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:19:36 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 11:19:36 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 11:19:36 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 11:19:36 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:7f52a1da-cbe9-e613-358b-42eb35a9d176'], when='during'),)
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': 'b43681c1-70a9-4ea8-8d57-065c5d0a9139', 'game_id': 'ea5c323a-2ef6-4ede-bf6d-a82e0da195e8', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current in namespace state
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:19:36 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1 in namespace state
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:19:36 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:19:36 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:19:36 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:19:36 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 11:19:36 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:19:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:19:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:19:36 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:19:36 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:22:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 11:22:52 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'ea5c323a-2ef6-4ede-bf6d-a82e0da195e8', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 11:22:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 11:22:52 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 11:22:52 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:22:52 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:22:52 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:22:52 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=b43681c1-70a9-4ea8-8d57-065c5d0a9139
2025-01-06 11:22:52 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:22:52 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 11:22:52 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:22:52 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=b43681c1-70a9-4ea8-8d57-065c5d0a9139
2025-01-06 11:22:52 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current in namespace state
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1 in namespace state
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'b43681c1-70a9-4ea8-8d57-065c5d0a9139', 'game_id': 'ea5c323a-2ef6-4ede-bf6d-a82e0da195e8', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), 'last_update': datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current in namespace state
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1 in namespace state
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:22:52 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=b43681c1-70a9-4ea8-8d57-065c5d0a9139, section=ea5c323a-2ef6-4ede-bf6d-a82e0da195e8
2025-01-06 11:22:52 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 11:22:52 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:22:52 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=b43681c1-70a9-4ea8-8d57-065c5d0a9139, section=1
2025-01-06 11:22:52 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 11:22:52 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 11:22:52 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 11:22:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 11:22:52 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 11:22:52 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 11:22:52 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 11:22:52 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=b43681c1-70a9-4ea8-8d57-065c5d0a9139
2025-01-06 11:22:52 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:22:52 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 11:22:52 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:22:52 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 11:22:52 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 11:22:52 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:22:52 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:22:52 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=b43681c1-70a9-4ea8-8d57-065c5d0a9139, section=1
2025-01-06 11:22:52 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 11:22:52 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 11:22:52 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 11:22:52 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 11:22:52 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 11:22:52 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 11:22:52 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=b43681c1-70a9-4ea8-8d57-065c5d0a9139
2025-01-06 11:22:52 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:22:52 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:52 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 11:22:52 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 11:22:52 | DEBUG    | agents.story_graph:_process_decision:216 - Processing user input: Engager la procédure d'évasion
2025-01-06 11:22:52 | DEBUG    | agents.decision_agent:ainvoke:177 - Full state in decision: {'session_id': 'b43681c1-70a9-4ea8-8d57-065c5d0a9139', 'game_id': 'ea5c323a-2ef6-4ede-bf6d-a82e0da195e8', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), 'last_update': datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 11:22:52 | INFO     | agents.decision_agent:ainvoke:178 - Starting decision processing: session=b43681c1-70a9-4ea8-8d57-065c5d0a9139, game=ea5c323a-2ef6-4ede-bf6d-a82e0da195e8, section=1, input=Engager la procédure d'évasion
2025-01-06 11:22:52 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procédure d'évasion
2025-01-06 11:22:52 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=NextActionType.USER_FIRST
2025-01-06 11:22:52 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2025-01-06 11:22:54 | INFO     | agents.decision_agent:_process_decision:153 - Analysis complete: current_section=1, next_section=48
2025-01-06 11:22:54 | INFO     | agents.decision_agent:ainvoke:197 - Decision processed successfully: next_section=48
2025-01-06 11:22:54 | INFO     | agents.story_graph:_process_decision:236 - Decision processed: current_section=1, next_section=48
2025-01-06 11:22:54 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=b43681c1-70a9-4ea8-8d57-065c5d0a9139
2025-01-06 11:22:54 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:22:54 | INFO     | managers.workflow_manager:end_workflow:156 - Ending workflow with output: session=b43681c1-70a9-4ea8-8d57-065c5d0a9139, game=ea5c323a-2ef6-4ede-bf6d-a82e0da195e8, section=1
2025-01-06 11:22:54 | DEBUG    | managers.workflow_manager:end_workflow:162 - Saving final state
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 22, 54, 904435), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current in namespace state
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1 in namespace state
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | INFO     | managers.workflow_manager:end_workflow:165 - Workflow ended successfully
2025-01-06 11:22:54 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=b43681c1-70a9-4ea8-8d57-065c5d0a9139
2025-01-06 11:22:54 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 22, 54, 904435), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current in namespace state
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:22:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1 in namespace state
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:22:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:22:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:22:54 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:22:54 | INFO     | managers.agent_manager:process_game_state:324 - Game state processed successfully
2025-01-06 11:22:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2025-01-06 11:30:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:30:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:30:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:30:39 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:30:39 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:30:39 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:30:39 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:30:39 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:30:39 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:30:39 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 22, 54, 904435), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:30:39 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:30:39 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='b43681c1-70a9-4ea8-8d57-065c5d0a9139' game_id='ea5c323a-2ef6-4ede-bf6d-a82e0da195e8' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 19, 36, 577959), last_update=datetime.datetime(2025, 1, 6, 11, 19, 36, 577977)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 22, 54, 904435), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:30:39 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:30:39 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:30:39 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:30:39 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:30:39 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:30:39 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:30:39 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current in namespace state
2025-01-06 11:30:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:30:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:30:39 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:30:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:30:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current.json
2025-01-06 11:30:39 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_current
2025-01-06 11:30:39 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:30:39 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1 in namespace state
2025-01-06 11:30:39 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:30:39 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:30:39 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:30:39 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:30:39 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\ea5c323a-2ef6-4ede-bf6d-a82e0da195e8\states\game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1.json
2025-01-06 11:30:39 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_ea5c323a-2ef6-4ede-bf6d-a82e0da195e8_section_1
2025-01-06 11:30:39 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:30:39 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:30:39 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 11:30:39 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 11:30:39 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:30:41 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:30:45 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:30:45 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:30:45 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:30:46 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:30:46 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:30:46 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:30:46 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:30:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:30:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:30:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:30:46 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:30:46 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:30:46 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:30:46 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:30:46 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:30:46 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:30:46 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:30:46 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:30:46 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:30:46 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:30:46 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:30:46 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:30:46 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:30:46 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:30:47 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:30:47 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:30:47 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:30:47 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:30:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:30:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:30:47 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:30:47 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:30:47 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:30:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:30:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:30:47 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:30:47 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:31:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:31:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:31:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:31:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:31:13 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:31:13 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:31:13 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:31:13 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:31:13 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:31:13 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:31:14 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:31:19 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:31:19 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:31:19 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:31:19 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:31:19 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:31:19 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:31:19 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:31:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:31:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:31:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:31:19 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:31:19 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:31:19 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:31:19 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:31:19 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:31:19 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:31:19 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:31:19 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:31:19 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:31:19 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:31:19 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:31:19 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:31:19 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:31:19 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:31:20 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:31:20 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:31:20 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:31:20 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:31:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:31:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:31:20 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:31:20 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:31:20 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:31:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:31:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:31:20 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:31:20 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:31:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:31:30 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:31:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:31:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:31:30 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:31:30 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:31:30 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:31:30 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:31:30 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:31:30 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:31:30 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:31:30 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:31:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:31:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:31:31 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:31:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:31:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:31:31 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:31:31 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:31:31 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:31:31 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 11:31:31 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:31:31 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: 9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392
2025-01-06 11:31:31 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: 9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392
2025-01-06 11:31:31 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states
2025-01-06 11:31:31 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\traces
2025-01-06 11:31:31 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\characters
2025-01-06 11:31:31 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: 9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='235fe206-9452-4732-b62c-43268febc3dd' game_id='9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='235fe206-9452-4732-b62c-43268febc3dd' game_id='9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:31:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_current in namespace state
2025-01-06 11:31:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:31:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:31:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_current.json
2025-01-06 11:31:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_current.json
2025-01-06 11:31:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_current.json
2025-01-06 11:31:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_current
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:31:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_section_1 in namespace state
2025-01-06 11:31:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:31:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:31:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_section_1.json
2025-01-06 11:31:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_section_1.json
2025-01-06 11:31:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_section_1.json
2025-01-06 11:31:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_section_1
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:31:31 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:31:31 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 11:31:31 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 11:31:31 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': '235fe206-9452-4732-b62c-43268febc3dd', 'game_id': '9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:31:31 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:31:31 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 11:31:31 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 11:31:31 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 11:31:31 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 11:31:31 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 11:31:31 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392'}}
2025-01-06 11:31:31 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': '235fe206-9452-4732-b62c-43268febc3dd', 'game_id': '9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:31:31 | ERROR    | managers.agent_manager:initialize_game:234 - Error initializing game. Input data: {'session_id': '235fe206-9452-4732-b62c-43268febc3dd', 'game_id': '9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}, Error: object async_generator can't be used in 'await' expression
2025-01-06 11:31:31 | ERROR    | api.routes.rest.game_route_rest:initialize_game:35 - Failed to initialize game: Failed to process game state: object async_generator can't be used in 'await' expression
2025-01-06 11:31:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:31:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:31:48 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:31:48 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:31:48 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:31:48 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:31:48 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:31:48 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='235fe206-9452-4732-b62c-43268febc3dd' game_id='9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:31:48 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:31:48 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='235fe206-9452-4732-b62c-43268febc3dd' game_id='9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:31:48 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:31:48 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:31:48 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:31:48 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:31:48 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:31:48 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_current in namespace state
2025-01-06 11:31:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:31:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:31:48 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_current.json
2025-01-06 11:31:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_current.json
2025-01-06 11:31:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_current.json
2025-01-06 11:31:48 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_current
2025-01-06 11:31:48 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:31:48 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_section_1 in namespace state
2025-01-06 11:31:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:31:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:31:48 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_section_1.json
2025-01-06 11:31:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_section_1.json
2025-01-06 11:31:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392\states\game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_section_1.json
2025-01-06 11:31:48 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9a52e2d2-e3ef-4c61-8ecd-5d6ac724a392_section_1
2025-01-06 11:31:48 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:31:48 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:31:48 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 11:31:48 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 11:31:48 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:31:49 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:31:52 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:31:52 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:31:52 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:31:53 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:31:53 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:31:53 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:31:53 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:31:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:31:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:31:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:31:53 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:31:53 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:31:53 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:31:53 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:31:53 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:31:53 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:31:53 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:31:53 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:31:53 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:31:53 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:31:53 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:31:53 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:31:53 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:31:53 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:31:54 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:31:54 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:31:54 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:31:54 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:31:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:31:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:31:54 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:31:54 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:36:46 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:36:46 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 11:36:46 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:36:46 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: 9c3fd72f-fd17-4c69-bdbd-5698f3636806
2025-01-06 11:36:46 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: 9c3fd72f-fd17-4c69-bdbd-5698f3636806
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\traces
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\characters
2025-01-06 11:36:46 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: 9c3fd72f-fd17-4c69-bdbd-5698f3636806
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current in namespace state
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:46 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1 in namespace state
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:46 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': 'f4448282-22a3-4625-838d-802701126c94', 'game_id': '9c3fd72f-fd17-4c69-bdbd-5698f3636806', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:36:46 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:36:46 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 11:36:46 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 11:36:46 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 11:36:46 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 11:36:46 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 11:36:46 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '9c3fd72f-fd17-4c69-bdbd-5698f3636806'}}
2025-01-06 11:36:46 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': 'f4448282-22a3-4625-838d-802701126c94', 'game_id': '9c3fd72f-fd17-4c69-bdbd-5698f3636806', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:36:46 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 11:36:46 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:36:46 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=f4448282-22a3-4625-838d-802701126c94
2025-01-06 11:36:46 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current in namespace state
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:46 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1 in namespace state
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:46 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'f4448282-22a3-4625-838d-802701126c94', 'game_id': '9c3fd72f-fd17-4c69-bdbd-5698f3636806', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current in namespace state
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:46 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1 in namespace state
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:46 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:36:46 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:36:46 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=f4448282-22a3-4625-838d-802701126c94, section=9c3fd72f-fd17-4c69-bdbd-5698f3636806
2025-01-06 11:36:46 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 11:36:46 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 11:36:46 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=f4448282-22a3-4625-838d-802701126c94, section=1
2025-01-06 11:36:46 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 11:36:46 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 11:36:46 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 11:36:46 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 11:36:46 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=f4448282-22a3-4625-838d-802701126c94, section=1
2025-01-06 11:36:46 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 11:36:46 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 11:36:46 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 11:36:46 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 11:36:46 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 11:36:46 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 11:36:46 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 11:36:46 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=f4448282-22a3-4625-838d-802701126c94
2025-01-06 11:36:46 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:36:46 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 11:36:46 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 11:36:46 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 11:36:46 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 11:36:46 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 11:36:46 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 11:36:47 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 11:36:47 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 11:36:47 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=f4448282-22a3-4625-838d-802701126c94
2025-01-06 11:36:47 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:36:47 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 11:36:47 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 11:36:47 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 11:36:47 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:7188d1ae-82e7-0324-3675-858d2532aec4'], when='during'),)
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': 'f4448282-22a3-4625-838d-802701126c94', 'game_id': '9c3fd72f-fd17-4c69-bdbd-5698f3636806', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 11:36:47 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:36:47 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current in namespace state
2025-01-06 11:36:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:36:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:36:47 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:36:47 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current
2025-01-06 11:36:47 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:36:47 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1 in namespace state
2025-01-06 11:36:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:36:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:36:47 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:36:47 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1
2025-01-06 11:36:47 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:36:47 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:36:47 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 11:36:47 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:36:47 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:36:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:36:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:36:47 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:37:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 11:37:50 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '9c3fd72f-fd17-4c69-bdbd-5698f3636806', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 11:37:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 11:37:50 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 11:37:50 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:37:50 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:37:50 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:37:50 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=f4448282-22a3-4625-838d-802701126c94
2025-01-06 11:37:50 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:37:50 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 11:37:50 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:37:50 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=f4448282-22a3-4625-838d-802701126c94
2025-01-06 11:37:50 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current in namespace state
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:50 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1 in namespace state
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:50 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'f4448282-22a3-4625-838d-802701126c94', 'game_id': '9c3fd72f-fd17-4c69-bdbd-5698f3636806', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 11, 36, 47, 995), 'last_update': datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current in namespace state
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:50 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1 in namespace state
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:50 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:37:50 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=f4448282-22a3-4625-838d-802701126c94, section=9c3fd72f-fd17-4c69-bdbd-5698f3636806
2025-01-06 11:37:50 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 11:37:50 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:37:50 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=f4448282-22a3-4625-838d-802701126c94, section=1
2025-01-06 11:37:50 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 11:37:50 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 11:37:50 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 11:37:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 11:37:50 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 11:37:50 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 11:37:50 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 11:37:50 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=f4448282-22a3-4625-838d-802701126c94
2025-01-06 11:37:50 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:37:50 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 11:37:50 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:37:50 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 11:37:50 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 11:37:50 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:37:50 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:37:50 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=f4448282-22a3-4625-838d-802701126c94, section=1
2025-01-06 11:37:50 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 11:37:50 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 11:37:50 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 11:37:50 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 11:37:50 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 11:37:50 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 11:37:50 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=f4448282-22a3-4625-838d-802701126c94
2025-01-06 11:37:50 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:37:50 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:50 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 11:37:50 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 11:37:50 | DEBUG    | agents.story_graph:_process_decision:216 - Processing user input: Engager la procédure d'évasion
2025-01-06 11:37:50 | DEBUG    | agents.decision_agent:ainvoke:177 - Full state in decision: {'session_id': 'f4448282-22a3-4625-838d-802701126c94', 'game_id': '9c3fd72f-fd17-4c69-bdbd-5698f3636806', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 11, 36, 47, 995), 'last_update': datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 11:37:50 | INFO     | agents.decision_agent:ainvoke:178 - Starting decision processing: session=f4448282-22a3-4625-838d-802701126c94, game=9c3fd72f-fd17-4c69-bdbd-5698f3636806, section=1, input=Engager la procédure d'évasion
2025-01-06 11:37:50 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procédure d'évasion
2025-01-06 11:37:50 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=NextActionType.USER_FIRST
2025-01-06 11:37:50 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2025-01-06 11:37:52 | INFO     | agents.decision_agent:_process_decision:153 - Analysis complete: current_section=1, next_section=48
2025-01-06 11:37:52 | INFO     | agents.decision_agent:ainvoke:197 - Decision processed successfully: next_section=48
2025-01-06 11:37:52 | INFO     | agents.story_graph:_process_decision:236 - Decision processed: current_section=1, next_section=48
2025-01-06 11:37:52 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=f4448282-22a3-4625-838d-802701126c94
2025-01-06 11:37:52 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:37:52 | INFO     | managers.workflow_manager:end_workflow:156 - Ending workflow with output: session=f4448282-22a3-4625-838d-802701126c94, game=9c3fd72f-fd17-4c69-bdbd-5698f3636806, section=1
2025-01-06 11:37:52 | DEBUG    | managers.workflow_manager:end_workflow:162 - Saving final state
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 37, 52, 395711), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current in namespace state
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1 in namespace state
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | INFO     | managers.workflow_manager:end_workflow:165 - Workflow ended successfully
2025-01-06 11:37:52 | DEBUG    | models.game_state:with_updates:321 - Creating new state with updates for session_id=f4448282-22a3-4625-838d-802701126c94
2025-01-06 11:37:52 | DEBUG    | models.game_state:with_updates:322 - Creating new state with updates for section_number=1
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 37, 52, 395711), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current in namespace state
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:37:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1 in namespace state
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:37:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:37:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:37:52 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:37:52 | INFO     | managers.agent_manager:process_game_state:324 - Game state processed successfully
2025-01-06 11:37:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2025-01-06 11:45:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:45:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:45:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:45:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:45:40 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:45:40 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:45:40 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:45:40 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:45:40 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:45:40 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 37, 52, 395711), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:45:40 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:45:40 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='f4448282-22a3-4625-838d-802701126c94' game_id='9c3fd72f-fd17-4c69-bdbd-5698f3636806' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 36, 47, 995), last_update=datetime.datetime(2025, 1, 6, 11, 36, 47, 1047)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 37, 52, 395711), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:45:40 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:45:40 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:45:40 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:45:40 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:45:40 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:45:40 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:45:40 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current in namespace state
2025-01-06 11:45:40 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:45:40 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:45:40 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:45:40 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:45:40 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current.json
2025-01-06 11:45:40 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_current
2025-01-06 11:45:40 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:45:40 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1 in namespace state
2025-01-06 11:45:40 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:45:40 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:45:40 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:45:40 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:45:40 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9c3fd72f-fd17-4c69-bdbd-5698f3636806\states\game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1.json
2025-01-06 11:45:40 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9c3fd72f-fd17-4c69-bdbd-5698f3636806_section_1
2025-01-06 11:45:40 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:45:40 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:45:40 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 11:45:40 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 11:45:40 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:45:42 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:45:45 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:45:45 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:45:45 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:45:45 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:45:45 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:45:45 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:45:45 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:45:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:45:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:45:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:45:45 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:45:45 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:45:45 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:45:45 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:45:45 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:45:45 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:45:45 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:45:45 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:45:45 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:45:45 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:45:45 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:45:45 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:45:45 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:45:45 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:45:46 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:45:46 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:45:46 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:45:46 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:45:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:45:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:45:46 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:45:46 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:45:46 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:45:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:45:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:45:46 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:45:46 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:46:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:46:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:46:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:46:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:46:41 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:46:41 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:46:41 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:46:41 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:46:41 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:46:41 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:46:42 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:46:44 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:46:44 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:46:44 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:46:44 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:46:44 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:46:44 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:46:44 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:46:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:46:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:46:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:46:44 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:46:44 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:46:44 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:46:44 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:46:44 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:46:44 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:46:44 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:46:44 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:46:44 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:46:44 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:46:44 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:46:44 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:46:44 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:46:44 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:46:45 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:46:45 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:46:45 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:46:45 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:46:45 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:46:45 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:46:45 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:46:45 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:46:45 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:46:45 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:49:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:49:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:49:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:49:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:49:33 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:49:33 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:49:33 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:49:33 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:49:33 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:49:33 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:49:34 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:49:39 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:49:39 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:49:39 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:49:39 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:49:39 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:49:39 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:49:39 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:49:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:49:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:49:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:49:39 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:49:39 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:49:39 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:49:39 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:49:39 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:49:39 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:49:39 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:49:39 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:49:39 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:49:39 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:49:39 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:49:39 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:49:39 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:49:39 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:49:40 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:49:40 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:49:40 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:49:40 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:49:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:49:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:49:40 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:49:40 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:49:40 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:49:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:49:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:49:40 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:49:40 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:51:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:51:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:51:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:51:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:51:10 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:51:10 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:51:10 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:51:10 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:51:10 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:51:10 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:51:12 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:51:17 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:51:17 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:51:17 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:51:18 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:51:18 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:51:18 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:51:18 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:51:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:51:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:51:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:51:18 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:51:18 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:51:18 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:51:18 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:51:18 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:51:18 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:51:18 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:51:18 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:51:18 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:51:18 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:51:18 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:51:18 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:51:18 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:51:18 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:51:19 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:51:19 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:51:19 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:51:19 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:51:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:51:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:51:19 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:51:19 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:51:19 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:51:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:51:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:51:19 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:51:19 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:51:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:51:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:51:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:51:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:51:21 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:51:21 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:51:21 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:51:21 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:51:21 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:51:21 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:51:22 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:51:25 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:51:25 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:51:25 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:51:25 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:51:25 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:51:25 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:51:25 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:51:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:51:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:51:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:51:25 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:51:25 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:51:25 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:51:25 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:51:25 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:51:25 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:51:25 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:51:25 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:51:25 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:51:25 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:51:25 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:51:25 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:51:25 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:51:25 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:51:26 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:51:26 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:51:26 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:51:26 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:51:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:51:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:51:26 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:51:26 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:51:26 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:51:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:51:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:51:26 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:51:26 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:52:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:52:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:52:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:52:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:52:20 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:52:20 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:52:20 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:52:20 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:52:20 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:52:20 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:52:21 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:52:23 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:52:23 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:52:23 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:52:23 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:52:23 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:52:23 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:52:23 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:52:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:52:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:52:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:52:23 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:52:23 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:52:23 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:52:23 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:52:23 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:52:23 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:52:23 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:52:23 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:52:23 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:52:23 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:52:23 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:52:23 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:52:23 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:52:23 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:52:24 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:52:24 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:52:24 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:52:24 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:52:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:52:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:52:24 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:52:24 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:52:24 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:52:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:52:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:52:24 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:52:24 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:53:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:53:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:53:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:53:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:53:11 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:53:11 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:53:11 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:53:11 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:53:11 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:53:11 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:53:13 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:53:17 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:53:17 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:53:17 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:53:17 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:53:17 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:53:17 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:53:17 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:53:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:53:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:53:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:53:17 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:53:17 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:53:17 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:53:17 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:53:17 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:53:17 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:53:17 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:53:17 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:53:17 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:53:17 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:53:17 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:53:17 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:53:17 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:53:17 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:53:18 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:53:18 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:53:18 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:53:18 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:53:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:53:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:53:18 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:53:18 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:53:18 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:53:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:53:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:53:18 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:53:18 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:53:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:53:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:53:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:53:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:53:29 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:53:29 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:53:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:53:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:53:29 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:53:29 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:53:29 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:53:29 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:53:29 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:53:29 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:53:29 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:53:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:53:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:53:30 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:53:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:53:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:53:30 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:53:30 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:53:31 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:53:31 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 11:53:31 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:53:31 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: 756c838d-ac72-4178-914b-7714c963a133
2025-01-06 11:53:31 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: 756c838d-ac72-4178-914b-7714c963a133
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\756c838d-ac72-4178-914b-7714c963a133\traces
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\756c838d-ac72-4178-914b-7714c963a133\characters
2025-01-06 11:53:31 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: 756c838d-ac72-4178-914b-7714c963a133
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_current in namespace state
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_current
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_section_1 in namespace state
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_section_1
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': 'bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596', 'game_id': '756c838d-ac72-4178-914b-7714c963a133', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:53:31 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 11:53:31 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 11:53:31 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '756c838d-ac72-4178-914b-7714c963a133'}}
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': 'bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596', 'game_id': '756c838d-ac72-4178-914b-7714c963a133', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:53:31 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 11:53:31 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:53:31 | DEBUG    | models.game_state:with_updates:240 - Creating new state with updates for session_id=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596
2025-01-06 11:53:31 | DEBUG    | models.game_state:with_updates:241 - Creating new state with updates for section_number=1
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_current in namespace state
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_current
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_section_1 in namespace state
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_section_1
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596', 'game_id': '756c838d-ac72-4178-914b-7714c963a133', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_current in namespace state
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_current
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_section_1 in namespace state
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_section_1
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:53:31 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596, section=756c838d-ac72-4178-914b-7714c963a133
2025-01-06 11:53:31 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 11:53:31 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 11:53:31 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596, section=1
2025-01-06 11:53:31 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 11:53:31 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 11:53:31 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 11:53:31 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 11:53:31 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596, section=1
2025-01-06 11:53:31 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 11:53:31 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 11:53:31 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 11:53:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 11:53:31 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 11:53:31 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 11:53:31 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 11:53:31 | DEBUG    | models.game_state:with_updates:240 - Creating new state with updates for session_id=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596
2025-01-06 11:53:31 | DEBUG    | models.game_state:with_updates:241 - Creating new state with updates for section_number=1
2025-01-06 11:53:31 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 11:53:31 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 11:53:31 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 11:53:31 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 11:53:31 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 11:53:31 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 11:53:31 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | models.game_state:with_updates:240 - Creating new state with updates for session_id=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596
2025-01-06 11:53:31 | DEBUG    | models.game_state:with_updates:241 - Creating new state with updates for section_number=1
2025-01-06 11:53:31 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 11:53:31 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 11:53:31 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 11:53:31 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:88f9c0e6-09d3-a372-aaa7-1c561773a9c1'], when='during'),)
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': 'bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596', 'game_id': '756c838d-ac72-4178-914b-7714c963a133', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_current in namespace state
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_current
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_section_1 in namespace state
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_section_1
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:53:31 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:31 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 11:53:31 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:53:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:53:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:53:31 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:53:31 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:53:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 11:53:33 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '756c838d-ac72-4178-914b-7714c963a133', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 11:53:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='756c838d-ac72-4178-914b-7714c963a133' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 11:53:33 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 11:53:33 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:53:33 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:53:33 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:53:33 | DEBUG    | models.game_state:with_updates:240 - Creating new state with updates for session_id=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596
2025-01-06 11:53:33 | DEBUG    | models.game_state:with_updates:241 - Creating new state with updates for section_number=1
2025-01-06 11:53:33 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 11:53:33 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:53:33 | DEBUG    | models.game_state:with_updates:240 - Creating new state with updates for session_id=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596
2025-01-06 11:53:33 | DEBUG    | models.game_state:with_updates:241 - Creating new state with updates for section_number=1
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_current in namespace state
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:33 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_current
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_section_1 in namespace state
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:33 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_section_1
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596', 'game_id': '756c838d-ac72-4178-914b-7714c963a133', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), 'last_update': datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_current in namespace state
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:33 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_current
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_section_1 in namespace state
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:33 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_section_1
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:53:33 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596, section=756c838d-ac72-4178-914b-7714c963a133
2025-01-06 11:53:33 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 11:53:33 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:53:33 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596, section=1
2025-01-06 11:53:33 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 11:53:33 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 11:53:33 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 11:53:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 11:53:33 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 11:53:33 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 11:53:33 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 11:53:33 | DEBUG    | models.game_state:with_updates:240 - Creating new state with updates for session_id=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596
2025-01-06 11:53:33 | DEBUG    | models.game_state:with_updates:241 - Creating new state with updates for section_number=1
2025-01-06 11:53:33 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 11:53:33 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:53:33 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 11:53:33 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 11:53:33 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:53:33 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 11:53:33 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596, section=1
2025-01-06 11:53:33 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 11:53:33 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 11:53:33 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 11:53:33 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 11:53:33 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 11:53:33 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 11:53:33 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | models.game_state:with_updates:240 - Creating new state with updates for session_id=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596
2025-01-06 11:53:33 | DEBUG    | models.game_state:with_updates:241 - Creating new state with updates for section_number=1
2025-01-06 11:53:33 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:33 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 11:53:33 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 11:53:33 | DEBUG    | agents.story_graph:_process_decision:216 - Processing user input: Engager la procédure d'évasion
2025-01-06 11:53:33 | DEBUG    | agents.decision_agent:ainvoke:177 - Full state in decision: {'session_id': 'bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596', 'game_id': '756c838d-ac72-4178-914b-7714c963a133', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), 'last_update': datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 11:53:33 | INFO     | agents.decision_agent:ainvoke:178 - Starting decision processing: session=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596, game=756c838d-ac72-4178-914b-7714c963a133, section=1, input=Engager la procédure d'évasion
2025-01-06 11:53:33 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procédure d'évasion
2025-01-06 11:53:33 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=NextActionType.USER_FIRST
2025-01-06 11:53:33 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2025-01-06 11:53:35 | INFO     | agents.decision_agent:_process_decision:153 - Analysis complete: current_section=1, next_section=48
2025-01-06 11:53:35 | INFO     | agents.decision_agent:ainvoke:197 - Decision processed successfully: next_section=48
2025-01-06 11:53:35 | INFO     | agents.story_graph:_process_decision:236 - Decision processed: current_section=1, next_section=48
2025-01-06 11:53:35 | DEBUG    | models.game_state:with_updates:240 - Creating new state with updates for session_id=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596
2025-01-06 11:53:35 | DEBUG    | models.game_state:with_updates:241 - Creating new state with updates for section_number=1
2025-01-06 11:53:35 | INFO     | managers.workflow_manager:end_workflow:156 - Ending workflow with output: session=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596, game=756c838d-ac72-4178-914b-7714c963a133, section=1
2025-01-06 11:53:35 | DEBUG    | managers.workflow_manager:end_workflow:162 - Saving final state
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 53, 35, 132618), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_current in namespace state
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:35 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_current
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_section_1 in namespace state
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:35 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_section_1
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | INFO     | managers.workflow_manager:end_workflow:165 - Workflow ended successfully
2025-01-06 11:53:35 | DEBUG    | models.game_state:with_updates:240 - Creating new state with updates for session_id=bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596
2025-01-06 11:53:35 | DEBUG    | models.game_state:with_updates:241 - Creating new state with updates for section_number=1
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 53, 35, 132618), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_current in namespace state
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:53:35 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_current
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_section_1 in namespace state
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:53:35 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:53:35 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_section_1
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:53:35 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:53:35 | INFO     | managers.agent_manager:process_game_state:324 - Game state processed successfully
2025-01-06 11:53:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2025-01-06 11:57:43 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:57:43 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:57:43 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:57:43 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:57:43 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:57:43 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:57:43 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:57:43 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:57:43 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:57:43 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 53, 35, 132618), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:57:43 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:57:43 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='bfb7cc0d-b91d-48ef-9bd3-295eb0f0d596' game_id='756c838d-ac72-4178-914b-7714c963a133' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 53, 31, 714756), last_update=datetime.datetime(2025, 1, 6, 11, 53, 31, 714778)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 11, 53, 35, 132618), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 11:57:43 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:57:43 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:57:43 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:57:43 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:57:43 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:57:43 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:57:43 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_current in namespace state
2025-01-06 11:57:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:57:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:57:43 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:57:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:57:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_current.json
2025-01-06 11:57:43 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_current
2025-01-06 11:57:43 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:57:43 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_756c838d-ac72-4178-914b-7714c963a133_section_1 in namespace state
2025-01-06 11:57:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:57:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:57:43 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:57:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:57:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\756c838d-ac72-4178-914b-7714c963a133\states\game_756c838d-ac72-4178-914b-7714c963a133_section_1.json
2025-01-06 11:57:43 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_756c838d-ac72-4178-914b-7714c963a133_section_1
2025-01-06 11:57:43 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:57:43 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:57:43 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 11:57:43 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 11:57:43 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:57:44 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:57:47 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:57:47 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:57:47 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:57:47 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:57:47 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:57:47 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:57:47 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:57:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:57:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:57:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:57:47 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:57:47 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:57:47 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:57:47 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:57:47 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:57:47 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:57:47 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:57:47 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:57:47 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:57:47 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:57:47 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:57:47 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:57:47 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:57:47 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:57:48 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:57:48 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:57:48 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:57:48 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:57:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:57:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:57:48 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:57:48 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:57:48 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:57:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:57:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:57:48 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:57:48 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:58:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:58:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:58:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:58:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:58:40 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:58:40 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:58:40 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:58:40 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:58:40 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:58:40 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:58:41 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:58:44 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:58:44 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:58:44 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:58:44 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:58:44 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:58:44 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:58:44 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:58:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:58:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:58:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:58:44 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:58:44 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:58:44 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:58:44 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:58:44 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:58:44 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:58:44 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:58:44 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:58:44 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:58:44 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:58:44 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:58:44 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:58:44 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:58:44 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:58:46 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:58:46 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:58:46 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:58:46 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:58:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:58:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:58:46 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:58:46 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:58:46 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:58:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:58:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:58:46 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:58:46 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:58:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:58:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:58:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:58:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:58:48 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:58:48 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:58:48 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:58:48 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:58:48 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:58:48 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:58:49 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:58:52 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:58:52 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:58:52 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:58:52 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:58:52 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:58:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:58:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:58:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:58:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:58:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:58:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:58:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:58:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:58:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:58:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:58:52 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:58:52 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:58:52 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:58:52 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:58:52 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:58:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:58:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:58:52 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:58:52 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:58:53 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:58:53 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:58:53 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:58:53 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:58:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:58:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:58:53 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:58:53 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:58:53 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:58:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:58:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:58:53 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:58:53 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:59:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:59:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:59:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:59:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:59:03 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:59:03 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:59:03 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:59:03 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:59:03 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 11:59:03 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:59:04 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:59:07 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:59:07 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:59:07 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:59:07 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:59:07 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:59:07 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:59:07 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:59:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:59:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:59:07 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:59:07 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:59:07 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:59:07 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:59:07 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:59:07 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:59:07 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:59:07 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:59:07 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:59:07 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:59:07 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:59:07 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:59:07 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:59:07 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:59:07 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:59:08 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:59:08 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:59:08 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:59:08 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:59:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:59:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:59:08 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:08 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:59:08 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:59:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:59:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:59:08 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:08 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:59:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:59:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:59:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:59:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:59:36 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:59:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:59:36 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:59:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:59:36 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:36 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:59:36 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:36 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:59:36 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:59:36 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:36 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:59:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:59:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:59:37 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:59:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:59:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:59:37 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:37 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:59:37 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:59:37 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 11:59:37 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:59:37 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: 345b76f6-7a24-408f-a738-a33113b009c7
2025-01-06 11:59:37 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: 345b76f6-7a24-408f-a738-a33113b009c7
2025-01-06 11:59:37 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states
2025-01-06 11:59:37 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\traces
2025-01-06 11:59:37 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\characters
2025-01-06 11:59:37 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: 345b76f6-7a24-408f-a738-a33113b009c7
2025-01-06 11:59:37 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T03:59:37.943725'}
2025-01-06 11:59:37 | DEBUG    | models.game_state:handle_langgraph_lists:161 - Final values after list processing: {'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T03:59:37.943725'}
2025-01-06 11:59:37 | DEBUG    | models.game_state:validate_state:167 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='d5e155af-3bf9-4e0b-8204-adfced442f95' game_id='345b76f6-7a24-408f-a738-a33113b009c7' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='d5e155af-3bf9-4e0b-8204-adfced442f95' game_id='345b76f6-7a24-408f-a738-a33113b009c7' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:59:37 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_345b76f6-7a24-408f-a738-a33113b009c7_current in namespace state
2025-01-06 11:59:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:59:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:59:37 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:37 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_345b76f6-7a24-408f-a738-a33113b009c7_current
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:59:37 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_345b76f6-7a24-408f-a738-a33113b009c7_section_1 in namespace state
2025-01-06 11:59:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:59:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:59:37 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:37 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_345b76f6-7a24-408f-a738-a33113b009c7_section_1
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:59:37 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:59:37 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 11:59:37 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 11:59:37 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:37 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:59:37 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 11:59:37 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 11:59:37 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 11:59:38 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '345b76f6-7a24-408f-a738-a33113b009c7'}}
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:161 - Final values after list processing: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:validate_state:167 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 11:59:38 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 11:59:38 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T03:59:38.128858'}
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:161 - Final values after list processing: {'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T03:59:38.128858'}
2025-01-06 11:59:38 | DEBUG    | models.game_state:validate_state:167 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 11:59:38 | DEBUG    | models.game_state:with_updates:245 - Creating new state with updates for session_id=d5e155af-3bf9-4e0b-8204-adfced442f95
2025-01-06 11:59:38 | DEBUG    | models.game_state:with_updates:246 - Creating new state with updates for section_number=1
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:161 - Final values after list processing: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:validate_state:167 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='d5e155af-3bf9-4e0b-8204-adfced442f95' game_id='345b76f6-7a24-408f-a738-a33113b009c7' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='d5e155af-3bf9-4e0b-8204-adfced442f95' game_id='345b76f6-7a24-408f-a738-a33113b009c7' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_345b76f6-7a24-408f-a738-a33113b009c7_current in namespace state
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_345b76f6-7a24-408f-a738-a33113b009c7_current
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_345b76f6-7a24-408f-a738-a33113b009c7_section_1 in namespace state
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_345b76f6-7a24-408f-a738-a33113b009c7_section_1
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:161 - Final values after list processing: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:validate_state:167 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='d5e155af-3bf9-4e0b-8204-adfced442f95' game_id='345b76f6-7a24-408f-a738-a33113b009c7' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_345b76f6-7a24-408f-a738-a33113b009c7_current in namespace state
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_345b76f6-7a24-408f-a738-a33113b009c7_current
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_345b76f6-7a24-408f-a738-a33113b009c7_section_1 in namespace state
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_345b76f6-7a24-408f-a738-a33113b009c7_section_1
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 11:59:38 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=d5e155af-3bf9-4e0b-8204-adfced442f95, section=345b76f6-7a24-408f-a738-a33113b009c7
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:161 - Final values after list processing: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:validate_state:167 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:161 - Final values after list processing: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:validate_state:167 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 11:59:38 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 11:59:38 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 11:59:38 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=d5e155af-3bf9-4e0b-8204-adfced442f95, section=1
2025-01-06 11:59:38 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 11:59:38 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 11:59:38 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 11:59:38 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 11:59:38 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=d5e155af-3bf9-4e0b-8204-adfced442f95, section=1
2025-01-06 11:59:38 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 11:59:38 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 11:59:38 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 11:59:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 11:59:38 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 11:59:38 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 11:59:38 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 11:59:38 | DEBUG    | models.game_state:with_updates:245 - Creating new state with updates for session_id=d5e155af-3bf9-4e0b-8204-adfced442f95
2025-01-06 11:59:38 | DEBUG    | models.game_state:with_updates:246 - Creating new state with updates for section_number=1
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:161 - Final values after list processing: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:validate_state:167 - Validating final state. section_number=1, narrative=None, rules=1
2025-01-06 11:59:38 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 11:59:38 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 11:59:38 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 11:59:38 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 11:59:38 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 11:59:38 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 11:59:38 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | models.game_state:with_updates:245 - Creating new state with updates for session_id=d5e155af-3bf9-4e0b-8204-adfced442f95
2025-01-06 11:59:38 | DEBUG    | models.game_state:with_updates:246 - Creating new state with updates for section_number=1
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:161 - Final values after list processing: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:validate_state:167 - Validating final state. section_number=1, narrative=1, rules=None
2025-01-06 11:59:38 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:161 - Final values after list processing: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:validate_state:167 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 11:59:38 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 11:59:38 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 11:59:38 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:2cc1a8da-f651-a0a6-f928-7963d5ed601e'], when='during'),)
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:handle_langgraph_lists:161 - Final values after list processing: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 11:59:38 | DEBUG    | models.game_state:validate_state:167 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='d5e155af-3bf9-4e0b-8204-adfced442f95' game_id='345b76f6-7a24-408f-a738-a33113b009c7' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_345b76f6-7a24-408f-a738-a33113b009c7_current in namespace state
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_345b76f6-7a24-408f-a738-a33113b009c7_current
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_345b76f6-7a24-408f-a738-a33113b009c7_section_1 in namespace state
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:59:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_345b76f6-7a24-408f-a738-a33113b009c7_section_1
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:59:38 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:38 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 11:59:38 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:59:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:59:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='d5e155af-3bf9-4e0b-8204-adfced442f95' game_id='345b76f6-7a24-408f-a738-a33113b009c7' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:59:38 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:38 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='d5e155af-3bf9-4e0b-8204-adfced442f95' game_id='345b76f6-7a24-408f-a738-a33113b009c7' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:59:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 11:59:40 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 11:59:40 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='345b76f6-7a24-408f-a738-a33113b009c7' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 11:59:40 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 11:59:40 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:40 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='d5e155af-3bf9-4e0b-8204-adfced442f95' game_id='345b76f6-7a24-408f-a738-a33113b009c7' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:59:40 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 11:59:40 | DEBUG    | models.game_state:with_updates:245 - Creating new state with updates for session_id=d5e155af-3bf9-4e0b-8204-adfced442f95
2025-01-06 11:59:40 | DEBUG    | models.game_state:with_updates:246 - Creating new state with updates for section_number=1
2025-01-06 11:59:40 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'd5e155af-3bf9-4e0b-8204-adfced442f95', 'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), 'last_update': datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 11:59:40 | ERROR    | managers.agent_manager:process_game_state:336 - Error processing game state: 'dict' object has no attribute 'section_number'
2025-01-06 11:59:40 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Failed to process game state: 'dict' object has no attribute 'section_number'
2025-01-06 11:59:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:59:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:59:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 11:59:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 11:59:50 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 11:59:50 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:59:50 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 11:59:50 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 11:59:50 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:50 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='d5e155af-3bf9-4e0b-8204-adfced442f95' game_id='345b76f6-7a24-408f-a738-a33113b009c7' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:59:50 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:50 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='d5e155af-3bf9-4e0b-8204-adfced442f95' game_id='345b76f6-7a24-408f-a738-a33113b009c7' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 11, 59, 38, 278197), last_update=datetime.datetime(2025, 1, 6, 11, 59, 38, 278223)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 11:59:50 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:50 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:50 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:50 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:50 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:50 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:50 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_345b76f6-7a24-408f-a738-a33113b009c7_current in namespace state
2025-01-06 11:59:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:59:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:59:50 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_current.json
2025-01-06 11:59:50 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_345b76f6-7a24-408f-a738-a33113b009c7_current
2025-01-06 11:59:50 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 11:59:50 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_345b76f6-7a24-408f-a738-a33113b009c7_section_1 in namespace state
2025-01-06 11:59:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 11:59:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 11:59:50 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\345b76f6-7a24-408f-a738-a33113b009c7\states\game_345b76f6-7a24-408f-a738-a33113b009c7_section_1.json
2025-01-06 11:59:50 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_345b76f6-7a24-408f-a738-a33113b009c7_section_1
2025-01-06 11:59:50 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 11:59:50 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 11:59:50 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 11:59:50 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 11:59:50 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 11:59:52 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:59:54 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 11:59:54 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 11:59:54 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 11:59:55 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 11:59:55 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 11:59:55 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 11:59:55 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:59:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 11:59:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 11:59:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 11:59:55 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 11:59:55 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:59:55 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 11:59:55 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 11:59:55 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 11:59:55 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 11:59:55 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 11:59:55 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 11:59:55 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 11:59:55 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 11:59:55 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 11:59:55 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 11:59:55 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 11:59:55 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 11:59:55 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 11:59:55 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 11:59:55 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 11:59:55 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 11:59:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:59:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:59:55 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:55 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 11:59:55 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 11:59:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 11:59:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 11:59:55 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 11:59:55 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:00:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:00:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:00:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:00:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:00:48 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:00:48 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:00:48 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:00:48 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:00:48 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:00:48 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:00:49 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:00:55 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:00:55 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:00:55 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:00:55 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:00:55 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:00:55 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:00:55 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:00:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:00:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:00:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:00:55 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:00:55 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:00:55 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:00:55 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:00:55 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:00:55 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:00:55 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:00:55 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:00:55 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:00:55 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:00:55 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:00:55 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:00:55 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:00:55 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:00:56 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:00:56 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:00:56 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:00:56 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:00:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:00:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:00:56 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:00:56 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:00:56 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:00:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:00:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:00:56 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:00:56 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:01:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 12:01:00 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '345b76f6-7a24-408f-a738-a33113b009c7', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 12:01:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='345b76f6-7a24-408f-a738-a33113b009c7' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 12:01:00 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 12:01:00 | ERROR    | managers.agent_manager:process_game_state:256 - Story graph not initialized
2025-01-06 12:01:00 | ERROR    | managers.agent_manager:process_game_state:336 - Error processing game state: Story graph not initialized
2025-01-06 12:01:00 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Failed to process game state: Story graph not initialized
2025-01-06 12:01:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:01:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:01:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:01:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:01:07 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:01:07 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:01:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:01:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:01:07 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:01:07 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:01:07 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:01:07 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:01:07 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:01:07 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:01:07 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:01:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:01:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:01:08 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:01:08 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 12:01:08 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:01:08 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: 61810816-a012-4eb5-93d7-865bd1bf28f2
2025-01-06 12:01:08 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: 61810816-a012-4eb5-93d7-865bd1bf28f2
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\traces
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\characters
2025-01-06 12:01:08 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: 61810816-a012-4eb5-93d7-865bd1bf28f2
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:01:08.080616'}
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:01:08.080616'}
2025-01-06 12:01:08 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_current in namespace state
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_current
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1 in namespace state
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 12:01:08 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 12:01:08 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '61810816-a012-4eb5-93d7-865bd1bf28f2'}}
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:01:08 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:01:08 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:01:08.219910'}
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:01:08.219910'}
2025-01-06 12:01:08 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:01:08 | DEBUG    | models.game_state:with_updates:261 - Creating new state with updates for session_id=a7ea2d92-75e8-4409-8c2a-739ad3170a46
2025-01-06 12:01:08 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for section_number=1
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_current in namespace state
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:01:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_current
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1 in namespace state
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_current in namespace state
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_current
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1 in namespace state
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:01:08 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=a7ea2d92-75e8-4409-8c2a-739ad3170a46, section=61810816-a012-4eb5-93d7-865bd1bf28f2
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:01:08 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:01:08 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 12:01:08 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=a7ea2d92-75e8-4409-8c2a-739ad3170a46, section=1
2025-01-06 12:01:08 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:01:08 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:01:08 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:01:08 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 12:01:08 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=a7ea2d92-75e8-4409-8c2a-739ad3170a46, section=1
2025-01-06 12:01:08 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:01:08 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:01:08 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:01:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:01:08 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:01:08 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:01:08 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:01:08 | DEBUG    | models.game_state:with_updates:261 - Creating new state with updates for session_id=a7ea2d92-75e8-4409-8c2a-739ad3170a46
2025-01-06 12:01:08 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for section_number=1
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=None, rules=1
2025-01-06 12:01:08 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:01:08 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 12:01:08 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 12:01:08 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:01:08 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:01:08 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:01:08 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | models.game_state:with_updates:261 - Creating new state with updates for session_id=a7ea2d92-75e8-4409-8c2a-739ad3170a46
2025-01-06 12:01:08 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for section_number=1
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=None
2025-01-06 12:01:08 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:08 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:01:08 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 12:01:08 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:cb611700-4f15-3152-b78a-05920075db5f'], when='during'),)
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:01:08 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_current in namespace state
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_current
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1 in namespace state
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:01:08 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:08 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 12:01:08 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:01:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:01:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:01:08 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:01:08 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:01:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 12:01:11 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 12:01:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 12:01:11 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 12:01:11 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:01:11 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:01:11 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:01:11 | DEBUG    | models.game_state:with_updates:261 - Creating new state with updates for session_id=a7ea2d92-75e8-4409-8c2a-739ad3170a46
2025-01-06 12:01:11 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for section_number=1
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207) last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:01:11 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:11 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:01:11 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:01:11.259741'}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:01:11.259741'}
2025-01-06 12:01:11 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:01:11 | DEBUG    | models.game_state:with_updates:261 - Creating new state with updates for session_id=a7ea2d92-75e8-4409-8c2a-739ad3170a46
2025-01-06 12:01:11 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for section_number=1
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207) last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_current in namespace state
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:11 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_current
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1 in namespace state
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:11 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207) last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_current in namespace state
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:11 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_current
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1 in namespace state
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:11 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:01:11 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=a7ea2d92-75e8-4409-8c2a-739ad3170a46, section=61810816-a012-4eb5-93d7-865bd1bf28f2
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:11 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:01:11 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:01:11 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=a7ea2d92-75e8-4409-8c2a-739ad3170a46, section=1
2025-01-06 12:01:11 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:01:11 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:01:11 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:01:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:01:11 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:01:11 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:01:11 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:01:11 | DEBUG    | models.game_state:with_updates:261 - Creating new state with updates for session_id=a7ea2d92-75e8-4409-8c2a-739ad3170a46
2025-01-06 12:01:11 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for section_number=1
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207) last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:11 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:01:11 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:01:11 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:01:11 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:01:11 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:01:11 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:01:11 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=a7ea2d92-75e8-4409-8c2a-739ad3170a46, section=1
2025-01-06 12:01:11 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:01:11 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:01:11 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:01:11 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:01:11 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:01:11 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:01:11 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | models.game_state:with_updates:261 - Creating new state with updates for session_id=a7ea2d92-75e8-4409-8c2a-739ad3170a46
2025-01-06 12:01:11 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for section_number=1
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 11, 533388), last_update=datetime.datetime(2025, 1, 6, 12, 1, 11, 533418)), 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 11, 533388), last_update=datetime.datetime(2025, 1, 6, 12, 1, 11, 533418)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:11 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:11 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:11 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:01:11 | DEBUG    | agents.story_graph:_process_decision:216 - Processing user input: Engager la procédure d'évasion
2025-01-06 12:01:11 | DEBUG    | agents.decision_agent:ainvoke:177 - Full state in decision: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:11 | INFO     | agents.decision_agent:ainvoke:178 - Starting decision processing: session=a7ea2d92-75e8-4409-8c2a-739ad3170a46, game=61810816-a012-4eb5-93d7-865bd1bf28f2, section=1, input=Engager la procédure d'évasion
2025-01-06 12:01:11 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procédure d'évasion
2025-01-06 12:01:11 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=NextActionType.USER_FIRST
2025-01-06 12:01:11 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2025-01-06 12:01:14 | INFO     | agents.decision_agent:_process_decision:153 - Analysis complete: current_section=1, next_section=48
2025-01-06 12:01:14 | INFO     | agents.decision_agent:ainvoke:197 - Decision processed successfully: next_section=48
2025-01-06 12:01:14 | INFO     | agents.story_graph:_process_decision:236 - Decision processed: current_section=1, next_section=48
2025-01-06 12:01:14 | DEBUG    | models.game_state:with_updates:261 - Creating new state with updates for session_id=a7ea2d92-75e8-4409-8c2a-739ad3170a46
2025-01-06 12:01:14 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for section_number=1
2025-01-06 12:01:14 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 1, 14, 20367), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:14 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), 'last_update': datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)}
2025-01-06 12:01:14 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207) last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)
2025-01-06 12:01:14 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:01:14 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:01:14 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 1, 14, 20367), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:14 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:14 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 1, 14, 20367), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:14 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 1, 14, 20367), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:14 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:14 | INFO     | managers.workflow_manager:end_workflow:156 - Ending workflow with output: session=a7ea2d92-75e8-4409-8c2a-739ad3170a46, game=61810816-a012-4eb5-93d7-865bd1bf28f2, section=1
2025-01-06 12:01:14 | DEBUG    | managers.workflow_manager:end_workflow:162 - Saving final state
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 1, 14, 20367), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_current in namespace state
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:14 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_current
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1 in namespace state
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:14 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | INFO     | managers.workflow_manager:end_workflow:165 - Workflow ended successfully
2025-01-06 12:01:14 | DEBUG    | models.game_state:with_updates:261 - Creating new state with updates for session_id=a7ea2d92-75e8-4409-8c2a-739ad3170a46
2025-01-06 12:01:14 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for section_number=1
2025-01-06 12:01:14 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 1, 14, 20367), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:14 | DEBUG    | models.game_state:handle_langgraph_lists:177 - Final values after list processing: {'session_id': 'a7ea2d92-75e8-4409-8c2a-739ad3170a46', 'game_id': '61810816-a012-4eb5-93d7-865bd1bf28f2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 1, 14, 20367), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:01:14 | DEBUG    | models.game_state:validate_state:183 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 1, 14, 20367), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_current in namespace state
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:01:14 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_current
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1 in namespace state
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:01:14 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:14 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:14 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:01:14 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:01:14 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:01:14 | INFO     | managers.agent_manager:process_game_state:324 - Game state processed successfully
2025-01-06 12:01:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2025-01-06 12:02:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:02:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:02:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:02:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:02:01 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:02:01 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:02:01 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:02:01 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:02:01 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:02:01 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 1, 14, 20367), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:02:01 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:02:01 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='a7ea2d92-75e8-4409-8c2a-739ad3170a46' game_id='61810816-a012-4eb5-93d7-865bd1bf28f2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 1, 8, 376207), last_update=datetime.datetime(2025, 1, 6, 12, 1, 8, 376237)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 1, 14, 20367), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:02:01 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:02:01 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:02:01 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:02:01 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:02:01 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:02:01 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:02:01 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_current in namespace state
2025-01-06 12:02:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:02:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:02:01 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:02:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:02:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_current.json
2025-01-06 12:02:01 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_current
2025-01-06 12:02:01 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:02:01 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1 in namespace state
2025-01-06 12:02:01 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:02:01 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:02:01 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:02:01 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:02:01 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61810816-a012-4eb5-93d7-865bd1bf28f2\states\game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1.json
2025-01-06 12:02:01 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_61810816-a012-4eb5-93d7-865bd1bf28f2_section_1
2025-01-06 12:02:01 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:02:01 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:02:01 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 12:02:01 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 12:02:01 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:02:03 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:02:08 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:02:08 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:02:08 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:02:08 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:02:08 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:02:08 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:02:08 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:02:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:02:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:02:08 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:02:08 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:02:08 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:02:08 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:02:08 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:02:08 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:02:08 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:02:08 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:02:08 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:02:08 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:02:08 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:02:08 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:02:08 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:02:08 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:02:08 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:02:09 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:02:09 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:02:09 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:02:09 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:02:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:02:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:02:09 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:02:09 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:02:09 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:02:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:02:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:02:09 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:02:09 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:02:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:02:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:02:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:02:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:02:31 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:02:31 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:02:31 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:02:31 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:02:31 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:02:31 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:02:32 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:02:36 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:02:36 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:02:36 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:02:36 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:02:36 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:02:36 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:02:36 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:02:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:02:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:02:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:02:36 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:02:36 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:02:36 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:02:36 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:02:36 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:02:36 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:02:36 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:02:36 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:02:36 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:02:36 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:02:36 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:02:36 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:02:36 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:02:36 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:02:37 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:02:37 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:02:37 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:02:37 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:02:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:02:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:02:37 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:02:37 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:02:37 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:02:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:02:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:02:37 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:02:37 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:03:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:03:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:03:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:03:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:03:11 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:03:11 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:03:11 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:03:11 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:03:11 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:03:11 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:03:12 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:03:19 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:03:19 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:03:19 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:03:19 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:03:19 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:03:19 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:03:19 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:03:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:03:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:03:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:03:19 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:03:19 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:03:19 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:03:19 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:03:19 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:03:19 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:03:19 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:03:19 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:03:19 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:03:19 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:03:19 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:03:19 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:03:19 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:03:19 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:03:20 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:03:20 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:03:20 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:03:20 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:03:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:03:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:03:20 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:03:20 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:03:20 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:03:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:03:20 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:03:20 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:03:20 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:03:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:03:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:03:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:03:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:03:22 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:03:22 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:03:22 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:03:22 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:03:22 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:03:22 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:03:23 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:03:26 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:03:26 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:03:26 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:03:27 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:03:27 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:03:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:03:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:03:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:03:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:03:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:03:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:03:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:03:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:03:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:03:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:03:27 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:03:27 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:03:27 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:03:27 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:03:27 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:03:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:03:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:03:27 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:03:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:03:28 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:03:28 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:03:28 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:03:28 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:03:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:03:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:03:28 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:03:28 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:03:28 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:03:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:03:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:03:28 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:03:28 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:04:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:04:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:04:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:04:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:04:05 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:04:05 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:04:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:04:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:04:05 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:04:05 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:04:05 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:04:05 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:04:05 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:04:05 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:04:05 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:04:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:04:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:04:06 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:04:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:04:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:04:06 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:04:06 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:04:07 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:04:07 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 12:04:07 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:04:07 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: 9b81bb05-69d2-4176-b0f7-34c014f54f82
2025-01-06 12:04:07 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: 9b81bb05-69d2-4176-b0f7-34c014f54f82
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\traces
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\characters
2025-01-06 12:04:07 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: 9b81bb05-69d2-4176-b0f7-34c014f54f82
2025-01-06 12:04:07 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:04:07.808970'}
2025-01-06 12:04:07 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:04:07.808970'}
2025-01-06 12:04:07 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current in namespace state
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:07 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1 in namespace state
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:07 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:07 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:04:07 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 12:04:07 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 12:04:07 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 12:04:07 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 12:04:07 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 12:04:07 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82'}}
2025-01-06 12:04:07 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:07 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:07 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:07 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:04:07 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:04:07 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:04:07 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:04:07.979525'}
2025-01-06 12:04:07 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:04:07.979525'}
2025-01-06 12:04:07 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:04:07 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62
2025-01-06 12:04:07 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:04:07 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:07 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:07 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current in namespace state
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:07 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current
2025-01-06 12:04:07 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1 in namespace state
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current in namespace state
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1 in namespace state
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:04:08 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62, section=9b81bb05-69d2-4176-b0f7-34c014f54f82
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:04:08 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:04:08 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 12:04:08 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62, section=1
2025-01-06 12:04:08 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:04:08 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:04:08 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:04:08 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 12:04:08 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62, section=1
2025-01-06 12:04:08 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:04:08 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:04:08 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:04:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:04:08 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:04:08 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:04:08 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:04:08 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62
2025-01-06 12:04:08 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=1
2025-01-06 12:04:08 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:04:08 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 12:04:08 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 12:04:08 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:04:08 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:04:08 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:04:08 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62
2025-01-06 12:04:08 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=None
2025-01-06 12:04:08 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:08 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:04:08 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 12:04:08 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:5ecd5bd3-f0c9-5fd9-55b2-cef3bfad947f'], when='during'),)
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:04:08 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current in namespace state
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1 in namespace state
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:04:08 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:08 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 12:04:08 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:04:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:04:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:04:08 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:04:08 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:04:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 12:04:10 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 12:04:10 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 12:04:10 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 12:04:10 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:04:10 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:04:10 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:04:10 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62
2025-01-06 12:04:10 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545) last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:04:10 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:10 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:04:10 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:04:10.467315'}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:04:10.467315'}
2025-01-06 12:04:10 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:04:10 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62
2025-01-06 12:04:10 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545) last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current in namespace state
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:10 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1 in namespace state
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:10 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545) last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current in namespace state
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:10 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1 in namespace state
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:10 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:04:10 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62, section=9b81bb05-69d2-4176-b0f7-34c014f54f82
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:10 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:04:10 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:04:10 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62, section=1
2025-01-06 12:04:10 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:04:10 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:04:10 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:04:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:04:10 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:04:10 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:04:10 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:04:10 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62
2025-01-06 12:04:10 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545) last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:10 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:04:10 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:04:10 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:04:10 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:04:10 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:04:10 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:04:10 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62, section=1
2025-01-06 12:04:10 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:04:10 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:04:10 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:04:10 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:04:10 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:04:10 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:04:10 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62
2025-01-06 12:04:10 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 10, 653379), last_update=datetime.datetime(2025, 1, 6, 12, 4, 10, 653403)), 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 10, 653379), last_update=datetime.datetime(2025, 1, 6, 12, 4, 10, 653403)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:10 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:10 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:10 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:04:10 | DEBUG    | agents.story_graph:_process_decision:216 - Processing user input: Engager la procédure d'évasion
2025-01-06 12:04:10 | DEBUG    | agents.decision_agent:ainvoke:177 - Full state in decision: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:10 | INFO     | agents.decision_agent:ainvoke:178 - Starting decision processing: session=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62, game=9b81bb05-69d2-4176-b0f7-34c014f54f82, section=1, input=Engager la procédure d'évasion
2025-01-06 12:04:10 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procédure d'évasion
2025-01-06 12:04:10 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=NextActionType.USER_FIRST
2025-01-06 12:04:10 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2025-01-06 12:04:12 | INFO     | agents.decision_agent:_process_decision:153 - Analysis complete: current_section=1, next_section=48
2025-01-06 12:04:12 | INFO     | agents.decision_agent:ainvoke:197 - Decision processed successfully: next_section=48
2025-01-06 12:04:12 | INFO     | agents.story_graph:_process_decision:236 - Decision processed: current_section=1, next_section=48
2025-01-06 12:04:12 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62
2025-01-06 12:04:12 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:04:12 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 4, 12, 32915), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:12 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), 'last_update': datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)}
2025-01-06 12:04:12 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545) last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)
2025-01-06 12:04:12 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:04:12 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:04:12 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 4, 12, 32915), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:12 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:12 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 4, 12, 32915), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:12 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 4, 12, 32915), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:12 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:12 | INFO     | managers.workflow_manager:end_workflow:156 - Ending workflow with output: session=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62, game=9b81bb05-69d2-4176-b0f7-34c014f54f82, section=1
2025-01-06 12:04:12 | DEBUG    | managers.workflow_manager:end_workflow:162 - Saving final state
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 4, 12, 32915), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current in namespace state
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:12 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1 in namespace state
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:12 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | INFO     | managers.workflow_manager:end_workflow:165 - Workflow ended successfully
2025-01-06 12:04:12 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62
2025-01-06 12:04:12 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:04:12 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 4, 12, 32915), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:12 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62', 'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 4, 12, 32915), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:04:12 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 4, 12, 32915), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current in namespace state
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:12 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1 in namespace state
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:12 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:12 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:12 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:12 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:04:12 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:12 | INFO     | managers.agent_manager:process_game_state:324 - Game state processed successfully
2025-01-06 12:04:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2025-01-06 12:04:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:04:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:04:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:04:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:04:46 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:04:46 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:04:46 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:04:46 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:04:46 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:04:46 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 4, 12, 32915), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:04:46 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:46 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c2dfd42b-37f4-43ff-a1c9-03cbd17cbc62' game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 4, 8, 81545), last_update=datetime.datetime(2025, 1, 6, 12, 4, 8, 81594)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 4, 12, 32915), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:04:46 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:46 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:46 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:46 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:46 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:46 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:46 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current in namespace state
2025-01-06 12:04:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:46 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current.json
2025-01-06 12:04:46 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_current
2025-01-06 12:04:46 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:04:46 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1 in namespace state
2025-01-06 12:04:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:04:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:04:46 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9b81bb05-69d2-4176-b0f7-34c014f54f82\states\game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1.json
2025-01-06 12:04:46 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_9b81bb05-69d2-4176-b0f7-34c014f54f82_section_1
2025-01-06 12:04:46 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:04:46 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:04:46 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 12:04:46 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 12:04:46 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:04:48 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:04:53 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:04:53 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:04:53 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:04:53 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:04:53 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:04:53 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:04:53 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:04:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:04:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:04:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:04:53 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:04:53 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:04:53 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:04:53 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:04:53 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:04:53 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:04:53 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:04:53 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:04:53 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:04:53 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:04:53 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:04:53 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:04:53 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:04:53 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:04:54 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:04:54 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:04:54 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:04:54 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:04:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:04:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:04:54 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:04:54 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:04:54 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:04:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:04:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:04:54 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:04:54 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:05:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:05:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:05:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:05:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:05:19 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:05:19 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:05:19 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:05:19 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:05:19 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:05:19 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:05:21 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:05:26 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:05:26 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:05:26 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:05:27 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:05:27 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:05:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:05:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:05:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:05:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:05:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:05:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:05:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:05:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:05:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:05:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:05:27 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:05:27 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:05:27 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:05:27 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:05:27 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:05:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:05:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:05:27 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:05:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:05:27 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:05:27 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:05:27 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:05:27 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:05:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:05:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:05:27 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:05:27 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:05:27 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:05:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:05:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:05:27 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:05:27 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:06:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:06:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:06:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:06:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:06:24 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:06:24 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:06:24 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:06:24 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:06:24 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:06:24 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:06:26 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:06:29 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:06:29 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:06:29 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:06:29 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:06:29 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:06:29 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:06:29 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:06:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:06:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:06:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:06:29 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:06:29 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:06:29 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:06:29 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:06:29 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:06:29 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:06:29 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:06:29 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:06:29 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:06:29 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:06:29 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:06:29 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:06:29 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:06:29 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:06:30 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:06:30 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:06:30 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:06:30 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:06:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:06:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:06:30 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:06:30 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:06:30 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:06:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:06:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:06:30 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:06:30 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:07:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:07:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:07:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:07:21 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:07:21 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:07:21 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:07:21 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:07:21 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:07:21 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:07:21 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:07:22 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:07:24 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:07:24 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:07:24 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:07:25 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:07:25 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:07:25 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:07:25 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:07:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:07:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:07:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:07:25 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:07:25 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:07:25 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:07:25 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:07:25 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:07:25 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:07:25 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:07:25 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:07:25 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:07:25 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:07:25 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:07:25 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:07:25 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:07:25 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:07:26 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:07:26 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:07:26 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:07:26 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:07:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:07:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:07:26 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:07:26 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:07:26 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:07:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:07:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:07:26 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:07:26 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:07:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:07:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:07:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:07:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:07:29 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:07:29 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:07:29 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:07:29 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:07:29 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:07:29 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:07:31 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:07:33 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:07:33 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:07:33 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:07:34 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:07:34 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:07:34 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:07:34 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:07:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:07:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:07:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:07:34 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:07:34 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:07:34 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:07:34 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:07:34 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:07:34 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:07:34 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:07:34 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:07:34 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:07:34 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:07:34 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:07:34 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:07:34 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:07:34 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:07:35 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:07:35 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:07:35 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:07:35 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:07:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:07:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:07:35 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:07:35 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:07:35 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:07:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:07:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:07:35 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:07:35 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:07:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 12:07:46 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '9b81bb05-69d2-4176-b0f7-34c014f54f82', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 12:07:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='9b81bb05-69d2-4176-b0f7-34c014f54f82' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 12:07:46 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 12:07:46 | ERROR    | managers.agent_manager:process_game_state:256 - Story graph not initialized
2025-01-06 12:07:46 | ERROR    | managers.agent_manager:process_game_state:336 - Error processing game state: Story graph not initialized
2025-01-06 12:07:46 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Failed to process game state: Story graph not initialized
2025-01-06 12:07:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:07:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:07:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:07:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:07:58 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:07:58 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:07:58 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:07:58 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:07:58 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:07:58 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:07:59 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:08:02 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:08:02 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:08:02 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:08:02 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:08:02 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:08:02 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:08:02 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:08:03 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:08:03 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:08:03 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:08:03 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:08:03 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:08:03 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:08:03 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:08:03 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:08:03 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:08:03 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:08:03 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:08:03 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:08:03 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:08:03 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:08:03 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:08:03 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:08:03 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:08:03 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:08:03 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:08:03 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:08:03 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:08:03 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:08:03 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:08:03 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:08:03 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:08:03 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:08:03 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:08:04 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:08:04 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:08:04 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:08:04 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:08:04 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 12:08:04 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:08:04 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 12:08:04 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:08:04 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: 71348685-5fbc-4f82-b61d-4ec1ff9b70a1
2025-01-06 12:08:04 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:08:04 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: 71348685-5fbc-4f82-b61d-4ec1ff9b70a1
2025-01-06 12:08:04 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\traces
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\characters
2025-01-06 12:08:04 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: 71348685-5fbc-4f82-b61d-4ec1ff9b70a1
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:08:04.367168'}
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:08:04.367168'}
2025-01-06 12:08:04 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='de532f5b-22bb-40a3-8b50-2f723d1224bb' game_id='71348685-5fbc-4f82-b61d-4ec1ff9b70a1' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='de532f5b-22bb-40a3-8b50-2f723d1224bb' game_id='71348685-5fbc-4f82-b61d-4ec1ff9b70a1' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current in namespace state
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:08:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1 in namespace state
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 12:08:04 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 12:08:04 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1'}}
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:08:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:08:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:08:04 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:08:04 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:08:04.508258'}
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:08:04.508258'}
2025-01-06 12:08:04 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:08:04 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=de532f5b-22bb-40a3-8b50-2f723d1224bb
2025-01-06 12:08:04 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='de532f5b-22bb-40a3-8b50-2f723d1224bb' game_id='71348685-5fbc-4f82-b61d-4ec1ff9b70a1' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='de532f5b-22bb-40a3-8b50-2f723d1224bb' game_id='71348685-5fbc-4f82-b61d-4ec1ff9b70a1' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current in namespace state
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1 in namespace state
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='de532f5b-22bb-40a3-8b50-2f723d1224bb' game_id='71348685-5fbc-4f82-b61d-4ec1ff9b70a1' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current in namespace state
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1 in namespace state
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:08:04 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=de532f5b-22bb-40a3-8b50-2f723d1224bb, section=71348685-5fbc-4f82-b61d-4ec1ff9b70a1
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:08:04 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:08:04 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 12:08:04 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=de532f5b-22bb-40a3-8b50-2f723d1224bb, section=1
2025-01-06 12:08:04 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:08:04 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:08:04 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:08:04 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 12:08:04 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=de532f5b-22bb-40a3-8b50-2f723d1224bb, section=1
2025-01-06 12:08:04 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:08:04 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:08:04 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:08:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:08:04 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:08:04 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:08:04 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:08:04 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=de532f5b-22bb-40a3-8b50-2f723d1224bb
2025-01-06 12:08:04 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=1
2025-01-06 12:08:04 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:08:04 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 12:08:04 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 12:08:04 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:08:04 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:08:04 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:08:04 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=de532f5b-22bb-40a3-8b50-2f723d1224bb
2025-01-06 12:08:04 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 8, 4, 623392), last_update=datetime.datetime(2025, 1, 6, 12, 8, 4, 623410)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 8, 4, 623392), last_update=datetime.datetime(2025, 1, 6, 12, 8, 4, 623410)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=None
2025-01-06 12:08:04 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 8, 4, 623392), last_update=datetime.datetime(2025, 1, 6, 12, 8, 4, 623410)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 8, 4, 623392), last_update=datetime.datetime(2025, 1, 6, 12, 8, 4, 623410)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:08:04 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:08:04 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 12:08:04 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:93fa271d-b725-03b2-042f-b73ed7df817c'], when='during'),)
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 8, 4, 623392), last_update=datetime.datetime(2025, 1, 6, 12, 8, 4, 623410)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 8, 4, 623392), last_update=datetime.datetime(2025, 1, 6, 12, 8, 4, 623410)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'de532f5b-22bb-40a3-8b50-2f723d1224bb', 'game_id': '71348685-5fbc-4f82-b61d-4ec1ff9b70a1', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 8, 4, 623392), last_update=datetime.datetime(2025, 1, 6, 12, 8, 4, 623410)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:08:04 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='de532f5b-22bb-40a3-8b50-2f723d1224bb' game_id='71348685-5fbc-4f82-b61d-4ec1ff9b70a1' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 8, 4, 623392), last_update=datetime.datetime(2025, 1, 6, 12, 8, 4, 623410)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current in namespace state
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current.json
2025-01-06 12:08:04 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_current
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1 in namespace state
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:08:04 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\71348685-5fbc-4f82-b61d-4ec1ff9b70a1\states\game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1.json
2025-01-06 12:08:04 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_71348685-5fbc-4f82-b61d-4ec1ff9b70a1_section_1
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:08:04 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:08:04 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 12:09:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:09:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:09:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:09:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:09:07 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:09:07 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:09:07 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:09:07 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:09:07 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:09:07 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:09:08 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:09:13 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:09:13 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:09:13 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:09:13 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:09:13 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:09:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:09:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:09:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:09:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:09:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:09:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:09:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:09:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:09:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:09:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:09:13 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:09:13 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:09:13 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:09:13 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:09:13 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:09:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:09:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:09:13 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:09:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:09:14 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:09:14 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:09:14 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:09:14 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:09:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:09:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:09:14 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:09:14 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:09:14 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:09:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:09:14 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:09:14 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:09:14 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:14:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:14:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:14:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:14:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:15:00 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:15:00 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:15:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:15:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:15:00 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:15:00 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:15:00 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:15:00 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:15:00 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:15:00 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:15:00 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:15:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:15:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:15:01 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:15:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:15:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:15:01 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:15:01 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:15:02 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:15:02 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 12:15:02 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:15:02 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: 1ea3371c-017a-49e0-9b30-9c998e9eb42e
2025-01-06 12:15:02 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: 1ea3371c-017a-49e0-9b30-9c998e9eb42e
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\traces
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\characters
2025-01-06 12:15:02 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: 1ea3371c-017a-49e0-9b30-9c998e9eb42e
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:15:02.342273'}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:15:02.342273'}
2025-01-06 12:15:02 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current in namespace state
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1 in namespace state
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 12:15:02 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 12:15:02 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e'}}
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:15:02 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:15:02 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:15:02.767255'}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:15:02.767255'}
2025-01-06 12:15:02 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:15:02 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=56c6d4a8-dfbe-4943-9fe7-4500248b6da3
2025-01-06 12:15:02 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current in namespace state
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1 in namespace state
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current in namespace state
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1 in namespace state
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:02 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:15:02 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=56c6d4a8-dfbe-4943-9fe7-4500248b6da3, section=1ea3371c-017a-49e0-9b30-9c998e9eb42e
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:15:02 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:15:02 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 12:15:02 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=56c6d4a8-dfbe-4943-9fe7-4500248b6da3, section=1
2025-01-06 12:15:02 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:15:02 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:15:02 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:15:02 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 12:15:02 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=56c6d4a8-dfbe-4943-9fe7-4500248b6da3, section=1
2025-01-06 12:15:02 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:15:02 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:15:02 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:15:02 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:15:02 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:15:02 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:15:02 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:15:02 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=56c6d4a8-dfbe-4943-9fe7-4500248b6da3
2025-01-06 12:15:02 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=1
2025-01-06 12:15:02 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:15:02 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 12:15:02 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:15:02 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:15:02 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 12:15:02 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:15:02 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:15:02 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:15:02 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:02 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:02 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=56c6d4a8-dfbe-4943-9fe7-4500248b6da3
2025-01-06 12:15:02 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=None
2025-01-06 12:15:02 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:02 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:02 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:15:02 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 12:15:02 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:99a8ad86-d113-5623-6241-a8b8d665cda8'], when='during'),)
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:15:02 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 12:15:02 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:02 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:03 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:03 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current in namespace state
2025-01-06 12:15:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:03 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:03 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current
2025-01-06 12:15:03 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:15:03 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1 in namespace state
2025-01-06 12:15:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:03 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:03 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1
2025-01-06 12:15:03 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:15:03 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:03 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:03 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 12:15:03 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:15:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:15:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:15:03 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:15:03 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:15:03 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:15:03 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:15:03 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:15:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 12:15:06 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 12:15:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 12:15:06 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 12:15:06 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:15:06 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:15:06 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:15:06 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=56c6d4a8-dfbe-4943-9fe7-4500248b6da3
2025-01-06 12:15:06 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716) last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:15:06 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:06 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:15:06 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:15:06.182172'}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:15:06.182172'}
2025-01-06 12:15:06 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:15:06 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=56c6d4a8-dfbe-4943-9fe7-4500248b6da3
2025-01-06 12:15:06 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716) last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current in namespace state
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1 in namespace state
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716) last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current in namespace state
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1 in namespace state
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:06 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:15:06 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=56c6d4a8-dfbe-4943-9fe7-4500248b6da3, section=1ea3371c-017a-49e0-9b30-9c998e9eb42e
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:06 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:15:06 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:15:06 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=56c6d4a8-dfbe-4943-9fe7-4500248b6da3, section=1
2025-01-06 12:15:06 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:15:06 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:15:06 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:15:06 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:15:06 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:15:06 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:15:06 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:15:06 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=56c6d4a8-dfbe-4943-9fe7-4500248b6da3
2025-01-06 12:15:06 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716) last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:06 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:15:06 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:15:06 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:15:06 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:15:06 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:15:06 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:15:06 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=56c6d4a8-dfbe-4943-9fe7-4500248b6da3, section=1
2025-01-06 12:15:06 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:15:06 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:15:06 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:15:06 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:15:06 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:15:06 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:15:06 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=56c6d4a8-dfbe-4943-9fe7-4500248b6da3
2025-01-06 12:15:06 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 6, 447033), last_update=datetime.datetime(2025, 1, 6, 12, 15, 6, 447057)), 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 6, 447033), last_update=datetime.datetime(2025, 1, 6, 12, 15, 6, 447057)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:06 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:06 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:06 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:15:06 | DEBUG    | agents.story_graph:_process_decision:216 - Processing user input: Engager la procédure d'évasion
2025-01-06 12:15:06 | DEBUG    | agents.decision_agent:ainvoke:177 - Full state in decision: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:06 | INFO     | agents.decision_agent:ainvoke:178 - Starting decision processing: session=56c6d4a8-dfbe-4943-9fe7-4500248b6da3, game=1ea3371c-017a-49e0-9b30-9c998e9eb42e, section=1, input=Engager la procédure d'évasion
2025-01-06 12:15:06 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procédure d'évasion
2025-01-06 12:15:06 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=NextActionType.USER_FIRST
2025-01-06 12:15:06 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2025-01-06 12:15:08 | INFO     | agents.decision_agent:_process_decision:153 - Analysis complete: current_section=1, next_section=48
2025-01-06 12:15:08 | INFO     | agents.decision_agent:ainvoke:197 - Decision processed successfully: next_section=48
2025-01-06 12:15:08 | INFO     | agents.story_graph:_process_decision:236 - Decision processed: current_section=1, next_section=48
2025-01-06 12:15:08 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=56c6d4a8-dfbe-4943-9fe7-4500248b6da3
2025-01-06 12:15:08 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:15:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 15, 8, 660627), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:08 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), 'last_update': datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)}
2025-01-06 12:15:08 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716) last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)
2025-01-06 12:15:08 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:15:08 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:15:08 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 15, 8, 660627), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:08 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 15, 8, 660627), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:08 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 15, 8, 660627), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:08 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:08 | INFO     | managers.workflow_manager:end_workflow:156 - Ending workflow with output: session=56c6d4a8-dfbe-4943-9fe7-4500248b6da3, game=1ea3371c-017a-49e0-9b30-9c998e9eb42e, section=1
2025-01-06 12:15:08 | DEBUG    | managers.workflow_manager:end_workflow:162 - Saving final state
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 15, 8, 660627), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current in namespace state
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1 in namespace state
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | INFO     | managers.workflow_manager:end_workflow:165 - Workflow ended successfully
2025-01-06 12:15:08 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=56c6d4a8-dfbe-4943-9fe7-4500248b6da3
2025-01-06 12:15:08 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:15:08 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 15, 8, 660627), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:08 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '56c6d4a8-dfbe-4943-9fe7-4500248b6da3', 'game_id': '1ea3371c-017a-49e0-9b30-9c998e9eb42e', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 15, 8, 660627), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:15:08 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 15, 8, 660627), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current in namespace state
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:15:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1 in namespace state
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:15:08 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:15:08 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:15:08 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:15:08 | INFO     | managers.agent_manager:process_game_state:324 - Game state processed successfully
2025-01-06 12:15:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2025-01-06 12:20:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:20:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:20:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:20:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:20:26 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:20:26 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:20:26 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:20:26 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:20:26 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:20:26 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 15, 8, 660627), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:20:26 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:20:26 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='56c6d4a8-dfbe-4943-9fe7-4500248b6da3' game_id='1ea3371c-017a-49e0-9b30-9c998e9eb42e' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 15, 2, 907716), last_update=datetime.datetime(2025, 1, 6, 12, 15, 2, 907738)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 15, 8, 660627), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:20:26 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:20:26 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:20:26 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:20:26 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:20:26 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:20:26 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:20:26 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current in namespace state
2025-01-06 12:20:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:20:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:20:26 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:20:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:20:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current.json
2025-01-06 12:20:26 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_current
2025-01-06 12:20:26 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:20:26 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1 in namespace state
2025-01-06 12:20:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:20:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:20:26 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:20:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:20:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ea3371c-017a-49e0-9b30-9c998e9eb42e\states\game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1.json
2025-01-06 12:20:26 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1ea3371c-017a-49e0-9b30-9c998e9eb42e_section_1
2025-01-06 12:20:26 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:20:26 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:20:26 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 12:20:26 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 12:20:26 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:20:28 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:20:34 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:20:34 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:20:34 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:20:34 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:20:34 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:20:34 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:20:34 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:20:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:20:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:20:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:20:34 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:20:34 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:20:34 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:20:34 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:20:34 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:20:34 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:20:34 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:20:34 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:20:34 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:20:34 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:20:34 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:20:34 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:20:34 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:20:34 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:20:35 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:20:35 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:20:35 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:20:35 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:20:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:20:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:20:35 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:20:35 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:20:35 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:20:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:20:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:20:35 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:20:35 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:22:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:22:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:22:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:22:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:22:09 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:22:09 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:22:09 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:22:09 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:22:09 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:22:09 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:22:10 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:22:15 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:22:15 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:22:15 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:22:15 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:22:15 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:22:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:22:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:22:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:22:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:22:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:22:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:22:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:22:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:22:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:22:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:22:15 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:22:15 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:22:15 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:22:15 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:22:15 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:22:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:22:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:22:15 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:22:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:22:16 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:22:16 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:22:16 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:22:16 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:22:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:22:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:22:16 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:22:16 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:22:16 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:22:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:22:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:22:16 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:22:16 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:23:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:23:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:23:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:23:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:23:02 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:23:02 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:23:02 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:23:02 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:23:02 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:23:02 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:23:07 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:23:10 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:23:10 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:23:10 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:23:11 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:23:11 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:23:11 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:23:11 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:23:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:23:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:23:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:23:11 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:23:11 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:23:11 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:23:11 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:23:11 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:23:11 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:23:11 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:23:11 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:23:11 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:23:11 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:23:11 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:23:11 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:23:11 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:23:11 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:23:11 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:23:11 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:23:11 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:23:11 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:23:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:23:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:23:11 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:23:11 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:23:11 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:23:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:23:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:23:11 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:23:11 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:24:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:24:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:24:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:24:09 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:24:09 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:24:09 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:24:09 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:24:09 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:24:09 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:24:09 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:24:11 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:24:14 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:24:14 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:24:14 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:24:14 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:24:14 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:24:14 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:24:14 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:24:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:24:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:24:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:24:14 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:24:14 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:24:14 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:24:14 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:24:14 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:24:14 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:24:14 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:24:14 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:24:14 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:24:14 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:24:14 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:24:14 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:24:14 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:24:14 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:24:15 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:24:15 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:24:15 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:24:15 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:24:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:24:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:24:15 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:24:15 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:24:15 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:24:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:24:15 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:24:15 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:24:15 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:25:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:25:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:25:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:25:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:25:26 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:25:26 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:25:26 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:25:26 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:25:26 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:25:26 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:25:28 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:25:33 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:25:33 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:25:33 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:25:33 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:25:33 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:25:33 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:25:33 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:25:33 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:25:33 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:25:33 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:25:33 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:25:33 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:25:33 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:25:33 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:25:33 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:25:33 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:25:33 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:25:33 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:25:33 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:25:33 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:25:33 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:25:33 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:25:33 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:25:33 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:25:34 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:25:34 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:25:34 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:25:34 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:25:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:25:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:25:34 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:25:34 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:25:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:25:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:25:35 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:25:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:25:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:25:35 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:25:35 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:25:35 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:25:35 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:25:35 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:25:35 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:25:35 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:25:35 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:25:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:25:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:25:36 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:25:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:25:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:25:36 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:25:36 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:25:36 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:25:36 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 12:25:36 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:25:36 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: f69fe177-6bc0-49af-a00f-72a8867a7188
2025-01-06 12:25:36 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: f69fe177-6bc0-49af-a00f-72a8867a7188
2025-01-06 12:25:36 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states
2025-01-06 12:25:36 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\traces
2025-01-06 12:25:36 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\characters
2025-01-06 12:25:36 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: f69fe177-6bc0-49af-a00f-72a8867a7188
2025-01-06 12:25:36 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:25:36.848187'}
2025-01-06 12:25:36 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:25:36.848187'}
2025-01-06 12:25:36 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:25:36 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_current in namespace state
2025-01-06 12:25:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:36 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:36 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_current
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:25:36 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1 in namespace state
2025-01-06 12:25:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:36 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:36 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:25:36 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:25:36 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 12:25:36 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 12:25:36 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:36 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:25:36 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 12:25:36 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 12:25:36 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 12:25:36 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 12:25:36 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 12:25:36 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188'}}
2025-01-06 12:25:36 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:36 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:36 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:36 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:25:36 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:25:36 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:25:36 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:25:36.997767'}
2025-01-06 12:25:36 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:25:36.997767'}
2025-01-06 12:25:37 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:25:37 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=e50c69c8-a2b4-445b-9a63-19777ca50ea6
2025-01-06 12:25:37 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_current in namespace state
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:37 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_current
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1 in namespace state
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:37 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_current in namespace state
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:37 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_current
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1 in namespace state
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:37 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:25:37 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=e50c69c8-a2b4-445b-9a63-19777ca50ea6, section=f69fe177-6bc0-49af-a00f-72a8867a7188
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:25:37 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:25:37 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 12:25:37 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=e50c69c8-a2b4-445b-9a63-19777ca50ea6, section=1
2025-01-06 12:25:37 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:25:37 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:25:37 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:25:37 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 12:25:37 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=e50c69c8-a2b4-445b-9a63-19777ca50ea6, section=1
2025-01-06 12:25:37 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:25:37 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:25:37 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:25:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:25:37 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:25:37 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:25:37 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:25:37 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=e50c69c8-a2b4-445b-9a63-19777ca50ea6
2025-01-06 12:25:37 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=1
2025-01-06 12:25:37 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:25:37 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 12:25:37 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 12:25:37 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:25:37 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:25:37 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:25:37 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=e50c69c8-a2b4-445b-9a63-19777ca50ea6
2025-01-06 12:25:37 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=None
2025-01-06 12:25:37 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:37 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:25:37 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 12:25:37 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:ef3d963e-20df-61c5-5341-19d294409092'], when='during'),)
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:25:37 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_current in namespace state
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:37 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_current
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1 in namespace state
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:37 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:37 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:25:37 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:37 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 12:25:37 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:25:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:25:37 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:25:37 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:25:37 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:25:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 12:25:52 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 12:25:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 12:25:52 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 12:25:52 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:25:52 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:25:52 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:25:52 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=e50c69c8-a2b4-445b-9a63-19777ca50ea6
2025-01-06 12:25:52 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122) last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:25:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:52 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:25:52 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:25:52.585573'}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:25:52.585573'}
2025-01-06 12:25:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:25:52 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=e50c69c8-a2b4-445b-9a63-19777ca50ea6
2025-01-06 12:25:52 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122) last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_current in namespace state
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_current
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1 in namespace state
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122) last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_current in namespace state
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_current
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1 in namespace state
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:25:52 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=e50c69c8-a2b4-445b-9a63-19777ca50ea6, section=f69fe177-6bc0-49af-a00f-72a8867a7188
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:52 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:25:52 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:25:52 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=e50c69c8-a2b4-445b-9a63-19777ca50ea6, section=1
2025-01-06 12:25:52 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:25:52 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:25:52 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:25:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:25:52 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:25:52 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:25:52 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:25:52 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=e50c69c8-a2b4-445b-9a63-19777ca50ea6
2025-01-06 12:25:52 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122) last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:52 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:25:52 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:25:52 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:25:52 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:25:52 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:25:52 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:25:52 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=e50c69c8-a2b4-445b-9a63-19777ca50ea6, section=1
2025-01-06 12:25:52 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:25:52 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:25:52 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:25:52 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:25:52 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:25:52 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:25:52 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=e50c69c8-a2b4-445b-9a63-19777ca50ea6
2025-01-06 12:25:52 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 52, 842331), last_update=datetime.datetime(2025, 1, 6, 12, 25, 52, 842349)), 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 52, 842331), last_update=datetime.datetime(2025, 1, 6, 12, 25, 52, 842349)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:52 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:52 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:52 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:25:52 | DEBUG    | agents.story_graph:_process_decision:216 - Processing user input: Engager la procédure d'évasion
2025-01-06 12:25:52 | DEBUG    | agents.decision_agent:ainvoke:177 - Full state in decision: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:52 | INFO     | agents.decision_agent:ainvoke:178 - Starting decision processing: session=e50c69c8-a2b4-445b-9a63-19777ca50ea6, game=f69fe177-6bc0-49af-a00f-72a8867a7188, section=1, input=Engager la procédure d'évasion
2025-01-06 12:25:52 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procédure d'évasion
2025-01-06 12:25:52 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=NextActionType.USER_FIRST
2025-01-06 12:25:52 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2025-01-06 12:25:54 | INFO     | agents.decision_agent:_process_decision:153 - Analysis complete: current_section=1, next_section=48
2025-01-06 12:25:54 | INFO     | agents.decision_agent:ainvoke:197 - Decision processed successfully: next_section=48
2025-01-06 12:25:54 | INFO     | agents.story_graph:_process_decision:236 - Decision processed: current_section=1, next_section=48
2025-01-06 12:25:54 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=e50c69c8-a2b4-445b-9a63-19777ca50ea6
2025-01-06 12:25:54 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:25:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 25, 54, 589293), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:54 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), 'last_update': datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)}
2025-01-06 12:25:54 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122) last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)
2025-01-06 12:25:54 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:25:54 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:25:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 25, 54, 589293), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 25, 54, 589293), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 25, 54, 589293), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:54 | INFO     | managers.workflow_manager:end_workflow:156 - Ending workflow with output: session=e50c69c8-a2b4-445b-9a63-19777ca50ea6, game=f69fe177-6bc0-49af-a00f-72a8867a7188, section=1
2025-01-06 12:25:54 | DEBUG    | managers.workflow_manager:end_workflow:162 - Saving final state
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 25, 54, 589293), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_current in namespace state
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_current
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1 in namespace state
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | INFO     | managers.workflow_manager:end_workflow:165 - Workflow ended successfully
2025-01-06 12:25:54 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=e50c69c8-a2b4-445b-9a63-19777ca50ea6
2025-01-06 12:25:54 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:25:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 25, 54, 589293), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'e50c69c8-a2b4-445b-9a63-19777ca50ea6', 'game_id': 'f69fe177-6bc0-49af-a00f-72a8867a7188', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 25, 54, 589293), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:25:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 25, 54, 589293), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_current in namespace state
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:25:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_current
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1 in namespace state
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:25:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:25:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:25:54 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:25:54 | INFO     | managers.agent_manager:process_game_state:324 - Game state processed successfully
2025-01-06 12:25:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2025-01-06 12:25:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:25:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:25:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:25:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:25:59 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:26:00 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:26:00 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:26:00 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:26:00 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:26:00 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 25, 54, 589293), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:26:00 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:26:00 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='e50c69c8-a2b4-445b-9a63-19777ca50ea6' game_id='f69fe177-6bc0-49af-a00f-72a8867a7188' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 25, 37, 160122), last_update=datetime.datetime(2025, 1, 6, 12, 25, 37, 160147)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 25, 54, 589293), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:26:00 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:26:00 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:26:00 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:26:00 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:26:00 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:26:00 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:26:00 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_current in namespace state
2025-01-06 12:26:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:26:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:26:00 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:26:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:26:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_current.json
2025-01-06 12:26:00 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_current
2025-01-06 12:26:00 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:26:00 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1 in namespace state
2025-01-06 12:26:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:26:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:26:00 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:26:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:26:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f69fe177-6bc0-49af-a00f-72a8867a7188\states\game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1.json
2025-01-06 12:26:00 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_f69fe177-6bc0-49af-a00f-72a8867a7188_section_1
2025-01-06 12:26:00 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:26:00 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:26:00 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 12:26:00 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 12:26:00 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:26:01 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:26:05 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:26:05 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:26:05 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:26:05 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:26:05 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:26:05 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:26:05 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:26:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:26:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:26:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:26:05 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:26:05 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:26:05 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:26:05 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:26:05 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:26:05 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:26:05 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:26:05 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:26:05 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:26:05 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:26:05 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:26:05 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:26:05 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:26:05 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:26:05 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:26:05 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:26:05 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:26:05 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:26:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:26:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:26:05 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:26:05 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:26:05 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:26:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:26:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:26:05 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:26:05 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:28:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:28:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:28:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:28:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:28:03 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:28:03 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:28:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:28:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:28:03 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:28:03 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:28:03 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:28:03 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:28:03 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:28:03 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:28:03 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:28:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:28:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:28:04 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:28:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:28:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:28:04 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:28:04 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:28:04 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:28:05 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 12:28:05 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:28:05 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: 1fc84829-2ad1-4b28-af36-b582ba1776ad
2025-01-06 12:28:05 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: 1fc84829-2ad1-4b28-af36-b582ba1776ad
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\traces
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\characters
2025-01-06 12:28:05 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: 1fc84829-2ad1-4b28-af36-b582ba1776ad
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:28:05.070040'}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:28:05.070040'}
2025-01-06 12:28:05 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current in namespace state
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1 in namespace state
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 12:28:05 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 12:28:05 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad'}}
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:28:05 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:28:05 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:28:05.394691'}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:28:05.394691'}
2025-01-06 12:28:05 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:28:05 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=57c7c025-6a2d-4395-bd56-abcd14360607
2025-01-06 12:28:05 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current in namespace state
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1 in namespace state
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current in namespace state
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1 in namespace state
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:28:05 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=57c7c025-6a2d-4395-bd56-abcd14360607, section=1fc84829-2ad1-4b28-af36-b582ba1776ad
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:28:05 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:28:05 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 12:28:05 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=57c7c025-6a2d-4395-bd56-abcd14360607, section=1
2025-01-06 12:28:05 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:28:05 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:28:05 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:28:05 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 12:28:05 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=57c7c025-6a2d-4395-bd56-abcd14360607, section=1
2025-01-06 12:28:05 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:28:05 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:28:05 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:28:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:28:05 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:28:05 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:28:05 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:28:05 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=57c7c025-6a2d-4395-bd56-abcd14360607
2025-01-06 12:28:05 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=1
2025-01-06 12:28:05 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:28:05 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 12:28:05 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 12:28:05 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:28:05 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:28:05 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:28:05 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=57c7c025-6a2d-4395-bd56-abcd14360607
2025-01-06 12:28:05 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=None
2025-01-06 12:28:05 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:28:05 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:28:05 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 12:28:05 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:1163ef82-0098-d7d5-0e69-7a8b1661c0df'], when='during'),)
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:28:05 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current in namespace state
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:28:05 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1 in namespace state
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:28:05 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:28:05 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:28:05 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:28:05 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 12:28:05 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:28:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:28:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:28:05 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:28:05 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:29:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:29:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:29:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:29:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:29:17 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:29:17 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:29:17 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:29:17 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:29:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:29:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:29:17 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:29:17 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:29:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 12:29:22 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 12:29:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 12:29:22 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 12:29:22 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:29:22 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:29:22 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:29:22 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=57c7c025-6a2d-4395-bd56-abcd14360607
2025-01-06 12:29:22 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122) last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:22 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:29:22 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:22 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:22 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:29:22 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:29:22.909880'}
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:29:22.909880'}
2025-01-06 12:29:22 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:29:22 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=57c7c025-6a2d-4395-bd56-abcd14360607
2025-01-06 12:29:22 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122) last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:22 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current in namespace state
2025-01-06 12:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:29:22 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:22 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:29:22 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1 in namespace state
2025-01-06 12:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:29:22 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:22 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:22 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}
2025-01-06 12:29:22 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122) last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current in namespace state
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:23 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1 in namespace state
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:23 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:29:23 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=57c7c025-6a2d-4395-bd56-abcd14360607, section=1fc84829-2ad1-4b28-af36-b582ba1776ad
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:23 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:29:23 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:29:23 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=57c7c025-6a2d-4395-bd56-abcd14360607, section=1
2025-01-06 12:29:23 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:29:23 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:29:23 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:29:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:29:23 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:29:23 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:29:23 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:29:23 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=57c7c025-6a2d-4395-bd56-abcd14360607
2025-01-06 12:29:23 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122) last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:23 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:29:23 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:29:23 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:29:23 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:29:23 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:29:23 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:29:23 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=57c7c025-6a2d-4395-bd56-abcd14360607, section=1
2025-01-06 12:29:23 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:29:23 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:29:23 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:29:23 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:29:23 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:29:23 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:29:23 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=57c7c025-6a2d-4395-bd56-abcd14360607
2025-01-06 12:29:23 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 29, 23, 109843), last_update=datetime.datetime(2025, 1, 6, 12, 29, 23, 109862)), 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 29, 23, 109843), last_update=datetime.datetime(2025, 1, 6, 12, 29, 23, 109862)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:23 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:23 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:23 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:29:23 | DEBUG    | agents.story_graph:_process_decision:216 - Processing user input: Engager la procédure d'évasion
2025-01-06 12:29:23 | DEBUG    | agents.decision_agent:ainvoke:177 - Full state in decision: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:23 | INFO     | agents.decision_agent:ainvoke:178 - Starting decision processing: session=57c7c025-6a2d-4395-bd56-abcd14360607, game=1fc84829-2ad1-4b28-af36-b582ba1776ad, section=1, input=Engager la procédure d'évasion
2025-01-06 12:29:23 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procédure d'évasion
2025-01-06 12:29:23 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=NextActionType.USER_FIRST
2025-01-06 12:29:23 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2025-01-06 12:29:24 | INFO     | agents.decision_agent:_process_decision:153 - Analysis complete: current_section=1, next_section=48
2025-01-06 12:29:24 | INFO     | agents.decision_agent:ainvoke:197 - Decision processed successfully: next_section=48
2025-01-06 12:29:24 | INFO     | agents.story_graph:_process_decision:236 - Decision processed: current_section=1, next_section=48
2025-01-06 12:29:24 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=57c7c025-6a2d-4395-bd56-abcd14360607
2025-01-06 12:29:24 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:29:24 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 29, 24, 833430), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:24 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), 'last_update': datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)}
2025-01-06 12:29:24 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122) last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)
2025-01-06 12:29:24 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:29:24 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:29:24 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 29, 24, 833430), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:24 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:24 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 29, 24, 833430), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:24 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 29, 24, 833430), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:24 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:24 | INFO     | managers.workflow_manager:end_workflow:156 - Ending workflow with output: session=57c7c025-6a2d-4395-bd56-abcd14360607, game=1fc84829-2ad1-4b28-af36-b582ba1776ad, section=1
2025-01-06 12:29:24 | DEBUG    | managers.workflow_manager:end_workflow:162 - Saving final state
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 29, 24, 833430), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current in namespace state
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:24 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1 in namespace state
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:24 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | INFO     | managers.workflow_manager:end_workflow:165 - Workflow ended successfully
2025-01-06 12:29:24 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=57c7c025-6a2d-4395-bd56-abcd14360607
2025-01-06 12:29:24 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:29:24 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 29, 24, 833430), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:24 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': '57c7c025-6a2d-4395-bd56-abcd14360607', 'game_id': '1fc84829-2ad1-4b28-af36-b582ba1776ad', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 29, 24, 833430), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:29:24 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 29, 24, 833430), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current in namespace state
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:29:24 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1 in namespace state
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:29:24 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:29:24 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:29:24 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:29:24 | INFO     | managers.agent_manager:process_game_state:324 - Game state processed successfully
2025-01-06 12:29:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2025-01-06 12:33:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:33:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:33:31 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:33:31 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:33:31 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:33:31 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:33:31 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:33:31 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 29, 24, 833430), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:33:31 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:33:31 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='57c7c025-6a2d-4395-bd56-abcd14360607' game_id='1fc84829-2ad1-4b28-af36-b582ba1776ad' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 28, 5, 550122), last_update=datetime.datetime(2025, 1, 6, 12, 28, 5, 550195)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 29, 24, 833430), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:33:31 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:33:31 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:33:31 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:33:31 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:33:31 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:33:31 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:33:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current in namespace state
2025-01-06 12:33:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:33:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:33:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:33:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:33:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current.json
2025-01-06 12:33:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_current
2025-01-06 12:33:31 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:33:31 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1 in namespace state
2025-01-06 12:33:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:33:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:33:31 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:33:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:33:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1fc84829-2ad1-4b28-af36-b582ba1776ad\states\game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1.json
2025-01-06 12:33:31 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_1fc84829-2ad1-4b28-af36-b582ba1776ad_section_1
2025-01-06 12:33:31 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:33:31 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:33:31 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 12:33:31 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 12:33:31 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:33:38 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:33:46 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:33:46 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:33:46 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:33:47 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:33:47 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:33:47 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:33:47 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:33:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:33:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:33:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:33:47 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:33:47 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:33:47 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:33:47 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:33:47 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:33:47 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:33:47 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:33:47 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:33:47 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:33:47 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:33:47 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:33:47 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:33:47 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:33:47 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:33:49 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:33:49 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:33:49 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:33:49 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:33:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:33:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:33:49 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:33:49 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:33:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:33:58 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:33:58 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:33:58 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:33:58 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:33:58 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:33:58 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:33:58 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:34:00 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:34:03 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:34:03 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:34:03 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:34:04 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:34:04 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:34:04 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:34:04 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:34:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:34:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:34:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:34:04 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:34:04 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:34:04 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:34:04 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:34:04 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:34:04 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:34:04 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:34:04 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:34:04 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:34:04 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:34:04 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:34:04 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:34:04 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:34:04 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:34:04 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:34:04 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:34:04 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:34:04 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:34:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:34:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:34:04 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:34:04 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:35:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:35:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:35:33 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:35:33 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:35:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:35:33 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:35:33 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:35:33 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:35:33 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:35:33 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:35:34 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:35:34 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:35:34 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:35:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:35:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:35:35 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:35:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:35:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:35:35 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:35:35 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:35:37 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:35:37 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 12:35:37 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:35:37 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: 169610bd-cd93-4d29-a3cc-7e41090dd794
2025-01-06 12:35:37 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: 169610bd-cd93-4d29-a3cc-7e41090dd794
2025-01-06 12:35:37 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states
2025-01-06 12:35:37 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\traces
2025-01-06 12:35:37 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\characters
2025-01-06 12:35:37 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: 169610bd-cd93-4d29-a3cc-7e41090dd794
2025-01-06 12:35:37 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:35:37.650764'}
2025-01-06 12:35:37 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:35:37.650764'}
2025-01-06 12:35:37 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:35:37 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_current in namespace state
2025-01-06 12:35:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:37 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:37 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_current
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:35:37 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1 in namespace state
2025-01-06 12:35:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:37 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:37 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:35:37 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:35:37 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 12:35:37 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 12:35:37 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:37 | INFO     | managers.agent_manager:get_story_workflow:353 - Getting story workflow
2025-01-06 12:35:37 | DEBUG    | managers.agent_manager:get_story_workflow:357 - Story graph not configured, configuring now
2025-01-06 12:35:37 | DEBUG    | managers.agent_manager:get_story_workflow:366 - Compiling workflow
2025-01-06 12:35:37 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 12:35:38 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': '169610bd-cd93-4d29-a3cc-7e41090dd794'}}
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:35:38 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:35:38 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:35:38.650537'}
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:35:38.650537'}
2025-01-06 12:35:38 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:35:38 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=ba773608-e8f8-4347-8150-145f4ee3650a
2025-01-06 12:35:38 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_current in namespace state
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_current
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1 in namespace state
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_current in namespace state
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_current
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1 in namespace state
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:35:38 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=ba773608-e8f8-4347-8150-145f4ee3650a, section=169610bd-cd93-4d29-a3cc-7e41090dd794
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:35:38 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:35:38 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 12:35:38 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=ba773608-e8f8-4347-8150-145f4ee3650a, section=1
2025-01-06 12:35:38 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:35:38 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:35:38 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:35:38 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 12:35:38 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=ba773608-e8f8-4347-8150-145f4ee3650a, section=1
2025-01-06 12:35:38 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:35:38 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:35:38 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:35:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:35:38 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:35:38 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:35:38 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:35:38 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=ba773608-e8f8-4347-8150-145f4ee3650a
2025-01-06 12:35:38 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=1
2025-01-06 12:35:38 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:35:38 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 12:35:38 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 12:35:38 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:35:38 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:35:38 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:35:38 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=ba773608-e8f8-4347-8150-145f4ee3650a
2025-01-06 12:35:38 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=None
2025-01-06 12:35:38 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:38 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:35:38 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 12:35:38 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:e6b12bc9-ceda-399e-fb1a-848f84136f26'], when='during'),)
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:35:38 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_current in namespace state
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_current
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1 in namespace state
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:38 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:38 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:35:38 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:38 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 12:35:38 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:35:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:35:38 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:35:38 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:35:38 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:35:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 12:35:50 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 12:35:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 12:35:50 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 12:35:50 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:35:50 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:35:50 | INFO     | managers.agent_manager:get_story_workflow:353 - Getting story workflow
2025-01-06 12:35:50 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=ba773608-e8f8-4347-8150-145f4ee3650a
2025-01-06 12:35:50 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028) last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:35:50 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:50 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:35:50 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:35:50.708438'}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:35:50.708438'}
2025-01-06 12:35:50 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:35:50 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=ba773608-e8f8-4347-8150-145f4ee3650a
2025-01-06 12:35:50 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028) last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_current in namespace state
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:50 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_current
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1 in namespace state
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:50 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028) last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_current in namespace state
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:50 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_current
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1 in namespace state
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:50 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:35:50 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=ba773608-e8f8-4347-8150-145f4ee3650a, section=169610bd-cd93-4d29-a3cc-7e41090dd794
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:50 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:35:50 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:35:50 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=ba773608-e8f8-4347-8150-145f4ee3650a, section=1
2025-01-06 12:35:50 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:35:50 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:35:50 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:35:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:35:50 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:35:50 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:35:50 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:35:50 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=ba773608-e8f8-4347-8150-145f4ee3650a
2025-01-06 12:35:50 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028) last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:50 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:35:50 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:35:50 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:35:50 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:35:50 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:35:50 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:35:50 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=ba773608-e8f8-4347-8150-145f4ee3650a, section=1
2025-01-06 12:35:50 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:35:50 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:35:50 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:35:50 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:35:50 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:35:50 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:35:50 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=ba773608-e8f8-4347-8150-145f4ee3650a
2025-01-06 12:35:50 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 50, 889171), last_update=datetime.datetime(2025, 1, 6, 12, 35, 50, 889193)), 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 50, 889171), last_update=datetime.datetime(2025, 1, 6, 12, 35, 50, 889193)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:50 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:50 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:50 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:35:50 | DEBUG    | agents.story_graph:_process_decision:216 - Processing user input: Engager la procédure d'évasion
2025-01-06 12:35:50 | DEBUG    | agents.decision_agent:ainvoke:177 - Full state in decision: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:50 | INFO     | agents.decision_agent:ainvoke:178 - Starting decision processing: session=ba773608-e8f8-4347-8150-145f4ee3650a, game=169610bd-cd93-4d29-a3cc-7e41090dd794, section=1, input=Engager la procédure d'évasion
2025-01-06 12:35:50 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procédure d'évasion
2025-01-06 12:35:50 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=NextActionType.USER_FIRST
2025-01-06 12:35:50 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2025-01-06 12:35:52 | INFO     | agents.decision_agent:_process_decision:153 - Analysis complete: current_section=1, next_section=48
2025-01-06 12:35:52 | INFO     | agents.decision_agent:ainvoke:197 - Decision processed successfully: next_section=48
2025-01-06 12:35:52 | INFO     | agents.story_graph:_process_decision:236 - Decision processed: current_section=1, next_section=48
2025-01-06 12:35:52 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=ba773608-e8f8-4347-8150-145f4ee3650a
2025-01-06 12:35:52 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:35:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 35, 52, 499108), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:52 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), 'last_update': datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)}
2025-01-06 12:35:52 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028) last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)
2025-01-06 12:35:52 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:35:52 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:35:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 35, 52, 499108), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 35, 52, 499108), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 35, 52, 499108), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:52 | INFO     | managers.workflow_manager:end_workflow:156 - Ending workflow with output: session=ba773608-e8f8-4347-8150-145f4ee3650a, game=169610bd-cd93-4d29-a3cc-7e41090dd794, section=1
2025-01-06 12:35:52 | DEBUG    | managers.workflow_manager:end_workflow:162 - Saving final state
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 35, 52, 499108), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_current in namespace state
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_current
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1 in namespace state
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | INFO     | managers.workflow_manager:end_workflow:165 - Workflow ended successfully
2025-01-06 12:35:52 | DEBUG    | managers.agent_manager:process_game_state:302 - Analyzing result: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 35, 52, 499108), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:52 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=ba773608-e8f8-4347-8150-145f4ee3650a
2025-01-06 12:35:52 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:35:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 35, 52, 499108), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'ba773608-e8f8-4347-8150-145f4ee3650a', 'game_id': '169610bd-cd93-4d29-a3cc-7e41090dd794', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 35, 52, 499108), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:35:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 35, 52, 499108), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_current in namespace state
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:35:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_current
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1 in namespace state
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:35:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:35:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:35:52 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:35:52 | INFO     | managers.agent_manager:process_game_state:325 - Game state processed successfully
2025-01-06 12:35:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2025-01-06 12:36:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:36:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:36:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:36:22 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:36:23 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:36:23 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:36:23 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:36:23 | INFO     | managers.agent_manager:stop_game:424 - Stopping game...
2025-01-06 12:36:23 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:36:23 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 35, 52, 499108), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:36:23 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:36:23 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='ba773608-e8f8-4347-8150-145f4ee3650a' game_id='169610bd-cd93-4d29-a3cc-7e41090dd794' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 35, 38, 811028), last_update=datetime.datetime(2025, 1, 6, 12, 35, 38, 811062)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 35, 52, 499108), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:36:23 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:36:23 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:36:23 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:36:23 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:36:23 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:36:23 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:36:23 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_current in namespace state
2025-01-06 12:36:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:36:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:36:23 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:36:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:36:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_current.json
2025-01-06 12:36:23 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_current
2025-01-06 12:36:23 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:36:23 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1 in namespace state
2025-01-06 12:36:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:36:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:36:23 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:36:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:36:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\169610bd-cd93-4d29-a3cc-7e41090dd794\states\game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1.json
2025-01-06 12:36:23 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_169610bd-cd93-4d29-a3cc-7e41090dd794_section_1
2025-01-06 12:36:23 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:36:23 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:36:23 | INFO     | managers.agent_manager:stop_game:436 - Final game state saved successfully
2025-01-06 12:36:23 | INFO     | managers.agent_manager:stop_game:438 - Game stopped successfully
2025-01-06 12:36:23 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:36:24 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:36:27 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:36:28 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:36:28 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:36:28 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:36:28 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:36:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:36:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:36:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:36:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:36:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:36:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:36:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:36:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:36:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:36:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:36:28 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:36:28 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:36:28 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:36:28 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:36:28 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:36:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:36:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:36:28 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:36:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:36:29 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:36:29 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:36:29 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:36:29 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:36:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:36:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:36:29 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:36:29 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:36:29 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:36:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:36:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:36:29 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:36:29 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:38:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:38:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:38:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:38:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:38:08 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:38:08 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:38:08 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:38:08 | INFO     | managers.agent_manager:stop_game:424 - Stopping game...
2025-01-06 12:38:08 | DEBUG    | managers.agent_manager:stop_game:429 - No game ID set, nothing to save
2025-01-06 12:38:08 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:38:12 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:38:16 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:38:16 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:38:16 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:38:17 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:38:17 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:38:17 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:38:17 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:38:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:38:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:38:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:38:17 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:38:17 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:38:17 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:38:17 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:38:17 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:38:17 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:38:17 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:38:17 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:38:17 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:38:17 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:38:17 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:38:17 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:38:17 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:38:17 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:38:18 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:38:18 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:38:18 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:38:18 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:38:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:38:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:38:18 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:38:18 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:38:18 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:38:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:38:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:38:18 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:38:18 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:38:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:38:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:38:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:38:48 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:38:49 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:38:49 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:38:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:38:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:38:49 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:38:49 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:38:49 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:38:49 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:38:49 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:38:49 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:38:49 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:38:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:38:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:38:50 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:38:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:38:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:38:50 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:38:50 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:38:51 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:38:51 | INFO     | managers.agent_manager:initialize_game:126 - Initializing new game
2025-01-06 12:38:51 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:38:51 | INFO     | managers.state_manager:initialize:57 - Initializing state resources
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:initialize:60 - Generated new game ID: c998fca3-a135-4250-961b-67d4252c04c2
2025-01-06 12:38:51 | INFO     | managers.cache_manager:update_game_id:359 - Updating game ID to: c998fca3-a135-4250-961b-67d4252c04c2
2025-01-06 12:38:51 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for state: data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states
2025-01-06 12:38:51 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for trace: data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\traces
2025-01-06 12:38:51 | DEBUG    | managers.cache_manager:update_game_id:369 - Creating per-game directory for characters: data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\characters
2025-01-06 12:38:51 | INFO     | managers.state_manager:initialize:64 - State manager initialized with game ID: c998fca3-a135-4250-961b-67d4252c04c2
2025-01-06 12:38:51 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:38:51.616586'}
2025-01-06 12:38:51 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:38:51.616586'}
2025-01-06 12:38:51 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:38:51 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_current in namespace state
2025-01-06 12:38:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:51 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:51 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_current
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:38:51 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_section_1 in namespace state
2025-01-06 12:38:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:51 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:51 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_section_1
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:38:51 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:38:51 | DEBUG    | managers.agent_manager:initialize_game:131 - Initial state created, narrative content: None
2025-01-06 12:38:51 | DEBUG    | managers.agent_manager:initialize_game:137 - State converted to dict, narrative content: None
2025-01-06 12:38:51 | DEBUG    | managers.agent_manager:initialize_game:145 - State dict after ID verification: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:51 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:38:51 | DEBUG    | managers.agent_manager:get_story_workflow:356 - Story graph not configured, configuring now
2025-01-06 12:38:51 | DEBUG    | managers.agent_manager:get_story_workflow:365 - Compiling workflow
2025-01-06 12:38:51 | INFO     | agents.story_graph:_setup_workflow:82 - Setting up LangGraph workflow with parallel processing
2025-01-06 12:38:52 | SUCCESS  | agents.story_graph:_setup_workflow:109 - Workflow setup completed
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:149 - Story workflow retrieved
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:153 - Thread config prepared: {'configurable': {'thread_id': 'c998fca3-a135-4250-961b-67d4252c04c2'}}
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:156 - Invoking workflow with state dict: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:38:52 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:38:52 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:38:52.214753'}
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:38:52.214753'}
2025-01-06 12:38:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:38:52 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c433e880-7af6-464e-8617-b048bf22c0e4
2025-01-06 12:38:52 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': None, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_current in namespace state
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_current
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_section_1 in namespace state
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_section_1
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: None
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata={'node': 'start'} narrative=None rules=None decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_current in namespace state
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_current
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_section_1 in namespace state
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_section_1
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:38:52 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=c433e880-7af6-464e-8617-b048bf22c0e4, section=c998fca3-a135-4250-961b-67d4252c04c2
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:38:52 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:38:52 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: None
2025-01-06 12:38:52 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=c433e880-7af6-464e-8617-b048bf22c0e4, section=1
2025-01-06 12:38:52 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:38:52 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2025-01-06 12:38:52 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:38:52 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: None
2025-01-06 12:38:52 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=c433e880-7af6-464e-8617-b048bf22c0e4, section=1
2025-01-06 12:38:52 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:38:52 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:get_cached_data:208 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (591 characters)
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:38:52 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:38:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:38:52 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:38:52 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:38:52 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:38:52 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c433e880-7af6-464e-8617-b048bf22c0e4
2025-01-06 12:38:52 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': None, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=1
2025-01-06 12:38:52 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:38:52 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: None
2025-01-06 12:38:52 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2540 characters)
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:get_cached_data:213 - Found in persistent storage
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:_deserialize_data:107 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2025-01-06 12:38:52 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:38:52 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:38:52 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:38:52 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c433e880-7af6-464e-8617-b048bf22c0e4
2025-01-06 12:38:52 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': None, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=None
2025-01-06 12:38:52 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:52 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:38:52 | INFO     | agents.story_graph:_process_decision:211 - Waiting for user input in section 1
2025-01-06 12:38:52 | INFO     | agents.story_graph:_process_decision:246 - Workflow interrupted for user input: (Interrupt(value='Waiting for user input', resumable=True, ns=['node_decision:6ddc7461-8fe1-d310-de7d-31e6b63995d8'], when='during'),)
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:158 - Workflow result received: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:178 - Result is dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:201 - Result analysis:
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:202 -  - Narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:203 -  - Rules summary: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:204 -  - Decision next section: None
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:205 -  - Trace details: None
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': None}
2025-01-06 12:38:52 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:215 - New state created from result:
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:216 -  - Narrative: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:218 -  - Rules: Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:219 -  - Decision: None
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:220 -  - Trace: None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_current in namespace state
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_current
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_section_1 in namespace state
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:52 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:52 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_section_1
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:38:52 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:initialize_game:224 - New state saved, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:52 | INFO     | managers.agent_manager:initialize_game:227 - Game initialization completed successfully
2025-01-06 12:38:52 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:38:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:38:52 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:38:52 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:38:52 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:38:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 12:38:54 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 12:38:54 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='c998fca3-a135-4250-961b-67d4252c04c2' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 12:38:54 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 12:38:54 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:38:54 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input=None
2025-01-06 12:38:54 | INFO     | managers.agent_manager:get_story_workflow:352 - Getting story workflow
2025-01-06 12:38:54 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c433e880-7af6-464e-8617-b048bf22c0e4
2025-01-06 12:38:54 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390) last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'section_number': 1}
2025-01-06 12:38:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:54 | INFO     | managers.workflow_manager:start_workflow:111 - Starting workflow
2025-01-06 12:38:54 | INFO     | managers.state_manager:create_initial_state:215 - Creating initial state
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:38:54.539978'}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'section_number': 1, 'narrative': None, 'rules': None, 'decision': None, 'trace': None, 'character_id': 'current', 'timestamp': '2025-01-06T04:38:54.539978'}
2025-01-06 12:38:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=None, rules=None
2025-01-06 12:38:54 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c433e880-7af6-464e-8617-b048bf22c0e4
2025-01-06 12:38:54 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390) last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_current in namespace state
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_current
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_section_1 in namespace state
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_section_1
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:validate_state:176 - Input is Dict, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390) last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:validate_state:179 - Created GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:validate_state:185 - State format validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=None trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_current in namespace state
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_current
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_section_1 in namespace state
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:54 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_section_1
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:38:54 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | INFO     | managers.workflow_manager:start_workflow:132 - Workflow started successfully: session=c433e880-7af6-464e-8617-b048bf22c0e4, section=c998fca3-a135-4250-961b-67d4252c04c2
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:54 | INFO     | agents.story_graph:_process_rules:117 - Processing rules for section 1
2025-01-06 12:38:54 | DEBUG    | agents.story_graph:_process_rules:118 - Input narrative content before rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:38:54 | DEBUG    | agents.rules_agent:ainvoke:251 - Processing rules for state: session=c433e880-7af6-464e-8617-b048bf22c0e4, section=1
2025-01-06 12:38:54 | DEBUG    | agents.rules_agent:_process_section_rules:53 - Starting process_section_rules for section 1
2025-01-06 12:38:54 | INFO     | managers.rules_manager:get_cached_rules:38 - Getting cached rules for section 1
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1_rules in namespace rules
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_markdown_to_rules:260 - Parsing markdown content for section 1
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_markdown_to_rules:279 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_markdown_to_rules:298 - Parsed metadata: {'last_update': '2025-01-02T17:25:55.262062', 'source': 'llm_analysis', 'source_type': 'processed'}
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_markdown_to_rules:318 - Parsed analysis: {'needs_dice': 'false', 'dice_type': 'none', 'needs_user_response': 'true', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_parse_choices:192 - Parsing choices from content
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Engager la procédure d'évasion'
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 48
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Engager la procédure d'évasion'
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_parse_choices:202 - Parsing choice: 'Continuer votre route'
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_parse_choices:218 - Parsed dice type: none
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_parse_choices:235 - Parsed target section: 398
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_parse_choices:250 - Choice parsed successfully: 'Continuer votre route'
2025-01-06 12:38:54 | INFO     | managers.rules_manager:_parse_choices:255 - Successfully parsed 2 choices
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_markdown_to_rules:328 - Parsed 2 choices
2025-01-06 12:38:54 | DEBUG    | managers.rules_manager:_markdown_to_rules:373 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2025-01-06 12:38:54 | INFO     | managers.rules_manager:_markdown_to_rules:385 - Successfully created RulesModel for section 1
2025-01-06 12:38:54 | INFO     | managers.rules_manager:get_cached_rules:51 - Successfully retrieved rules for section 1 from cache
2025-01-06 12:38:54 | INFO     | agents.rules_agent:_process_section_rules:58 - Rules found in cache for section 1
2025-01-06 12:38:54 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c433e880-7af6-464e-8617-b048bf22c0e4
2025-01-06 12:38:54 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390) last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:54 | DEBUG    | agents.story_graph:_process_rules:135 - Rules processing completed for section 1
2025-01-06 12:38:54 | DEBUG    | agents.story_graph:_process_rules:137 - Output narrative content after rules: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:38:54 | DEBUG    | agents.story_graph:_process_rules:139 - rules_agent returned: {'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062))}
2025-01-06 12:38:54 | INFO     | agents.story_graph:_process_narrative:157 - Processing narrative for section 1
2025-01-06 12:38:54 | DEBUG    | agents.story_graph:_process_narrative:158 - Input narrative content before processing: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:38:54 | DEBUG    | agents.story_graph:_process_narrative:165 - Input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.

Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.

La préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »

Puis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.

Le générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.

Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.

Des heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.

Allez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?
2025-01-06 12:38:54 | DEBUG    | agents.narrator_agent:ainvoke:201 - Processing narrative for state: session=c433e880-7af6-464e-8617-b048bf22c0e4, section=1
2025-01-06 12:38:54 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2025-01-06 12:38:54 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:get_cached_data:184 - Getting data for key section_1 in namespace sections
2025-01-06 12:38:54 | DEBUG    | managers.cache_manager:get_cached_data:203 - Found in memory cache
2025-01-06 12:38:54 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2025-01-06 12:38:54 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2025-01-06 12:38:54 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2025-01-06 12:38:54 | DEBUG    | agents.narrator_agent:_process_section:54 - Cached narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | agents.story_graph:_process_narrative:178 - Received narrative content from agent: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c433e880-7af6-464e-8617-b048bf22c0e4
2025-01-06 12:38:54 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 54, 789612), last_update=datetime.datetime(2025, 1, 6, 12, 38, 54, 789647)), 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 54, 789612), last_update=datetime.datetime(2025, 1, 6, 12, 38, 54, 789647)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:54 | DEBUG    | agents.story_graph:_process_narrative:181 - Updated game state narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:54 | DEBUG    | agents.story_graph:_process_narrative:183 - Narrative processing completed for section 1
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:54 | INFO     | agents.story_graph:_process_decision:200 - Processing decision for section 1
2025-01-06 12:38:54 | DEBUG    | agents.story_graph:_process_decision:216 - Processing user input: Engager la procédure d'évasion
2025-01-06 12:38:54 | DEBUG    | agents.decision_agent:ainvoke:177 - Full state in decision: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': None, 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:54 | INFO     | agents.decision_agent:ainvoke:178 - Starting decision processing: session=c433e880-7af6-464e-8617-b048bf22c0e4, game=c998fca3-a135-4250-961b-67d4252c04c2, section=1, input=Engager la procédure d'évasion
2025-01-06 12:38:54 | INFO     | agents.decision_agent:_process_decision:103 - Processing decision for section 1 with input: Engager la procédure d'évasion
2025-01-06 12:38:54 | DEBUG    | agents.decision_agent:_process_decision:115 - Rules state: needs_dice=False, next_action=NextActionType.USER_FIRST
2025-01-06 12:38:54 | INFO     | agents.decision_agent:_process_decision:146 - Analyzing user response
2025-01-06 12:38:56 | INFO     | agents.decision_agent:_process_decision:153 - Analysis complete: current_section=1, next_section=48
2025-01-06 12:38:56 | INFO     | agents.decision_agent:ainvoke:197 - Decision processed successfully: next_section=48
2025-01-06 12:38:56 | INFO     | agents.story_graph:_process_decision:236 - Decision processed: current_section=1, next_section=48
2025-01-06 12:38:56 | DEBUG    | models.game_state:with_updates:262 - Creating new state with updates for session_id=c433e880-7af6-464e-8617-b048bf22c0e4
2025-01-06 12:38:56 | DEBUG    | models.game_state:with_updates:263 - Creating new state with updates for section_number=1
2025-01-06 12:38:56 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}, 'rules': {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}, 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 38, 56, 183997), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:56 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field narrative: {'section_number': 1, 'content': "Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", 'source_type': <SourceType.RAW: 'raw'>, 'error': None, 'timestamp': datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), 'last_update': datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)}
2025-01-06 12:38:56 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted narrative to model: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390) last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)
2025-01-06 12:38:56 | DEBUG    | models.game_state:handle_langgraph_lists:142 - Found dict for field rules: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': False, 'needs_user_response': True, 'next_action': <NextActionType.USER_FIRST: 'user_first'>, 'conditions': [], 'choices': [{'text': "Engager la procédure d'évasion", 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 48, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}, {'text': 'Continuer votre route', 'type': <ChoiceType.DIRECT: 'direct'>, 'target_section': 398, 'conditions': [], 'dice_type': <DiceType.NONE: 'none'>, 'dice_results': {}}], 'rules_summary': "Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", 'error': None, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>, 'last_update': datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)}
2025-01-06 12:38:56 | DEBUG    | models.game_state:handle_langgraph_lists:147 - Converted rules to model: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=False needs_user_response=True next_action=<NextActionType.USER_FIRST: 'user_first'> conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)
2025-01-06 12:38:56 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 38, 56, 183997), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:56 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:56 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 38, 56, 183997), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:56 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 38, 56, 183997), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:56 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=1, narrative=1, rules=1
2025-01-06 12:38:56 | INFO     | managers.workflow_manager:end_workflow:156 - Ending workflow with output: session=c433e880-7af6-464e-8617-b048bf22c0e4, game=c998fca3-a135-4250-961b-67d4252c04c2, section=1
2025-01-06 12:38:56 | DEBUG    | managers.workflow_manager:end_workflow:162 - Saving final state
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata={'node': 'start'} narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)) decision=DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 38, 56, 183997), next_action=None) trace=None character=None error=None section_number=1 player_input="Engager la procédure d'évasion"
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:_validate_format:136 - Checking narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_current in namespace state
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:56 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_current
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_section_1 in namespace state
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_1.json
2025-01-06 12:38:56 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_section_1
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vai...
2025-01-06 12:38:56 | INFO     | managers.workflow_manager:end_workflow:165 - Workflow ended successfully
2025-01-06 12:38:56 | INFO     | managers.agent_manager:process_game_state:302 - Analyzing result: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'metadata': {'node': 'start'}, 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché, de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement, et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées, car seul compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2025, 1, 6, 12, 38, 52, 401390), last_update=datetime.datetime(2025, 1, 6, 12, 38, 52, 401421)), 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=True, next_action=<NextActionType.USER_FIRST: 'user_first'>, conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2025, 1, 2, 17, 25, 55, 262062)), 'decision': DecisionModel(section_number=1, next_section=48, error=None, awaiting_action=<ActionType.USER_INPUT: 'user_input'>, conditions=[], timestamp=datetime.datetime(2025, 1, 6, 12, 38, 56, 183997), next_action=None), 'trace': None, 'character': None, 'error': None, 'section_number': 1, 'player_input': "Engager la procédure d'évasion"}
2025-01-06 12:38:56 | INFO     | managers.agent_manager:process_game_state:308 - Moving to next section: current=1 -> next=48
2025-01-06 12:38:56 | DEBUG    | models.game_state:handle_langgraph_lists:128 - Processing LangGraph lists. Initial values: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'section_number': 48, 'player_input': None}
2025-01-06 12:38:56 | DEBUG    | models.game_state:handle_langgraph_lists:178 - Final values after list processing: {'session_id': 'c433e880-7af6-464e-8617-b048bf22c0e4', 'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'section_number': 48, 'player_input': None}
2025-01-06 12:38:56 | DEBUG    | models.game_state:validate_state:184 - Validating final state. section_number=48, narrative=None, rules=None
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=48 player_input=None
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_current in namespace state
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:38:56 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_current
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_section_48 in namespace state
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:38:56 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_48.json
2025-01-06 12:38:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_48.json
2025-01-06 12:38:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_48.json
2025-01-06 12:38:56 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_section_48
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:38:56 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:38:56 | INFO     | managers.agent_manager:process_game_state:318 - Created new state for next section
2025-01-06 12:38:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:143 - Broadcasting new state after choice
2025-01-06 12:41:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:41:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:41:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:41:34 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:41:34 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:41:34 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:41:34 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:41:34 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:41:34 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:41:34 | DEBUG    | managers.agent_manager:get_state:111 - Current state: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=48 player_input=None
2025-01-06 12:41:34 | DEBUG    | managers.state_manager:save_state:333 - Saving state, input narrative content: None
2025-01-06 12:41:34 | DEBUG    | managers.state_manager:validate_state:167 - Validating state data: session_id='c433e880-7af6-464e-8617-b048bf22c0e4' game_id='c998fca3-a135-4250-961b-67d4252c04c2' metadata=None narrative=None rules=None decision=None trace=None character=None error=None section_number=48 player_input=None
2025-01-06 12:41:34 | DEBUG    | managers.state_manager:validate_state:170 - Input is GameState, narrative content: None
2025-01-06 12:41:34 | DEBUG    | managers.state_manager:_validate_format:122 - Validating format for state, narrative content: None
2025-01-06 12:41:34 | DEBUG    | managers.state_manager:_validate_format:143 - Format validation successful, narrative content: None
2025-01-06 12:41:34 | DEBUG    | managers.state_manager:save_state:341 - State validated, narrative content: None
2025-01-06 12:41:34 | DEBUG    | managers.state_manager:save_state:346 - State serialized, narrative content in json: None
2025-01-06 12:41:34 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_current in namespace state
2025-01-06 12:41:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:41:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:41:34 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:41:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:41:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_current.json
2025-01-06 12:41:35 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_current
2025-01-06 12:41:35 | DEBUG    | managers.state_manager:save_state:355 - Current state saved to cache
2025-01-06 12:41:35 | DEBUG    | managers.cache_manager:save_cached_data:151 - Saving data for key game_c998fca3-a135-4250-961b-67d4252c04c2_section_48 in namespace state
2025-01-06 12:41:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Serializing data for storage
2025-01-06 12:41:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2025-01-06 12:41:35 | DEBUG    | managers.cache_manager:save_cached_data:173 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_48.json
2025-01-06 12:41:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_48.json
2025-01-06 12:41:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c998fca3-a135-4250-961b-67d4252c04c2\states\game_c998fca3-a135-4250-961b-67d4252c04c2_section_48.json
2025-01-06 12:41:35 | INFO     | managers.cache_manager:save_cached_data:175 - Successfully saved data for state/game_c998fca3-a135-4250-961b-67d4252c04c2_section_48
2025-01-06 12:41:35 | DEBUG    | managers.state_manager:save_state:363 - Section state saved to cache
2025-01-06 12:41:35 | DEBUG    | managers.state_manager:save_state:366 - Current state updated, final narrative content: None
2025-01-06 12:41:35 | INFO     | managers.agent_manager:stop_game:435 - Final game state saved successfully
2025-01-06 12:41:35 | INFO     | managers.agent_manager:stop_game:437 - Game stopped successfully
2025-01-06 12:41:35 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:41:38 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:41:45 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:41:45 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:41:45 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:41:45 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:41:45 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:41:45 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:41:45 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:41:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:41:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:41:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:41:45 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:41:45 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:41:45 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:41:45 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:41:45 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:41:45 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:41:45 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:41:45 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:41:45 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:41:45 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:41:45 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:41:45 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:41:45 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:41:45 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
2025-01-06 12:41:46 | DEBUG    | managers.dependencies:get_agent_manager:72 - Initializing AgentManager with components
2025-01-06 12:41:46 | INFO     | managers.agent_manager:__init__:85 - Initializing AgentManager
2025-01-06 12:41:46 | INFO     | managers.agent_manager:__init__:97 - AgentManager initialization completed
2025-01-06 12:41:46 | INFO     | managers.dependencies:get_agent_manager:79 - AgentManager initialized successfully
2025-01-06 12:41:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:41:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:41:46 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:41:46 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:41:47 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:41:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:70 - New WebSocket connection attempt
2025-01-06 12:41:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:78 - WebSocket connection established
2025-01-06 12:41:47 | DEBUG    | managers.agent_manager:get_state:109 - Fetching current game state
2025-01-06 12:41:47 | DEBUG    | managers.agent_manager:get_state:111 - Current state: None
2025-01-06 12:42:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:120 - Processing user choice
2025-01-06 12:42:11 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:123 - Received choice data: {'type': 'choice', 'choice': {'game_id': 'c998fca3-a135-4250-961b-67d4252c04c2', 'choice_id': '48', 'choice_text': "Engager la procédure d'évasion", 'metadata': {'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}}}
2025-01-06 12:42:11 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:136 - Processing choice: game_id='c998fca3-a135-4250-961b-67d4252c04c2' choice_id='48' choice_text="Engager la procédure d'évasion" metadata={'type': 'direct', 'target_section': 48, 'conditions': [], 'dice_type': 'none', 'dice_results': {}}
2025-01-06 12:42:11 | INFO     | managers.agent_manager:process_game_state:253 - Starting game state processing
2025-01-06 12:42:11 | ERROR    | managers.agent_manager:process_game_state:256 - Story graph not initialized
2025-01-06 12:42:11 | ERROR    | managers.agent_manager:process_game_state:336 - Error processing game state: Story graph not initialized
2025-01-06 12:42:11 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:150 - Error processing choice: Failed to process game state: Story graph not initialized
2025-01-06 12:42:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:42:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:42:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:158 - WebSocket disconnected
2025-01-06 12:42:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:172 - WebSocket connection closed
2025-01-06 12:42:24 | INFO     | api.app:lifespan:75 - Shutting down...
2025-01-06 12:42:24 | DEBUG    | managers.dependencies:get_agent_manager:81 - Returning existing AgentManager instance
2025-01-06 12:42:24 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2025-01-06 12:42:24 | INFO     | managers.agent_manager:stop_game:423 - Stopping game...
2025-01-06 12:42:24 | DEBUG    | managers.agent_manager:stop_game:428 - No game ID set, nothing to save
2025-01-06 12:42:24 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2025-01-06 12:42:25 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:42:28 | INFO     | config.logging_config:setup_logging:31 - Configuring logging with level: DEBUG
2025-01-06 12:42:28 | SUCCESS  | config.logging_config:setup_logging:63 - Logging configured successfully
2025-01-06 12:42:28 | INFO     | api.app:lifespan:72 - Starting up...
2025-01-06 12:42:29 | INFO     | managers.dependencies:get_agent_manager:57 - Creating new AgentManager instance
2025-01-06 12:42:29 | DEBUG    | managers.dependencies:get_agent_manager:59 - Creating new GameFactory instance
2025-01-06 12:42:29 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2025-01-06 12:42:29 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:42:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2025-01-06 12:42:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2025-01-06 12:42:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2025-01-06 12:42:29 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2025-01-06 12:42:29 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:42:29 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2025-01-06 12:42:29 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2025-01-06 12:42:29 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2025-01-06 12:42:29 | DEBUG    | managers.dependencies:get_agent_manager:64 - Creating game components
2025-01-06 12:42:29 | INFO     | managers.state_manager:__init__:45 - Initializing StateManager
2025-01-06 12:42:29 | DEBUG    | managers.state_manager:__init__:51 - StateManager initialized with config: base_path=WindowsPath('data') encoding='utf-8' max_cache_size=1000 game_id=None manager_id='' persistence_enabled=True debug=False cache_enabled=True options={} namespaces={'state': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/states'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=3600, cache_enabled=True, per_game=True), 'trace': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/traces'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'characters': NamespaceConfig(path=WindowsPath('cache/games/{game_id}/characters'), format=<StorageFormat.JSON: 'json'>, ttl_seconds=None, cache_enabled=True, per_game=True), 'raw_content': NamespaceConfig(path=WindowsPath('sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=False, per_game=False), 'rules': NamespaceConfig(path=WindowsPath('cache/rules'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False), 'sections': NamespaceConfig(path=WindowsPath('cache/sections'), format=<StorageFormat.MARKDOWN: 'markdown'>, ttl_seconds=None, cache_enabled=True, per_game=False)}
2025-01-06 12:42:29 | INFO     | managers.rules_manager:__init__:30 - Initializing RulesManager
2025-01-06 12:42:29 | DEBUG    | managers.rules_manager:__init__:34 - RulesManager initialized with config: StorageConfig
2025-01-06 12:42:29 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2025-01-06 12:42:29 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2025-01-06 12:42:29 | INFO     | managers.workflow_manager:__init__:33 - Initializing WorkflowManager
2025-01-06 12:42:29 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager
