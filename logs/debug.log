2024-12-29 16:51:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 16:51:25 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-29 16:51:25 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-29 16:51:25 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-29 16:51:25 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-29 16:51:25 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-29 16:51:25 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-29 16:51:25 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-29 16:51:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 16:51:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 16:51:27 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 16:52:05 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 16:52:05 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 16:52:05 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 16:52:05 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 16:52:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 16:52:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 16:52:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 16:52:05 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 16:52:05 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 16:52:05 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 16:52:05 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 16:52:05 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 16:52:05 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 16:52:05 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 16:52:05 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 16:52:05 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 16:52:05 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 16:52:05 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 16:52:05 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 16:52:05 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 16:52:07 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 16:52:07 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 16:52:07 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 16:52:07 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 16:52:07 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 16:52:07 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 16:52:07 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-29 16:52:07 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-29 16:52:07 | INFO     | agents.story_graph:_setup_workflow:67 - Setting up LangGraph workflow with parallel processing
2024-12-29 16:52:07 | SUCCESS  | agents.story_graph:_setup_workflow:92 - Workflow setup completed
2024-12-29 16:52:07 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-29 16:52:07 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 6ad21134-3127-484c-afb4-2c94a160218e
2024-12-29 16:52:07 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 6ad21134-3127-484c-afb4-2c94a160218e
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\traces
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\characters
2024-12-29 16:52:07 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 6ad21134-3127-484c-afb4-2c94a160218e
2024-12-29 16:52:07 | INFO     | managers.state_manager:create_initial_state:346 - Creating initial state with session_id: 84fbc3f7-f1f7-4935-8c10-4d390315dd1d
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\characters\current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\characters\current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\characters\current.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 16:52:07 | DEBUG    | managers.state_manager:create_initial_state:373 - Parameters for initial GameState: {'section_number': 1, 'session_id': '84fbc3f7-f1f7-4935-8c10-4d390315dd1d', 'game_id': '6ad21134-3127-484c-afb4-2c94a160218e', 'last_update': '2024-12-29T16:52:07.161048', 'character_id': 'current'}
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_current in namespace state
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_current
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_section_1 in namespace state
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_section_1
2024-12-29 16:52:07 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 16:52:07 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 16:52:07 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 16:52:07 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 16:52:07 | INFO     | managers.state_manager:create_initial_state:346 - Creating initial state with session_id: 59e368ae-91fd-4a93-b99b-f426e23fd83f
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\characters\current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\characters\current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\characters\current.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 16:52:07 | DEBUG    | managers.state_manager:create_initial_state:373 - Parameters for initial GameState: {'section_number': 1, 'session_id': '59e368ae-91fd-4a93-b99b-f426e23fd83f', 'game_id': '6ad21134-3127-484c-afb4-2c94a160218e', 'last_update': '2024-12-29T16:52:07.210195', 'character_id': 'current'}
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_current in namespace state
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_current
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_section_1 in namespace state
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_section_1
2024-12-29 16:52:07 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 59e368ae-91fd-4a93-b99b-f426e23fd83f and game_id: 6ad21134-3127-484c-afb4-2c94a160218e
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_current in namespace state
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_current
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_section_1 in namespace state
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_section_1
2024-12-29 16:52:07 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 59e368ae-91fd-4a93-b99b-f426e23fd83f and section_number: 1
2024-12-29 16:52:07 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 16:52:07 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 16:52:07 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 16:52:07 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 16:52:07 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 16:52:07 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 16:52:07 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 16:52:07 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 16:52:07 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 16:52:07 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 16:52:07 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 16:52:07 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 16:52:07 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 16:52:07 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 16:52:07 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-29 16:52:07 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 16:52:07 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 16:52:07 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 16:52:07 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 16:52:07 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 16:52:07 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 16:52:07 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 16:52:07 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_current in namespace state
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_current
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_section_1 in namespace state
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_section_1
2024-12-29 16:52:07 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_current in namespace state
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_current
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_section_1 in namespace state
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 16:52:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 16:52:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_section_1
2024-12-29 16:52:07 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 17:00:58 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 17:00:58 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 17:00:58 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 17:00:58 | INFO     | managers.agent_manager:stop_game:382 - Stopping game...
2024-12-29 17:00:58 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 17:00:58 | DEBUG    | managers.state_manager:get_current_state:267 - Getting current state
2024-12-29 17:00:58 | DEBUG    | managers.state_manager:get_current_state:271 - Returning current state from memory
2024-12-29 17:00:58 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='84fbc3f7-f1f7-4935-8c10-4d390315dd1d' game_id='6ad21134-3127-484c-afb4-2c94a160218e' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 16, 52, 7, 355898), last_update=datetime.datetime(2024, 12, 29, 16, 52, 7, 355954)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 17:00:58 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_current in namespace state
2024-12-29 17:00:58 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 17:00:58 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 17:00:58 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 17:00:58 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 17:00:58 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_current.json
2024-12-29 17:00:58 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_current
2024-12-29 17:00:58 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_6ad21134-3127-484c-afb4-2c94a160218e_section_1 in namespace state
2024-12-29 17:00:58 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 17:00:58 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 17:00:58 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 17:00:58 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 17:00:58 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6ad21134-3127-484c-afb4-2c94a160218e\states\game_6ad21134-3127-484c-afb4-2c94a160218e_section_1.json
2024-12-29 17:00:58 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_6ad21134-3127-484c-afb4-2c94a160218e_section_1
2024-12-29 17:00:58 | INFO     | managers.agent_manager:stop_game:394 - Final game state saved successfully
2024-12-29 17:00:58 | INFO     | managers.agent_manager:stop_game:396 - Game stopped successfully
2024-12-29 17:00:58 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 17:01:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 17:01:12 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-29 17:01:12 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-29 17:01:12 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-29 17:01:12 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-29 17:01:12 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-29 17:01:12 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-29 17:01:12 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-29 17:01:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 17:01:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 17:01:14 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 17:46:19 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 17:46:19 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 17:46:19 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 17:46:19 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 17:46:19 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 17:46:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 17:46:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 17:46:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 17:46:19 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 17:46:19 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 17:46:19 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 17:46:19 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 17:46:19 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 17:46:19 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 17:46:19 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 17:46:19 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 17:46:19 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 17:46:19 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 17:46:19 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 17:46:19 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 17:46:19 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 17:46:20 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 17:46:20 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 17:46:20 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 17:46:20 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 17:46:20 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 17:46:20 | INFO     | managers.agent_manager:stop_game:382 - Stopping game...
2024-12-29 17:46:20 | DEBUG    | managers.agent_manager:stop_game:387 - No game ID set, nothing to save
2024-12-29 17:46:20 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 17:46:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 17:50:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 17:58:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 17:59:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 17:59:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 17:59:18 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 17:59:27 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 17:59:27 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 17:59:27 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 17:59:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 17:59:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 17:59:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 17:59:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 17:59:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 17:59:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 17:59:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 17:59:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 17:59:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 17:59:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 17:59:27 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 17:59:27 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 17:59:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 17:59:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 17:59:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 17:59:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 17:59:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 17:59:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 17:59:27 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 17:59:27 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 17:59:27 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 17:59:27 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 17:59:27 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 17:59:27 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-29 17:59:27 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-29 17:59:27 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 17:59:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 17:59:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 17:59:31 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 18:01:02 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 18:01:02 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 18:01:02 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 18:01:02 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 18:01:02 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:01:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 18:01:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 18:01:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 18:01:02 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 18:01:02 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:01:02 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 18:01:02 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 18:01:02 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:01:02 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 18:01:02 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 18:01:02 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 18:01:02 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 18:01:02 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 18:01:02 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 18:01:02 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 18:01:02 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 18:01:04 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 18:01:04 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 18:01:04 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 18:01:04 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 18:01:04 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 18:01:04 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-29 18:01:04 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-29 18:01:04 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 18:01:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:01:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:01:12 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 18:01:30 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 18:01:30 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 18:01:30 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 18:01:30 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 18:01:30 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:01:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 18:01:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 18:01:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 18:01:30 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 18:01:30 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:01:30 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 18:01:30 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 18:01:30 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:01:30 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 18:01:30 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 18:01:30 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 18:01:30 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 18:01:30 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 18:01:30 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 18:01:30 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 18:01:30 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 18:01:32 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 18:01:32 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 18:01:32 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 18:01:32 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 18:01:32 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 18:01:32 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-29 18:01:32 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-29 18:01:32 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 18:01:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:01:43 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-29 18:01:43 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-29 18:01:43 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-29 18:01:43 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-29 18:01:43 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-29 18:01:43 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-29 18:01:43 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-29 18:01:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:01:45 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:01:45 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 18:04:06 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 18:04:06 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 18:04:06 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 18:04:06 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 18:04:06 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:04:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 18:04:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 18:04:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 18:04:06 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 18:04:06 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:04:06 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 18:04:06 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 18:04:06 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:04:06 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 18:04:06 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 18:04:06 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 18:04:06 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 18:04:06 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 18:04:06 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 18:04:06 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 18:04:06 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 18:04:07 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 18:04:07 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 18:04:07 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 18:04:07 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 18:04:07 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 18:04:07 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-29 18:04:07 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-29 18:04:07 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 18:04:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:04:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:04:13 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 18:04:19 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 18:04:19 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 18:04:19 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 18:04:19 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 18:04:19 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:04:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 18:04:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 18:04:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 18:04:19 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 18:04:19 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:04:19 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 18:04:19 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 18:04:19 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:04:19 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 18:04:19 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 18:04:19 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 18:04:19 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 18:04:19 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 18:04:19 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 18:04:19 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 18:04:19 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 18:04:20 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 18:04:20 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 18:04:20 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 18:04:20 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 18:04:20 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 18:04:20 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-29 18:04:20 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-29 18:04:20 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 18:04:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:04:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:04:24 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 18:06:44 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 18:06:44 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 18:06:44 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 18:06:44 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 18:06:44 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:06:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 18:06:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 18:06:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 18:06:44 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 18:06:44 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:06:44 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 18:06:44 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 18:06:44 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:06:44 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 18:06:44 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 18:06:44 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 18:06:44 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 18:06:44 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 18:06:44 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 18:06:44 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 18:06:44 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 18:06:45 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 18:06:45 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 18:06:45 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 18:06:45 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 18:06:45 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 18:06:45 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-29 18:06:45 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-29 18:06:45 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 18:06:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:06:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:06:51 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 18:06:59 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 18:06:59 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 18:06:59 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 18:06:59 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 18:06:59 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:06:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 18:06:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 18:06:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 18:06:59 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 18:06:59 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:06:59 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 18:06:59 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 18:06:59 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:06:59 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 18:06:59 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 18:06:59 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 18:06:59 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 18:06:59 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 18:06:59 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 18:06:59 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 18:06:59 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 18:07:00 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 18:07:00 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 18:07:00 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 18:07:00 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 18:07:00 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 18:07:00 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-29 18:07:00 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-29 18:07:00 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 18:07:03 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:07:05 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-29 18:07:05 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-29 18:07:05 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-29 18:07:05 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-29 18:07:05 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-29 18:07:05 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-29 18:07:05 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-29 18:07:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:07:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:07:07 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 18:08:02 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 18:08:02 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 18:08:02 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 18:08:02 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 18:08:02 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:08:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 18:08:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 18:08:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 18:08:02 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 18:08:02 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:08:02 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 18:08:02 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 18:08:02 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:08:02 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 18:08:02 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 18:08:02 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 18:08:02 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 18:08:02 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 18:08:02 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 18:08:02 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 18:08:02 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 18:08:03 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 18:08:03 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 18:08:03 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 18:08:03 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 18:08:03 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 18:08:03 | INFO     | managers.agent_manager:stop_game:328 - Stopping game...
2024-12-29 18:08:03 | DEBUG    | managers.agent_manager:stop_game:333 - No game ID set, nothing to save
2024-12-29 18:08:03 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 18:08:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:08:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 18:08:09 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 18:08:15 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 18:08:15 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 18:08:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 18:08:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:08:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 18:08:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 18:08:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 18:08:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 18:08:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:08:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 18:08:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 18:08:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 18:08:15 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 18:08:15 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 18:08:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 18:08:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 18:08:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 18:08:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 18:08:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 18:08:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 18:08:16 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 18:08:16 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 18:08:16 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 18:08:16 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 18:08:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 18:08:16 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 18:08:16 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 18:08:16 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-29 18:08:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:108 - Processing user choice
2024-12-29 18:08:46 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:111 - Received choice data: {'type': 'choice', 'choice': "Engager la procédure d'évasion"}
2024-12-29 18:08:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:116 - Processing choice: Engager la procédure d'évasion
2024-12-29 18:08:46 | INFO     | managers.agent_manager:process_game_state:153 - Starting game state processing
2024-12-29 18:08:46 | DEBUG    | managers.agent_manager:process_game_state:154 - Input state: None, User input: Engager la procédure d'évasion
2024-12-29 18:08:46 | ERROR    | managers.agent_manager:process_game_state:157 - Story graph not initialized
2024-12-29 18:08:46 | ERROR    | managers.agent_manager:process_game_state:186 - Error processing game state: Story graph not initialized
2024-12-29 18:08:46 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:130 - Error processing choice: Story graph not initialized
2024-12-29 18:08:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 18:08:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 18:09:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 18:09:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 18:09:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 18:09:00 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 18:09:00 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-29 21:08:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 21:08:38 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-29 21:08:38 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-29 21:08:38 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-29 21:08:38 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-29 21:08:38 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-29 21:08:38 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-29 21:08:38 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-29 21:08:38 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 21:08:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 21:08:40 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 21:08:57 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 21:08:57 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 21:08:57 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 21:08:57 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 21:08:57 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 21:08:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 21:08:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 21:08:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 21:08:57 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 21:08:57 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 21:08:57 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 21:08:57 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 21:08:57 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 21:08:57 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 21:08:57 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 21:08:57 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 21:08:57 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 21:08:57 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 21:08:57 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 21:08:57 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 21:08:57 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 21:08:58 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 21:08:58 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 21:08:58 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 21:08:58 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 21:08:58 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 21:08:58 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 21:08:58 | DEBUG    | managers.agent_manager:stop_game:328 - No game ID set, nothing to save
2024-12-29 21:08:58 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 21:08:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 21:09:03 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 21:09:03 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 21:09:31 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 21:09:31 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 21:09:31 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 21:09:31 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 21:09:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 21:09:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 21:09:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 21:09:31 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 21:09:31 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 21:09:31 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 21:09:31 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 21:09:31 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 21:09:31 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 21:09:31 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 21:09:31 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 21:09:31 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 21:09:31 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 21:09:31 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 21:09:31 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 21:09:31 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 21:09:32 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 21:09:32 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 21:09:32 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 21:09:32 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 21:09:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 21:09:32 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 21:09:32 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 21:09:32 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-29 21:09:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 21:09:57 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 21:09:59 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 21:09:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 21:09:59 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 21:09:59 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 21:09:59 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-29 21:10:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 21:10:00 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 21:10:01 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 21:10:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 21:10:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 21:10:01 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 21:10:01 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-29 21:10:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 21:10:18 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 21:10:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 21:10:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 21:10:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 21:10:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 21:10:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: None
2024-12-29 21:10:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 21:10:31 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 22:12:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:12:59 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-29 22:12:59 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-29 22:12:59 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-29 22:12:59 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-29 22:12:59 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-29 22:12:59 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-29 22:12:59 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-29 22:12:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:13:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:13:01 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 22:15:22 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 22:15:22 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 22:15:22 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 22:15:22 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 22:15:22 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:15:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 22:15:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 22:15:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 22:15:22 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 22:15:22 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:15:22 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 22:15:22 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 22:15:22 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:15:22 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 22:15:22 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 22:15:22 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 22:15:22 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 22:15:22 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 22:15:22 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 22:15:22 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 22:15:22 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 22:15:24 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 22:15:24 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 22:15:24 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 22:15:24 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 22:15:24 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 22:15:24 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 22:15:24 | DEBUG    | managers.agent_manager:stop_game:328 - No game ID set, nothing to save
2024-12-29 22:15:24 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 22:15:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:15:29 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:15:29 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 22:18:48 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 22:18:48 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 22:18:48 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 22:18:48 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:18:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 22:18:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 22:18:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 22:18:48 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 22:18:48 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:18:48 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 22:18:48 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 22:18:48 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:18:48 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 22:18:48 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 22:18:48 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 22:18:48 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 22:18:48 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 22:18:48 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 22:18:48 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 22:18:48 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 22:18:48 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 22:18:48 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 22:18:48 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 22:18:48 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 22:18:48 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 22:18:48 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 22:18:48 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-29 22:18:48 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-29 22:18:48 | INFO     | agents.story_graph:_setup_workflow:67 - Setting up LangGraph workflow with parallel processing
2024-12-29 22:18:48 | SUCCESS  | agents.story_graph:_setup_workflow:92 - Workflow setup completed
2024-12-29 22:18:48 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-29 22:18:48 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: bd6b5160-eaef-4c78-a020-41a8c80d2a24
2024-12-29 22:18:48 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: bd6b5160-eaef-4c78-a020-41a8c80d2a24
2024-12-29 22:18:48 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states
2024-12-29 22:18:48 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\traces
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\characters
2024-12-29 22:18:49 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: bd6b5160-eaef-4c78-a020-41a8c80d2a24
2024-12-29 22:18:49 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 75f78a43-d045-4cb8-b02e-e0ec3a851e42
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\characters\current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\characters\current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\characters\current.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:18:49 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '75f78a43-d045-4cb8-b02e-e0ec3a851e42', 'game_id': 'bd6b5160-eaef-4c78-a020-41a8c80d2a24', 'last_update': '2024-12-29T22:18:49.025287', 'character_id': 'current'}
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current in namespace state
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1 in namespace state
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1
2024-12-29 22:18:49 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 22:18:49 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:18:49 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 22:18:49 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 22:18:49 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 2ec51645-29de-460f-b8d7-589ebd7982d4
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\characters\current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\characters\current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\characters\current.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:18:49 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '2ec51645-29de-460f-b8d7-589ebd7982d4', 'game_id': 'bd6b5160-eaef-4c78-a020-41a8c80d2a24', 'last_update': '2024-12-29T22:18:49.083690', 'character_id': 'current'}
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current in namespace state
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1 in namespace state
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1
2024-12-29 22:18:49 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 2ec51645-29de-460f-b8d7-589ebd7982d4 and game_id: bd6b5160-eaef-4c78-a020-41a8c80d2a24
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current in namespace state
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1 in namespace state
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1
2024-12-29 22:18:49 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 2ec51645-29de-460f-b8d7-589ebd7982d4 and section_number: 1
2024-12-29 22:18:49 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 22:18:49 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 22:18:49 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 22:18:49 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 22:18:49 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 22:18:49 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 22:18:49 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 22:18:49 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 22:18:49 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 22:18:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 22:18:49 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 22:18:49 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 22:18:49 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 22:18:49 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 22:18:49 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-29 22:18:49 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 22:18:49 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 22:18:49 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 22:18:49 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 22:18:49 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 22:18:49 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 22:18:49 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 22:18:49 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 22:18:49 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current in namespace state
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1 in namespace state
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1
2024-12-29 22:18:49 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current in namespace state
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1 in namespace state
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:18:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:18:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1
2024-12-29 22:18:49 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 22:20:06 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 22:20:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:20:06 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 22:20:06 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 22:20:06 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 22:20:06 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='75f78a43-d045-4cb8-b02e-e0ec3a851e42' game_id='bd6b5160-eaef-4c78-a020-41a8c80d2a24' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 22, 18, 49, 143755), last_update=datetime.datetime(2024, 12, 29, 22, 18, 49, 143771)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:20:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current in namespace state
2024-12-29 22:20:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:20:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:20:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current.json
2024-12-29 22:20:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_current
2024-12-29 22:20:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1 in namespace state
2024-12-29 22:20:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:20:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:20:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bd6b5160-eaef-4c78-a020-41a8c80d2a24\states\game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1.json
2024-12-29 22:20:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bd6b5160-eaef-4c78-a020-41a8c80d2a24_section_1
2024-12-29 22:20:06 | INFO     | managers.agent_manager:stop_game:335 - Final game state saved successfully
2024-12-29 22:20:06 | INFO     | managers.agent_manager:stop_game:337 - Game stopped successfully
2024-12-29 22:20:06 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 22:20:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:20:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:20:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:20:16 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 22:20:28 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 22:20:28 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 22:20:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 22:20:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:20:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 22:20:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 22:20:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 22:20:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 22:20:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:20:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 22:20:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 22:20:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:20:28 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 22:20:28 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 22:20:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 22:20:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 22:20:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 22:20:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 22:20:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 22:20:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 22:20:29 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 22:20:29 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 22:20:29 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 22:20:29 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 22:20:29 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 22:20:29 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 22:20:29 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-29 22:20:29 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-29 22:20:29 | INFO     | agents.story_graph:_setup_workflow:67 - Setting up LangGraph workflow with parallel processing
2024-12-29 22:20:29 | SUCCESS  | agents.story_graph:_setup_workflow:92 - Workflow setup completed
2024-12-29 22:20:29 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-29 22:20:29 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: b524319d-8402-4f84-a646-9434df387eaf
2024-12-29 22:20:29 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: b524319d-8402-4f84-a646-9434df387eaf
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\traces
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters
2024-12-29 22:20:29 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: b524319d-8402-4f84-a646-9434df387eaf
2024-12-29 22:20:29 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 132f19ea-c94c-4982-af29-0c79fc309e3f
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:20:29 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '132f19ea-c94c-4982-af29-0c79fc309e3f', 'game_id': 'b524319d-8402-4f84-a646-9434df387eaf', 'last_update': '2024-12-29T22:20:29.033880', 'character_id': 'current'}
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:20:29 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 22:20:29 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:20:29 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 22:20:29 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 22:20:29 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 7e5aaec0-a716-4833-aa15-bb3edd09884b
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:20:29 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '7e5aaec0-a716-4833-aa15-bb3edd09884b', 'game_id': 'b524319d-8402-4f84-a646-9434df387eaf', 'last_update': '2024-12-29T22:20:29.066288', 'character_id': 'current'}
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:20:29 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 7e5aaec0-a716-4833-aa15-bb3edd09884b and game_id: b524319d-8402-4f84-a646-9434df387eaf
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:20:29 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 7e5aaec0-a716-4833-aa15-bb3edd09884b and section_number: 1
2024-12-29 22:20:29 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 22:20:29 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 22:20:29 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 22:20:29 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 22:20:29 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 22:20:29 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 22:20:29 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 22:20:29 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 22:20:29 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 22:20:29 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 22:20:29 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 22:20:29 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 22:20:29 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 22:20:29 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-29 22:20:29 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 22:20:29 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 22:20:29 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 22:20:29 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 22:20:29 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 22:20:29 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 22:20:29 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 22:20:29 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 22:20:29 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:20:29 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:20:29 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 22:20:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:20:29 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 22:20:29 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 22:20:29 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 2055e3a8-3936-47c3-9802-5115ae970217
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:20:29 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '2055e3a8-3936-47c3-9802-5115ae970217', 'game_id': 'b524319d-8402-4f84-a646-9434df387eaf', 'last_update': '2024-12-29T22:20:29.335917', 'character_id': 'current'}
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:20:29 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 22:20:29 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:20:29 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 22:20:29 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 22:20:29 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 9c006ff9-bf34-4522-b107-03a6e337db68
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:20:29 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '9c006ff9-bf34-4522-b107-03a6e337db68', 'game_id': 'b524319d-8402-4f84-a646-9434df387eaf', 'last_update': '2024-12-29T22:20:29.361308', 'character_id': 'current'}
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:20:29 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 9c006ff9-bf34-4522-b107-03a6e337db68 and game_id: b524319d-8402-4f84-a646-9434df387eaf
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:20:29 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 9c006ff9-bf34-4522-b107-03a6e337db68 and section_number: 1
2024-12-29 22:20:29 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 22:20:29 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 22:20:29 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 22:20:29 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 22:20:29 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 22:20:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 22:20:29 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 22:20:29 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 22:20:29 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 22:20:29 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 22:20:29 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 22:20:29 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 22:20:29 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 22:20:29 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 22:20:29 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:20:29 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 22:20:29 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 22:20:29 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 22:20:29 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 22:20:29 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 22:20:29 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 22:20:29 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 22:20:29 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 22:20:29 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:20:29 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:20:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:20:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:20:29 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 22:21:38 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:21:38 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 22:21:38 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 22:21:38 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 0cb367b8-ed06-4c59-9642-5ae5bf3ef5f4
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:21:38 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '0cb367b8-ed06-4c59-9642-5ae5bf3ef5f4', 'game_id': 'b524319d-8402-4f84-a646-9434df387eaf', 'last_update': '2024-12-29T22:21:38.203952', 'character_id': 'current'}
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:21:38 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 22:21:38 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:21:38 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 22:21:38 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 22:21:38 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: d012ade0-e69c-4cce-afbb-ce5282bdc878
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:21:38 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd012ade0-e69c-4cce-afbb-ce5282bdc878', 'game_id': 'b524319d-8402-4f84-a646-9434df387eaf', 'last_update': '2024-12-29T22:21:38.274405', 'character_id': 'current'}
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:21:38 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: d012ade0-e69c-4cce-afbb-ce5282bdc878 and game_id: b524319d-8402-4f84-a646-9434df387eaf
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:21:38 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: d012ade0-e69c-4cce-afbb-ce5282bdc878 and section_number: 1
2024-12-29 22:21:38 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 22:21:38 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 22:21:38 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 22:21:38 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 22:21:38 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 22:21:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 22:21:38 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 22:21:38 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 22:21:38 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 22:21:38 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 22:21:38 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 22:21:38 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 22:21:38 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 22:21:38 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 22:21:38 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:21:38 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 22:21:38 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 22:21:38 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 22:21:38 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 22:21:38 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 22:21:38 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 22:21:38 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 22:21:38 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 22:21:38 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:21:38 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:21:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:21:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:21:38 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 22:27:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:27:13 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 22:27:13 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 22:27:13 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 1488b4b5-d4f5-4368-9b89-285b897ed1f3
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:27:13 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '1488b4b5-d4f5-4368-9b89-285b897ed1f3', 'game_id': 'b524319d-8402-4f84-a646-9434df387eaf', 'last_update': '2024-12-29T22:27:13.216483', 'character_id': 'current'}
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:27:13 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 22:27:13 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:27:13 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 22:27:13 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 22:27:13 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 5d197b86-35a1-4056-bdf7-c90b44e68941
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\characters\current.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:27:13 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '5d197b86-35a1-4056-bdf7-c90b44e68941', 'game_id': 'b524319d-8402-4f84-a646-9434df387eaf', 'last_update': '2024-12-29T22:27:13.427093', 'character_id': 'current'}
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:27:13 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 5d197b86-35a1-4056-bdf7-c90b44e68941 and game_id: b524319d-8402-4f84-a646-9434df387eaf
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:27:13 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 5d197b86-35a1-4056-bdf7-c90b44e68941 and section_number: 1
2024-12-29 22:27:13 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 22:27:13 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 22:27:13 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 22:27:13 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 22:27:13 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 22:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 22:27:13 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 22:27:13 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 22:27:13 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 22:27:13 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 22:27:13 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 22:27:13 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 22:27:13 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 22:27:13 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 22:27:13 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:27:13 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 22:27:13 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 22:27:13 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 22:27:13 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 22:27:13 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 22:27:13 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 22:27:13 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 22:27:13 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 22:27:13 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:27:13 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:27:13 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 22:27:13 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:27:13 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 22:27:13 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='1488b4b5-d4f5-4368-9b89-285b897ed1f3' game_id='b524319d-8402-4f84-a646-9434df387eaf' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 22, 27, 13, 493780), last_update=datetime.datetime(2024, 12, 29, 22, 27, 13, 494044)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:27:13 | ERROR    | api.routes.rest.game_route_rest:get_game_state:78 - Failed to get game state: GameResponse.__init__() missing 1 required positional argument: 'success'
2024-12-29 22:28:06 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 22:28:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:28:06 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 22:28:06 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 22:28:06 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 22:28:06 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='1488b4b5-d4f5-4368-9b89-285b897ed1f3' game_id='b524319d-8402-4f84-a646-9434df387eaf' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 22, 27, 13, 493780), last_update=datetime.datetime(2024, 12, 29, 22, 27, 13, 494044)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:28:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_current in namespace state
2024-12-29 22:28:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:28:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:28:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:28:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:28:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_current.json
2024-12-29 22:28:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_current
2024-12-29 22:28:06 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b524319d-8402-4f84-a646-9434df387eaf_section_1 in namespace state
2024-12-29 22:28:06 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:28:06 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:28:06 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:28:06 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:28:06 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b524319d-8402-4f84-a646-9434df387eaf\states\game_b524319d-8402-4f84-a646-9434df387eaf_section_1.json
2024-12-29 22:28:06 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b524319d-8402-4f84-a646-9434df387eaf_section_1
2024-12-29 22:28:06 | INFO     | managers.agent_manager:stop_game:335 - Final game state saved successfully
2024-12-29 22:28:06 | INFO     | managers.agent_manager:stop_game:337 - Game stopped successfully
2024-12-29 22:28:06 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 22:28:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:28:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:28:14 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 22:28:28 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 22:28:28 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 22:28:28 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 22:28:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 22:28:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 22:28:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 22:28:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:28:28 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 22:28:28 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 22:28:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 22:28:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 22:28:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 22:28:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 22:28:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 22:28:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 22:28:30 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 22:28:30 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 22:28:30 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 22:28:30 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 22:28:30 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 22:28:30 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 22:28:30 | DEBUG    | managers.agent_manager:stop_game:328 - No game ID set, nothing to save
2024-12-29 22:28:30 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 22:28:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:28:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:31:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:32:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:33:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:33:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:33:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:33:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:34:08 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:34:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:34:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:35:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:36:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:36:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:38:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:39:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:39:53 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:39:53 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 22:43:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:43:24 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-29 22:43:24 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-29 22:43:24 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-29 22:43:24 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-29 22:43:24 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-29 22:43:24 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-29 22:43:24 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-29 22:43:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:43:26 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:43:26 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 22:44:55 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 22:44:55 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 22:44:55 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 22:44:55 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 22:44:55 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:44:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 22:44:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 22:44:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 22:44:55 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 22:44:55 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:44:55 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 22:44:55 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 22:44:55 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:44:55 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 22:44:55 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 22:44:55 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 22:44:55 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 22:44:55 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 22:44:55 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 22:44:55 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 22:44:55 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 22:44:56 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 22:44:56 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 22:44:56 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 22:44:56 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 22:44:56 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 22:44:56 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 22:44:56 | DEBUG    | managers.agent_manager:stop_game:328 - No game ID set, nothing to save
2024-12-29 22:44:56 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 22:44:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:45:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:45:01 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 22:45:13 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 22:45:13 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 22:45:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 22:45:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:45:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 22:45:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 22:45:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 22:45:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 22:45:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:45:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 22:45:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 22:45:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:45:13 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 22:45:13 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 22:45:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 22:45:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 22:45:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 22:45:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 22:45:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 22:45:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 22:45:14 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 22:45:14 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 22:45:14 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 22:45:14 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 22:47:10 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 22:47:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:47:10 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 22:47:10 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 22:47:10 | DEBUG    | managers.agent_manager:stop_game:328 - No game ID set, nothing to save
2024-12-29 22:47:10 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 22:47:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:47:19 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-29 22:47:19 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-29 22:47:19 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-29 22:47:19 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-29 22:47:19 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-29 22:47:19 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-29 22:47:19 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-29 22:47:19 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:47:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:47:22 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 22:47:30 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 22:47:30 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 22:47:30 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 22:47:30 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:47:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 22:47:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 22:47:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 22:47:30 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 22:47:30 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:47:30 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 22:47:30 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 22:47:30 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:47:30 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 22:47:30 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 22:47:30 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 22:47:30 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 22:47:30 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 22:47:30 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 22:47:30 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 22:47:30 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 22:47:31 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 22:47:31 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 22:47:31 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 22:47:31 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 22:48:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:48:10 | ERROR    | api.routes.rest.game_route_rest:initialize_game:34 - Failed to initialize game: AgentManager.initialize_game() takes 1 positional argument but 2 were given
2024-12-29 22:52:07 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 22:52:07 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:52:07 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 22:52:07 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 22:52:07 | DEBUG    | managers.agent_manager:stop_game:328 - No game ID set, nothing to save
2024-12-29 22:52:07 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 22:52:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:52:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:52:14 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 22:52:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:52:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:52:20 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 22:53:33 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 22:53:33 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 22:53:33 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 22:53:33 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:53:33 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 22:53:33 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 22:53:33 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 22:53:33 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 22:53:33 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:53:33 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 22:53:33 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 22:53:33 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:53:33 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 22:53:33 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 22:53:33 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 22:53:33 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 22:53:33 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 22:53:33 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 22:53:33 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 22:53:33 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 22:53:34 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 22:53:34 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 22:53:34 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 22:53:34 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 22:53:44 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 22:53:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:53:44 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 22:53:44 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 22:53:44 | DEBUG    | managers.agent_manager:stop_game:328 - No game ID set, nothing to save
2024-12-29 22:53:44 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 22:53:45 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:53:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 22:53:48 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 22:54:06 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 22:54:06 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 22:54:06 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 22:54:06 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:54:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 22:54:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 22:54:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 22:54:06 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 22:54:06 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:54:06 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 22:54:06 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 22:54:06 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 22:54:06 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 22:54:06 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 22:54:06 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 22:54:06 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 22:54:06 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 22:54:06 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 22:54:06 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 22:54:06 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 22:54:07 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 22:54:07 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 22:54:07 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 22:54:07 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 22:54:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:54:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:54:35 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:54:35 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 22:54:35 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 22:54:35 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-29 22:54:35 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-29 22:54:35 | INFO     | agents.story_graph:_setup_workflow:67 - Setting up LangGraph workflow with parallel processing
2024-12-29 22:54:35 | SUCCESS  | agents.story_graph:_setup_workflow:92 - Workflow setup completed
2024-12-29 22:54:35 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-29 22:54:35 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 22:54:35 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\traces
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters
2024-12-29 22:54:35 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 22:54:35 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 938fb928-d6b8-4502-a655-8d6404d60f64
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:54:35 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '938fb928-d6b8-4502-a655-8d6404d60f64', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T22:54:35.167649', 'character_id': 'current'}
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:54:35 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 22:54:35 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:54:35 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 22:54:35 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 22:54:35 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8a74d99a-fc1d-44b0-91e7-f39b50a8f314
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:54:35 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8a74d99a-fc1d-44b0-91e7-f39b50a8f314', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T22:54:35.225002', 'character_id': 'current'}
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:54:35 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 8a74d99a-fc1d-44b0-91e7-f39b50a8f314 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:54:35 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 8a74d99a-fc1d-44b0-91e7-f39b50a8f314 and section_number: 1
2024-12-29 22:54:35 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 22:54:35 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 22:54:35 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 22:54:35 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 22:54:35 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 22:54:35 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 22:54:35 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 22:54:35 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 22:54:35 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 22:54:35 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 22:54:35 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 22:54:35 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 22:54:35 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 22:54:35 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 22:54:35 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-29 22:54:35 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 22:54:35 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 22:54:35 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 22:54:35 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 22:54:35 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 22:54:35 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 22:54:35 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 22:54:35 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 22:54:35 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:54:35 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:54:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:54:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:54:35 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 22:54:45 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:57:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:57:03 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 22:57:03 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 22:57:03 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 49f5fec2-398f-40bb-81d4-a11bdb543c78
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:57:03 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '49f5fec2-398f-40bb-81d4-a11bdb543c78', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T22:57:03.196932', 'character_id': 'current'}
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:57:03 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 22:57:03 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:57:03 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 22:57:03 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 22:57:03 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 84c00d3c-e218-4c94-b687-6aae6562ea31
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:57:03 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '84c00d3c-e218-4c94-b687-6aae6562ea31', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T22:57:03.376111', 'character_id': 'current'}
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:57:03 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 84c00d3c-e218-4c94-b687-6aae6562ea31 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:57:03 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 84c00d3c-e218-4c94-b687-6aae6562ea31 and section_number: 1
2024-12-29 22:57:03 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 22:57:03 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 22:57:03 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 22:57:03 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 22:57:03 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 22:57:03 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 22:57:03 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 22:57:03 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 22:57:03 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 22:57:03 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 22:57:03 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 22:57:03 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 22:57:03 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 22:57:03 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:57:03 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 22:57:03 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 22:57:03 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 22:57:03 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 22:57:03 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 22:57:03 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 22:57:03 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 22:57:03 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 22:57:03 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:57:03 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:57:03 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 22:57:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:57:03 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 22:57:03 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 22:57:03 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: d58123ce-faf1-45d7-b8e2-0c6ef3d908bd
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:57:03 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd58123ce-faf1-45d7-b8e2-0c6ef3d908bd', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T22:57:03.669879', 'character_id': 'current'}
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:57:03 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 22:57:03 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:57:03 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 22:57:03 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 22:57:03 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8a3f26f7-b06f-4f70-a421-1ad8f6bce7a7
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:57:03 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8a3f26f7-b06f-4f70-a421-1ad8f6bce7a7', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T22:57:03.699018', 'character_id': 'current'}
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:57:03 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 8a3f26f7-b06f-4f70-a421-1ad8f6bce7a7 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:57:03 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 8a3f26f7-b06f-4f70-a421-1ad8f6bce7a7 and section_number: 1
2024-12-29 22:57:03 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 22:57:03 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 22:57:03 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 22:57:03 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 22:57:03 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 22:57:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 22:57:03 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 22:57:03 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 22:57:03 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 22:57:03 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 22:57:03 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 22:57:03 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 22:57:03 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 22:57:03 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 22:57:03 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:57:03 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 22:57:03 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 22:57:03 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 22:57:03 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 22:57:03 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 22:57:03 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 22:57:03 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 22:57:03 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 22:57:03 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:57:03 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:57:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:57:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:57:03 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 22:57:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:58:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:58:56 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 22:58:56 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 22:58:56 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 3e418b25-1cb1-4273-80c1-5299837e3dcf
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:58:56 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '3e418b25-1cb1-4273-80c1-5299837e3dcf', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T22:58:56.181704', 'character_id': 'current'}
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:58:56 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 22:58:56 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:58:56 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 22:58:56 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 22:58:56 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 707a06ce-6ef5-48da-90ab-c80e3cbf7f89
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:58:56 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '707a06ce-6ef5-48da-90ab-c80e3cbf7f89', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T22:58:56.206705', 'character_id': 'current'}
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:58:56 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 707a06ce-6ef5-48da-90ab-c80e3cbf7f89 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:58:56 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 707a06ce-6ef5-48da-90ab-c80e3cbf7f89 and section_number: 1
2024-12-29 22:58:56 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 22:58:56 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 22:58:56 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 22:58:56 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 22:58:56 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 22:58:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 22:58:56 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 22:58:56 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 22:58:56 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 22:58:56 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 22:58:56 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 22:58:56 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 22:58:56 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 22:58:56 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 22:58:56 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:58:56 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 22:58:56 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 22:58:56 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 22:58:56 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 22:58:56 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 22:58:56 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 22:58:56 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 22:58:56 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 22:58:56 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:58:56 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:58:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:58:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:58:56 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 22:59:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:59:18 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 22:59:18 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 22:59:18 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ea349b2a-e540-4fe0-b172-c4ef29755cc7
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:59:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:59:18 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ea349b2a-e540-4fe0-b172-c4ef29755cc7', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T22:59:18.647569', 'character_id': 'current'}
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:59:18 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 22:59:18 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 22:59:18 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 22:59:18 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 22:59:18 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 77651675-47ed-4af9-9da0-cc9c6f37927a
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 22:59:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 22:59:18 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '77651675-47ed-4af9-9da0-cc9c6f37927a', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T22:59:18.682622', 'character_id': 'current'}
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:59:18 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 77651675-47ed-4af9-9da0-cc9c6f37927a and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:59:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:59:19 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 77651675-47ed-4af9-9da0-cc9c6f37927a and section_number: 1
2024-12-29 22:59:19 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 22:59:19 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 22:59:19 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 22:59:19 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 22:59:19 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 22:59:19 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 22:59:19 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 22:59:19 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 22:59:19 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 22:59:19 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 22:59:19 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 22:59:19 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 22:59:19 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 22:59:19 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 22:59:19 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 22:59:19 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 22:59:19 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 22:59:19 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 22:59:19 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 22:59:19 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 22:59:19 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 22:59:19 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 22:59:19 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 22:59:19 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:59:19 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 22:59:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 22:59:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 22:59:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 22:59:19 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 22:59:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 22:59:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 22:59:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='ea349b2a-e540-4fe0-b172-c4ef29755cc7' game_id='04fc3628-7e4b-43be-9483-ab21e873d3f4' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 22, 59, 19, 349863), last_update=datetime.datetime(2024, 12, 29, 22, 59, 19, 349884)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:00:23 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:00:23 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:00:23 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:00:23 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: aebce0e4-5782-4b66-aa68-5c5a313a3e10
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:00:23 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'aebce0e4-5782-4b66-aa68-5c5a313a3e10', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:00:23.712934', 'character_id': 'current'}
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:00:23 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:00:23 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:00:23 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:00:23 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:00:23 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 0e7ef14a-9b67-4a90-a18b-067c568ee12f
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:00:23 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '0e7ef14a-9b67-4a90-a18b-067c568ee12f', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:00:23.791834', 'character_id': 'current'}
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:00:23 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 0e7ef14a-9b67-4a90-a18b-067c568ee12f and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:00:23 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 0e7ef14a-9b67-4a90-a18b-067c568ee12f and section_number: 1
2024-12-29 23:00:23 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:00:23 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:00:23 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:00:23 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:00:23 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:00:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:00:23 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:00:23 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:00:23 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:00:23 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:00:23 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:00:23 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:00:23 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:00:23 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:00:23 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:00:23 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:00:23 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:00:23 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:00:23 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:00:23 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:00:23 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:00:23 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:00:23 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:00:23 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:00:23 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:00:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:00:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:00:23 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:00:23 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:00:23 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:00:23 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='aebce0e4-5782-4b66-aa68-5c5a313a3e10' game_id='04fc3628-7e4b-43be-9483-ab21e873d3f4' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 0, 23, 853084), last_update=datetime.datetime(2024, 12, 29, 23, 0, 23, 853116)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:01:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:01:36 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:01:36 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:01:36 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 37920758-daa7-4b9a-a10c-7c1fd262e605
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:01:36 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '37920758-daa7-4b9a-a10c-7c1fd262e605', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:01:36.730480', 'character_id': 'current'}
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:01:36 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:01:36 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:01:36 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:01:36 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:01:36 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: fab51298-1696-49c3-99df-a24d072ba1f2
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:01:36 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'fab51298-1696-49c3-99df-a24d072ba1f2', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:01:36.758344', 'character_id': 'current'}
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:01:36 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: fab51298-1696-49c3-99df-a24d072ba1f2 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:01:36 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: fab51298-1696-49c3-99df-a24d072ba1f2 and section_number: 1
2024-12-29 23:01:36 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:01:36 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:01:36 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:01:36 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:01:36 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:01:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:01:36 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:01:36 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:01:36 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:01:36 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:01:36 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:01:36 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:01:36 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:01:36 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:01:36 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:01:36 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:01:36 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:01:36 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:01:36 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:01:36 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:01:36 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:01:36 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:01:36 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:01:36 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:01:36 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:01:36 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:01:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:01:36 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:01:36 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='37920758-daa7-4b9a-a10c-7c1fd262e605' game_id='04fc3628-7e4b-43be-9483-ab21e873d3f4' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 1, 36, 806210), last_update=datetime.datetime(2024, 12, 29, 23, 1, 36, 806251)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:01:49 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:01:49 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:01:49 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:01:49 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 33738910-8479-4e1c-acb9-2c65301c30a1
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:01:49 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '33738910-8479-4e1c-acb9-2c65301c30a1', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:01:49.595522', 'character_id': 'current'}
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:01:49 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:01:49 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:01:49 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:01:49 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:01:49 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 6aef249a-b6ca-47c2-9562-e7ce662e1e7b
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:01:49 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '6aef249a-b6ca-47c2-9562-e7ce662e1e7b', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:01:49.628287', 'character_id': 'current'}
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:01:49 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 6aef249a-b6ca-47c2-9562-e7ce662e1e7b and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:01:49 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 6aef249a-b6ca-47c2-9562-e7ce662e1e7b and section_number: 1
2024-12-29 23:01:49 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:01:49 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:01:49 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:01:49 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:01:49 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:01:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:01:49 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:01:49 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:01:49 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:01:49 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:01:49 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:01:49 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:01:49 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:01:49 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:01:49 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:01:49 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:01:49 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:01:49 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:01:49 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:01:49 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:01:49 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:01:49 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:01:49 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:01:49 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:01:49 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:01:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:01:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:01:49 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:01:49 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:01:49 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:01:49 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='33738910-8479-4e1c-acb9-2c65301c30a1' game_id='04fc3628-7e4b-43be-9483-ab21e873d3f4' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 1, 49, 672927), last_update=datetime.datetime(2024, 12, 29, 23, 1, 49, 672950)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:05:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:05:37 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:05:37 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:05:37 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:05:37 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 553fd44d-ebc3-4827-8fe1-f0f6e6e6f2f9
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:05:37 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '553fd44d-ebc3-4827-8fe1-f0f6e6e6f2f9', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:05:37.684780', 'character_id': 'current'}
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:05:37 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:05:37 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:05:37 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:05:37 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:05:37 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 972ec83d-5207-497b-b499-fc78c10cace8
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:05:37 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '972ec83d-5207-497b-b499-fc78c10cace8', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:05:37.706981', 'character_id': 'current'}
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:05:37 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 972ec83d-5207-497b-b499-fc78c10cace8 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:05:37 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 972ec83d-5207-497b-b499-fc78c10cace8 and section_number: 1
2024-12-29 23:05:37 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:05:37 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:05:37 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:05:37 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:05:37 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:05:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:05:37 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:05:37 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:05:37 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:05:37 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:05:37 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:05:37 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:05:37 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:05:37 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:05:37 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:05:37 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:05:37 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:05:37 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:05:37 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:05:37 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:05:37 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:05:37 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:05:37 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:05:37 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:05:37 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:05:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:05:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:05:37 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:05:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:07:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:07:08 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:07:08 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:07:08 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 6c2c044b-ebfe-4b21-a589-ff2538557cc4
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:07:08 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '6c2c044b-ebfe-4b21-a589-ff2538557cc4', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:07:08.730408', 'character_id': 'current'}
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:08 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:07:08 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:07:08 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:07:08 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:07:08 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ed3b291c-380e-487d-8ec2-baaf16b6c311
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:07:08 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ed3b291c-380e-487d-8ec2-baaf16b6c311', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:07:08.768225', 'character_id': 'current'}
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:08 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: ed3b291c-380e-487d-8ec2-baaf16b6c311 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:08 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: ed3b291c-380e-487d-8ec2-baaf16b6c311 and section_number: 1
2024-12-29 23:07:08 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:07:08 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:07:08 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:07:08 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:07:08 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:07:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:07:08 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:07:08 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:07:08 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:07:08 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:07:08 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:07:08 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:07:08 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:07:08 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:07:08 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:07:08 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:07:08 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:07:08 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:07:08 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:07:08 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:07:08 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:07:08 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:07:08 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:07:08 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:08 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:08 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:07:09 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:07:09 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:07:09 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:07:09 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 378fd97f-e983-4354-aecc-5a015d1651ec
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:07:09 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '378fd97f-e983-4354-aecc-5a015d1651ec', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:07:09.368675', 'character_id': 'current'}
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:09 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:07:09 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:07:09 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:07:09 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:07:09 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b5bdccb7-0824-4fd7-a543-44efe9a5c549
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:07:09 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b5bdccb7-0824-4fd7-a543-44efe9a5c549', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:07:09.386868', 'character_id': 'current'}
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:09 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: b5bdccb7-0824-4fd7-a543-44efe9a5c549 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:09 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: b5bdccb7-0824-4fd7-a543-44efe9a5c549 and section_number: 1
2024-12-29 23:07:09 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:07:09 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:07:09 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:07:09 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:07:09 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:07:09 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:07:09 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:07:09 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:07:09 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:07:09 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:07:09 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:07:09 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:07:09 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:07:09 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:07:09 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:07:09 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:07:09 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:07:09 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:07:09 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:07:09 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:07:09 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:07:09 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:07:09 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:07:09 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:09 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:09 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:09 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:09 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:07:09 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:07:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:07:48 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:07:48 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:07:48 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 07126cfd-a5ea-4f5f-ad30-d0582387a80e
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:07:48 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '07126cfd-a5ea-4f5f-ad30-d0582387a80e', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:07:48.522729', 'character_id': 'current'}
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:48 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:07:48 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:07:48 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:07:48 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:07:48 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 6e916cdb-8d27-4ad2-b2f4-6e19c30dfd19
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:07:48 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '6e916cdb-8d27-4ad2-b2f4-6e19c30dfd19', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:07:48.547195', 'character_id': 'current'}
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:48 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 6e916cdb-8d27-4ad2-b2f4-6e19c30dfd19 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:48 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 6e916cdb-8d27-4ad2-b2f4-6e19c30dfd19 and section_number: 1
2024-12-29 23:07:48 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:07:48 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:07:48 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:07:48 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:07:48 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:07:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:07:48 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:07:48 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:07:48 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:07:48 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:07:48 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:07:48 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:07:48 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:07:48 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:07:48 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:07:48 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:07:48 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:07:48 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:07:48 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:07:48 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:07:48 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:07:48 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:07:48 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:07:48 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:48 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:07:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:07:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:07:48 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:07:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:08:18 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:08:18 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:08:18 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:08:18 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 7a608461-8f47-4f6d-8f14-a47f57cd4439
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:08:18 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '7a608461-8f47-4f6d-8f14-a47f57cd4439', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:08:18.728272', 'character_id': 'current'}
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:08:18 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:08:18 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:08:18 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:08:18 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:08:18 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 293b05ea-2bf9-46a6-8fdc-acf3e3bbbc63
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:08:18 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '293b05ea-2bf9-46a6-8fdc-acf3e3bbbc63', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:08:18.760990', 'character_id': 'current'}
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:08:18 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 293b05ea-2bf9-46a6-8fdc-acf3e3bbbc63 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:08:18 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 293b05ea-2bf9-46a6-8fdc-acf3e3bbbc63 and section_number: 1
2024-12-29 23:08:18 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:08:18 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:08:18 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:08:18 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:08:18 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:08:18 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:08:18 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:08:18 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:08:18 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:08:18 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:08:18 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:08:18 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:08:18 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:08:18 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:08:18 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:08:18 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:08:18 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:08:18 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:08:18 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:08:18 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:08:18 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:08:18 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:08:18 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:08:18 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:08:18 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:08:18 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:08:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:08:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:08:48 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:08:48 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:08:48 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ab203f0a-ed35-4e7c-9a4d-647c1ee5002b
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:08:48 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ab203f0a-ed35-4e7c-9a4d-647c1ee5002b', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:08:48.290205', 'character_id': 'current'}
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:08:48 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:08:48 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:08:48 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:08:48 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:08:48 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 29498b93-e002-4bd5-a467-fb8c2c957b30
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:08:48 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '29498b93-e002-4bd5-a467-fb8c2c957b30', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:08:48.320920', 'character_id': 'current'}
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:08:48 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 29498b93-e002-4bd5-a467-fb8c2c957b30 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:08:48 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 29498b93-e002-4bd5-a467-fb8c2c957b30 and section_number: 1
2024-12-29 23:08:48 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:08:48 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:08:48 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:08:48 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:08:48 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:08:48 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:08:48 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:08:48 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:08:48 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:08:48 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:08:48 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:08:48 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:08:48 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:08:48 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:08:48 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:08:48 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:08:48 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:08:48 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:08:48 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:08:48 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:08:48 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:08:48 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:08:48 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:08:48 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:08:48 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:08:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:08:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:08:48 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:08:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:09:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:09:44 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:09:44 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:09:44 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: f16d26aa-ad11-475e-b81a-ad3048ec4a40
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:09:44 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'f16d26aa-ad11-475e-b81a-ad3048ec4a40', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:09:44.255057', 'character_id': 'current'}
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:09:44 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:09:44 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:09:44 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:09:44 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:09:44 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 1d11d9f2-2edb-472b-8ed1-b23fd7a0661b
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:09:44 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '1d11d9f2-2edb-472b-8ed1-b23fd7a0661b', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:09:44.275420', 'character_id': 'current'}
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:09:44 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 1d11d9f2-2edb-472b-8ed1-b23fd7a0661b and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:09:44 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 1d11d9f2-2edb-472b-8ed1-b23fd7a0661b and section_number: 1
2024-12-29 23:09:44 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:09:44 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:09:44 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:09:44 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:09:44 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:09:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:09:44 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:09:44 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:09:44 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:09:44 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:09:44 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:09:44 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:09:44 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:09:44 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:09:44 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:09:44 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:09:44 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:09:44 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:09:44 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:09:44 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:09:44 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:09:44 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:09:44 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:09:44 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:09:44 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:09:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:09:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:09:44 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:09:44 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:10:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:10:47 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:10:47 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:10:47 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: a42bc0f5-ee3d-4c06-8e9c-a17a13bfca19
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:10:47 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'a42bc0f5-ee3d-4c06-8e9c-a17a13bfca19', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:10:47.840158', 'character_id': 'current'}
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:10:47 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:10:47 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:10:47 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:10:47 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:10:47 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 4a1302e1-587e-43dc-93ff-d70a874759ee
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:10:47 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '4a1302e1-587e-43dc-93ff-d70a874759ee', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:10:47.877445', 'character_id': 'current'}
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:10:47 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 4a1302e1-587e-43dc-93ff-d70a874759ee and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:10:47 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 4a1302e1-587e-43dc-93ff-d70a874759ee and section_number: 1
2024-12-29 23:10:47 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:10:47 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:10:47 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:10:47 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:10:47 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:10:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:10:47 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:10:47 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:10:47 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:10:47 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:10:47 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:10:47 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:10:47 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:10:47 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:10:47 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:10:47 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:10:47 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:10:47 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:10:47 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:10:47 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:10:47 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:10:47 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:10:47 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:10:47 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:10:47 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:10:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:10:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:10:47 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:10:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:11:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:11:10 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:11:10 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:11:10 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 731ef2d0-0a3f-4d19-af55-ee740f4f8e0a
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:11:10 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '731ef2d0-0a3f-4d19-af55-ee740f4f8e0a', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:11:10.426886', 'character_id': 'current'}
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:10 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:11:10 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:11:10 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:11:10 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:11:10 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: d52828ff-4a3f-4705-b85c-9a43c4270e19
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:11:10 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd52828ff-4a3f-4705-b85c-9a43c4270e19', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:11:10.446802', 'character_id': 'current'}
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:10 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: d52828ff-4a3f-4705-b85c-9a43c4270e19 and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:10 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: d52828ff-4a3f-4705-b85c-9a43c4270e19 and section_number: 1
2024-12-29 23:11:10 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:11:10 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:11:10 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:11:10 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:11:10 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:11:10 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:11:10 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:11:10 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:11:10 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:11:10 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:11:10 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:11:10 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:11:10 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:11:10 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:11:10 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:11:10 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:11:10 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:11:10 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:11:10 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:11:10 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:11:10 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:11:10 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:11:10 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:10 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:10 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:11:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:11:10 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:11:10 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:11:10 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b8f07d95-88a3-4aaf-b09b-f36bde056555
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:11:10 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b8f07d95-88a3-4aaf-b09b-f36bde056555', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:11:10.560685', 'character_id': 'current'}
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:10 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:11:10 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:11:10 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:11:10 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:11:10 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 237056c1-ec47-4ca2-a0ed-73ab03a2326d
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:11:10 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '237056c1-ec47-4ca2-a0ed-73ab03a2326d', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:11:10.577435', 'character_id': 'current'}
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:10 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 237056c1-ec47-4ca2-a0ed-73ab03a2326d and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:10 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 237056c1-ec47-4ca2-a0ed-73ab03a2326d and section_number: 1
2024-12-29 23:11:10 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:11:10 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:11:10 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:11:10 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:11:10 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:11:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:11:10 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:11:10 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:11:10 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:11:10 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:11:10 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:11:10 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:11:10 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:11:10 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:11:10 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:11:10 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:11:10 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:11:10 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:11:10 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:11:10 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:11:10 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:11:10 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:11:10 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:11:10 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:10 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:10 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:11:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:11:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:11:21 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:11:21 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:11:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ef80ff1d-17b1-4a3e-9130-89c39f4ccab3
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:11:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ef80ff1d-17b1-4a3e-9130-89c39f4ccab3', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:11:21.808188', 'character_id': 'current'}
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:21 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:11:21 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:11:21 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:11:21 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:11:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 3d56401e-4f25-4085-9814-981fdf597eab
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:11:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '3d56401e-4f25-4085-9814-981fdf597eab', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:11:21.827828', 'character_id': 'current'}
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:21 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 3d56401e-4f25-4085-9814-981fdf597eab and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:21 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 3d56401e-4f25-4085-9814-981fdf597eab and section_number: 1
2024-12-29 23:11:21 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:11:21 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:11:21 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:11:21 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:11:21 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:11:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:11:21 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:11:21 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:11:21 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:11:21 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:11:21 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:11:21 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:11:21 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:11:21 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:11:21 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:11:21 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:11:21 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:11:21 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:11:21 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:11:21 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:11:21 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:11:21 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:11:21 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:11:21 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:21 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:11:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:11:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:11:21 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:11:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:13:29 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:13:29 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:13:29 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:13:29 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b301d0bb-4120-4ef5-8a9f-985870fe5e1e
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:13:29 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b301d0bb-4120-4ef5-8a9f-985870fe5e1e', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:13:29.830067', 'character_id': 'current'}
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:13:29 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:13:29 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:13:29 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:13:29 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:13:29 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 9d524204-a644-474d-aff6-53fcbff73aaa
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\characters\current.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:13:29 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '9d524204-a644-474d-aff6-53fcbff73aaa', 'game_id': '04fc3628-7e4b-43be-9483-ab21e873d3f4', 'last_update': '2024-12-29T23:13:29.883453', 'character_id': 'current'}
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:13:29 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 9d524204-a644-474d-aff6-53fcbff73aaa and game_id: 04fc3628-7e4b-43be-9483-ab21e873d3f4
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:13:29 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 9d524204-a644-474d-aff6-53fcbff73aaa and section_number: 1
2024-12-29 23:13:29 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:13:29 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:13:29 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:13:29 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:13:29 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:13:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:13:29 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:13:29 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:13:29 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:13:29 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:13:29 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:13:29 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:13:29 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:13:29 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:13:29 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:13:29 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:13:29 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:13:29 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:13:29 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:13:29 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:13:29 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:13:29 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:13:29 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:13:29 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:13:29 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:13:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:13:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:13:29 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:13:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:18:03 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 23:18:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:18:03 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 23:18:03 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 23:18:04 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:18:04 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='b301d0bb-4120-4ef5-8a9f-985870fe5e1e' game_id='04fc3628-7e4b-43be-9483-ab21e873d3f4' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 13, 29, 945756), last_update=datetime.datetime(2024, 12, 29, 23, 13, 29, 945784)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:18:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current in namespace state
2024-12-29 23:18:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:18:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:18:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:18:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:18:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current.json
2024-12-29 23:18:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_current
2024-12-29 23:18:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1 in namespace state
2024-12-29 23:18:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:18:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:18:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:18:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:18:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\04fc3628-7e4b-43be-9483-ab21e873d3f4\states\game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1.json
2024-12-29 23:18:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_04fc3628-7e4b-43be-9483-ab21e873d3f4_section_1
2024-12-29 23:18:04 | INFO     | managers.agent_manager:stop_game:335 - Final game state saved successfully
2024-12-29 23:18:04 | INFO     | managers.agent_manager:stop_game:337 - Game stopped successfully
2024-12-29 23:18:04 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 23:18:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:18:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:18:09 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 23:18:56 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 23:18:56 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 23:18:56 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 23:18:56 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 23:18:56 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:18:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 23:18:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 23:18:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 23:18:56 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 23:18:56 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:18:56 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 23:18:56 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 23:18:56 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:18:56 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 23:18:56 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 23:18:56 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 23:18:56 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 23:18:56 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 23:18:56 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 23:18:56 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 23:18:56 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 23:18:57 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 23:18:57 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 23:18:57 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 23:18:57 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 23:18:57 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 23:18:57 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 23:18:57 | DEBUG    | managers.agent_manager:stop_game:328 - No game ID set, nothing to save
2024-12-29 23:18:57 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 23:19:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:19:02 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-29 23:19:02 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-29 23:19:02 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-29 23:19:02 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-29 23:19:02 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-29 23:19:02 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-29 23:19:02 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-29 23:19:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:19:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:19:04 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 23:19:10 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 23:19:10 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 23:19:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 23:19:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:19:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 23:19:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 23:19:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 23:19:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 23:19:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:19:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 23:19:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 23:19:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:19:10 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 23:19:10 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 23:19:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 23:19:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 23:19:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 23:19:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 23:19:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 23:19:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 23:19:11 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 23:19:11 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 23:19:11 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 23:19:11 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 23:19:11 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:19:11 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:19:11 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-29 23:19:11 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-29 23:19:11 | INFO     | agents.story_graph:_setup_workflow:67 - Setting up LangGraph workflow with parallel processing
2024-12-29 23:19:11 | SUCCESS  | agents.story_graph:_setup_workflow:92 - Workflow setup completed
2024-12-29 23:19:11 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-29 23:19:11 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 837cd387-3421-43a0-a239-b5cf5c61979a
2024-12-29 23:19:11 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 837cd387-3421-43a0-a239-b5cf5c61979a
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\traces
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\characters
2024-12-29 23:19:11 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 837cd387-3421-43a0-a239-b5cf5c61979a
2024-12-29 23:19:11 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 81c2f12d-5ac3-4f7f-a43b-1e87c1f448e6
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\characters\current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\characters\current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\characters\current.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:19:11 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '81c2f12d-5ac3-4f7f-a43b-1e87c1f448e6', 'game_id': '837cd387-3421-43a0-a239-b5cf5c61979a', 'last_update': '2024-12-29T23:19:11.778234', 'character_id': 'current'}
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_837cd387-3421-43a0-a239-b5cf5c61979a_current in namespace state
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_837cd387-3421-43a0-a239-b5cf5c61979a_current
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1 in namespace state
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1
2024-12-29 23:19:11 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:19:11 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:19:11 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:19:11 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:19:11 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b7e34271-ce8b-439e-9327-cfdf71a4a473
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\characters\current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\characters\current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\characters\current.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:19:11 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b7e34271-ce8b-439e-9327-cfdf71a4a473', 'game_id': '837cd387-3421-43a0-a239-b5cf5c61979a', 'last_update': '2024-12-29T23:19:11.800795', 'character_id': 'current'}
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_837cd387-3421-43a0-a239-b5cf5c61979a_current in namespace state
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_837cd387-3421-43a0-a239-b5cf5c61979a_current
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1 in namespace state
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1
2024-12-29 23:19:11 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: b7e34271-ce8b-439e-9327-cfdf71a4a473 and game_id: 837cd387-3421-43a0-a239-b5cf5c61979a
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_837cd387-3421-43a0-a239-b5cf5c61979a_current in namespace state
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_837cd387-3421-43a0-a239-b5cf5c61979a_current
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1 in namespace state
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1
2024-12-29 23:19:11 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: b7e34271-ce8b-439e-9327-cfdf71a4a473 and section_number: 1
2024-12-29 23:19:11 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:19:11 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:19:11 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:19:11 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 23:19:11 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:19:11 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:19:11 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:19:11 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:19:11 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:19:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:19:11 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:19:11 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:19:11 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:19:11 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:19:11 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-29 23:19:11 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:19:11 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:19:11 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:19:11 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:19:11 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:19:11 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:19:11 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:19:11 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:19:11 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_837cd387-3421-43a0-a239-b5cf5c61979a_current in namespace state
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_837cd387-3421-43a0-a239-b5cf5c61979a_current
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1 in namespace state
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1
2024-12-29 23:19:11 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_837cd387-3421-43a0-a239-b5cf5c61979a_current in namespace state
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_current.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_837cd387-3421-43a0-a239-b5cf5c61979a_current
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1 in namespace state
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:19:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\837cd387-3421-43a0-a239-b5cf5c61979a\states\game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1.json
2024-12-29 23:19:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_837cd387-3421-43a0-a239-b5cf5c61979a_section_1
2024-12-29 23:19:11 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:19:12 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:20:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:20:18 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-29 23:20:18 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-29 23:20:18 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-29 23:20:18 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-29 23:20:18 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-29 23:20:18 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-29 23:20:18 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-29 23:20:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:20:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:20:20 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 23:20:22 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 23:20:22 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 23:20:22 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 23:20:22 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:20:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 23:20:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 23:20:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 23:20:22 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 23:20:22 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:20:22 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 23:20:22 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 23:20:22 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:20:22 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 23:20:22 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 23:20:22 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 23:20:22 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 23:20:22 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 23:20:22 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 23:20:22 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 23:20:22 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 23:20:23 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 23:20:23 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 23:20:23 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 23:20:23 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 23:20:23 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:20:23 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:20:23 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-29 23:20:23 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-29 23:20:23 | INFO     | agents.story_graph:_setup_workflow:67 - Setting up LangGraph workflow with parallel processing
2024-12-29 23:20:23 | SUCCESS  | agents.story_graph:_setup_workflow:92 - Workflow setup completed
2024-12-29 23:20:23 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-29 23:20:23 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: 835804d7-ba4b-4f09-8415-16008acfa1ac
2024-12-29 23:20:23 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 835804d7-ba4b-4f09-8415-16008acfa1ac
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\traces
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters
2024-12-29 23:20:23 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: 835804d7-ba4b-4f09-8415-16008acfa1ac
2024-12-29 23:20:23 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: a23c9503-3d14-49d5-a0ce-da549185b21a
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:20:23 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'a23c9503-3d14-49d5-a0ce-da549185b21a', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:20:23.350565', 'character_id': 'current'}
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:20:23 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:20:23 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:20:23 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:20:23 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:20:23 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 6ce70bca-3cc9-4e35-8028-06f4abdeb818
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:20:23 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '6ce70bca-3cc9-4e35-8028-06f4abdeb818', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:20:23.366719', 'character_id': 'current'}
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:20:23 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 6ce70bca-3cc9-4e35-8028-06f4abdeb818 and game_id: 835804d7-ba4b-4f09-8415-16008acfa1ac
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:20:23 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 6ce70bca-3cc9-4e35-8028-06f4abdeb818 and section_number: 1
2024-12-29 23:20:23 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:20:23 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:20:23 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:20:23 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 23:20:23 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:20:23 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:20:23 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:20:23 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:20:23 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:20:23 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:20:23 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:20:23 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:20:23 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:20:23 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:20:23 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-29 23:20:23 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:20:23 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:20:23 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:20:23 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:20:23 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:20:23 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:20:23 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:20:23 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:20:23 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:20:23 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:20:23 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:20:23 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:20:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:20:34 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:20:34 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:20:34 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: f3f862cd-b588-4659-b953-bf852159f3b6
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:20:34 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'f3f862cd-b588-4659-b953-bf852159f3b6', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:20:34.313054', 'character_id': 'current'}
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:20:34 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:20:34 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:20:34 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:20:34 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:20:34 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 920cccd4-4fbf-4d68-98b3-f6771aade465
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:20:34 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '920cccd4-4fbf-4d68-98b3-f6771aade465', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:20:34.333576', 'character_id': 'current'}
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:20:34 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 920cccd4-4fbf-4d68-98b3-f6771aade465 and game_id: 835804d7-ba4b-4f09-8415-16008acfa1ac
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:20:34 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 920cccd4-4fbf-4d68-98b3-f6771aade465 and section_number: 1
2024-12-29 23:20:34 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:20:34 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:20:34 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:20:34 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:20:34 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:20:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:20:34 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:20:34 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:20:34 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:20:34 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:20:34 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:20:34 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:20:34 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:20:34 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:20:34 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:20:34 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:20:34 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:20:34 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:20:34 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:20:34 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:20:34 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:20:34 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:20:34 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:20:34 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:20:34 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:20:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:20:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:20:34 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:20:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:22:37 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:22:37 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:22:37 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:22:37 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 66c24972-0474-4680-a3a6-94f4da7c2201
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:22:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:22:37 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '66c24972-0474-4680-a3a6-94f4da7c2201', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:22:37.837867', 'character_id': 'current'}
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:22:37 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:22:37 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:22:37 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:22:37 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:22:37 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: bb7cab7d-4ae2-431d-a75b-89e6595ce7c3
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:22:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:22:37 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'bb7cab7d-4ae2-431d-a75b-89e6595ce7c3', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:22:37.954338', 'character_id': 'current'}
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:22:37 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: bb7cab7d-4ae2-431d-a75b-89e6595ce7c3 and game_id: 835804d7-ba4b-4f09-8415-16008acfa1ac
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:37 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:37 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:22:37 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: bb7cab7d-4ae2-431d-a75b-89e6595ce7c3 and section_number: 1
2024-12-29 23:22:37 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:22:37 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:22:37 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:22:37 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:22:37 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:22:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:22:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:22:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:22:37 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:22:37 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:22:37 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:22:37 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:22:37 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:22:37 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:22:38 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:22:38 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:22:38 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:22:38 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:22:38 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:22:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:22:38 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:22:38 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:22:38 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:22:38 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:22:38 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:22:38 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:22:38 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:22:38 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:22:38 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:22:38 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:22:38 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:22:38 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:22:38 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:22:38 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:22:38 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:22:38 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:22:38 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:22:38 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:22:38 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:22:38 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:22:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:22:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:22:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:22:38 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:23:46 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:23:48 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:23:53 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:23:53 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:23:53 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:23:53 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: be134c04-3c2c-4457-a70b-c77bac1abac4
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:23:53 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'be134c04-3c2c-4457-a70b-c77bac1abac4', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:23:53.749840', 'character_id': 'current'}
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:23:53 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:23:53 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:23:53 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:23:53 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:23:53 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 49534d34-a067-4117-8e1e-754262ac88c8
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:23:53 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '49534d34-a067-4117-8e1e-754262ac88c8', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:23:53.789732', 'character_id': 'current'}
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:23:53 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 49534d34-a067-4117-8e1e-754262ac88c8 and game_id: 835804d7-ba4b-4f09-8415-16008acfa1ac
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:23:53 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 49534d34-a067-4117-8e1e-754262ac88c8 and section_number: 1
2024-12-29 23:23:53 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:23:53 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:23:53 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:23:53 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:23:53 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:23:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:23:53 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:23:53 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:23:53 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:23:53 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:23:53 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:23:53 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:23:53 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:23:53 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:23:53 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:23:53 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:23:53 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:23:53 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:23:53 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:23:53 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:23:53 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:23:53 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:23:53 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:23:53 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:23:53 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:23:53 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:23:55 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:23:55 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:23:55 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:23:55 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: e8dea6c4-94e9-4e9c-8682-39619aeb9bd0
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:23:55 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'e8dea6c4-94e9-4e9c-8682-39619aeb9bd0', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:23:55.523353', 'character_id': 'current'}
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:23:55 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:23:55 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:23:55 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:23:55 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:23:55 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: e57a2ba8-dd5b-438a-bdb9-5b22623ce865
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:23:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:23:55 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'e57a2ba8-dd5b-438a-bdb9-5b22623ce865', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:23:55.587154', 'character_id': 'current'}
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:23:55 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: e57a2ba8-dd5b-438a-bdb9-5b22623ce865 and game_id: 835804d7-ba4b-4f09-8415-16008acfa1ac
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:23:55 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: e57a2ba8-dd5b-438a-bdb9-5b22623ce865 and section_number: 1
2024-12-29 23:23:55 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:23:55 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:23:55 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:23:55 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:23:55 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:23:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:23:55 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:23:55 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:23:55 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:23:55 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:23:55 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:23:55 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:23:55 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:23:55 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:23:55 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:23:55 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:23:55 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:23:55 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:23:55 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:23:55 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:23:55 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:23:56 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:23:56 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:23:56 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:23:56 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:23:56 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:23:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:23:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:23:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:23:56 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:24:10 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:24:10 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:24:10 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='e8dea6c4-94e9-4e9c-8682-39619aeb9bd0' game_id='835804d7-ba4b-4f09-8415-16008acfa1ac' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 23, 55, 678141), last_update=datetime.datetime(2024, 12, 29, 23, 23, 55, 678171)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:25:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:25:21 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:25:21 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:25:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: e97ecc16-134a-4926-bb56-99ffb51466e0
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:25:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'e97ecc16-134a-4926-bb56-99ffb51466e0', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:25:21.241063', 'character_id': 'current'}
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:25:21 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:25:21 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:25:21 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:25:21 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:25:21 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 13da5b32-4917-4d53-aa7a-7d4e9dc1b8c8
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:25:21 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '13da5b32-4917-4d53-aa7a-7d4e9dc1b8c8', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:25:21.271882', 'character_id': 'current'}
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:25:21 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 13da5b32-4917-4d53-aa7a-7d4e9dc1b8c8 and game_id: 835804d7-ba4b-4f09-8415-16008acfa1ac
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:25:21 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 13da5b32-4917-4d53-aa7a-7d4e9dc1b8c8 and section_number: 1
2024-12-29 23:25:21 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:25:21 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:25:21 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:25:21 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:25:21 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:25:21 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:25:21 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:25:21 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:25:21 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:25:21 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:25:21 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:25:21 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:25:21 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:25:21 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:25:21 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:25:21 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:25:21 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:25:21 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:25:21 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:25:21 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:25:21 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:25:21 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:25:21 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:25:21 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:25:21 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:25:21 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:25:21 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:25:21 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:25:21 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='e97ecc16-134a-4926-bb56-99ffb51466e0' game_id='835804d7-ba4b-4f09-8415-16008acfa1ac' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 25, 21, 328412), last_update=datetime.datetime(2024, 12, 29, 23, 25, 21, 328470)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:25:33 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:25:33 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:25:33 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:25:33 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: f1a206eb-6aa3-496a-9db6-ab0c5b0525f8
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:25:33 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'f1a206eb-6aa3-496a-9db6-ab0c5b0525f8', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:25:33.597722', 'character_id': 'current'}
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:25:33 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:25:33 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:25:33 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:25:33 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:25:33 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 127cc608-fb91-42e7-a2a0-c0cee1372587
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\characters\current.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:25:33 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '127cc608-fb91-42e7-a2a0-c0cee1372587', 'game_id': '835804d7-ba4b-4f09-8415-16008acfa1ac', 'last_update': '2024-12-29T23:25:33.622892', 'character_id': 'current'}
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:25:33 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 127cc608-fb91-42e7-a2a0-c0cee1372587 and game_id: 835804d7-ba4b-4f09-8415-16008acfa1ac
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:25:33 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 127cc608-fb91-42e7-a2a0-c0cee1372587 and section_number: 1
2024-12-29 23:25:33 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:25:33 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:25:33 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:25:33 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:25:33 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:25:33 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:25:33 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:25:33 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:25:33 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:25:33 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:25:33 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:25:33 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:25:33 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:25:33 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:25:33 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:25:33 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:25:33 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:25:33 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:25:33 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:25:33 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:25:33 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:25:33 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:25:33 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:25:33 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:25:33 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:25:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:25:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:25:33 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:25:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:25:34 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:25:34 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='f1a206eb-6aa3-496a-9db6-ab0c5b0525f8' game_id='835804d7-ba4b-4f09-8415-16008acfa1ac' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 25, 33, 665990), last_update=datetime.datetime(2024, 12, 29, 23, 25, 33, 666006)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:27:23 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 23:27:23 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:27:23 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 23:27:23 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 23:27:23 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:27:23 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='f1a206eb-6aa3-496a-9db6-ab0c5b0525f8' game_id='835804d7-ba4b-4f09-8415-16008acfa1ac' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 25, 33, 665990), last_update=datetime.datetime(2024, 12, 29, 23, 25, 33, 666006)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:27:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_current in namespace state
2024-12-29 23:27:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:27:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:27:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:27:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:27:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_current.json
2024-12-29 23:27:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_current
2024-12-29 23:27:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1 in namespace state
2024-12-29 23:27:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:27:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:27:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:27:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:27:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\835804d7-ba4b-4f09-8415-16008acfa1ac\states\game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1.json
2024-12-29 23:27:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_835804d7-ba4b-4f09-8415-16008acfa1ac_section_1
2024-12-29 23:27:24 | INFO     | managers.agent_manager:stop_game:335 - Final game state saved successfully
2024-12-29 23:27:24 | INFO     | managers.agent_manager:stop_game:337 - Game stopped successfully
2024-12-29 23:27:24 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 23:27:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:27:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:27:28 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 23:29:21 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 23:29:21 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 23:29:21 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 23:29:21 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:29:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 23:29:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 23:29:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 23:29:21 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 23:29:21 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:29:21 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 23:29:21 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 23:29:21 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:29:21 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 23:29:21 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 23:29:21 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 23:29:21 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 23:29:21 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 23:29:21 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 23:29:21 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 23:29:21 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 23:29:22 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 23:29:22 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 23:29:22 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 23:29:22 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 23:29:22 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:29:22 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:29:22 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-29 23:29:22 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-29 23:29:22 | INFO     | agents.story_graph:_setup_workflow:67 - Setting up LangGraph workflow with parallel processing
2024-12-29 23:29:22 | SUCCESS  | agents.story_graph:_setup_workflow:92 - Workflow setup completed
2024-12-29 23:29:22 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-29 23:29:22 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: bf4f96aa-0d64-488a-80b7-a4541120cbbb
2024-12-29 23:29:22 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: bf4f96aa-0d64-488a-80b7-a4541120cbbb
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\traces
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\characters
2024-12-29 23:29:22 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: bf4f96aa-0d64-488a-80b7-a4541120cbbb
2024-12-29 23:29:22 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 96ef283c-6d01-41ac-b0f8-f7593a43813e
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\characters\current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\characters\current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\characters\current.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:29:22 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '96ef283c-6d01-41ac-b0f8-f7593a43813e', 'game_id': 'bf4f96aa-0d64-488a-80b7-a4541120cbbb', 'last_update': '2024-12-29T23:29:22.513577', 'character_id': 'current'}
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current in namespace state
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1 in namespace state
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1
2024-12-29 23:29:22 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:29:22 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:29:22 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:29:22 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:29:22 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: c9b8a8a4-e2c9-4dcd-b5cd-3b4e6f8ee0f0
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\characters\current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\characters\current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\characters\current.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:29:22 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'c9b8a8a4-e2c9-4dcd-b5cd-3b4e6f8ee0f0', 'game_id': 'bf4f96aa-0d64-488a-80b7-a4541120cbbb', 'last_update': '2024-12-29T23:29:22.528792', 'character_id': 'current'}
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current in namespace state
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1 in namespace state
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1
2024-12-29 23:29:22 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: c9b8a8a4-e2c9-4dcd-b5cd-3b4e6f8ee0f0 and game_id: bf4f96aa-0d64-488a-80b7-a4541120cbbb
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current in namespace state
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1 in namespace state
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1
2024-12-29 23:29:22 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: c9b8a8a4-e2c9-4dcd-b5cd-3b4e6f8ee0f0 and section_number: 1
2024-12-29 23:29:22 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:29:22 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:29:22 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:29:22 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 23:29:22 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:29:22 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:29:22 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:29:22 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:29:22 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:29:22 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:29:22 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:29:22 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:29:22 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:29:22 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:29:22 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-29 23:29:22 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:29:22 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:29:22 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:29:22 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:29:22 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:29:22 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:29:22 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:29:22 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:29:22 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current in namespace state
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1 in namespace state
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1
2024-12-29 23:29:22 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current in namespace state
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1 in namespace state
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:29:22 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:29:22 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1
2024-12-29 23:29:22 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:29:22 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:29:22 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:29:22 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='96ef283c-6d01-41ac-b0f8-f7593a43813e' game_id='bf4f96aa-0d64-488a-80b7-a4541120cbbb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 29, 22, 559263), last_update=datetime.datetime(2024, 12, 29, 23, 29, 22, 559273)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:36:04 | INFO     | api.app:lifespan:75 - Shutting down...
2024-12-29 23:36:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:36:04 | DEBUG    | api.app:shutdown_event:60 - Cleaning up AgentManager
2024-12-29 23:36:04 | INFO     | managers.agent_manager:stop_game:323 - Stopping game...
2024-12-29 23:36:04 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:36:04 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='96ef283c-6d01-41ac-b0f8-f7593a43813e' game_id='bf4f96aa-0d64-488a-80b7-a4541120cbbb' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 29, 22, 559263), last_update=datetime.datetime(2024, 12, 29, 23, 29, 22, 559273)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:36:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current in namespace state
2024-12-29 23:36:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:36:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:36:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:36:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:36:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current.json
2024-12-29 23:36:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_current
2024-12-29 23:36:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1 in namespace state
2024-12-29 23:36:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:36:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:36:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:36:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:36:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bf4f96aa-0d64-488a-80b7-a4541120cbbb\states\game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1.json
2024-12-29 23:36:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_bf4f96aa-0d64-488a-80b7-a4541120cbbb_section_1
2024-12-29 23:36:04 | INFO     | managers.agent_manager:stop_game:335 - Final game state saved successfully
2024-12-29 23:36:04 | INFO     | managers.agent_manager:stop_game:337 - Game stopped successfully
2024-12-29 23:36:04 | INFO     | api.app:shutdown_event:63 - API shutdown successfully
2024-12-29 23:36:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:36:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-29 23:36:10 | INFO     | api.app:lifespan:72 - Starting up...
2024-12-29 23:37:49 | INFO     | managers.dependencies:get_agent_manager:19 - Creating new AgentManager instance
2024-12-29 23:37:49 | DEBUG    | managers.dependencies:get_agent_manager:21 - Creating new GameFactory instance
2024-12-29 23:37:49 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-29 23:37:49 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:37:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-29 23:37:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-29 23:37:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-29 23:37:49 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-29 23:37:49 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:37:49 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-29 23:37:49 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-29 23:37:49 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-29 23:37:49 | DEBUG    | managers.dependencies:get_agent_manager:25 - Creating game components
2024-12-29 23:37:49 | INFO     | managers.state_manager:__init__:38 - Initializing StateManager
2024-12-29 23:37:49 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-29 23:37:49 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-29 23:37:49 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-29 23:37:49 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-29 23:37:49 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-29 23:37:49 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-29 23:37:50 | DEBUG    | managers.dependencies:get_agent_manager:29 - Initializing AgentManager with components
2024-12-29 23:37:50 | INFO     | managers.agent_manager:__init__:121 - Initializing AgentManager
2024-12-29 23:37:50 | INFO     | managers.agent_manager:__init__:133 - AgentManager initialization completed
2024-12-29 23:37:50 | INFO     | managers.dependencies:get_agent_manager:36 - AgentManager initialized successfully
2024-12-29 23:37:50 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:37:50 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:37:50 | DEBUG    | managers.agent_manager:get_story_workflow:265 - Story graph not configured, configuring now
2024-12-29 23:37:50 | DEBUG    | managers.agent_manager:get_story_workflow:274 - Compiling workflow
2024-12-29 23:37:50 | INFO     | agents.story_graph:_setup_workflow:67 - Setting up LangGraph workflow with parallel processing
2024-12-29 23:37:51 | SUCCESS  | agents.story_graph:_setup_workflow:92 - Workflow setup completed
2024-12-29 23:37:51 | INFO     | managers.state_manager:initialize:51 - Initializing StateManager
2024-12-29 23:37:51 | DEBUG    | managers.state_manager:initialize:53 - Generated game ID: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:37:51 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\traces
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters
2024-12-29 23:37:51 | INFO     | managers.state_manager:initialize:56 - Initialized state manager with game ID: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:37:51 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 2c795d99-4a6c-4c96-b6b3-91ee1cf7269c
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:37:51 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '2c795d99-4a6c-4c96-b6b3-91ee1cf7269c', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:37:51.022932', 'character_id': 'current'}
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:37:51 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:37:51 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:37:51 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:37:51 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:37:51 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 2e9575ab-cab4-4653-b3ad-d4e51513dfdd
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:37:51 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '2e9575ab-cab4-4653-b3ad-d4e51513dfdd', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:37:51.049277', 'character_id': 'current'}
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:37:51 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 2e9575ab-cab4-4653-b3ad-d4e51513dfdd and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:37:51 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 2e9575ab-cab4-4653-b3ad-d4e51513dfdd and section_number: 1
2024-12-29 23:37:51 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:37:51 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:37:51 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:37:51 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-29 23:37:51 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:37:51 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:37:51 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:37:51 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:37:51 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:37:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:37:51 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:37:51 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:37:51 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:37:51 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:37:51 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2538 characters)
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-29 23:37:51 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:37:51 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:37:51 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:37:51 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:37:51 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:37:51 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:37:51 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:37:51 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:37:51 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:37:51 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:37:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:37:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:37:51 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:37:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:37:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:37:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:37:51 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:37:51 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='2c795d99-4a6c-4c96-b6b3-91ee1cf7269c' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 37, 51, 111697), last_update=datetime.datetime(2024, 12, 29, 23, 37, 51, 111720)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:37:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:37:51 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:37:51 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='2c795d99-4a6c-4c96-b6b3-91ee1cf7269c' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 37, 51, 111697), last_update=datetime.datetime(2024, 12, 29, 23, 37, 51, 111720)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:38:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:38:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:38:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:38:04 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:38:04 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:38:04 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 4b6f7933-3ab8-45cc-bf0b-b5f9db661a53
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:38:04 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '4b6f7933-3ab8-45cc-bf0b-b5f9db661a53', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:38:04.089772', 'character_id': 'current'}
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:38:04 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:38:04 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:38:04 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:38:04 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:38:04 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: fd947613-de28-45b8-b999-630c84073282
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:38:04 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'fd947613-de28-45b8-b999-630c84073282', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:38:04.110027', 'character_id': 'current'}
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:38:04 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: fd947613-de28-45b8-b999-630c84073282 and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:38:04 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: fd947613-de28-45b8-b999-630c84073282 and section_number: 1
2024-12-29 23:38:04 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:38:04 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:38:04 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:38:04 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:38:04 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:38:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:38:04 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:38:04 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:38:04 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:38:04 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:38:04 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:38:04 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:38:04 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:38:04 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:38:04 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:38:04 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:38:04 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:38:04 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:38:04 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:38:04 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:38:04 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:38:04 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:38:04 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:38:04 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:38:04 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:38:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:38:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:38:04 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:38:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:38:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:38:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:38:04 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:38:04 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='4b6f7933-3ab8-45cc-bf0b-b5f9db661a53' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 38, 4, 131090), last_update=datetime.datetime(2024, 12, 29, 23, 38, 4, 131101)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:38:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:38:04 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:38:04 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='4b6f7933-3ab8-45cc-bf0b-b5f9db661a53' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 38, 4, 131090), last_update=datetime.datetime(2024, 12, 29, 23, 38, 4, 131101)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:40:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:40:13 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:40:16 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:40:16 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:40:16 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:40:16 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 6b208e92-c6ee-43e2-a697-5a6aedced515
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:40:16 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '6b208e92-c6ee-43e2-a697-5a6aedced515', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:40:16.675986', 'character_id': 'current'}
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:16 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:40:16 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:40:16 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:40:16 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:40:16 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 15f0cb8e-ea64-46af-9616-70698db9b64a
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:40:16 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '15f0cb8e-ea64-46af-9616-70698db9b64a', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:40:16.707943', 'character_id': 'current'}
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:16 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 15f0cb8e-ea64-46af-9616-70698db9b64a and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:16 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 15f0cb8e-ea64-46af-9616-70698db9b64a and section_number: 1
2024-12-29 23:40:16 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:40:16 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:40:16 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:40:16 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:40:16 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:40:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:40:16 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:40:16 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:40:16 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:40:16 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:40:16 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:40:16 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:40:16 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:40:16 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:40:16 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:40:16 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:40:16 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:40:16 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:40:16 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:40:16 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:40:16 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:40:16 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:40:16 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:40:16 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:16 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:16 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:40:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:40:17 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:40:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:40:17 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:40:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:40:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='6b208e92-c6ee-43e2-a697-5a6aedced515' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 40, 16, 761794), last_update=datetime.datetime(2024, 12, 29, 23, 40, 16, 761832)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:40:17 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:40:17 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='6b208e92-c6ee-43e2-a697-5a6aedced515' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 40, 16, 761794), last_update=datetime.datetime(2024, 12, 29, 23, 40, 16, 761832)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:40:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:40:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:40:27 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:40:27 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:40:27 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:40:27 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 99762439-a00d-4bac-a064-29a0e30a7cc1
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:40:27 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '99762439-a00d-4bac-a064-29a0e30a7cc1', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:40:27.745014', 'character_id': 'current'}
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:27 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:40:27 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:40:27 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:40:27 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:40:27 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 71c4d22f-256b-43ce-a84d-62f40c973136
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:40:27 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '71c4d22f-256b-43ce-a84d-62f40c973136', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:40:27.769496', 'character_id': 'current'}
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:27 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 71c4d22f-256b-43ce-a84d-62f40c973136 and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:27 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 71c4d22f-256b-43ce-a84d-62f40c973136 and section_number: 1
2024-12-29 23:40:27 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:40:27 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:40:27 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:40:27 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:40:27 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:40:27 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:40:27 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:40:27 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:40:27 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:40:27 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:40:27 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:40:27 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:40:27 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:40:27 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:40:27 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:40:27 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:40:27 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:40:27 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:40:27 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:40:27 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:40:27 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:40:27 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:40:27 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:40:27 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:27 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:27 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:40:28 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:40:28 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:40:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:40:28 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:40:28 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:40:28 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='99762439-a00d-4bac-a064-29a0e30a7cc1' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 40, 27, 807981), last_update=datetime.datetime(2024, 12, 29, 23, 40, 27, 808014)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:40:28 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:40:28 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='99762439-a00d-4bac-a064-29a0e30a7cc1' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 40, 27, 807981), last_update=datetime.datetime(2024, 12, 29, 23, 40, 27, 808014)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:40:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:40:46 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:40:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:40:47 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:40:47 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:40:47 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 4276917d-a2b3-4b92-9772-7a928f8d3466
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:40:47 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '4276917d-a2b3-4b92-9772-7a928f8d3466', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:40:47.274260', 'character_id': 'current'}
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:47 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:40:47 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:40:47 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:40:47 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:40:47 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: e34414c3-4472-4284-b041-8e41b22940a9
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:40:47 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'e34414c3-4472-4284-b041-8e41b22940a9', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:40:47.290649', 'character_id': 'current'}
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:47 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: e34414c3-4472-4284-b041-8e41b22940a9 and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:47 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: e34414c3-4472-4284-b041-8e41b22940a9 and section_number: 1
2024-12-29 23:40:47 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:40:47 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:40:47 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:40:47 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:40:47 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:40:47 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:40:47 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:40:47 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:40:47 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:40:47 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:40:47 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:40:47 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:40:47 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:40:47 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:40:47 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:40:47 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:40:47 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:40:47 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:40:47 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:40:47 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:40:47 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:40:47 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:40:47 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:40:47 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:47 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:40:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:40:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:40:47 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:40:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:40:47 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:40:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:40:47 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:40:47 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:40:47 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='4276917d-a2b3-4b92-9772-7a928f8d3466' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 40, 47, 316584), last_update=datetime.datetime(2024, 12, 29, 23, 40, 47, 316607)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:40:47 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:40:47 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='4276917d-a2b3-4b92-9772-7a928f8d3466' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 40, 47, 316584), last_update=datetime.datetime(2024, 12, 29, 23, 40, 47, 316607)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:44:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:44:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:44:03 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:44:03 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:44:03 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:44:03 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8d3a09b8-c826-472d-bcb2-e64da617ac0d
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:44:03 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8d3a09b8-c826-472d-bcb2-e64da617ac0d', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:44:03.556793', 'character_id': 'current'}
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:44:03 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:44:03 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:44:03 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:44:03 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:44:03 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: ff709f4f-d7fa-47ac-99bc-7e19e168bded
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:44:03 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ff709f4f-d7fa-47ac-99bc-7e19e168bded', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:44:03.607851', 'character_id': 'current'}
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:44:03 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: ff709f4f-d7fa-47ac-99bc-7e19e168bded and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:44:03 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: ff709f4f-d7fa-47ac-99bc-7e19e168bded and section_number: 1
2024-12-29 23:44:03 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:44:03 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:44:03 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:44:03 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:44:03 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:44:03 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:44:03 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:44:03 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:44:03 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:44:03 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:44:03 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:44:03 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:44:03 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:44:03 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:44:03 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:44:03 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:44:03 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:44:03 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:44:03 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:44:03 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:44:03 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:44:03 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:44:03 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:44:03 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:44:03 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:03 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:03 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:44:03 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:44:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:44:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:44:04 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:44:04 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:44:04 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='8d3a09b8-c826-472d-bcb2-e64da617ac0d' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 44, 3, 656195), last_update=datetime.datetime(2024, 12, 29, 23, 44, 3, 656220)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:44:04 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:44:04 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='8d3a09b8-c826-472d-bcb2-e64da617ac0d' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 44, 3, 656195), last_update=datetime.datetime(2024, 12, 29, 23, 44, 3, 656220)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:44:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:44:05 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:44:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:44:05 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:44:05 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:44:05 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 9bb285ee-c5b9-4415-bb22-634f737a653e
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:44:05 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '9bb285ee-c5b9-4415-bb22-634f737a653e', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:44:05.453390', 'character_id': 'current'}
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:44:05 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:44:05 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:44:05 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:44:05 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:44:05 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: f651ea42-e3a0-4d16-b987-37c12ebf193a
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:44:05 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'f651ea42-e3a0-4d16-b987-37c12ebf193a', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:44:05.563506', 'character_id': 'current'}
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:44:05 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: f651ea42-e3a0-4d16-b987-37c12ebf193a and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:44:05 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: f651ea42-e3a0-4d16-b987-37c12ebf193a and section_number: 1
2024-12-29 23:44:05 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:44:05 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:44:05 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:44:05 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:44:05 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:44:05 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:44:05 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:44:05 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:44:05 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:44:05 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:44:05 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:44:05 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:44:05 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:44:05 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:44:05 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:44:05 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:44:05 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:44:05 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:44:05 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:44:05 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:44:05 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:44:05 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:44:05 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:44:05 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:44:05 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:44:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:44:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:44:05 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:44:05 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:44:05 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:44:05 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='9bb285ee-c5b9-4415-bb22-634f737a653e' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 44, 5, 670942), last_update=datetime.datetime(2024, 12, 29, 23, 44, 5, 671010)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:44:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:44:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:44:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:44:06 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:44:06 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='9bb285ee-c5b9-4415-bb22-634f737a653e' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 44, 5, 670942), last_update=datetime.datetime(2024, 12, 29, 23, 44, 5, 671010)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:45:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:45:03 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:47:35 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:47:35 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:47:36 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:47:36 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 085f1962-3453-4870-915d-d8be1f25bef2
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:47:36 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '085f1962-3453-4870-915d-d8be1f25bef2', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:47:36.082499', 'character_id': 'current'}
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:47:36 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:47:36 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:47:36 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:47:36 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:47:36 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b3f168ef-51e3-488d-a44c-e7ec8d4bcba3
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:47:36 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b3f168ef-51e3-488d-a44c-e7ec8d4bcba3', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:47:36.208775', 'character_id': 'current'}
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:47:36 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: b3f168ef-51e3-488d-a44c-e7ec8d4bcba3 and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:47:36 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: b3f168ef-51e3-488d-a44c-e7ec8d4bcba3 and section_number: 1
2024-12-29 23:47:36 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:47:36 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:47:36 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:47:36 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:47:36 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:47:36 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:47:36 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:47:36 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:47:36 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:47:36 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:47:36 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:47:36 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:47:36 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:47:36 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:47:36 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:47:36 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:47:36 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:47:36 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:47:36 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:47:36 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:47:36 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:47:36 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:47:36 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:47:36 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:47:36 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:47:36 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:47:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:47:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:47:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:47:36 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:47:36 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='085f1962-3453-4870-915d-d8be1f25bef2' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 47, 36, 312701), last_update=datetime.datetime(2024, 12, 29, 23, 47, 36, 313125)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:47:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:47:36 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:47:36 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='085f1962-3453-4870-915d-d8be1f25bef2' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 47, 36, 312701), last_update=datetime.datetime(2024, 12, 29, 23, 47, 36, 313125)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:47:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:108 - Processing user choice
2024-12-29 23:47:51 | DEBUG    | api.routes.ws.game_route_ws:game_websocket_endpoint:111 - Received choice data: {'type': 'choice'}
2024-12-29 23:47:51 | ERROR    | api.routes.ws.game_route_ws:game_websocket_endpoint:130 - Error processing choice: No choice provided
2024-12-29 23:47:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:47:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:47:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:47:56 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:47:56 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:47:56 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 99b97516-4b1f-4932-8d62-613771215fd0
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:47:56 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '99b97516-4b1f-4932-8d62-613771215fd0', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:47:56.438504', 'character_id': 'current'}
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:47:56 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:47:56 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:47:56 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:47:56 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:47:56 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 9218d544-9e69-4d05-b1d8-c0123ef4a2d7
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:47:56 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '9218d544-9e69-4d05-b1d8-c0123ef4a2d7', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:47:56.481946', 'character_id': 'current'}
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:47:56 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 9218d544-9e69-4d05-b1d8-c0123ef4a2d7 and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:47:56 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 9218d544-9e69-4d05-b1d8-c0123ef4a2d7 and section_number: 1
2024-12-29 23:47:56 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:47:56 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:47:56 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:47:56 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:47:56 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:47:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:47:56 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:47:56 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:47:56 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:47:56 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:47:56 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:47:56 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:47:56 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:47:56 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:47:56 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:47:56 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:47:56 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:47:56 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:47:56 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:47:56 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:47:56 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:47:56 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:47:56 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:47:56 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:47:56 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:47:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:47:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:47:56 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:47:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:47:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:47:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:47:56 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:47:56 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='99b97516-4b1f-4932-8d62-613771215fd0' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 47, 56, 534686), last_update=datetime.datetime(2024, 12, 29, 23, 47, 56, 534726)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:47:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:47:56 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:47:56 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='99b97516-4b1f-4932-8d62-613771215fd0' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 47, 56, 534686), last_update=datetime.datetime(2024, 12, 29, 23, 47, 56, 534726)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:48:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:48:24 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:48:25 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:48:25 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:48:25 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:48:25 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 956711f4-7e95-443d-88fc-736252e3a7cb
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:48:25 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '956711f4-7e95-443d-88fc-736252e3a7cb', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:48:25.206659', 'character_id': 'current'}
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:48:25 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:48:25 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:48:25 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:48:25 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:48:25 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: b62e496a-4f80-4b8c-a20b-db93b59a2ebb
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:48:25 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b62e496a-4f80-4b8c-a20b-db93b59a2ebb', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:48:25.228774', 'character_id': 'current'}
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:48:25 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: b62e496a-4f80-4b8c-a20b-db93b59a2ebb and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:48:25 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: b62e496a-4f80-4b8c-a20b-db93b59a2ebb and section_number: 1
2024-12-29 23:48:25 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:48:25 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:48:25 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:48:25 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:48:25 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:48:25 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:48:25 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:48:25 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:48:25 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:48:25 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:48:25 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:48:25 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:48:25 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:48:25 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:48:25 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:48:25 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:48:25 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:48:25 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:48:25 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:48:25 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:48:25 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:48:25 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:48:25 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:48:25 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:48:25 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:48:25 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:48:25 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:48:25 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:48:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:48:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:48:25 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:48:25 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='956711f4-7e95-443d-88fc-736252e3a7cb' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 25, 263748), last_update=datetime.datetime(2024, 12, 29, 23, 48, 25, 263761)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:48:25 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:48:25 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='956711f4-7e95-443d-88fc-736252e3a7cb' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 25, 263748), last_update=datetime.datetime(2024, 12, 29, 23, 48, 25, 263761)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:48:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:48:55 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:48:55 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:48:55 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:48:55 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:48:55 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: beee7e76-e963-4e96-9a54-950287c4e6f4
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:48:55 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'beee7e76-e963-4e96-9a54-950287c4e6f4', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:48:55.630461', 'character_id': 'current'}
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:48:55 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:48:55 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:48:55 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:48:55 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:48:55 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 8af57fae-3d3b-4626-a915-1a5ad45a6f09
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:48:55 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '8af57fae-3d3b-4626-a915-1a5ad45a6f09', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:48:55.648092', 'character_id': 'current'}
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:48:55 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 8af57fae-3d3b-4626-a915-1a5ad45a6f09 and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:48:55 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 8af57fae-3d3b-4626-a915-1a5ad45a6f09 and section_number: 1
2024-12-29 23:48:55 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:48:55 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:48:55 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:48:55 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:48:55 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:48:55 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:48:55 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:48:55 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:48:55 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:48:55 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:48:55 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:48:55 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:48:55 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:48:55 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:48:55 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:48:55 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:48:55 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:48:55 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:48:55 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:48:55 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:48:55 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:48:55 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:48:55 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:48:55 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:48:55 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:48:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:48:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:48:55 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:48:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:48:56 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:48:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:48:56 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:48:56 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:48:56 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='beee7e76-e963-4e96-9a54-950287c4e6f4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 55, 687984), last_update=datetime.datetime(2024, 12, 29, 23, 48, 55, 687997)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:48:56 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:48:56 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='beee7e76-e963-4e96-9a54-950287c4e6f4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 55, 687984), last_update=datetime.datetime(2024, 12, 29, 23, 48, 55, 687997)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:49:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:49:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:49:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:49:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:49:51 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:49:51 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:49:51 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='beee7e76-e963-4e96-9a54-950287c4e6f4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 55, 687984), last_update=datetime.datetime(2024, 12, 29, 23, 48, 55, 687997)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:49:51 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:49:51 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:49:51 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='beee7e76-e963-4e96-9a54-950287c4e6f4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 55, 687984), last_update=datetime.datetime(2024, 12, 29, 23, 48, 55, 687997)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:50:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:50:12 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:50:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:50:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:50:19 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:50:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:50:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='beee7e76-e963-4e96-9a54-950287c4e6f4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 55, 687984), last_update=datetime.datetime(2024, 12, 29, 23, 48, 55, 687997)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:50:19 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:50:19 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:50:19 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='beee7e76-e963-4e96-9a54-950287c4e6f4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 55, 687984), last_update=datetime.datetime(2024, 12, 29, 23, 48, 55, 687997)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:50:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:50:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:50:27 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:50:27 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:50:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:50:27 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:50:27 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:50:27 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='beee7e76-e963-4e96-9a54-950287c4e6f4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 55, 687984), last_update=datetime.datetime(2024, 12, 29, 23, 48, 55, 687997)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:50:27 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:50:27 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='beee7e76-e963-4e96-9a54-950287c4e6f4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 55, 687984), last_update=datetime.datetime(2024, 12, 29, 23, 48, 55, 687997)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:51:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:51:07 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:51:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:51:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:51:08 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:51:08 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:51:08 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='beee7e76-e963-4e96-9a54-950287c4e6f4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 55, 687984), last_update=datetime.datetime(2024, 12, 29, 23, 48, 55, 687997)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:51:08 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:51:08 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:51:08 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='beee7e76-e963-4e96-9a54-950287c4e6f4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 48, 55, 687984), last_update=datetime.datetime(2024, 12, 29, 23, 48, 55, 687997)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:00 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:00 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:52:00 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:52:00 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 2df9696f-411b-490c-b4eb-5e7dd762f29a
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:52:00 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '2df9696f-411b-490c-b4eb-5e7dd762f29a', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:52:00.139452', 'character_id': 'current'}
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:00 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:52:00 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:00 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:52:00 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:52:00 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 07afa654-fc27-4cd6-bfcf-da81e201a748
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:52:00 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '07afa654-fc27-4cd6-bfcf-da81e201a748', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:52:00.163689', 'character_id': 'current'}
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:00 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 07afa654-fc27-4cd6-bfcf-da81e201a748 and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:00 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 07afa654-fc27-4cd6-bfcf-da81e201a748 and section_number: 1
2024-12-29 23:52:00 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:52:00 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:52:00 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:52:00 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:52:00 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:52:00 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:52:00 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:52:00 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:52:00 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:52:00 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:52:00 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:52:00 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:52:00 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:52:00 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:52:00 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:52:00 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:52:00 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:52:00 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:52:00 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:52:00 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:52:00 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:52:00 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:52:00 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:52:00 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:00 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:00 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:52:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:52:01 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:52:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:52:02 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:52:02 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:52:02 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='2df9696f-411b-490c-b4eb-5e7dd762f29a' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 52, 0, 216050), last_update=datetime.datetime(2024, 12, 29, 23, 52, 0, 216074)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:02 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:02 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:52:02 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='2df9696f-411b-490c-b4eb-5e7dd762f29a' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 52, 0, 216050), last_update=datetime.datetime(2024, 12, 29, 23, 52, 0, 216074)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:24 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:24 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:52:24 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:52:24 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 770fea3e-dedc-47c1-a907-8d56ce02182c
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:52:24 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '770fea3e-dedc-47c1-a907-8d56ce02182c', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:52:24.209456', 'character_id': 'current'}
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:24 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:52:24 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:24 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:52:24 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:52:24 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 1826bab0-f0b7-4491-b8a0-fdf7caaa9cca
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:52:24 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '1826bab0-f0b7-4491-b8a0-fdf7caaa9cca', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:52:24.240852', 'character_id': 'current'}
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:24 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 1826bab0-f0b7-4491-b8a0-fdf7caaa9cca and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:24 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 1826bab0-f0b7-4491-b8a0-fdf7caaa9cca and section_number: 1
2024-12-29 23:52:24 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:52:24 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:52:24 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:52:24 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:52:24 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:52:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:52:24 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:52:24 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:52:24 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:52:24 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:52:24 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:52:24 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:52:24 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:52:24 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:52:24 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:52:24 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:52:24 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:52:24 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:52:24 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:52:24 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:52:24 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:52:24 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:52:24 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:52:24 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:24 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:24 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:52:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:52:25 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:52:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:52:26 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:52:26 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:52:26 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='770fea3e-dedc-47c1-a907-8d56ce02182c' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 52, 24, 313118), last_update=datetime.datetime(2024, 12, 29, 23, 52, 24, 313159)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:26 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:26 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:52:26 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='770fea3e-dedc-47c1-a907-8d56ce02182c' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 52, 24, 313118), last_update=datetime.datetime(2024, 12, 29, 23, 52, 24, 313159)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:34 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:34 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:52:34 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:52:34 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 1e391dbf-c077-4b33-a12a-0ea4182f7414
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:52:34 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '1e391dbf-c077-4b33-a12a-0ea4182f7414', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:52:34.903617', 'character_id': 'current'}
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:34 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:52:34 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:34 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:52:34 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:52:34 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 2bcbe50d-db1e-4743-9375-65af3c7727ba
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:52:34 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '2bcbe50d-db1e-4743-9375-65af3c7727ba', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:52:34.930755', 'character_id': 'current'}
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:34 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 2bcbe50d-db1e-4743-9375-65af3c7727ba and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:34 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 2bcbe50d-db1e-4743-9375-65af3c7727ba and section_number: 1
2024-12-29 23:52:34 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:52:34 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:52:34 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:52:34 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:52:34 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:52:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:52:34 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:52:34 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:52:34 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:52:34 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:52:34 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:52:34 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:52:34 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:52:34 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:52:34 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:52:34 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:52:34 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:52:34 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:52:34 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:52:34 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:52:34 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:52:34 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:52:34 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:52:34 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:34 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:35 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:52:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:52:35 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:52:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:52:36 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:52:36 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:52:36 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='1e391dbf-c077-4b33-a12a-0ea4182f7414' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 52, 34, 973763), last_update=datetime.datetime(2024, 12, 29, 23, 52, 34, 973776)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:36 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:36 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:52:36 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='1e391dbf-c077-4b33-a12a-0ea4182f7414' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 52, 34, 973763), last_update=datetime.datetime(2024, 12, 29, 23, 52, 34, 973776)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:49 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:49 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:52:49 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:52:49 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 0ffb01a7-4f81-4c3a-98c7-84054c4df8c4
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:52:49 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '0ffb01a7-4f81-4c3a-98c7-84054c4df8c4', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:52:49.507490', 'character_id': 'current'}
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:49 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:52:49 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:49 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:52:49 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:52:49 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 1c611539-adc3-44ef-aad2-294f1a1095d1
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:52:49 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '1c611539-adc3-44ef-aad2-294f1a1095d1', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:52:49.527245', 'character_id': 'current'}
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:49 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 1c611539-adc3-44ef-aad2-294f1a1095d1 and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:49 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 1c611539-adc3-44ef-aad2-294f1a1095d1 and section_number: 1
2024-12-29 23:52:49 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:52:49 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:52:49 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:52:49 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:52:49 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:52:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:52:49 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:52:49 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:52:49 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:52:49 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:52:49 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:52:49 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:52:49 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:52:49 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:52:49 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:52:49 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:52:49 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:52:49 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:52:49 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:52:49 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:52:49 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:52:49 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:52:49 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:52:49 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:49 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:52:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:52:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:52:49 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:52:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:52:49 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:52:50 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:52:50 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:52:50 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:52:50 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='0ffb01a7-4f81-4c3a-98c7-84054c4df8c4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 52, 49, 560286), last_update=datetime.datetime(2024, 12, 29, 23, 52, 49, 560294)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:52:50 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:52:50 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:52:50 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='0ffb01a7-4f81-4c3a-98c7-84054c4df8c4' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 52, 49, 560286), last_update=datetime.datetime(2024, 12, 29, 23, 52, 49, 560294)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:53:04 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:53:04 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:53:04 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:53:04 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: baa89904-4e1a-455d-95f5-48ab26d3b982
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:53:04 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'baa89904-4e1a-455d-95f5-48ab26d3b982', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:53:04.475927', 'character_id': 'current'}
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:53:04 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:53:04 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:53:04 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:53:04 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:53:04 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 2cca4170-4a5e-49b6-acf5-3fbed4f79cf9
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:53:04 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '2cca4170-4a5e-49b6-acf5-3fbed4f79cf9', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:53:04.497349', 'character_id': 'current'}
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:53:04 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: 2cca4170-4a5e-49b6-acf5-3fbed4f79cf9 and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:53:04 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: 2cca4170-4a5e-49b6-acf5-3fbed4f79cf9 and section_number: 1
2024-12-29 23:53:04 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:53:04 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:53:04 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:53:04 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:53:04 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:53:04 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:53:04 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:53:04 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:53:04 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:53:04 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:53:04 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:53:04 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:53:04 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:53:04 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:53:04 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:53:04 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:53:04 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:53:04 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:53:04 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:53:04 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:53:04 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:53:04 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:53:04 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:53:04 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:53:04 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:04 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:04 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:53:04 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:53:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:53:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:53:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:53:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:53:06 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:53:06 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:53:06 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='baa89904-4e1a-455d-95f5-48ab26d3b982' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 53, 4, 540748), last_update=datetime.datetime(2024, 12, 29, 23, 53, 4, 540770)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:53:06 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:53:06 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:53:06 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='baa89904-4e1a-455d-95f5-48ab26d3b982' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 53, 4, 540748), last_update=datetime.datetime(2024, 12, 29, 23, 53, 4, 540770)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:53:28 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:53:28 | INFO     | managers.agent_manager:initialize_game:210 - Initializing game
2024-12-29 23:53:28 | INFO     | managers.agent_manager:get_story_workflow:261 - Getting story workflow
2024-12-29 23:53:28 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: 39ff647d-5947-4886-ab4e-32968412402a
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:53:28 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': '39ff647d-5947-4886-ab4e-32968412402a', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:53:28.934248', 'character_id': 'current'}
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:53:28 | INFO     | managers.workflow_manager:start_workflow:69 - Starting workflow node
2024-12-29 23:53:28 | DEBUG    | managers.workflow_manager:start_workflow:70 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' game_id='' narrative=None rules=None trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:53:28 | DEBUG    | managers.workflow_manager:start_workflow:81 - Input data is already a GameState
2024-12-29 23:53:28 | DEBUG    | managers.workflow_manager:start_workflow:88 - Creating initial state with session_id and game_id
2024-12-29 23:53:28 | INFO     | managers.state_manager:create_initial_state:325 - Creating initial state with session_id: c4b65d9e-0b12-4d0f-b1b2-9c981bcc7207
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\characters\current.json
2024-12-29 23:53:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-29 23:53:28 | DEBUG    | managers.state_manager:create_initial_state:352 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'c4b65d9e-0b12-4d0f-b1b2-9c981bcc7207', 'game_id': 'b600d462-2cde-444f-8eb2-295d72866e7b', 'last_update': '2024-12-29T23:53:28.961396', 'character_id': 'current'}
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:53:28 | DEBUG    | managers.workflow_manager:start_workflow:90 - Validated state session_id: c4b65d9e-0b12-4d0f-b1b2-9c981bcc7207 and game_id: b600d462-2cde-444f-8eb2-295d72866e7b
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:53:28 | INFO     | managers.workflow_manager:start_workflow:109 - Successfully created and saved output with session_id: c4b65d9e-0b12-4d0f-b1b2-9c981bcc7207 and section_number: 1
2024-12-29 23:53:28 | INFO     | agents.story_graph:_process_rules:103 - Processing rules for section 1
2024-12-29 23:53:28 | DEBUG    | agents.rules_agent:ainvoke:234 - Processing rules for state: session=, section=1
2024-12-29 23:53:28 | DEBUG    | agents.rules_agent:_process_section_rules:51 - Starting process_section_rules for section 1
2024-12-29 23:53:28 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-29 23:53:28 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:53:28 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-29 23:53:28 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-29 23:53:28 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-27T18:26:26.567172', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-29 23:53:29 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-29 23:53:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-29 23:53:29 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-29 23:53:29 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-29 23:53:29 | INFO     | agents.rules_agent:_process_section_rules:56 - Rules found in cache for section 1
2024-12-29 23:53:29 | DEBUG    | agents.rules_agent:ainvoke:254 - Rules processed successfully
2024-12-29 23:53:29 | DEBUG    | agents.story_graph:_process_rules:119 - Rules processing completed for section 1
2024-12-29 23:53:29 | INFO     | agents.story_graph:_process_narrative:137 - Processing narrative for section 1
2024-12-29 23:53:29 | DEBUG    | agents.narrator_agent:ainvoke:189 - Processing narrative for state: session=, section=1
2024-12-29 23:53:29 | DEBUG    | agents.narrator_agent:_process_section:48 - Starting process_section for section 1
2024-12-29 23:53:29 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-29 23:53:29 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-29 23:53:29 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-29 23:53:29 | INFO     | agents.narrator_agent:_process_section:53 - Content found in cache for section 1
2024-12-29 23:53:29 | DEBUG    | agents.narrator_agent:ainvoke:206 - Section processed successfully
2024-12-29 23:53:29 | DEBUG    | agents.story_graph:_process_narrative:157 - Narrative processing completed for section 1
2024-12-29 23:53:29 | DEBUG    | agents.story_graph:_process_decision:213 - No user input to process
2024-12-29 23:53:29 | INFO     | agents.story_graph:_process_decision:215 -  En attente d'une réponse utilisateur pour la section 1
2024-12-29 23:53:29 | INFO     | managers.workflow_manager:end_workflow:129 - Ending workflow with output: session=, section=1
2024-12-29 23:53:29 | DEBUG    | managers.workflow_manager:end_workflow:134 - Saving final state
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:53:29 | INFO     | managers.workflow_manager:end_workflow:137 - Workflow ended successfully
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_current in namespace state
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_current.json
2024-12-29 23:53:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_current
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1 in namespace state
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-29 23:53:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b600d462-2cde-444f-8eb2-295d72866e7b\states\game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1.json
2024-12-29 23:53:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/game_b600d462-2cde-444f-8eb2-295d72866e7b_section_1
2024-12-29 23:53:29 | INFO     | managers.agent_manager:initialize_game:238 - Game initialization completed successfully
2024-12-29 23:53:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:53:29 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:53:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:53:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:53:30 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:53:30 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:53:30 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='39ff647d-5947-4886-ab4e-32968412402a' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 53, 29, 15417), last_update=datetime.datetime(2024, 12, 29, 23, 53, 29, 15442)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:53:30 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:53:30 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:53:30 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='39ff647d-5947-4886-ab4e-32968412402a' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 53, 29, 15417), last_update=datetime.datetime(2024, 12, 29, 23, 53, 29, 15442)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:53:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:53:41 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:53:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:53:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:53:42 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:53:42 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:53:42 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='39ff647d-5947-4886-ab4e-32968412402a' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 53, 29, 15417), last_update=datetime.datetime(2024, 12, 29, 23, 53, 29, 15442)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:53:42 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:53:42 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:53:42 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='39ff647d-5947-4886-ab4e-32968412402a' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 53, 29, 15417), last_update=datetime.datetime(2024, 12, 29, 23, 53, 29, 15442)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:53:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:138 - WebSocket disconnected
2024-12-29 23:53:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:152 - WebSocket connection closed
2024-12-29 23:53:53 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:53:53 | DEBUG    | managers.dependencies:get_agent_manager:38 - Returning existing AgentManager instance
2024-12-29 23:53:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:63 - New WebSocket connection attempt
2024-12-29 23:53:53 | INFO     | api.routes.ws.game_route_ws:game_websocket_endpoint:66 - WebSocket connection established
2024-12-29 23:53:53 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:53:53 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='39ff647d-5947-4886-ab4e-32968412402a' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 53, 29, 15417), last_update=datetime.datetime(2024, 12, 29, 23, 53, 29, 15442)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
2024-12-29 23:53:53 | DEBUG    | managers.agent_manager:get_state:192 - Fetching current game state
2024-12-29 23:53:53 | DEBUG    | managers.agent_manager:get_state:194 - Current state: session_id='39ff647d-5947-4886-ab4e-32968412402a' game_id='b600d462-2cde-444f-8eb2-295d72866e7b' narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. Il ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans.\n\nLe circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogation de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. »\n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. Au bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre.\n\nLe générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. Vous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne, des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique.\n\nBien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. Reverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission.\n\nDes heures s'écoulent, uniformes et lentes. Puis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature.\n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 29, 23, 53, 29, 15417), last_update=datetime.datetime(2024, 12, 29, 23, 53, 29, 15442)) rules=RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 27, 18, 26, 26, 567172)) trace=None character=None decision=None error=None section_number=1 player_input=None content=None
