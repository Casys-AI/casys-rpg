2024-12-25 17:37:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:37:21 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-25 17:37:21 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-25 17:37:21 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-25 17:37:21 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-25 17:37:21 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-25 17:37:21 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-25 17:37:21 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-25 17:37:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:37:23 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:37:23 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:37:23 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:37:23 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:37:23 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:37:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:37:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:37:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:37:23 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:37:23 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:37:23 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:37:23 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:37:23 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:37:23 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:37:23 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:37:23 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:37:23 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:37:23 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:37:23 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:37:23 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:37:23 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:37:23 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:37:23 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:37:23 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:37:23 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:37:34 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 17:37:34 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 17:37:34 | INFO     | api.app:initialize_game:634 - Generated session ID: df05534d-90ee-4ea2-b81d-7145144a7ec5
2024-12-25 17:37:34 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 17:37:34 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 17:37:34 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 17:37:34 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 17:37:34 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 17:37:34 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 8e521d81-896e-44e3-87ee-2a74cb810538
2024-12-25 17:37:34 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 8e521d81-896e-44e3-87ee-2a74cb810538
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\states
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\traces
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\characters
2024-12-25 17:37:34 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 8e521d81-896e-44e3-87ee-2a74cb810538
2024-12-25 17:37:34 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 17:37:34 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 17:37:34 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 17:37:34 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 17:37:34 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 17:37:34 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 17:37:34 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 17:37:34 | INFO     | agents.story_graph:_setup_workflow:56 - Setting up LangGraph workflow with parallel processing
2024-12-25 17:37:34 | SUCCESS  | agents.story_graph:_setup_workflow:84 - LangGraph workflow setup completed successfully
2024-12-25 17:37:34 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 17:37:34 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='df05534d-90ee-4ea2-b81d-7145144a7ec5' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 17:37:34 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\states\section_1.json
2024-12-25 17:37:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\states\section_1.json
2024-12-25 17:37:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\states\section_1.json
2024-12-25 17:37:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 17:37:34 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 17:37:34 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 17:37:34 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='df05534d-90ee-4ea2-b81d-7145144a7ec5' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 17:37:34 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 17:37:34 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 17:37:34 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 17:37:34 | DEBUG    | managers.workflow_manager:start_workflow:210 - No state provided, creating initial state
2024-12-25 17:37:34 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session '8e521d81-896e-44e3-87ee-2a74cb810538'
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\characters\current.json
2024-12-25 17:37:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\characters\current.json
2024-12-25 17:37:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\characters\current.json
2024-12-25 17:37:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-25 17:37:34 | DEBUG    | managers.state_manager:create_initial_state:298 - Initial state created: section=1, session=8e521d81-896e-44e3-87ee-2a74cb810538
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\states\section_1.json
2024-12-25 17:37:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\states\section_1.json
2024-12-25 17:37:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\states\section_1.json
2024-12-25 17:37:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 17:37:34 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: session_id='8e521d81-896e-44e3-87ee-2a74cb810538' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 17:37:34 | DEBUG    | managers.workflow_manager:start_workflow:230 - Returning output: session_id='8e521d81-896e-44e3-87ee-2a74cb810538' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None
2024-12-25 17:37:34 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '8e521d81-896e-44e3-87ee-2a74cb810538'}}
2024-12-25 17:37:34 | INFO     | agents.story_graph:_process_rules:94 - Processing rules for section 1
2024-12-25 17:37:34 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 17:37:34 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 17:37:34 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 17:37:34 | INFO     | agents.story_graph:_process_narrative:127 - Processing narrative for section 1
2024-12-25 17:37:34 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 17:37:34 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 17:37:34 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 17:37:34 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 17:37:34 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 17:37:34 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 17:37:34 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 17:37:34 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 17:37:34 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 17:37:34 | DEBUG    | agents.story_graph:_process_rules:112 - Rules processing completed for section 1
2024-12-25 17:37:34 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 17:37:34 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 17:37:34 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 17:37:34 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 17:37:34 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 17:37:34 | DEBUG    | agents.story_graph:_process_narrative:148 - Narrative processing completed for section 1
2024-12-25 17:37:34 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394))}}
2024-12-25 17:37:34 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 25, 17, 37, 34, 783147), last_update=datetime.datetime(2024, 12, 25, 17, 37, 34, 783192))}}
2024-12-25 17:37:34 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: StoryGraph._process_decision() missing 1 required positional argument: 'narrative_output'
2024-12-25 17:37:34 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: StoryGraph._process_decision() missing 1 required positional argument: 'narrative_output'
2024-12-25 17:37:34 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: StoryGraph._process_decision() missing 1 required positional argument: 'narrative_output'
2024-12-25 17:37:34 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: StoryGraph._process_decision() missing 1 required positional argument: 'narrative_output'
2024-12-25 17:38:16 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:38:16 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:38:16 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:38:16 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 17:38:16 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 17:38:16 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 17:38:16 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\states\current_state.json
2024-12-25 17:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\states\current_state.json
2024-12-25 17:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\8e521d81-896e-44e3-87ee-2a74cb810538\states\current_state.json
2024-12-25 17:38:16 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 17:38:16 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 17:38:16 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 17:38:16 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 17:38:16 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:38:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:39:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:39:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:39:52 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:39:52 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:39:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:39:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:39:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:39:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:39:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:39:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:39:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:39:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:39:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:39:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:39:52 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:39:52 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:39:52 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:39:52 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:39:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:39:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:39:52 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:39:52 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:39:53 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:39:53 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:39:53 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:39:53 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:41:16 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:41:16 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:41:16 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:41:16 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:41:16 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:41:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:43:55 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:43:58 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:43:58 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:43:58 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:43:58 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:43:58 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:43:58 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:43:58 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:43:58 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:43:58 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:43:58 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:43:58 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:43:58 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:43:58 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:43:58 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:43:58 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:43:58 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:43:59 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:43:59 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:43:59 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:43:59 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:44:06 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:44:06 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:44:06 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:44:06 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:44:06 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:44:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:44:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:44:09 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:44:09 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:44:09 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:44:09 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:44:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:44:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:44:09 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:44:09 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:09 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:44:09 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:44:09 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:09 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:44:09 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:44:09 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:44:09 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:44:09 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:44:09 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:44:09 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:44:09 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:44:10 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:44:10 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:44:10 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:44:10 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:44:17 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:44:17 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:44:17 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:44:17 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:44:17 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:44:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:44:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:44:21 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:44:21 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:44:21 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:44:21 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:44:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:44:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:44:21 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:44:21 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:21 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:44:21 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:44:21 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:21 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:44:21 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:44:21 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:44:21 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:44:21 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:44:21 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:44:21 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:44:21 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:44:22 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:44:22 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:44:22 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:44:22 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:44:24 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:44:24 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:44:24 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:44:24 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:44:24 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:44:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:44:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:44:27 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:44:27 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:44:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:44:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:44:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:44:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:44:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:44:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:44:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:44:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:27 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:44:27 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:44:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:44:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:44:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:44:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:44:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:44:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:44:28 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:44:28 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:44:28 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:44:28 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:44:40 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:44:40 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:44:40 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:44:40 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:44:40 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:44:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:44:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:44:43 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:44:43 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:44:43 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:44:43 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:44:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:44:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:44:43 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:44:43 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:43 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:44:43 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:44:43 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:43 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:44:43 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:44:43 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:44:43 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:44:43 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:44:43 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:44:43 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:44:43 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:44:44 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:44:44 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:44:44 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:44:44 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:44:47 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:44:47 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:44:47 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:44:47 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:44:47 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:44:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:44:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:44:51 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:44:51 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:44:51 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:44:51 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:44:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:44:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:44:51 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:44:51 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:51 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:44:51 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:44:51 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:44:51 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:44:51 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:44:51 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:44:51 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:44:51 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:44:51 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:44:51 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:44:51 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:44:51 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:44:51 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:44:51 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:44:51 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:45:09 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:45:09 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:45:09 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:45:09 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:45:09 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:45:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:45:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:45:12 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:45:12 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:45:12 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:45:12 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:45:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:45:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:45:12 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:45:12 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:45:12 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:45:12 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:45:12 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:45:12 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:45:12 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:45:12 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:45:12 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:45:12 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:45:12 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:45:12 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:45:12 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:45:12 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:45:13 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:45:13 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:45:13 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:45:13 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:45:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:46:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:46:23 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:46:23 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:46:23 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:46:23 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:46:23 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:46:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:46:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:46:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:46:23 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:46:23 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:46:23 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:46:23 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:46:23 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:46:23 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:46:23 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:46:23 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:46:23 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:46:23 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:46:23 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:46:23 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:46:23 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:46:24 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:46:24 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:46:24 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:46:24 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:54:36 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:54:36 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:54:36 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:54:36 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:54:36 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:54:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:54:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:54:40 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:54:40 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:54:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:54:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:54:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:54:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:54:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:54:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:54:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:54:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:54:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:54:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:54:40 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:54:40 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:54:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:54:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:54:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:54:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:54:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:54:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:54:41 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:54:41 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:54:41 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:54:41 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:54:41 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 17:54:41 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 17:54:41 | INFO     | api.app:initialize_game:634 - Generated session ID: 0e9f1030-4119-4730-84ba-934355240b42
2024-12-25 17:54:41 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 17:54:41 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 17:54:41 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 17:54:41 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 17:54:41 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 17:54:41 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: d4e75a18-f257-4b64-8c5a-952a2c78637f
2024-12-25 17:54:41 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: d4e75a18-f257-4b64-8c5a-952a2c78637f
2024-12-25 17:54:41 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\d4e75a18-f257-4b64-8c5a-952a2c78637f\states
2024-12-25 17:54:41 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\d4e75a18-f257-4b64-8c5a-952a2c78637f\traces
2024-12-25 17:54:41 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\d4e75a18-f257-4b64-8c5a-952a2c78637f\characters
2024-12-25 17:54:41 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: d4e75a18-f257-4b64-8c5a-952a2c78637f
2024-12-25 17:54:41 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 17:54:41 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 17:54:41 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 17:54:41 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 17:54:41 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 17:54:41 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 17:54:41 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 17:54:41 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 17:54:41 | ERROR    | agents.story_graph:_setup_workflow:82 - Error setting up workflow: 'rules' is already being used as a state key
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1432)
                                      │           └ <function spawn_main at 0x0000017F8D8C0860>
                                      └ <function spawn_main at 0x0000017F8D8C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 600
               │     └ 3
               └ <function _main at 0x0000017F8D8C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 600
           │    └ <function BaseProcess._bootstrap at 0x0000017F8D806A20>
           └ <SpawnProcess name='SpawnProcess-14' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000017F8D805F80>
    └ <SpawnProcess name='SpawnProcess-14' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000017F93714AD0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-14' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-14' parent=39512 started>
    │    └ <function subprocess_started at 0x0000017F936FEE80>
    └ <SpawnProcess name='SpawnProcess-14' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=768, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000017F93714C20>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=768, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x0000017F936FE160>
           │       │   └ <uvicorn.server.Server object at 0x0000017F93714C20>
           │       └ <function run at 0x0000017F8DE063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x0000017F936F9A80>
           │      └ <function Runner.run at 0x0000017F8DE704A0>
           └ <asyncio.runners.Runner object at 0x0000017F937156A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000017F8DE69E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000017F937156A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000017F8DE69DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000017F8DE6BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000017F8DDED3A0>
    └ <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 403, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
                   └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000017F8DFB38C0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
                 │    │   │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77770>>
                 │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
                 │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
                 │    └ <fastapi.applications.FastAPI object at 0x0000017F9342FB60>
                 └ <uvicorn.middleware.proxy_headers.ProxyHeadersMiddleware object at 0x0000017F8DFB38C0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\fastapi\applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
                           │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77770>>
                           │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
                           └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\applications.py", line 113, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <bound method RequestResponseCycle.send of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77770>>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000017F8DFB2270>
          └ <fastapi.applications.FastAPI object at 0x0000017F9342FB60>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
          │    │   │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017F93A6A520>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.cors.CORSMiddleware object at 0x0000017F8DFB30E0>
          └ <starlette.middleware.errors.ServerErrorMiddleware object at 0x0000017F8DFB2270>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
          │    │               │      │        │                     └ Headers({'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '68', 'sec-ch-ua-platform': '"Windows"', 'us...
          │    │               │      │        └ <function ServerErrorMiddleware.__call__.<locals>._send at 0x0000017F93A6A520>
          │    │               │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
          │    │               └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function CORSMiddleware.simple_response at 0x0000017F90878540>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000017F8DFB30E0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
          │    │   │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000017F8DFB30E0...
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000017F8DFB2CF0>
          └ <starlette.middleware.cors.CORSMiddleware object at 0x0000017F8DFB30E0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\middleware\exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
          │                            │    │    │     │      │        └ functools.partial(<bound method CORSMiddleware.send of <starlette.middleware.cors.CORSMiddleware object at 0x0000017F8DFB30E0...
          │                            │    │    │     │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
          │                            │    │    │     └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    │    └ <starlette.requests.Request object at 0x0000017F93A778C0>
          │                            │    └ <fastapi.routing.APIRouter object at 0x0000017F934E2710>
          │                            └ <starlette.middleware.exceptions.ExceptionMiddleware object at 0x0000017F8DFB2CF0>
          └ <function wrap_app_handling_exceptions at 0x0000017F905BD3A0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017F93A6A700>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <fastapi.routing.APIRouter object at 0x0000017F934E2710>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
          │    │                │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017F93A6A700>
          │    │                │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
          │    │                └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <bound method Router.app of <fastapi.routing.APIRouter object at 0x0000017F934E2710>>
          └ <fastapi.routing.APIRouter object at 0x0000017F934E2710>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 735, in app
    await route.handle(scope, receive, send)
          │     │      │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017F93A6A700>
          │     │      │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
          │     │      └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │     └ <function Route.handle at 0x0000017F905BEC00>
          └ APIRoute(path='/api/game/initialize', name='initialize_game', methods=['POST'])
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 288, in handle
    await self.app(scope, receive, send)
          │    │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017F93A6A700>
          │    │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
          │    │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │    └ <function request_response.<locals>.app at 0x0000017F935496C0>
          └ APIRoute(path='/api/game/initialize', name='initialize_game', methods=['POST'])
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
          │                            │    │        │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017F93A6A700>
          │                            │    │        │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
          │                            │    │        └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          │                            │    └ <starlette.requests.Request object at 0x0000017F93A6C550>
          │                            └ <function request_response.<locals>.app.<locals>.app at 0x0000017F93A6A7A0>
          └ <function wrap_app_handling_exceptions at 0x0000017F905BD3A0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
          │   │      │        └ <function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0x0000017F93A6A8E0>
          │   │      └ <bound method RequestResponseCycle.receive of <uvicorn.protocols.http.h11_impl.RequestResponseCycle object at 0x0000017F93A77...
          │   └ {'type': 'http', 'asgi': {'version': '3.0', 'spec_version': '2.3'}, 'http_version': '1.1', 'server': ('127.0.0.1', 8000), 'cl...
          └ <function request_response.<locals>.app.<locals>.app at 0x0000017F93A6A7A0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\starlette\routing.py", line 73, in app
    response = await f(request)
                     │ └ <starlette.requests.Request object at 0x0000017F93A6C550>
                     └ <function get_request_handler.<locals>.app at 0x0000017F93549760>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\fastapi\routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                         └ <function run_endpoint_function at 0x0000017F905BCAE0>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\fastapi\routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
                 │         │      └ {'agent_mgr': <managers.agent_manager.AgentManager object at 0x0000017F93A76CF0>, 'init_request': GameInitRequest(game_id='st...
                 │         └ <function initialize_game at 0x0000017F9354AD40>
                 └ Dependant(path_params=[], query_params=[], header_params=[], cookie_params=[], body_params=[ModelField(field_info=Body(None),...

  File "C:\Users\erpes\Desktop\casys-rpg\api\app.py", line 652, in initialize_game
    initial_state = await agent_mgr.initialize_game(
                          │         └ <function AgentManager.initialize_game at 0x0000017F925A0EA0>
                          └ <managers.agent_manager.AgentManager object at 0x0000017F93A76CF0>

  File "C:\Users\erpes\Desktop\casys-rpg\managers\agent_manager.py", line 353, in initialize_game
    await self.story_graph._setup_workflow()
          │    │           └ <function StoryGraph._setup_workflow at 0x0000017F92D4DDA0>
          │    └ <agents.story_graph.StoryGraph object at 0x0000017F93A80050>
          └ <managers.agent_manager.AgentManager object at 0x0000017F93A76CF0>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 61, in _setup_workflow
    self._graph.add_node("rules", self._process_rules)
    │    │      │                 │    └ <function StoryGraph._process_rules at 0x0000017F925A0040>
    │    │      │                 └ <agents.story_graph.StoryGraph object at 0x0000017F93A80050>
    │    │      └ <function StateGraph.add_node at 0x0000017F92D4CE00>
    │    └ <langgraph.graph.state.StateGraph object at 0x0000017F93A816A0>
    └ <agents.story_graph.StoryGraph object at 0x0000017F93A80050>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\langgraph\graph\state.py", line 336, in add_node
    raise ValueError(f"'{node}' is already being used as a state key")
                         └ 'rules'

ValueError: 'rules' is already being used as a state key
2024-12-25 17:54:41 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: 'rules' is already being used as a state key
2024-12-25 17:54:41 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: 'rules' is already being used as a state key
2024-12-25 17:54:41 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: 'rules' is already being used as a state key
2024-12-25 17:56:23 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:56:23 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:56:23 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:56:23 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 17:56:23 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 17:56:23 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 17:56:23 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d4e75a18-f257-4b64-8c5a-952a2c78637f\states\current_state.json
2024-12-25 17:56:23 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d4e75a18-f257-4b64-8c5a-952a2c78637f\states\current_state.json
2024-12-25 17:56:23 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d4e75a18-f257-4b64-8c5a-952a2c78637f\states\current_state.json
2024-12-25 17:56:23 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 17:56:23 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 17:56:23 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 17:56:23 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 17:56:23 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:56:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:56:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:56:27 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:56:27 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:56:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:56:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:56:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:56:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:56:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:56:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:56:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:56:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:56:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:56:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:56:27 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:56:27 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:56:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:56:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:56:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:56:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:56:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:56:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:56:28 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:56:28 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:56:28 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:56:28 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:56:40 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:56:40 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:56:40 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:56:40 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:56:40 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:56:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:56:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:56:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:56:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:56:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:57:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:57:00 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:57:00 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:57:00 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:57:00 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:57:00 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:57:00 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:57:00 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:57:00 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:57:00 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:57:00 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:57:00 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:57:00 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:57:00 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:57:00 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:57:00 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:57:00 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:57:00 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:57:00 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:57:00 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:57:00 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:57:01 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:57:01 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:57:01 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:57:01 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:57:02 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:57:02 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:57:02 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:57:02 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:57:02 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:57:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:57:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:57:05 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:57:05 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:57:05 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:57:05 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:57:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:57:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:57:05 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:57:05 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:57:05 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:57:05 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:57:05 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:57:05 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:57:05 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:57:05 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:57:05 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:57:05 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:57:05 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:57:05 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:57:05 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:57:05 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:57:06 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:57:06 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:57:06 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:57:06 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:57:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:57:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:57:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:57:13 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:57:13 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:57:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:57:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:57:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:57:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:57:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:57:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:57:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:57:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:57:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:57:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:57:13 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:57:13 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:57:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:57:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:57:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:57:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:57:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:57:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:57:14 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:57:14 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:57:14 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:57:14 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:57:17 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 17:57:17 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 17:57:17 | INFO     | api.app:initialize_game:634 - Generated session ID: d2a794e6-1577-4730-898a-bcd0e337dfd4
2024-12-25 17:57:17 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 17:57:17 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 17:57:17 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 17:57:17 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 17:57:17 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 17:57:17 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 652623be-2b45-4cce-acda-c2c040f7616b
2024-12-25 17:57:17 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 652623be-2b45-4cce-acda-c2c040f7616b
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\states
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\traces
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\characters
2024-12-25 17:57:17 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 652623be-2b45-4cce-acda-c2c040f7616b
2024-12-25 17:57:17 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 17:57:17 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 17:57:17 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 17:57:17 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 17:57:17 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 17:57:17 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 17:57:17 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 17:57:17 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 17:57:17 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 17:57:17 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 17:57:17 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='d2a794e6-1577-4730-898a-bcd0e337dfd4' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 17:57:17 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\states\section_1.json
2024-12-25 17:57:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\states\section_1.json
2024-12-25 17:57:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\states\section_1.json
2024-12-25 17:57:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 17:57:17 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 17:57:17 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 17:57:17 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='d2a794e6-1577-4730-898a-bcd0e337dfd4' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 17:57:17 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 17:57:17 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 17:57:17 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 17:57:17 | DEBUG    | managers.workflow_manager:start_workflow:210 - No state provided, creating initial state
2024-12-25 17:57:17 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session '652623be-2b45-4cce-acda-c2c040f7616b'
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\characters\current.json
2024-12-25 17:57:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\characters\current.json
2024-12-25 17:57:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\characters\current.json
2024-12-25 17:57:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-25 17:57:17 | DEBUG    | managers.state_manager:create_initial_state:298 - Initial state created: section=1, session=652623be-2b45-4cce-acda-c2c040f7616b
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\states\section_1.json
2024-12-25 17:57:17 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\states\section_1.json
2024-12-25 17:57:17 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\states\section_1.json
2024-12-25 17:57:17 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 17:57:17 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: session_id='652623be-2b45-4cce-acda-c2c040f7616b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 17:57:17 | DEBUG    | managers.workflow_manager:start_workflow:230 - Returning output: session_id='652623be-2b45-4cce-acda-c2c040f7616b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None
2024-12-25 17:57:17 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '652623be-2b45-4cce-acda-c2c040f7616b'}}
2024-12-25 17:57:17 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 17:57:17 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 17:57:17 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 17:57:17 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 17:57:17 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 17:57:17 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 17:57:17 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 17:57:17 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 17:57:17 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 17:57:17 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 17:57:17 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 17:57:17 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 17:57:17 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 17:57:17 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 17:57:17 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 17:57:17 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 17:57:17 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 17:57:17 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 17:57:17 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 17:57:17 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 17:57:17 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 17:57:17 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394))}}
2024-12-25 17:57:17 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 25, 17, 57, 17, 690411), last_update=datetime.datetime(2024, 12, 25, 17, 57, 17, 690424))}}
2024-12-25 17:57:17 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: StoryGraph._process_decision() missing 1 required positional argument: 'narrative_output'
2024-12-25 17:57:17 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: StoryGraph._process_decision() missing 1 required positional argument: 'narrative_output'
2024-12-25 17:57:17 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: StoryGraph._process_decision() missing 1 required positional argument: 'narrative_output'
2024-12-25 17:57:17 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: StoryGraph._process_decision() missing 1 required positional argument: 'narrative_output'
2024-12-25 17:58:18 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:58:18 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:58:18 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:58:18 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 17:58:18 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 17:58:18 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 17:58:18 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\states\current_state.json
2024-12-25 17:58:18 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\states\current_state.json
2024-12-25 17:58:18 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\652623be-2b45-4cce-acda-c2c040f7616b\states\current_state.json
2024-12-25 17:58:18 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 17:58:18 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 17:58:18 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 17:58:18 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 17:58:18 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:58:19 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:58:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:58:22 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:58:22 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:58:22 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:58:22 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:58:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:58:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:58:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:58:22 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:58:22 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:58:22 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:58:22 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:58:22 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:58:22 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:58:22 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:58:22 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:58:22 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:58:22 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:58:22 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:58:22 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:58:22 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:58:23 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:58:23 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:58:23 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:58:23 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:58:23 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:58:23 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:58:23 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:58:23 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:58:23 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:58:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:58:26 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:58:26 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:58:26 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:58:26 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:58:26 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:58:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:58:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:58:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:58:26 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:58:26 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:58:26 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:58:26 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:58:26 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:58:26 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:58:26 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:58:26 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:58:26 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:58:26 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:58:26 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:58:26 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:58:26 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:58:27 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:58:27 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:58:27 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:58:27 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:59:52 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 17:59:52 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 17:59:52 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 17:59:52 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 17:59:52 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 17:59:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:59:55 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 17:59:55 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 17:59:55 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 17:59:55 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 17:59:55 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:59:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 17:59:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 17:59:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 17:59:55 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 17:59:55 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:59:55 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 17:59:55 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 17:59:55 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 17:59:55 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 17:59:55 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 17:59:55 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 17:59:55 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 17:59:55 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 17:59:55 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 17:59:55 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 17:59:55 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 17:59:56 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 17:59:56 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 17:59:56 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 17:59:56 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 17:59:56 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 17:59:56 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 17:59:56 | INFO     | api.app:initialize_game:634 - Generated session ID: 645e0566-d02a-44bf-ad4f-7c8437afda0f
2024-12-25 17:59:56 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 17:59:56 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 17:59:56 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 17:59:56 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 17:59:56 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 17:59:56 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 61943397-3e44-43ff-8fed-a31457ff1259
2024-12-25 17:59:56 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 61943397-3e44-43ff-8fed-a31457ff1259
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\traces
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\characters
2024-12-25 17:59:56 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 61943397-3e44-43ff-8fed-a31457ff1259
2024-12-25 17:59:56 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 17:59:56 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 17:59:56 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 17:59:56 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 17:59:56 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 17:59:56 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 17:59:56 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 17:59:56 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 17:59:56 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 17:59:56 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='645e0566-d02a-44bf-ad4f-7c8437afda0f' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\section_1.json
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\section_1.json
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\section_1.json
2024-12-25 17:59:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 17:59:56 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 17:59:56 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='645e0566-d02a-44bf-ad4f-7c8437afda0f' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 17:59:56 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:start_workflow:210 - No state provided, creating initial state
2024-12-25 17:59:56 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session '61943397-3e44-43ff-8fed-a31457ff1259'
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\characters\current.json
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\characters\current.json
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\characters\current.json
2024-12-25 17:59:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-25 17:59:56 | DEBUG    | managers.state_manager:create_initial_state:298 - Initial state created: section=1, session=61943397-3e44-43ff-8fed-a31457ff1259
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\section_1.json
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\section_1.json
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\section_1.json
2024-12-25 17:59:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: session_id='61943397-3e44-43ff-8fed-a31457ff1259' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:start_workflow:230 - Returning output: session_id='61943397-3e44-43ff-8fed-a31457ff1259' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '61943397-3e44-43ff-8fed-a31457ff1259'}}
2024-12-25 17:59:56 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 17:59:56 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 17:59:56 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 17:59:56 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 17:59:56 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 17:59:56 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 17:59:56 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 17:59:56 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 17:59:56 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 17:59:56 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 17:59:56 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 17:59:56 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 17:59:56 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 17:59:56 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 17:59:56 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 17:59:56 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394))}}
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 25, 17, 59, 56, 171870), last_update=datetime.datetime(2024, 12, 25, 17, 59, 56, 171881))}}
2024-12-25 17:59:56 | INFO     | agents.story_graph:_process_decision:164 - Processing decision with merged state
2024-12-25 17:59:56 | ERROR    | agents.story_graph:_process_decision:198 - Error processing decision: 'GameStateInput' object has no attribute 'rules'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1832)
                                      │           └ <function spawn_main at 0x00000236B95C0860>
                                      └ <function spawn_main at 0x00000236B95C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 188
               │     └ 3
               └ <function _main at 0x00000236B95C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 188
           │    └ <function BaseProcess._bootstrap at 0x00000236B9506A20>
           └ <SpawnProcess name='SpawnProcess-26' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000236B9505F80>
    └ <SpawnProcess name='SpawnProcess-26' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000236BF304D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-26' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-26' parent=39512 started>
    │    └ <function subprocess_started at 0x00000236BF2FEF20>
    └ <SpawnProcess name='SpawnProcess-26' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=1020, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000236BF304EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=1020, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000236BF2FE200>
           │       │   └ <uvicorn.server.Server object at 0x00000236BF304EC0>
           │       └ <function run at 0x00000236B9A063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000236BF2F9A80>
           │      └ <function Runner.run at 0x00000236B9A704A0>
           └ <asyncio.runners.Runner object at 0x00000236BF305940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000236B9A69E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000236BF305940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000236B9A69DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000236B9A6BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000236B99ED3A0>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000236BF34F040>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000236BF34F040>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000236BF34F040>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000236BF34F040>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 167, in _process_decision
    rules_data = state.rules
                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'rules'
                                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

AttributeError: 'GameStateInput' object has no attribute 'rules'
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_decision': {'session_id': '', 'error': "'GameStateInput' object has no attribute 'rules'"}}
2024-12-25 17:59:56 | ERROR    | managers.workflow_manager:end_workflow:267 - Error in end node: 'GameStateInput' object has no attribute 'state'
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 17:59:56 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\section_1.json
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\section_1.json
2024-12-25 17:59:56 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\section_1.json
2024-12-25 17:59:56 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 17:59:56 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_end': {'session_id': 'f27f75a7-d26f-420a-b664-918542345b68', 'error': "'GameStateInput' object has no attribute 'state'"}}
2024-12-25 17:59:56 | ERROR    | managers.workflow_manager:execute_workflow:185 - No valid result from workflow
2024-12-25 17:59:56 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: No valid result from workflow execution
2024-12-25 17:59:56 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: No valid result from workflow execution
2024-12-25 17:59:56 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 17:59:56 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:03:06 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:03:06 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:03:06 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:03:06 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 18:03:06 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 18:03:06 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 18:03:06 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\current_state.json
2024-12-25 18:03:06 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\current_state.json
2024-12-25 18:03:06 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\61943397-3e44-43ff-8fed-a31457ff1259\states\current_state.json
2024-12-25 18:03:06 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 18:03:06 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 18:03:06 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 18:03:06 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 18:03:06 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:03:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:03:45 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:03:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:03:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:03:51 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:03:51 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:03:51 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:03:51 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:03:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:03:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:03:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:03:51 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:03:51 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:03:51 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:03:51 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:03:51 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:03:51 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:03:51 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:03:51 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:03:51 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:03:51 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:03:51 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:03:51 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:03:51 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:03:52 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:03:52 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:03:52 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:03:52 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:03:52 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 18:03:52 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 18:03:52 | INFO     | api.app:initialize_game:634 - Generated session ID: f3ad5595-64fa-44d4-bb00-90cf3a2a738d
2024-12-25 18:03:52 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 18:03:52 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 18:03:52 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 18:03:52 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 18:03:52 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 18:03:52 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 048b2879-3261-493b-81e0-494a1e777022
2024-12-25 18:03:52 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 048b2879-3261-493b-81e0-494a1e777022
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\048b2879-3261-493b-81e0-494a1e777022\traces
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\048b2879-3261-493b-81e0-494a1e777022\characters
2024-12-25 18:03:52 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 048b2879-3261-493b-81e0-494a1e777022
2024-12-25 18:03:52 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 18:03:52 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 18:03:52 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 18:03:52 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 18:03:52 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 18:03:52 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 18:03:52 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 18:03:52 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 18:03:52 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 18:03:52 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='f3ad5595-64fa-44d4-bb00-90cf3a2a738d' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:03:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:03:52 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 18:03:52 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='f3ad5595-64fa-44d4-bb00-90cf3a2a738d' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 18:03:52 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:start_workflow:210 - No state provided, creating initial state
2024-12-25 18:03:52 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session '048b2879-3261-493b-81e0-494a1e777022'
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\characters\current.json
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\characters\current.json
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\characters\current.json
2024-12-25 18:03:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-25 18:03:52 | DEBUG    | managers.state_manager:create_initial_state:298 - Initial state created: section=1, session=048b2879-3261-493b-81e0-494a1e777022
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:03:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: session_id='048b2879-3261-493b-81e0-494a1e777022' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:start_workflow:230 - Returning output: session_id='048b2879-3261-493b-81e0-494a1e777022' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '048b2879-3261-493b-81e0-494a1e777022'}}
2024-12-25 18:03:52 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 18:03:52 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 18:03:52 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 18:03:52 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 18:03:52 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 18:03:52 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 18:03:52 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 18:03:52 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 18:03:52 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 18:03:52 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 18:03:52 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 18:03:52 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 18:03:52 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 18:03:52 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 18:03:52 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 18:03:52 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394))}}
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 25, 18, 3, 52, 695418), last_update=datetime.datetime(2024, 12, 25, 18, 3, 52, 695466))}}
2024-12-25 18:03:52 | INFO     | agents.story_graph:_process_decision:164 - Processing decision with merged state
2024-12-25 18:03:52 | ERROR    | agents.story_graph:_process_decision:198 - Error processing decision: 'GameStateInput' object has no attribute 'rules'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=2492)
                                      │           └ <function spawn_main at 0x00000219522C0860>
                                      └ <function spawn_main at 0x00000219522C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 616
               │     └ 3
               └ <function _main at 0x00000219522C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 616
           │    └ <function BaseProcess._bootstrap at 0x0000021952206A20>
           └ <SpawnProcess name='SpawnProcess-29' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000021952205F80>
    └ <SpawnProcess name='SpawnProcess-29' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000021958304D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-29' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-29' parent=39512 started>
    │    └ <function subprocess_started at 0x00000219582FEF20>
    └ <SpawnProcess name='SpawnProcess-29' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=808, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000021958304EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=808, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000219582FE200>
           │       │   └ <uvicorn.server.Server object at 0x0000021958304EC0>
           │       └ <function run at 0x00000219528063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000219582F9A80>
           │      └ <function Runner.run at 0x00000219528704A0>
           └ <asyncio.runners.Runner object at 0x0000021958305940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000021952869E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000021958305940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000021952869DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002195286BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000219527ED3A0>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000219584C95D0>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000219584C95D0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000219584C95D0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000219584C95D0>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 167, in _process_decision
    rules_data = state.rules
                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'rules'
                                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

AttributeError: 'GameStateInput' object has no attribute 'rules'
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_decision': {'session_id': '', 'error': "'GameStateInput' object has no attribute 'rules'"}}
2024-12-25 18:03:52 | ERROR    | managers.workflow_manager:end_workflow:267 - Error in end node: 'GameStateInput' object has no attribute 'state'
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:03:52 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:03:52 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:03:52 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:03:52 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_end': {'session_id': 'c5d536af-6475-4658-9696-7aef0c016130', 'error': "'GameStateInput' object has no attribute 'state'"}}
2024-12-25 18:03:52 | ERROR    | managers.workflow_manager:execute_workflow:185 - No valid result from workflow
2024-12-25 18:03:52 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: No valid result from workflow execution
2024-12-25 18:03:52 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:03:52 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:03:52 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:04:44 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 18:04:44 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 18:04:44 | INFO     | api.app:initialize_game:634 - Generated session ID: 73dbcb8f-2f52-4c76-af08-8439b138adab
2024-12-25 18:04:44 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 18:04:44 | DEBUG    | managers.agent_manager:initialize:298 - AgentManager already initialized
2024-12-25 18:04:44 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 18:04:44 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 18:04:44 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 18:04:44 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 18:04:44 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 18:04:44 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 18:04:44 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 18:04:44 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 18:04:44 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='73dbcb8f-2f52-4c76-af08-8439b138adab' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:04:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:04:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:04:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:04:44 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 18:04:44 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='73dbcb8f-2f52-4c76-af08-8439b138adab' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 18:04:44 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:start_workflow:210 - No state provided, creating initial state
2024-12-25 18:04:44 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session '048b2879-3261-493b-81e0-494a1e777022'
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\characters\current.json
2024-12-25 18:04:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\characters\current.json
2024-12-25 18:04:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\characters\current.json
2024-12-25 18:04:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-25 18:04:44 | DEBUG    | managers.state_manager:create_initial_state:298 - Initial state created: section=1, session=048b2879-3261-493b-81e0-494a1e777022
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:04:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:04:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:04:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: session_id='048b2879-3261-493b-81e0-494a1e777022' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:start_workflow:230 - Returning output: session_id='048b2879-3261-493b-81e0-494a1e777022' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '048b2879-3261-493b-81e0-494a1e777022'}}
2024-12-25 18:04:44 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 18:04:44 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 18:04:44 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 18:04:44 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 18:04:44 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 18:04:44 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 18:04:44 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 18:04:44 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 18:04:44 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 18:04:44 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 18:04:44 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 18:04:44 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-25 18:04:44 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 18:04:44 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 18:04:44 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 18:04:44 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394))}}
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 25, 18, 4, 44, 965557), last_update=datetime.datetime(2024, 12, 25, 18, 4, 44, 965568))}}
2024-12-25 18:04:44 | INFO     | agents.story_graph:_process_decision:164 - Processing decision with merged state
2024-12-25 18:04:44 | ERROR    | agents.story_graph:_process_decision:198 - Error processing decision: 'GameStateInput' object has no attribute 'rules'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=2492)
                                      │           └ <function spawn_main at 0x00000219522C0860>
                                      └ <function spawn_main at 0x00000219522C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 616
               │     └ 3
               └ <function _main at 0x00000219522C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 616
           │    └ <function BaseProcess._bootstrap at 0x0000021952206A20>
           └ <SpawnProcess name='SpawnProcess-29' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000021952205F80>
    └ <SpawnProcess name='SpawnProcess-29' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000021958304D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-29' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-29' parent=39512 started>
    │    └ <function subprocess_started at 0x00000219582FEF20>
    └ <SpawnProcess name='SpawnProcess-29' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=808, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000021958304EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=808, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000219582FE200>
           │       │   └ <uvicorn.server.Server object at 0x0000021958304EC0>
           │       └ <function run at 0x00000219528063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000219582F9A80>
           │      └ <function Runner.run at 0x00000219528704A0>
           └ <asyncio.runners.Runner object at 0x0000021958305940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000021952869E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000021958305940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000021952869DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002195286BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000219527ED3A0>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000021958469F30>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000021958469F30>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000021958469F30>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x0000021958469F30>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 167, in _process_decision
    rules_data = state.rules
                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'rules'
                                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

AttributeError: 'GameStateInput' object has no attribute 'rules'
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_decision': {'session_id': '', 'error': "'GameStateInput' object has no attribute 'rules'"}}
2024-12-25 18:04:44 | ERROR    | managers.workflow_manager:end_workflow:267 - Error in end node: 'GameStateInput' object has no attribute 'state'
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:04:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:04:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:04:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\section_1.json
2024-12-25 18:04:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:04:44 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_end': {'session_id': '85ad97c1-8457-41bb-8711-812619a341fd', 'error': "'GameStateInput' object has no attribute 'state'"}}
2024-12-25 18:04:45 | ERROR    | managers.workflow_manager:execute_workflow:185 - No valid result from workflow
2024-12-25 18:04:45 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: No valid result from workflow execution
2024-12-25 18:04:45 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:04:45 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:04:45 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:08:14 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:08:14 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:08:14 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:08:14 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 18:08:14 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 18:08:14 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 18:08:14 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\current_state.json
2024-12-25 18:08:14 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\current_state.json
2024-12-25 18:08:14 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\048b2879-3261-493b-81e0-494a1e777022\states\current_state.json
2024-12-25 18:08:14 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 18:08:14 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 18:08:14 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 18:08:14 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 18:08:14 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:08:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:08:19 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:08:19 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:08:19 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:08:19 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:08:19 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:08:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:08:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:08:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:08:19 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:08:19 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:08:19 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:08:19 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:08:19 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:08:19 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:08:19 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:08:19 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:08:19 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:08:19 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:08:19 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:08:19 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:08:19 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:08:20 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:08:20 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:08:20 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:08:20 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:09:53 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:09:53 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:09:53 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:09:53 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:09:53 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:09:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:09:58 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:09:58 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:09:58 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:09:58 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:09:58 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:09:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:09:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:09:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:09:58 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:09:58 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:09:58 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:09:58 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:09:58 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:09:58 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:09:58 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:09:58 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:09:58 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:09:58 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:09:58 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:09:58 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:09:58 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:09:58 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:09:58 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:09:58 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:09:58 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:10:00 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:10:00 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:10:00 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:10:00 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:10:00 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:10:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:10:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:10:04 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:10:04 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:10:04 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:10:04 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:10:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:10:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:10:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:10:04 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:10:04 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:10:04 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:10:04 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:10:04 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:10:04 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:10:04 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:10:04 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:10:04 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:10:04 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:10:04 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:10:04 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:10:04 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:10:05 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:10:05 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:10:05 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:10:05 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:10:06 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:10:06 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:10:06 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:10:06 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:10:06 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:10:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:10:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:10:09 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:10:09 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:10:09 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:10:09 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:10:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:10:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:10:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:10:09 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:10:09 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:10:09 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:10:09 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:10:09 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:10:09 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:10:09 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:10:09 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:10:09 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:10:09 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:10:09 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:10:09 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:10:09 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:10:10 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:10:10 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:10:10 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:10:10 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:10:10 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 18:10:10 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 18:10:10 | INFO     | api.app:initialize_game:634 - Generated session ID: d259ca65-fb94-4828-9ceb-cbf19c6e3ac1
2024-12-25 18:10:10 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 18:10:10 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 18:10:10 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 18:10:10 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 18:10:10 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 18:10:10 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 532c3ba7-e5b6-4559-ba26-6ffc5f0fea71
2024-12-25 18:10:10 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 532c3ba7-e5b6-4559-ba26-6ffc5f0fea71
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\traces
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\characters
2024-12-25 18:10:10 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 532c3ba7-e5b6-4559-ba26-6ffc5f0fea71
2024-12-25 18:10:10 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 18:10:10 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 18:10:10 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 18:10:10 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 18:10:10 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 18:10:10 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 18:10:10 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 18:10:10 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 18:10:10 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 18:10:10 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='d259ca65-fb94-4828-9ceb-cbf19c6e3ac1' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\section_1.json
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\section_1.json
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\section_1.json
2024-12-25 18:10:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:10:10 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 18:10:10 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='d259ca65-fb94-4828-9ceb-cbf19c6e3ac1' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 18:10:10 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:start_workflow:210 - No state provided, creating initial state
2024-12-25 18:10:10 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session '532c3ba7-e5b6-4559-ba26-6ffc5f0fea71'
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\characters\current.json
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\characters\current.json
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\characters\current.json
2024-12-25 18:10:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-25 18:10:10 | DEBUG    | managers.state_manager:create_initial_state:298 - Initial state created: section=1, session=532c3ba7-e5b6-4559-ba26-6ffc5f0fea71
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\section_1.json
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\section_1.json
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\section_1.json
2024-12-25 18:10:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: session_id='532c3ba7-e5b6-4559-ba26-6ffc5f0fea71' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:start_workflow:230 - Returning output: session_id='532c3ba7-e5b6-4559-ba26-6ffc5f0fea71' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '532c3ba7-e5b6-4559-ba26-6ffc5f0fea71'}}
2024-12-25 18:10:10 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 18:10:10 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 18:10:10 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 18:10:10 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 18:10:10 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 18:10:10 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 18:10:10 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 18:10:10 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 18:10:10 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 18:10:10 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 18:10:10 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 18:10:10 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 18:10:10 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 18:10:10 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 18:10:10 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 18:10:10 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394))}}
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 25, 18, 10, 10, 584146), last_update=datetime.datetime(2024, 12, 25, 18, 10, 10, 584159))}}
2024-12-25 18:10:10 | INFO     | agents.story_graph:_process_decision:160 - Processing decision with merged state
2024-12-25 18:10:10 | ERROR    | agents.story_graph:_process_decision:177 - Error processing decision: 'GameStateInput' object has no attribute 'rules'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=2492)
                                      │           └ <function spawn_main at 0x00000237069C0860>
                                      └ <function spawn_main at 0x00000237069C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 632
               │     └ 3
               └ <function _main at 0x00000237069C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 632
           │    └ <function BaseProcess._bootstrap at 0x0000023706906A20>
           └ <SpawnProcess name='SpawnProcess-33' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000023706905F80>
    └ <SpawnProcess name='SpawnProcess-33' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002370C714AD0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-33' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-33' parent=39512 started>
    │    └ <function subprocess_started at 0x000002370C6FEF20>
    └ <SpawnProcess name='SpawnProcess-33' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=976, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002370C714C20>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=976, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002370C6FE200>
           │       │   └ <uvicorn.server.Server object at 0x000002370C714C20>
           │       └ <function run at 0x0000023706E063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000002370C6F9A80>
           │      └ <function Runner.run at 0x0000023706E704A0>
           └ <asyncio.runners.Runner object at 0x000002370C7156A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000023706E69E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002370C7156A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000023706E69DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x0000023706E6BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x0000023706DED3A0>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002370CA5DED0>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002370CA5DED0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002370CA5DED0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002370CA5DED0>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 163, in _process_decision
    if not state.rules or not state.narrative:
           │                  └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...
           └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'rules'
                                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

AttributeError: 'GameStateInput' object has no attribute 'rules'
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_decision': {'session_id': '', 'error': "'GameStateInput' object has no attribute 'rules'"}}
2024-12-25 18:10:10 | ERROR    | managers.workflow_manager:end_workflow:267 - Error in end node: 'GameStateInput' object has no attribute 'state'
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:10:10 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\section_1.json
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\section_1.json
2024-12-25 18:10:10 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\section_1.json
2024-12-25 18:10:10 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:10:10 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_end': {'session_id': 'fd4e4fe4-7f38-4b2f-aa18-7d24ee7a4598', 'error': "'GameStateInput' object has no attribute 'state'"}}
2024-12-25 18:10:10 | ERROR    | managers.workflow_manager:execute_workflow:185 - No valid result from workflow
2024-12-25 18:10:10 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: No valid result from workflow execution
2024-12-25 18:10:10 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:10:10 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:10:10 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:11:19 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:11:19 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:11:19 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:11:19 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 18:11:19 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 18:11:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 18:11:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\current_state.json
2024-12-25 18:11:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\current_state.json
2024-12-25 18:11:19 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\532c3ba7-e5b6-4559-ba26-6ffc5f0fea71\states\current_state.json
2024-12-25 18:11:19 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 18:11:19 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 18:11:19 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 18:11:19 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 18:11:19 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:11:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:11:23 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:11:23 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:11:23 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:11:23 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:11:23 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:11:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:11:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:11:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:11:23 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:11:23 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:11:23 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:11:23 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:11:23 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:11:23 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:11:23 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:11:23 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:11:23 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:11:23 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:11:23 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:11:23 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:11:23 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:11:24 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:11:24 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:11:24 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:11:24 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:11:26 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:11:26 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:11:26 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:11:26 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:11:26 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:11:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:11:30 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:11:30 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:11:30 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:11:30 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:11:30 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:11:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:11:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:11:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:11:30 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:11:30 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:11:30 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:11:30 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:11:30 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:11:30 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:11:30 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:11:30 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:11:30 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:11:30 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:11:30 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:11:30 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:11:30 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:11:32 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:11:32 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:11:32 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:11:32 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:11:40 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:11:40 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:11:40 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:11:40 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:11:40 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:11:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:11:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:11:44 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:11:44 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:11:44 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:11:44 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:11:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:11:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:11:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:11:44 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:11:44 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:11:44 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:11:44 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:11:44 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:11:44 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:11:44 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:11:44 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:11:44 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:11:44 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:11:44 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:11:44 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:11:44 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:11:44 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:11:44 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:11:44 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:11:44 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:35:20 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:35:20 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:35:20 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:35:20 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:35:20 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:35:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:35:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:35:25 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:35:25 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:35:25 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:35:25 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:35:25 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:35:25 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:35:25 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:35:25 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:35:25 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:35:25 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:35:25 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:35:25 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:35:25 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:35:25 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:35:25 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:35:26 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:35:26 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:35:26 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:35:26 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:36:26 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 18:36:26 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 18:36:26 | INFO     | api.app:initialize_game:634 - Generated session ID: ab45f049-e652-4f1e-8c5e-71948fc0149c
2024-12-25 18:36:26 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 18:36:26 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 18:36:26 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 18:36:26 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 18:36:26 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 18:36:26 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 9160d9b8-ceab-4b76-b9bb-f91b092dda0c
2024-12-25 18:36:26 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 9160d9b8-ceab-4b76-b9bb-f91b092dda0c
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\traces
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\characters
2024-12-25 18:36:26 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 9160d9b8-ceab-4b76-b9bb-f91b092dda0c
2024-12-25 18:36:26 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 18:36:26 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 18:36:26 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 18:36:26 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 18:36:26 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 18:36:26 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 18:36:26 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 18:36:26 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 18:36:26 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 18:36:26 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='ab45f049-e652-4f1e-8c5e-71948fc0149c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:36:26 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 18:36:26 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='ab45f049-e652-4f1e-8c5e-71948fc0149c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 18:36:26 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:start_workflow:210 - No state provided, creating initial state
2024-12-25 18:36:26 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session '9160d9b8-ceab-4b76-b9bb-f91b092dda0c'
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\characters\current.json
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\characters\current.json
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\characters\current.json
2024-12-25 18:36:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-25 18:36:26 | DEBUG    | managers.state_manager:create_initial_state:298 - Initial state created: section=1, session=9160d9b8-ceab-4b76-b9bb-f91b092dda0c
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: session_id='9160d9b8-ceab-4b76-b9bb-f91b092dda0c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:start_workflow:230 - Returning output: session_id='9160d9b8-ceab-4b76-b9bb-f91b092dda0c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '9160d9b8-ceab-4b76-b9bb-f91b092dda0c'}}
2024-12-25 18:36:26 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 18:36:26 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 18:36:26 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 18:36:26 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 18:36:26 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 18:36:26 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 18:36:26 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 18:36:26 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 18:36:26 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 18:36:26 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 18:36:26 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 18:36:26 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 18:36:26 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 18:36:26 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 18:36:26 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 18:36:26 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394))}}
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 25, 18, 36, 26, 443140), last_update=datetime.datetime(2024, 12, 25, 18, 36, 26, 443154))}}
2024-12-25 18:36:26 | INFO     | agents.story_graph:_process_decision:164 - Processing decision with merged state
2024-12-25 18:36:26 | ERROR    | agents.story_graph:_process_decision:198 - Error processing decision: 'GameStateInput' object has no attribute 'rules'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=2808)
                                      │           └ <function spawn_main at 0x0000024024EC0860>
                                      └ <function spawn_main at 0x0000024024EC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 600
               │     └ 3
               └ <function _main at 0x0000024024EC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 600
           │    └ <function BaseProcess._bootstrap at 0x0000024024E06A20>
           └ <SpawnProcess name='SpawnProcess-37' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000024024E05F80>
    └ <SpawnProcess name='SpawnProcess-37' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002402AD14AD0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-37' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-37' parent=39512 started>
    │    └ <function subprocess_started at 0x000002402AD02F20>
    └ <SpawnProcess name='SpawnProcess-37' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=840, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002402AD14C20>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=840, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002402AD02200>
           │       │   └ <uvicorn.server.Server object at 0x000002402AD14C20>
           │       └ <function run at 0x00000240253063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000002402ACF9A80>
           │      └ <function Runner.run at 0x00000240253704A0>
           └ <asyncio.runners.Runner object at 0x000002402AD156A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000024025369E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002402AD156A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000024025369DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002402536BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000240252ED3A0>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002402ADC6440>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002402ADC6440>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002402ADC6440>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002402ADC6440>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 167, in _process_decision
    rules_data = state.rules
                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'rules'
                                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

AttributeError: 'GameStateInput' object has no attribute 'rules'
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_decision': {'session_id': '', 'error': "'GameStateInput' object has no attribute 'rules'"}}
2024-12-25 18:36:26 | ERROR    | managers.workflow_manager:end_workflow:267 - Error in end node: 'GameStateInput' object has no attribute 'state'
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:36:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:36:26 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_end': {'session_id': 'b9aa2c93-ff43-4aa8-bbf2-3d770e49143f', 'error': "'GameStateInput' object has no attribute 'state'"}}
2024-12-25 18:36:26 | ERROR    | managers.workflow_manager:execute_workflow:185 - No valid result from workflow
2024-12-25 18:36:26 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: No valid result from workflow execution
2024-12-25 18:36:26 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:36:26 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:36:26 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:36:29 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 18:36:29 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 18:36:29 | INFO     | api.app:initialize_game:634 - Generated session ID: 63b60c71-0905-46a9-9af8-1e296dcd702d
2024-12-25 18:36:29 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 18:36:29 | DEBUG    | managers.agent_manager:initialize:298 - AgentManager already initialized
2024-12-25 18:36:29 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 18:36:29 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 18:36:29 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 18:36:29 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 18:36:29 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 18:36:29 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 18:36:29 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 18:36:29 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 18:36:29 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='63b60c71-0905-46a9-9af8-1e296dcd702d' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:36:29 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 18:36:29 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='63b60c71-0905-46a9-9af8-1e296dcd702d' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 18:36:29 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:start_workflow:210 - No state provided, creating initial state
2024-12-25 18:36:29 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session '9160d9b8-ceab-4b76-b9bb-f91b092dda0c'
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\characters\current.json
2024-12-25 18:36:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\characters\current.json
2024-12-25 18:36:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\characters\current.json
2024-12-25 18:36:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-25 18:36:29 | DEBUG    | managers.state_manager:create_initial_state:298 - Initial state created: section=1, session=9160d9b8-ceab-4b76-b9bb-f91b092dda0c
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: session_id='9160d9b8-ceab-4b76-b9bb-f91b092dda0c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:start_workflow:230 - Returning output: session_id='9160d9b8-ceab-4b76-b9bb-f91b092dda0c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '9160d9b8-ceab-4b76-b9bb-f91b092dda0c'}}
2024-12-25 18:36:29 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 18:36:29 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 18:36:29 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 18:36:29 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 18:36:29 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 18:36:29 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 18:36:29 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 18:36:29 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 18:36:29 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 18:36:29 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 18:36:29 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 18:36:29 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-25 18:36:29 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 18:36:29 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 18:36:29 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 18:36:29 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394))}}
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 25, 18, 36, 29, 479133), last_update=datetime.datetime(2024, 12, 25, 18, 36, 29, 479170))}}
2024-12-25 18:36:29 | INFO     | agents.story_graph:_process_decision:164 - Processing decision with merged state
2024-12-25 18:36:29 | ERROR    | agents.story_graph:_process_decision:198 - Error processing decision: 'GameStateInput' object has no attribute 'rules'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=2808)
                                      │           └ <function spawn_main at 0x0000024024EC0860>
                                      └ <function spawn_main at 0x0000024024EC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 600
               │     └ 3
               └ <function _main at 0x0000024024EC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 600
           │    └ <function BaseProcess._bootstrap at 0x0000024024E06A20>
           └ <SpawnProcess name='SpawnProcess-37' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000024024E05F80>
    └ <SpawnProcess name='SpawnProcess-37' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002402AD14AD0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-37' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-37' parent=39512 started>
    │    └ <function subprocess_started at 0x000002402AD02F20>
    └ <SpawnProcess name='SpawnProcess-37' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=840, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002402AD14C20>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=840, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002402AD02200>
           │       │   └ <uvicorn.server.Server object at 0x000002402AD14C20>
           │       └ <function run at 0x00000240253063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000002402ACF9A80>
           │      └ <function Runner.run at 0x00000240253704A0>
           └ <asyncio.runners.Runner object at 0x000002402AD156A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000024025369E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002402AD156A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000024025369DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002402536BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000240252ED3A0>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002402B0CF970>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002402B0CF970>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002402B0CF970>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002402B0CF970>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 167, in _process_decision
    rules_data = state.rules
                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'rules'
                                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

AttributeError: 'GameStateInput' object has no attribute 'rules'
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_decision': {'session_id': '', 'error': "'GameStateInput' object has no attribute 'rules'"}}
2024-12-25 18:36:29 | ERROR    | managers.workflow_manager:end_workflow:267 - Error in end node: 'GameStateInput' object has no attribute 'state'
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:36:29 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:29 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:29 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\section_1.json
2024-12-25 18:36:29 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:36:29 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_end': {'session_id': '659d4bc9-6140-4c16-9766-fbdafb75cb6f', 'error': "'GameStateInput' object has no attribute 'state'"}}
2024-12-25 18:36:29 | ERROR    | managers.workflow_manager:execute_workflow:185 - No valid result from workflow
2024-12-25 18:36:29 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: No valid result from workflow execution
2024-12-25 18:36:29 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:36:29 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:36:29 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:38:46 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:38:46 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:38:46 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:38:46 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 18:38:46 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 18:38:46 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 18:38:46 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\current_state.json
2024-12-25 18:38:46 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\current_state.json
2024-12-25 18:38:46 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\9160d9b8-ceab-4b76-b9bb-f91b092dda0c\states\current_state.json
2024-12-25 18:38:46 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 18:38:46 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 18:38:46 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 18:38:46 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 18:38:46 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:38:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:38:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:38:50 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:38:50 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:38:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:38:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:38:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:38:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:38:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:38:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:38:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:38:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:38:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:38:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:38:50 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:38:50 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:38:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:38:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:38:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:38:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:38:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:38:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:38:51 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:38:51 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:38:51 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:38:51 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:46:49 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:46:49 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:46:49 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:46:49 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:46:49 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:46:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:46:53 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:46:53 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:46:53 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:46:53 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:46:53 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:46:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:46:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:46:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:46:53 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:46:53 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:46:53 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:46:53 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:46:53 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:46:53 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:46:53 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:46:53 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:46:53 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:46:53 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:46:53 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:46:53 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:46:53 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:46:53 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:46:53 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:46:53 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:46:53 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:46:53 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 18:46:53 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 18:46:53 | INFO     | api.app:initialize_game:634 - Generated session ID: d6f8f74e-27ec-418f-b2b4-224f8c8f86bb
2024-12-25 18:46:53 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 18:46:53 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 18:46:53 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 18:46:53 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 18:46:53 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 18:46:53 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 95d413ec-4124-4d83-b3df-6fe8e0a456d9
2024-12-25 18:46:53 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 95d413ec-4124-4d83-b3df-6fe8e0a456d9
2024-12-25 18:46:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\95d413ec-4124-4d83-b3df-6fe8e0a456d9\states
2024-12-25 18:46:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\95d413ec-4124-4d83-b3df-6fe8e0a456d9\traces
2024-12-25 18:46:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\95d413ec-4124-4d83-b3df-6fe8e0a456d9\characters
2024-12-25 18:46:53 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 95d413ec-4124-4d83-b3df-6fe8e0a456d9
2024-12-25 18:46:53 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 18:46:53 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 18:46:53 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 18:46:53 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 18:46:53 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 18:46:53 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 18:46:53 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 18:46:53 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 18:46:53 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 18:46:53 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 18:46:53 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='d6f8f74e-27ec-418f-b2b4-224f8c8f86bb' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None state=<property object at 0x000002080D49BD80> section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:46:53 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 18:46:53 | ERROR    | managers.state_manager:_serialize_state:115 - Error serializing state: Type <class 'property'> not serializable
2024-12-25 18:46:53 | ERROR    | managers.state_manager:_persist_state:162 - Error persisting state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:46:53 | ERROR    | managers.state_manager:save_state:187 - Error saving state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:46:53 | ERROR    | managers.workflow_manager:initialize_workflow:293 - Error initializing workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:46:53 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to initialize workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:46:53 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to initialize workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:46:53 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to initialize workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:49:03 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:49:03 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:49:03 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:49:03 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 18:49:03 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 18:49:03 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 18:49:03 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\95d413ec-4124-4d83-b3df-6fe8e0a456d9\states\current_state.json
2024-12-25 18:49:03 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\95d413ec-4124-4d83-b3df-6fe8e0a456d9\states\current_state.json
2024-12-25 18:49:03 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\95d413ec-4124-4d83-b3df-6fe8e0a456d9\states\current_state.json
2024-12-25 18:49:03 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 18:49:03 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 18:49:03 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 18:49:03 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 18:49:03 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:49:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:49:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:49:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:49:09 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:49:09 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:49:09 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:49:09 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:49:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:49:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:49:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:49:09 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:49:09 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:49:09 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:49:09 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:49:09 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:49:09 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:49:09 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:49:09 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:49:09 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:49:09 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:49:09 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:49:09 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:49:09 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:49:10 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:49:10 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:49:10 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:49:10 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:49:11 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:49:11 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:49:11 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:49:11 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:49:11 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:49:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:49:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:49:13 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:49:13 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:49:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:49:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:49:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:49:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:49:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:49:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:49:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:49:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:49:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:49:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:49:13 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:49:13 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:49:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:49:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:49:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:49:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:49:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:49:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:49:14 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:49:14 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:49:14 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:49:14 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:49:53 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:49:53 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:49:53 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:49:53 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:49:53 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:49:53 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:49:55 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:49:55 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:49:55 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:49:55 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:49:55 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:49:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:49:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:49:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:49:55 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:49:55 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:49:55 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:49:55 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:49:55 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:49:55 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:49:55 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:49:55 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:49:55 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:49:55 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:49:55 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:49:55 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:49:55 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:49:56 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:49:56 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:49:56 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:49:56 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:54:18 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:54:18 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:54:18 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:54:18 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:54:18 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:54:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:54:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:54:26 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:54:26 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:54:26 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:54:26 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:54:26 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:54:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:54:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:54:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:54:26 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:54:26 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:54:26 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:54:26 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:54:26 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:54:26 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:54:26 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:54:26 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:54:26 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:54:26 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:54:26 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:54:26 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:54:26 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:54:26 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:54:26 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:54:26 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:54:26 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:54:28 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:54:28 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:54:28 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:54:28 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:54:28 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:54:29 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:55:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:55:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:55:04 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:55:04 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:55:04 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:55:04 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:55:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:55:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:55:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:55:04 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:55:04 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:55:04 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:55:04 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:55:04 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:55:04 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:55:04 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:55:04 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:55:04 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:55:04 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:55:04 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:55:04 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:55:04 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:55:05 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:55:05 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:55:05 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:55:05 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:55:31 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:55:31 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:55:31 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:55:31 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:55:31 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:55:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:55:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:55:35 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:55:35 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:55:35 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:55:35 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:55:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:55:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:55:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:55:35 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:55:35 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:55:35 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:55:35 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:55:35 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:55:35 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:55:35 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:55:35 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:55:35 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:55:35 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:55:35 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:55:35 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:55:35 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:55:36 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:55:36 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:55:36 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:55:36 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:56:01 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:56:01 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:56:01 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:56:01 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:56:01 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:56:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:56:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:56:04 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:56:04 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:56:04 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:56:04 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:56:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:56:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:56:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:56:04 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:56:04 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:56:04 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:56:04 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:56:04 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:56:04 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:56:04 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:56:04 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:56:04 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:56:04 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:56:04 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:56:04 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:56:04 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:56:05 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:56:05 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:56:05 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:56:05 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:56:06 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 18:56:06 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 18:56:06 | INFO     | api.app:initialize_game:634 - Generated session ID: 9a2ec026-82f9-41d1-9df3-db0c89f00683
2024-12-25 18:56:06 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 18:56:06 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 18:56:06 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 18:56:06 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 18:56:06 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 18:56:06 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 045f8acc-64eb-437e-b022-ce47cd3d445e
2024-12-25 18:56:06 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 045f8acc-64eb-437e-b022-ce47cd3d445e
2024-12-25 18:56:06 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\045f8acc-64eb-437e-b022-ce47cd3d445e\states
2024-12-25 18:56:06 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\045f8acc-64eb-437e-b022-ce47cd3d445e\traces
2024-12-25 18:56:06 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\045f8acc-64eb-437e-b022-ce47cd3d445e\characters
2024-12-25 18:56:06 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 045f8acc-64eb-437e-b022-ce47cd3d445e
2024-12-25 18:56:06 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 18:56:06 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 18:56:06 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 18:56:06 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 18:56:06 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 18:56:06 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 18:56:06 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 18:56:06 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 18:56:06 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 18:56:06 | INFO     | managers.workflow_manager:initialize_workflow:282 - Initializing workflow
2024-12-25 18:56:06 | DEBUG    | managers.workflow_manager:initialize_workflow:283 - Initial state: session_id='9a2ec026-82f9-41d1-9df3-db0c89f00683' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None state=<property object at 0x0000015A9239FCE0> section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:56:06 | DEBUG    | managers.workflow_manager:initialize_workflow:286 - Saving initial state
2024-12-25 18:56:06 | ERROR    | managers.state_manager:_serialize_state:115 - Error serializing state: Type <class 'property'> not serializable
2024-12-25 18:56:06 | ERROR    | managers.state_manager:_persist_state:162 - Error persisting state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:56:06 | ERROR    | managers.state_manager:save_state:187 - Error saving state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:56:06 | ERROR    | managers.workflow_manager:initialize_workflow:292 - Error initializing workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:56:06 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to initialize workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:56:06 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to initialize workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:56:06 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to initialize workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:56:09 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 18:56:09 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 18:56:09 | INFO     | api.app:initialize_game:634 - Generated session ID: dcc60aa4-4ae9-4684-b58a-70146c9ec920
2024-12-25 18:56:09 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 18:56:09 | DEBUG    | managers.agent_manager:initialize:298 - AgentManager already initialized
2024-12-25 18:56:09 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 18:56:09 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 18:56:09 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 18:56:09 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 18:56:09 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 18:56:09 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 18:56:09 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 18:56:09 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 18:56:09 | INFO     | managers.workflow_manager:initialize_workflow:282 - Initializing workflow
2024-12-25 18:56:09 | DEBUG    | managers.workflow_manager:initialize_workflow:283 - Initial state: session_id='dcc60aa4-4ae9-4684-b58a-70146c9ec920' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None state=<property object at 0x0000015A9239FCE0> section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:56:09 | DEBUG    | managers.workflow_manager:initialize_workflow:286 - Saving initial state
2024-12-25 18:56:09 | ERROR    | managers.state_manager:_serialize_state:115 - Error serializing state: Type <class 'property'> not serializable
2024-12-25 18:56:09 | ERROR    | managers.state_manager:_persist_state:162 - Error persisting state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:56:09 | ERROR    | managers.state_manager:save_state:187 - Error saving state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:56:09 | ERROR    | managers.workflow_manager:initialize_workflow:292 - Error initializing workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:56:09 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to initialize workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:56:09 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to initialize workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:56:09 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to initialize workflow: Failed to save state: Failed to persist state: Failed to serialize state: Type <class 'property'> not serializable
2024-12-25 18:57:15 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:57:15 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:57:15 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:57:15 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 18:57:15 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 18:57:15 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 18:57:15 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\045f8acc-64eb-437e-b022-ce47cd3d445e\states\current_state.json
2024-12-25 18:57:15 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\045f8acc-64eb-437e-b022-ce47cd3d445e\states\current_state.json
2024-12-25 18:57:15 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\045f8acc-64eb-437e-b022-ce47cd3d445e\states\current_state.json
2024-12-25 18:57:15 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 18:57:15 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 18:57:15 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 18:57:15 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 18:57:15 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:57:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:57:19 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:57:19 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:57:19 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:57:19 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:57:19 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:57:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:57:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:57:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:57:19 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:57:19 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:57:19 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:57:19 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:57:19 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:57:19 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:57:19 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:57:19 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:57:19 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:57:19 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:57:19 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:57:19 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:57:19 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:57:20 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:57:20 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:57:20 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:57:20 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:57:36 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:57:36 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:57:36 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:57:36 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:57:36 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:57:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:57:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:57:40 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:57:40 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:57:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:57:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:57:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:57:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:57:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:57:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:57:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:57:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:57:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:57:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:57:40 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:57:40 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:57:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:57:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:57:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:57:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:57:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:57:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:57:41 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:57:41 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:57:41 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:57:41 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:57:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:57:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:57:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:57:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:57:54 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:57:54 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:57:54 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:57:54 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:57:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:57:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:57:54 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:57:54 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:57:54 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:57:54 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:57:54 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:57:54 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:57:54 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:57:54 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:57:54 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:57:54 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:57:54 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:57:54 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:57:54 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:57:54 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:57:55 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:57:55 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:57:55 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:57:55 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:58:06 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:58:06 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:58:06 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:58:06 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:58:06 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:58:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:58:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:58:10 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:58:10 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:58:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:58:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:58:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:58:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:58:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:58:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:58:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:58:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:58:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:58:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:58:10 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:58:10 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:58:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:58:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:58:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:58:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:58:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:58:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:58:11 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:58:11 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:58:11 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:58:11 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:58:26 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:58:26 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:58:26 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:58:26 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 18:58:26 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:58:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:58:30 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:58:30 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:58:30 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:58:30 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:58:30 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:58:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:58:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:58:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:58:30 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:58:30 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:58:30 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:58:30 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:58:30 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:58:30 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:58:30 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:58:30 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:58:30 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:58:30 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:58:30 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:58:30 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:58:30 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:58:31 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:58:31 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:58:31 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:58:31 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 18:58:31 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 18:58:31 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 18:58:31 | INFO     | api.app:initialize_game:634 - Generated session ID: 2d693000-9227-43f6-937b-cc0bc3bed1a6
2024-12-25 18:58:31 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 18:58:31 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 18:58:31 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 18:58:31 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 18:58:31 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 18:58:31 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: a06952c5-7124-4593-99c4-747825989d6f
2024-12-25 18:58:31 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: a06952c5-7124-4593-99c4-747825989d6f
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\traces
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\characters
2024-12-25 18:58:31 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: a06952c5-7124-4593-99c4-747825989d6f
2024-12-25 18:58:31 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 18:58:31 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 18:58:31 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 18:58:31 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 18:58:31 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 18:58:31 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 18:58:31 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 18:58:31 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 18:58:31 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 18:58:31 | INFO     | managers.workflow_manager:initialize_workflow:282 - Initializing workflow
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:initialize_workflow:283 - Initial state: session_id='2d693000-9227-43f6-937b-cc0bc3bed1a6' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:initialize_workflow:286 - Saving initial state
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\section_1.json
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\section_1.json
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\section_1.json
2024-12-25 18:58:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:58:31 | INFO     | managers.workflow_manager:initialize_workflow:289 - Workflow initialization completed
2024-12-25 18:58:31 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='2d693000-9227-43f6-937b-cc0bc3bed1a6' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 18:58:31 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:start_workflow:210 - No state provided, creating initial state
2024-12-25 18:58:31 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session 'a06952c5-7124-4593-99c4-747825989d6f'
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\characters\current.json
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\characters\current.json
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\characters\current.json
2024-12-25 18:58:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-25 18:58:31 | DEBUG    | managers.state_manager:create_initial_state:298 - Initial state created: section=1, session=a06952c5-7124-4593-99c4-747825989d6f
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\section_1.json
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\section_1.json
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\section_1.json
2024-12-25 18:58:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: session_id='a06952c5-7124-4593-99c4-747825989d6f' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:start_workflow:230 - Returning output: session_id='a06952c5-7124-4593-99c4-747825989d6f' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': 'a06952c5-7124-4593-99c4-747825989d6f'}}
2024-12-25 18:58:31 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 18:58:31 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 18:58:31 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 18:58:31 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 18:58:31 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 18:58:31 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 18:58:31 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 18:58:31 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 18:58:31 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 18:58:31 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 18:58:31 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 18:58:31 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 18:58:31 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 18:58:31 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 18:58:31 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 18:58:31 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394))}}
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 25, 18, 58, 31, 429683), last_update=datetime.datetime(2024, 12, 25, 18, 58, 31, 429692))}}
2024-12-25 18:58:31 | INFO     | agents.story_graph:_process_decision:164 - Processing decision with merged state
2024-12-25 18:58:31 | ERROR    | agents.story_graph:_process_decision:198 - Error processing decision: 'GameStateInput' object has no attribute 'rules'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1344)
                                      │           └ <function spawn_main at 0x00000204603C0860>
                                      └ <function spawn_main at 0x00000204603C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 600
               │     └ 3
               └ <function _main at 0x00000204603C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 600
           │    └ <function BaseProcess._bootstrap at 0x0000020460306A20>
           └ <SpawnProcess name='SpawnProcess-56' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x0000020460305F80>
    └ <SpawnProcess name='SpawnProcess-56' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x0000020466304D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-56' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-56' parent=39512 started>
    │    └ <function subprocess_started at 0x00000204662FEF20>
    └ <SpawnProcess name='SpawnProcess-56' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=900, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x0000020466304EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=900, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000204662FE200>
           │       │   └ <uvicorn.server.Server object at 0x0000020466304EC0>
           │       └ <function run at 0x00000204608063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000204662F9A80>
           │      └ <function Runner.run at 0x00000204608704A0>
           └ <asyncio.runners.Runner object at 0x0000020466305940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x0000020460869E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x0000020466305940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x0000020460869DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002046086BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000204607ED3A0>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000204664DDBD0>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000204664DDBD0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000204664DDBD0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x00000204664DDBD0>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 167, in _process_decision
    rules_data = state.rules
                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'rules'
                                 └ GameStateInput(session_id='', section_number=1, player_input=None, content=None, effects={}, flags={}, source=<SourceType.RAW...

AttributeError: 'GameStateInput' object has no attribute 'rules'
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_decision': {'session_id': '', 'error': "'GameStateInput' object has no attribute 'rules'"}}
2024-12-25 18:58:31 | INFO     | managers.workflow_manager:end_workflow:254 - Ending workflow with output: session=, section=1
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:end_workflow:259 - Saving final state
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 18:58:31 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\section_1.json
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\section_1.json
2024-12-25 18:58:31 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\section_1.json
2024-12-25 18:58:31 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 18:58:31 | INFO     | managers.workflow_manager:end_workflow:262 - Workflow ended successfully
2024-12-25 18:58:31 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_end': {'session_id': '', 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 18:58:31 | ERROR    | managers.workflow_manager:execute_workflow:185 - No valid result from workflow
2024-12-25 18:58:31 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: No valid result from workflow execution
2024-12-25 18:58:31 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:58:31 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:58:31 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: No valid result from workflow execution
2024-12-25 18:59:26 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 18:59:26 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 18:59:26 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 18:59:26 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 18:59:26 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 18:59:26 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 18:59:26 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\current_state.json
2024-12-25 18:59:26 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\current_state.json
2024-12-25 18:59:26 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a06952c5-7124-4593-99c4-747825989d6f\states\current_state.json
2024-12-25 18:59:26 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 18:59:26 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 18:59:26 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 18:59:26 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 18:59:26 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 18:59:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:59:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 18:59:32 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 18:59:32 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 18:59:32 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 18:59:32 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:59:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 18:59:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 18:59:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 18:59:32 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 18:59:32 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:59:32 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 18:59:32 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 18:59:32 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 18:59:32 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 18:59:32 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 18:59:32 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 18:59:32 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 18:59:32 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 18:59:32 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 18:59:32 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 18:59:32 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 18:59:33 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 18:59:33 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 18:59:33 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 18:59:33 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:00:42 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:00:42 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:00:42 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:00:42 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:00:42 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:00:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:00:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:00:48 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:00:48 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:00:48 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:00:48 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:00:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:00:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:00:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:00:48 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:00:48 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:00:48 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:00:48 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:00:48 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:00:48 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:00:48 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:00:48 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:00:48 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:00:48 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:00:48 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:00:48 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:00:48 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:00:49 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:00:49 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:00:49 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:00:49 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:00:49 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:00:49 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:00:49 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:00:49 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:00:49 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:00:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:00:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:00:52 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:00:52 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:00:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:00:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:00:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:00:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:00:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:00:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:00:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:00:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:00:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:00:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:00:52 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:00:52 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:00:52 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:00:52 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:00:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:00:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:00:52 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:00:52 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:00:53 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:00:53 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:00:53 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:00:53 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:00:53 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 19:00:53 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 19:00:53 | INFO     | api.app:initialize_game:634 - Generated session ID: 6292812f-6dc3-482b-b8c2-022c9b2098f3
2024-12-25 19:00:53 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 19:00:53 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 19:00:53 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 19:00:53 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 19:00:53 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 19:00:53 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: d186b005-d04d-4841-9d5a-e7c7824e5a5e
2024-12-25 19:00:53 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: d186b005-d04d-4841-9d5a-e7c7824e5a5e
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\traces
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\characters
2024-12-25 19:00:53 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: d186b005-d04d-4841-9d5a-e7c7824e5a5e
2024-12-25 19:00:53 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 19:00:53 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 19:00:53 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 19:00:53 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 19:00:53 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 19:00:53 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 19:00:53 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 19:00:53 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 19:00:53 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 19:00:53 | INFO     | managers.workflow_manager:initialize_workflow:282 - Initializing workflow
2024-12-25 19:00:53 | DEBUG    | managers.workflow_manager:initialize_workflow:283 - Initial state: session_id='6292812f-6dc3-482b-b8c2-022c9b2098f3' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 19:00:53 | DEBUG    | managers.workflow_manager:initialize_workflow:286 - Saving initial state
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\section_1.json
2024-12-25 19:00:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\section_1.json
2024-12-25 19:00:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\section_1.json
2024-12-25 19:00:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:00:53 | INFO     | managers.workflow_manager:initialize_workflow:289 - Workflow initialization completed
2024-12-25 19:00:53 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 19:00:53 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='6292812f-6dc3-482b-b8c2-022c9b2098f3' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 19:00:53 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 19:00:53 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 19:00:53 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 19:00:53 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 19:00:53 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\section_1.json
2024-12-25 19:00:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\section_1.json
2024-12-25 19:00:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\section_1.json
2024-12-25 19:00:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:00:53 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': 'e1d75a4f-f4fc-4d66-99fa-9095e06e3f64', 'error': "'dict' object has no attribute 'session_id'"}}
2024-12-25 19:00:53 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 19:00:53 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 19:00:53 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:00:53 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:00:53 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 19:00:53 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 19:00:53 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:00:53 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:00:53 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 19:00:53 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 19:00:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 19:00:53 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 19:00:53 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 19:00:53 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 19:00:53 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 19:00:53 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 19:00:53 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 19:00:53 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 19:00:53 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 19:00:53 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 19:00:53 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394))}}
2024-12-25 19:00:53 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 25, 19, 0, 53, 721580), last_update=datetime.datetime(2024, 12, 25, 19, 0, 53, 721612))}}
2024-12-25 19:00:53 | INFO     | agents.story_graph:_process_decision:164 - Processing decision with merged state
2024-12-25 19:00:53 | DEBUG    | agents.story_graph:_process_decision:174 - Rules Data: section_number=1 dice_type=<DiceType.NONE: 'none'> needs_dice=True needs_user_response=True next_action='user_first' conditions=[] choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})] rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés." error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)
2024-12-25 19:00:53 | DEBUG    | agents.story_graph:_process_decision:175 - Narrative Data: section_number=1 content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?" source_type=<SourceType.RAW: 'raw'> error=None timestamp=datetime.datetime(2024, 12, 25, 19, 0, 53, 721580) last_update=datetime.datetime(2024, 12, 25, 19, 0, 53, 721612)
2024-12-25 19:00:53 | ERROR    | agents.decision_agent:analyze_decision:190 - Error in analyze_decision: 'GameStateOutput' object has no attribute 'section_number'
2024-12-25 19:00:53 | ERROR    | agents.story_graph:_process_decision:198 - Error processing decision: 'GameStateOutput' object has no attribute 'section_number'
Traceback (most recent call last):

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 104, in analyze_decision
    section_number = state.section_number
                     └ GameStateOutput(session_id='', narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le ...

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'section_number'
                                 └ GameStateOutput(session_id='', narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le ...

AttributeError: 'GameStateOutput' object has no attribute 'section_number'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1344)
                                      │           └ <function spawn_main at 0x000002A6EDEC0860>
                                      └ <function spawn_main at 0x000002A6EDEC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 588
               │     └ 3
               └ <function _main at 0x000002A6EDEC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 588
           │    └ <function BaseProcess._bootstrap at 0x000002A6EDE06A20>
           └ <SpawnProcess name='SpawnProcess-59' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000002A6EDE05F80>
    └ <SpawnProcess name='SpawnProcess-59' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002A6F3F08D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-59' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-59' parent=39512 started>
    │    └ <function subprocess_started at 0x000002A6F3EFEF20>
    └ <SpawnProcess name='SpawnProcess-59' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=964, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002A6F3F08EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=964, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000002A6F3EFE200>
           │       │   └ <uvicorn.server.Server object at 0x000002A6F3F08EC0>
           │       └ <function run at 0x000002A6EE3063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000002A6F3EF9A80>
           │      └ <function Runner.run at 0x000002A6EE3704A0>
           └ <asyncio.runners.Runner object at 0x000002A6F3F09940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002A6EE369E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002A6F3F09940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000002A6EE369DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002A6EE36BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002A6EE2ED3A0>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002A6F408FFA0>()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002A6F408FFA0>()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002A6F408FFA0>()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle <_asyncio.TaskStepMethWrapper object at 0x000002A6F408FFA0>()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 188, in _process_decision
    decision = await self.decision_agent.analyze_decision(final_state)
                     │    │              │                └ GameStateOutput(session_id='', narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le ...
                     │    │              └ <function DecisionAgent.analyze_decision at 0x000002A6F33016C0>
                     │    └ <agents.decision_agent.DecisionAgent object at 0x000002A6F3FDDD30>
                     └ <agents.story_graph.StoryGraph object at 0x000002A6F40802F0>

  File "C:\Users\erpes\Desktop\casys-rpg\agents\decision_agent.py", line 192, in analyze_decision
    section_number=state.section_number,
                   └ GameStateOutput(session_id='', narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le ...

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'section_number'
                                 └ GameStateOutput(session_id='', narrative=NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le ...

AttributeError: 'GameStateOutput' object has no attribute 'section_number'
2024-12-25 19:00:53 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_decision': {'session_id': '', 'error': "'GameStateOutput' object has no attribute 'section_number'"}}
2024-12-25 19:00:53 | INFO     | managers.workflow_manager:end_workflow:254 - Ending workflow with output: session=, section=1
2024-12-25 19:00:53 | DEBUG    | managers.workflow_manager:end_workflow:259 - Saving final state
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:00:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\section_1.json
2024-12-25 19:00:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\section_1.json
2024-12-25 19:00:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\section_1.json
2024-12-25 19:00:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:00:53 | INFO     | managers.workflow_manager:end_workflow:262 - Workflow ended successfully
2024-12-25 19:00:53 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: unsupported operand type(s) for +: 'NarratorModel' and 'NarratorModel'
2024-12-25 19:00:53 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: unsupported operand type(s) for +: 'NarratorModel' and 'NarratorModel'
2024-12-25 19:00:53 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: unsupported operand type(s) for +: 'NarratorModel' and 'NarratorModel'
2024-12-25 19:00:53 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: unsupported operand type(s) for +: 'NarratorModel' and 'NarratorModel'
2024-12-25 19:01:53 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:01:53 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:01:53 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:01:53 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 19:01:53 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 19:01:53 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 19:01:53 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\current_state.json
2024-12-25 19:01:53 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\current_state.json
2024-12-25 19:01:53 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d186b005-d04d-4841-9d5a-e7c7824e5a5e\states\current_state.json
2024-12-25 19:01:53 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 19:01:53 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 19:01:53 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 19:01:53 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 19:01:53 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:01:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:01:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:01:57 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:01:57 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:01:57 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:01:57 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:01:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:01:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:01:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:01:57 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:01:57 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:01:57 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:01:57 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:01:57 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:01:57 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:01:57 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:01:57 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:01:57 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:01:57 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:01:57 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:01:57 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:01:57 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:01:57 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:01:57 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:01:57 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:01:57 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:04:51 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:04:51 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:04:51 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:04:51 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:04:51 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:04:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:04:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:04:56 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:04:56 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:04:56 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:04:56 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:04:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:04:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:04:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:04:56 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:04:56 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:04:56 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:04:56 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:04:56 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:04:56 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:04:56 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:04:56 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:04:56 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:04:56 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:04:56 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:04:56 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:04:56 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:04:58 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:04:58 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:04:58 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:04:58 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:04:59 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:04:59 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:04:59 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:04:59 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:04:59 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:05:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:05:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:05:04 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:05:04 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:05:04 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:05:04 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:05:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:05:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:05:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:05:04 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:05:04 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:05:04 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:05:04 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:05:04 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:05:04 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:05:04 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:05:04 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:05:04 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:05:04 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:05:04 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:05:04 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:05:04 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:05:04 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:05:04 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:05:04 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:05:04 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:06:16 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:06:16 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:06:16 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:06:16 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:06:16 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:06:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:06:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:06:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:06:24 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:06:24 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:06:24 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:06:24 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:06:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:06:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:06:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:06:24 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:06:24 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:06:24 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:06:24 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:06:24 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:06:24 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:06:24 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:06:24 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:06:24 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:06:24 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:06:24 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:06:24 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:06:24 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:06:25 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:06:25 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:06:25 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:06:25 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:08:55 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:08:55 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:08:55 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:08:55 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:08:55 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:08:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:09:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:09:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:09:06 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:09:06 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:09:06 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:09:06 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:09:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:09:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:09:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:09:06 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:09:06 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:09:06 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:09:06 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:09:06 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:09:06 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:09:06 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:09:06 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:09:06 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:09:06 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:09:06 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:09:06 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:09:06 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:09:07 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:09:07 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:09:07 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:09:07 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:09:10 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:09:10 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:09:10 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:09:10 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:09:10 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:09:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:09:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:09:15 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:09:15 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:09:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:09:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:09:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:09:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:09:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:09:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:09:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:09:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:09:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:09:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:09:15 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:09:15 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:09:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:09:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:09:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:09:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:09:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:09:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:09:15 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:09:15 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:09:15 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:09:15 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:10:03 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:10:03 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:10:03 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:10:03 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:10:03 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:10:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:15 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:10:15 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:10:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:10:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:10:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:10:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:10:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:10:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:10:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:10:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:15 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:10:15 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:10:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:10:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:10:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:10:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:10:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:10:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:10:17 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:10:17 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:10:17 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:10:17 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:10:19 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:10:19 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:10:19 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:10:19 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:10:19 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:10:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:25 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:10:25 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:10:25 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:10:25 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:10:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:10:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:10:25 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:10:25 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:25 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:10:25 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:10:25 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:25 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:10:25 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:10:25 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:10:25 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:10:25 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:10:25 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:10:25 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:10:25 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:10:26 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:10:26 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:10:26 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:10:26 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:10:27 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:10:27 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:10:27 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:10:27 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:10:27 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:10:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:31 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:10:31 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:10:31 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:10:31 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:10:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:10:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:10:31 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:10:31 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:31 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:10:31 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:10:31 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:31 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:10:31 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:10:31 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:10:31 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:10:31 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:10:31 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:10:31 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:10:31 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:10:32 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:10:32 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:10:32 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:10:32 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:10:39 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:10:39 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:10:39 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:10:39 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:10:39 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:10:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:43 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:10:43 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:10:43 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:10:43 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:10:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:10:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:10:43 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:10:43 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:43 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:10:43 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:10:43 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:43 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:10:43 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:10:43 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:10:43 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:10:43 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:10:43 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:10:43 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:10:43 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:10:44 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:10:44 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:10:44 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:10:44 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:10:49 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:10:49 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:10:49 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:10:49 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:10:49 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:10:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:58 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:10:58 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:10:58 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:10:58 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:10:58 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:10:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:10:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:10:58 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:10:58 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:58 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:10:58 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:10:58 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:10:58 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:10:58 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:10:58 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:10:58 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:10:58 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:10:58 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:10:58 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:10:58 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:10:58 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:10:58 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:10:58 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:10:58 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:11:11 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:11:11 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:11:11 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:11:11 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:11:11 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:11:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:11:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:11:15 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:11:15 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:11:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:11:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:11:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:11:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:11:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:11:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:11:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:11:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:11:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:11:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:11:15 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:11:15 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:11:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:11:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:11:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:11:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:11:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:11:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:11:16 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:11:16 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:11:16 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:11:16 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:11:20 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 19:11:20 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 19:11:20 | INFO     | api.app:initialize_game:634 - Generated session ID: f12d9223-6465-4ca0-9792-7586ca6a10da
2024-12-25 19:11:20 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 19:11:20 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 19:11:20 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 19:11:20 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 19:11:20 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 19:11:20 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 64067965-7c58-429e-aaf0-f373a5d795be
2024-12-25 19:11:20 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 64067965-7c58-429e-aaf0-f373a5d795be
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\states
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\traces
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\characters
2024-12-25 19:11:20 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 64067965-7c58-429e-aaf0-f373a5d795be
2024-12-25 19:11:20 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 19:11:20 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 19:11:20 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 19:11:20 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 19:11:20 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 19:11:20 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 19:11:20 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 19:11:20 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 19:11:20 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 19:11:20 | INFO     | managers.workflow_manager:initialize_workflow:282 - Initializing workflow
2024-12-25 19:11:20 | DEBUG    | managers.workflow_manager:initialize_workflow:283 - Initial state: session_id='f12d9223-6465-4ca0-9792-7586ca6a10da' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 19:11:20 | DEBUG    | managers.workflow_manager:initialize_workflow:286 - Saving initial state
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\states\section_1.json
2024-12-25 19:11:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\states\section_1.json
2024-12-25 19:11:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\states\section_1.json
2024-12-25 19:11:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:11:20 | INFO     | managers.workflow_manager:initialize_workflow:289 - Workflow initialization completed
2024-12-25 19:11:20 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 19:11:20 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='f12d9223-6465-4ca0-9792-7586ca6a10da' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 19:11:20 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 19:11:20 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 19:11:20 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 19:11:20 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 19:11:20 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\states\section_1.json
2024-12-25 19:11:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\states\section_1.json
2024-12-25 19:11:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\states\section_1.json
2024-12-25 19:11:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:11:20 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '21f98bf0-293a-47c0-b9ab-ec40ed16ff82', 'error': "'dict' object has no attribute 'session_id'"}}
2024-12-25 19:11:20 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 19:11:20 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 19:11:20 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:11:20 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:11:20 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 19:11:20 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 19:11:20 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:11:20 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:11:20 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 19:11:20 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 19:11:20 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 19:11:20 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 19:11:20 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 19:11:20 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 19:11:20 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 19:11:20 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:11:20 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 19:11:20 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 19:11:20 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 19:11:20 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 19:11:20 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 19:11:20 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)), 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 19:11:20 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:11:20 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:11:20 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:11:20 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:12:28 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:12:28 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:12:28 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:12:28 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 19:12:28 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 19:12:28 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 19:12:28 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\states\current_state.json
2024-12-25 19:12:28 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\states\current_state.json
2024-12-25 19:12:28 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\64067965-7c58-429e-aaf0-f373a5d795be\states\current_state.json
2024-12-25 19:12:28 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 19:12:28 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 19:12:28 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 19:12:28 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 19:12:28 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:12:29 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:12:34 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:12:34 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:12:34 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:12:34 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:12:34 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:12:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:12:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:12:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:12:34 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:12:34 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:12:34 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:12:34 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:12:34 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:12:34 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:12:34 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:12:34 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:12:34 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:12:34 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:12:34 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:12:34 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:12:34 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:12:35 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:12:35 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:12:35 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:12:35 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:13:22 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:13:22 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:13:22 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:13:22 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:13:22 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:13:23 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:13:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:13:28 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:13:28 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:13:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:13:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:13:28 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:13:28 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:13:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:13:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:13:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:13:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:13:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:13:28 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:13:28 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:13:28 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:13:28 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:13:28 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 19:13:28 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 19:13:28 | INFO     | api.app:initialize_game:634 - Generated session ID: 0d60fcc6-d828-42fe-b820-db1a4fa4c73a
2024-12-25 19:13:28 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 19:13:28 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 19:13:28 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 19:13:28 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 19:13:28 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 19:13:28 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 27a26a48-ce2d-4e45-ba84-d429f3176a44
2024-12-25 19:13:28 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 27a26a48-ce2d-4e45-ba84-d429f3176a44
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\states
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\traces
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\characters
2024-12-25 19:13:28 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 27a26a48-ce2d-4e45-ba84-d429f3176a44
2024-12-25 19:13:28 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 19:13:28 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 19:13:28 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 19:13:28 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 19:13:28 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 19:13:28 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 19:13:28 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 19:13:28 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 19:13:28 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 19:13:28 | INFO     | managers.workflow_manager:initialize_workflow:282 - Initializing workflow
2024-12-25 19:13:28 | DEBUG    | managers.workflow_manager:initialize_workflow:283 - Initial state: session_id='0d60fcc6-d828-42fe-b820-db1a4fa4c73a' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 19:13:28 | DEBUG    | managers.workflow_manager:initialize_workflow:286 - Saving initial state
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\states\section_1.json
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\states\section_1.json
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\states\section_1.json
2024-12-25 19:13:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:13:28 | INFO     | managers.workflow_manager:initialize_workflow:289 - Workflow initialization completed
2024-12-25 19:13:28 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 19:13:28 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='0d60fcc6-d828-42fe-b820-db1a4fa4c73a' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 19:13:28 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 19:13:28 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 19:13:28 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 19:13:28 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 19:13:28 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\states\section_1.json
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\states\section_1.json
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\states\section_1.json
2024-12-25 19:13:28 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:13:28 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '41569976-33cd-4246-a9cd-1b260bcf14bf', 'error': "'dict' object has no attribute 'session_id'", 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 19:13:28 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 19:13:28 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 19:13:28 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:13:28 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 19:13:28 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 19:13:28 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 19:13:28 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 19:13:28 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 19:13:28 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 19:13:28 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 19:13:28 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 19:13:28 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 19:13:28 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:13:28 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 19:13:28 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 19:13:28 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 19:13:28 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 19:13:28 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 19:13:28 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)), 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 19:13:28 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:13:28 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:13:28 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:13:28 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:14:00 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:14:00 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:14:00 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:14:00 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 19:14:00 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 19:14:00 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 19:14:00 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\states\current_state.json
2024-12-25 19:14:00 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\states\current_state.json
2024-12-25 19:14:00 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\27a26a48-ce2d-4e45-ba84-d429f3176a44\states\current_state.json
2024-12-25 19:14:00 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 19:14:00 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 19:14:00 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 19:14:00 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 19:14:00 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:14:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:14:03 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:14:03 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:14:03 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:14:03 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:14:03 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:14:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:14:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:14:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:14:03 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:14:03 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:14:03 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:14:03 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:14:03 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:14:03 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:14:03 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:14:03 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:14:03 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:14:03 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:14:03 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:14:03 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:14:03 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:14:03 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:14:03 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:14:03 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:14:03 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:14:45 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:14:45 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:14:45 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:14:45 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:14:45 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:14:45 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:14:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:14:49 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:14:49 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:14:49 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:14:49 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:14:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:14:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:14:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:14:49 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:14:49 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:14:49 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:14:49 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:14:49 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:14:49 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:14:49 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:14:49 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:14:49 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:14:49 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:14:49 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:14:49 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:14:49 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:14:49 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:14:49 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:14:49 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:14:49 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:15:05 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:15:05 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:15:05 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:15:05 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:15:05 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:15:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:15:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:15:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:15:13 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:15:13 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:15:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:15:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:15:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:15:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:15:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:15:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:15:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:15:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:13 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:15:13 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:15:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:15:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:15:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:15:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:15:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:15:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:15:14 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:15:14 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:15:14 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:15:14 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:15:20 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:15:20 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:15:20 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:15:20 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:15:20 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:15:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:15:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:15:24 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:15:24 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:15:24 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:15:24 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:15:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:15:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:15:24 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:15:24 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:24 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:15:24 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:15:24 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:24 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:15:24 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:15:24 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:15:24 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:15:24 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:15:24 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:15:24 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:15:24 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:15:25 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:15:25 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:15:25 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:15:25 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:15:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:15:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:15:28 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:15:28 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:15:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:15:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:15:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:15:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:15:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:15:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:15:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:15:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:28 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:15:28 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:15:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:15:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:15:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:15:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:15:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:15:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:15:28 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:15:28 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:15:28 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:15:28 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:15:48 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:15:48 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:15:48 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:15:48 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:15:48 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:15:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:15:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:15:52 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:15:52 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:15:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:15:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:15:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:15:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:15:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:15:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:15:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:15:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:15:52 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:15:52 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:15:52 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:15:52 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:15:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:15:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:15:52 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:15:52 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:15:53 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:15:53 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:15:53 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:15:53 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:20:12 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:20:12 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:20:12 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:20:12 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:20:12 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:20:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:20:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:20:16 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:20:16 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:20:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:20:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:20:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:20:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:20:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:20:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:20:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:20:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:20:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:20:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:20:16 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:20:16 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:20:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:20:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:20:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:20:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:20:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:20:16 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:20:17 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:20:17 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:20:17 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:20:17 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:20:46 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:20:46 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:20:46 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:20:46 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:20:46 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:20:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:20:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:20:49 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:20:49 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:20:49 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:20:49 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:20:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:20:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:20:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:20:49 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:20:49 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:20:49 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:20:49 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:20:49 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:20:49 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:20:49 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:20:49 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:20:49 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:20:49 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:20:49 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:20:49 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:20:49 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:20:50 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:20:50 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:20:50 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:20:50 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:21:46 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:21:46 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:21:46 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:21:46 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:21:46 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:21:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:21:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:21:49 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:21:49 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:21:49 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:21:49 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:21:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:21:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:21:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:21:49 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:21:49 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:21:49 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:21:49 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:21:49 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:21:49 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:21:49 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:21:49 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:21:49 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:21:49 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:21:49 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:21:49 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:21:49 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:21:50 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:21:50 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:21:50 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:21:50 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:23:24 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:23:24 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:23:24 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:23:24 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:23:24 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:23:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:23:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:23:28 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:23:28 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:23:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:23:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:23:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:23:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:23:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:23:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:23:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:23:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:23:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:23:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:23:28 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:23:28 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:23:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:23:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:23:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:23:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:23:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:23:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:23:29 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:23:29 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:23:29 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:23:29 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:25:36 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:25:36 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:25:36 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:25:36 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:25:36 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:25:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:25:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:25:41 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:25:41 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:25:41 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:25:41 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:25:41 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:25:41 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:25:41 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:25:41 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:25:41 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:25:41 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:25:41 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:25:41 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:25:41 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:25:41 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:25:41 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:25:41 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:25:41 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:25:41 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:25:41 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:25:41 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:25:41 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:25:41 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:25:41 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:25:41 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:26:23 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:26:23 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:26:23 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:26:23 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:26:23 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:26:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:26:29 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:26:29 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:26:29 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:26:29 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:26:29 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:26:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:26:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:26:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:26:29 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:26:29 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:26:29 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:26:29 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:26:29 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:26:29 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:26:29 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:26:29 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:26:29 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:26:29 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:26:29 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:26:29 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:26:29 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:26:30 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:26:30 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:26:30 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:26:30 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:27:13 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 19:27:13 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 19:27:13 | INFO     | api.app:initialize_game:634 - Generated session ID: 9474d76c-f9f0-4dc0-a120-66977937ef70
2024-12-25 19:27:13 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 19:27:13 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 19:27:13 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 19:27:13 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 19:27:13 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 19:27:13 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: c03e8b15-b4cb-4101-9c9f-e9072e7696c2
2024-12-25 19:27:13 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: c03e8b15-b4cb-4101-9c9f-e9072e7696c2
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\states
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\traces
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\characters
2024-12-25 19:27:13 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: c03e8b15-b4cb-4101-9c9f-e9072e7696c2
2024-12-25 19:27:13 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 19:27:13 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 19:27:13 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 19:27:13 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 19:27:13 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 19:27:13 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 19:27:13 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 19:27:13 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 19:27:13 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 19:27:13 | INFO     | managers.workflow_manager:initialize_workflow:279 - Initializing workflow
2024-12-25 19:27:13 | DEBUG    | managers.workflow_manager:initialize_workflow:280 - Initial state: session_id='9474d76c-f9f0-4dc0-a120-66977937ef70' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 19:27:13 | DEBUG    | managers.workflow_manager:initialize_workflow:283 - Saving initial state
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\states\section_1.json
2024-12-25 19:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\states\section_1.json
2024-12-25 19:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\states\section_1.json
2024-12-25 19:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:27:13 | INFO     | managers.workflow_manager:initialize_workflow:286 - Workflow initialization completed
2024-12-25 19:27:13 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 19:27:13 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='9474d76c-f9f0-4dc0-a120-66977937ef70' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 19:27:13 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 19:27:13 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 19:27:13 | INFO     | managers.workflow_manager:start_workflow:199 - Starting workflow node
2024-12-25 19:27:13 | DEBUG    | managers.workflow_manager:start_workflow:219 - Created initial state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 19:27:13 | ERROR    | managers.workflow_manager:start_workflow:231 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\states\section_1.json
2024-12-25 19:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\states\section_1.json
2024-12-25 19:27:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\states\section_1.json
2024-12-25 19:27:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:27:13 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '1cfcfbb2-ac3d-473d-92f2-ad4436524aeb', 'error': "'dict' object has no attribute 'session_id'", 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 19:27:13 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 19:27:13 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 19:27:13 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:27:13 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:27:13 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 19:27:13 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 19:27:13 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:27:13 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:27:13 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 19:27:13 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 19:27:13 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 19:27:13 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 19:27:13 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 19:27:13 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 19:27:13 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 19:27:13 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:27:13 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 19:27:13 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 19:27:13 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 19:27:13 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 19:27:13 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 19:27:13 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)), 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 19:27:13 | ERROR    | managers.workflow_manager:execute_workflow:186 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:27:13 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:27:13 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:27:13 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:28:31 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:28:31 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:28:31 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:28:31 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 19:28:31 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 19:28:31 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 19:28:31 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\states\current_state.json
2024-12-25 19:28:31 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\states\current_state.json
2024-12-25 19:28:31 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c03e8b15-b4cb-4101-9c9f-e9072e7696c2\states\current_state.json
2024-12-25 19:28:31 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 19:28:31 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 19:28:31 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 19:28:31 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 19:28:31 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:28:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:28:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:28:35 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:28:35 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:28:35 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:28:35 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:28:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:28:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:28:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:28:35 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:28:35 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:28:35 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:28:35 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:28:35 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:28:35 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:28:35 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:28:35 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:28:35 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:28:35 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:28:35 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:28:35 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:28:35 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:28:36 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:28:36 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:28:36 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:28:36 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:28:52 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:28:52 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:28:52 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:28:52 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:28:52 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:28:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:28:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:28:56 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:28:56 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:28:56 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:28:56 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:28:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:28:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:28:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:28:56 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:28:56 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:28:56 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:28:56 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:28:56 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:28:56 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:28:56 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:28:56 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:28:56 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:28:56 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:28:56 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:28:56 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:28:56 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:28:57 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:28:57 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:28:57 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:28:57 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:29:06 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:29:06 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:29:06 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:29:06 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:29:06 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:29:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:29:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:29:10 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:29:10 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:29:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:29:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:29:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:29:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:29:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:29:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:29:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:29:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:29:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:29:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:29:10 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:29:10 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:29:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:29:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:29:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:29:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:29:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:29:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:29:11 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:29:11 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:29:11 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:29:11 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:29:11 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 19:29:11 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 19:29:11 | INFO     | api.app:initialize_game:634 - Generated session ID: d831d6b5-a8a2-442a-b4d5-10c9a9812c2b
2024-12-25 19:29:11 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 19:29:11 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 19:29:11 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 19:29:11 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 19:29:11 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 19:29:11 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 98f906a3-efba-4c50-868a-16b2a6ee4f79
2024-12-25 19:29:11 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 98f906a3-efba-4c50-868a-16b2a6ee4f79
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\states
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\traces
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\characters
2024-12-25 19:29:11 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 98f906a3-efba-4c50-868a-16b2a6ee4f79
2024-12-25 19:29:11 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 19:29:11 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 19:29:11 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 19:29:11 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 19:29:11 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 19:29:11 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 19:29:11 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 19:29:11 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 19:29:11 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 19:29:11 | INFO     | managers.workflow_manager:initialize_workflow:277 - Initializing workflow
2024-12-25 19:29:11 | DEBUG    | managers.workflow_manager:initialize_workflow:278 - Initial state: session_id='d831d6b5-a8a2-442a-b4d5-10c9a9812c2b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 19:29:11 | DEBUG    | managers.workflow_manager:initialize_workflow:281 - Saving initial state
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\states\section_1.json
2024-12-25 19:29:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\states\section_1.json
2024-12-25 19:29:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\states\section_1.json
2024-12-25 19:29:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:29:11 | INFO     | managers.workflow_manager:initialize_workflow:284 - Workflow initialization completed
2024-12-25 19:29:11 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 19:29:11 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='d831d6b5-a8a2-442a-b4d5-10c9a9812c2b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 19:29:11 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 19:29:11 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 19:29:11 | INFO     | managers.workflow_manager:start_workflow:197 - Starting workflow node
2024-12-25 19:29:11 | DEBUG    | managers.workflow_manager:start_workflow:217 - Created initial state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 19:29:11 | ERROR    | managers.workflow_manager:start_workflow:229 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\states\section_1.json
2024-12-25 19:29:11 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\states\section_1.json
2024-12-25 19:29:11 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\states\section_1.json
2024-12-25 19:29:11 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:29:11 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': 'a7a1e763-09b8-4fc5-9bc5-cf7f992f85fe', 'error': "'dict' object has no attribute 'session_id'", 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 19:29:11 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 19:29:11 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 19:29:11 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:29:11 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:29:11 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 19:29:11 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 19:29:11 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:29:11 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:29:11 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 19:29:11 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 19:29:11 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 19:29:11 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 19:29:11 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 19:29:11 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 19:29:11 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 19:29:11 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:29:11 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 19:29:11 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 19:29:11 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 19:29:11 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 19:29:11 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 19:29:11 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)), 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 19:29:11 | ERROR    | managers.workflow_manager:execute_workflow:184 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:29:11 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:29:11 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:29:11 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:31:30 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:31:30 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:31:30 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:31:30 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 19:31:30 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 19:31:30 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 19:31:30 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\states\current_state.json
2024-12-25 19:31:30 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\states\current_state.json
2024-12-25 19:31:30 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\98f906a3-efba-4c50-868a-16b2a6ee4f79\states\current_state.json
2024-12-25 19:31:30 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 19:31:30 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 19:31:30 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 19:31:30 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 19:31:30 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:31:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:31:34 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:31:34 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:31:34 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:31:34 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:31:34 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:31:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:31:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:31:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:31:34 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:31:34 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:31:34 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:31:34 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:31:34 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:31:34 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:31:34 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:31:34 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:31:34 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:31:34 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:31:34 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:31:34 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:31:34 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:31:34 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:31:34 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:31:34 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:31:34 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:32:20 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:32:20 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:32:20 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:32:20 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:32:20 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:32:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:32:23 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:32:23 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:32:23 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:32:23 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:32:23 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:32:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:32:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:32:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:32:23 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:32:23 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:32:23 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:32:23 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:32:23 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:32:23 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:32:23 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:32:23 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:32:23 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:32:23 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:32:23 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:32:23 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:32:23 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:32:23 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:32:23 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:32:23 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:32:23 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:33:55 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:33:55 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:33:55 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:33:55 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:33:55 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:33:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:33:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:33:59 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:33:59 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:33:59 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:33:59 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:33:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:33:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:33:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:33:59 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:33:59 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:33:59 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:33:59 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:33:59 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:33:59 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:33:59 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:33:59 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:33:59 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:33:59 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:33:59 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:33:59 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:33:59 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:34:00 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:34:00 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:34:00 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:34:00 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:34:36 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:34:36 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:34:36 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:34:36 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:34:36 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:34:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:34:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:34:39 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:34:39 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:34:39 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:34:39 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:34:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:34:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:34:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:34:39 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:34:39 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:34:39 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:34:39 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:34:39 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:34:39 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:34:39 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:34:39 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:34:39 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:34:39 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:34:39 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:34:39 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:34:39 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:34:40 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:34:40 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:34:40 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:34:40 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:34:57 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:34:57 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:34:57 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:34:57 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:34:57 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:34:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:35:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:35:01 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:35:01 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:35:01 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:35:01 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:35:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:35:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:35:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:35:01 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:35:01 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:35:01 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:35:01 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:35:01 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:35:01 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:35:01 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:35:01 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:35:01 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:35:01 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:35:01 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:35:01 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:35:01 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:35:02 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:35:02 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:35:02 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:35:02 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:35:08 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:35:08 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:35:08 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:35:08 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:35:08 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:35:08 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:35:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:35:13 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:35:13 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:35:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:35:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:35:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:35:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:35:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:35:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:35:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:35:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:35:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:35:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:35:13 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:35:13 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:35:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:35:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:35:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:35:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:35:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:35:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:35:14 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:35:14 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:35:14 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:35:14 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:35:45 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:35:45 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:35:45 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:35:45 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:35:45 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:35:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:35:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:35:50 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:35:50 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:35:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:35:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:35:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:35:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:35:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:35:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:35:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:35:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:35:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:35:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:35:50 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:35:50 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:35:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:35:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:35:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:35:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:35:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:35:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:35:50 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:35:50 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:35:50 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:35:50 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:38:35 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:38:35 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:38:35 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:38:35 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:38:35 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:38:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:38:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:38:37 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:38:37 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:38:37 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:38:37 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:38:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:38:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:38:37 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:38:37 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:38:37 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:38:37 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:38:37 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:38:37 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:38:37 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:38:37 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:38:37 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:38:37 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:38:37 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:38:37 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:38:37 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:38:37 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:38:38 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:38:38 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:38:38 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:38:38 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:38:41 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:38:41 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:38:41 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:38:41 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:38:41 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:38:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:38:45 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:38:45 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:38:45 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:38:45 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:38:45 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:38:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:38:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:38:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:38:45 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:38:45 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:38:45 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:38:45 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:38:45 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:38:45 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:38:45 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:38:45 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:38:45 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:38:45 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:38:45 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:38:45 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:38:45 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:38:46 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:38:46 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:38:46 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:38:46 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:54:22 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:54:22 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:54:22 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:54:22 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:54:23 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:54:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:54:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:54:27 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:54:27 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:54:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:54:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:54:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:54:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:54:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:54:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:54:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:54:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:54:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:54:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:54:27 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:54:27 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:54:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:54:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:54:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:54:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:54:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:54:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:54:28 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:54:28 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:54:28 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:54:28 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:54:56 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:54:56 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:54:56 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:54:56 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:54:56 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:54:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:55:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:55:01 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:55:01 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:55:01 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:55:01 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:55:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:55:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:55:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:55:01 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:55:01 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:55:01 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:55:01 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:55:01 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:55:01 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:55:01 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:55:01 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:55:01 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:55:01 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:55:01 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:55:01 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:55:01 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:55:01 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:55:01 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:55:01 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:55:01 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:55:17 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 19:55:17 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 19:55:17 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 19:55:17 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 19:55:17 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 19:55:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:55:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 19:55:20 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 19:55:20 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 19:55:20 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 19:55:20 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:55:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 19:55:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 19:55:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 19:55:20 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 19:55:20 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:55:20 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 19:55:20 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 19:55:20 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 19:55:20 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 19:55:20 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 19:55:20 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 19:55:20 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 19:55:20 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 19:55:20 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 19:55:20 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 19:55:20 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 19:55:20 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 19:55:20 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 19:55:20 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 19:55:20 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 19:55:24 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 19:55:24 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 19:55:24 | INFO     | api.app:initialize_game:634 - Generated session ID: 7c9a3f73-95fd-4227-a95c-087cd88e7f32
2024-12-25 19:55:24 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 19:55:24 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 19:55:24 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 19:55:24 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 19:55:24 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 19:55:24 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 134f4e94-c8a2-43de-b2cf-e88e7f0af67b
2024-12-25 19:55:24 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 134f4e94-c8a2-43de-b2cf-e88e7f0af67b
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\states
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\traces
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\characters
2024-12-25 19:55:24 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 134f4e94-c8a2-43de-b2cf-e88e7f0af67b
2024-12-25 19:55:24 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 19:55:24 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 19:55:24 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 19:55:24 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 19:55:24 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 19:55:24 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 19:55:24 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 19:55:24 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 19:55:24 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 19:55:24 | INFO     | managers.workflow_manager:initialize_workflow:278 - Initializing workflow
2024-12-25 19:55:24 | DEBUG    | managers.workflow_manager:initialize_workflow:279 - Initial state: session_id='7c9a3f73-95fd-4227-a95c-087cd88e7f32' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 19:55:24 | DEBUG    | managers.workflow_manager:initialize_workflow:282 - Saving initial state
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\states\section_1.json
2024-12-25 19:55:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\states\section_1.json
2024-12-25 19:55:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\states\section_1.json
2024-12-25 19:55:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:55:24 | INFO     | managers.workflow_manager:initialize_workflow:285 - Workflow initialization completed
2024-12-25 19:55:24 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 19:55:24 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='7c9a3f73-95fd-4227-a95c-087cd88e7f32' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 19:55:24 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 19:55:24 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 19:55:24 | INFO     | managers.workflow_manager:start_workflow:197 - Starting workflow node
2024-12-25 19:55:24 | DEBUG    | managers.workflow_manager:start_workflow:217 - Created initial state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 19:55:24 | ERROR    | managers.workflow_manager:start_workflow:229 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\states\section_1.json
2024-12-25 19:55:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\states\section_1.json
2024-12-25 19:55:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\states\section_1.json
2024-12-25 19:55:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 19:55:24 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '50b8c656-619d-43cd-8c26-74937f6c1880', 'error': "'dict' object has no attribute 'session_id'", 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 19:55:24 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 19:55:24 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 19:55:24 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:55:24 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 19:55:24 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 19:55:24 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 19:55:24 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:55:24 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 19:55:24 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 19:55:24 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 19:55:24 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 19:55:24 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 19:55:24 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 19:55:24 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 19:55:24 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 19:55:24 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 19:55:24 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 19:55:24 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 19:55:24 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 19:55:24 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 19:55:24 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 19:55:24 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)), 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 19:55:24 | ERROR    | managers.workflow_manager:execute_workflow:184 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:55:24 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:55:24 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 19:55:24 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:07:23 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:07:23 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:07:23 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:07:23 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 20:07:23 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 20:07:23 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 20:07:23 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\states\current_state.json
2024-12-25 20:07:23 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\states\current_state.json
2024-12-25 20:07:23 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\134f4e94-c8a2-43de-b2cf-e88e7f0af67b\states\current_state.json
2024-12-25 20:07:23 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:07:23 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 20:07:23 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 20:07:23 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 20:07:23 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:07:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:07:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:07:30 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:07:30 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:07:30 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:07:30 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:07:30 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:07:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:07:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:07:30 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:07:30 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:07:30 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:07:30 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:07:30 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:07:30 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:07:30 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:07:30 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:07:30 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:07:30 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:07:30 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:07:30 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:07:30 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:07:30 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:07:30 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:07:30 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:07:30 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:07:30 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:07:34 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 20:07:34 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 20:07:34 | INFO     | api.app:initialize_game:634 - Generated session ID: d2880bbf-e070-457c-afb2-21db091169a2
2024-12-25 20:07:34 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 20:07:34 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 20:07:34 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 20:07:34 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 20:07:34 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 20:07:34 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 773d1f08-7707-45c9-bf60-8fcf186aaf0b
2024-12-25 20:07:34 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 773d1f08-7707-45c9-bf60-8fcf186aaf0b
2024-12-25 20:07:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\773d1f08-7707-45c9-bf60-8fcf186aaf0b\states
2024-12-25 20:07:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\773d1f08-7707-45c9-bf60-8fcf186aaf0b\traces
2024-12-25 20:07:34 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\773d1f08-7707-45c9-bf60-8fcf186aaf0b\characters
2024-12-25 20:07:34 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 773d1f08-7707-45c9-bf60-8fcf186aaf0b
2024-12-25 20:07:34 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 20:07:34 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 20:07:34 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 20:07:34 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 20:07:34 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 20:07:34 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 20:07:34 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 20:07:34 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 20:07:34 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 20:07:34 | INFO     | managers.workflow_manager:initialize_workflow:276 - Initializing workflow
2024-12-25 20:07:34 | DEBUG    | managers.workflow_manager:initialize_workflow:277 - Initial state: session_id='d2880bbf-e070-457c-afb2-21db091169a2' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 20:07:34 | DEBUG    | managers.workflow_manager:initialize_workflow:280 - Saving initial state
2024-12-25 20:07:34 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:07:34 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:07:34 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:07:34 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\773d1f08-7707-45c9-bf60-8fcf186aaf0b\states\section_1.json
2024-12-25 20:07:34 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\773d1f08-7707-45c9-bf60-8fcf186aaf0b\states\section_1.json
2024-12-25 20:07:34 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\773d1f08-7707-45c9-bf60-8fcf186aaf0b\states\section_1.json
2024-12-25 20:07:34 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:07:34 | INFO     | managers.workflow_manager:initialize_workflow:283 - Workflow initialization completed
2024-12-25 20:07:34 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 20:07:34 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='d2880bbf-e070-457c-afb2-21db091169a2' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 20:07:34 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 20:07:34 | ERROR    | managers.workflow_manager:execute_workflow:182 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'player_input'
2024-12-25 20:07:34 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'player_input'
2024-12-25 20:07:34 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'player_input'
2024-12-25 20:07:34 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'player_input'
2024-12-25 20:09:41 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:09:41 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:09:41 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:09:41 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 20:09:41 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 20:09:41 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 20:09:41 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\773d1f08-7707-45c9-bf60-8fcf186aaf0b\states\current_state.json
2024-12-25 20:09:41 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\773d1f08-7707-45c9-bf60-8fcf186aaf0b\states\current_state.json
2024-12-25 20:09:41 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\773d1f08-7707-45c9-bf60-8fcf186aaf0b\states\current_state.json
2024-12-25 20:09:41 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:09:41 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 20:09:41 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 20:09:41 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 20:09:41 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:09:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:09:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:09:44 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:09:44 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:09:44 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:09:44 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:09:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:09:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:09:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:09:44 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:09:44 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:09:44 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:09:44 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:09:44 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:09:44 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:09:44 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:09:44 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:09:44 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:09:44 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:09:44 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:09:44 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:09:44 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:09:44 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:09:44 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:09:44 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:09:44 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:09:49 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:09:49 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:09:49 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:09:49 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:09:49 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:09:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:09:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:09:52 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:09:52 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:09:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:09:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:09:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:09:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:09:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:09:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:09:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:09:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:09:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:09:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:09:52 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:09:52 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:09:52 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:09:52 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:09:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:09:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:09:52 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:09:52 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:09:53 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:09:53 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:09:53 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:09:53 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:09:57 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:09:57 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:09:57 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:09:57 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:09:57 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:09:58 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:10:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:10:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:10:04 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:10:04 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:10:04 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:10:04 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:10:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:10:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:10:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:10:04 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:10:04 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:10:04 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:10:04 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:10:04 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:10:04 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:10:04 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:10:04 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:10:04 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:10:04 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:10:04 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:10:04 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:10:04 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:10:05 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:10:05 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:10:05 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:10:05 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:10:08 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 20:10:08 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 20:10:08 | INFO     | api.app:initialize_game:634 - Generated session ID: d3f3af54-496c-441e-af2d-2a99a2eb8feb
2024-12-25 20:10:08 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 20:10:08 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 20:10:08 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 20:10:08 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 20:10:08 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 20:10:08 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: bc18246c-13d8-4002-aac1-6901c8102307
2024-12-25 20:10:08 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: bc18246c-13d8-4002-aac1-6901c8102307
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\traces
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\characters
2024-12-25 20:10:08 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: bc18246c-13d8-4002-aac1-6901c8102307
2024-12-25 20:10:08 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 20:10:08 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 20:10:08 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 20:10:08 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 20:10:08 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 20:10:08 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 20:10:08 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 20:10:08 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 20:10:08 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 20:10:08 | INFO     | managers.workflow_manager:initialize_workflow:279 - Initializing workflow
2024-12-25 20:10:08 | DEBUG    | managers.workflow_manager:initialize_workflow:280 - Initial state: session_id='d3f3af54-496c-441e-af2d-2a99a2eb8feb' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 20:10:08 | DEBUG    | managers.workflow_manager:initialize_workflow:283 - Saving initial state
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:10:08 | INFO     | managers.workflow_manager:initialize_workflow:286 - Workflow initialization completed
2024-12-25 20:10:08 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 20:10:08 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='d3f3af54-496c-441e-af2d-2a99a2eb8feb' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 20:10:08 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 20:10:08 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 20:10:08 | INFO     | managers.workflow_manager:start_workflow:198 - Starting workflow node
2024-12-25 20:10:08 | DEBUG    | managers.workflow_manager:start_workflow:218 - Created initial state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 20:10:08 | ERROR    | managers.workflow_manager:start_workflow:230 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:08 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:08 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:08 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:10:08 | DEBUG    | managers.workflow_manager:execute_workflow:173 - Workflow execution result: {'node_start': {'session_id': 'bc1d2a91-6ab0-4707-acef-dabc2df1bd4b', 'error': "'dict' object has no attribute 'session_id'", 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:10:08 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 20:10:08 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 20:10:08 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 20:10:08 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 20:10:08 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 20:10:08 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 20:10:08 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 20:10:08 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 20:10:08 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 20:10:08 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 20:10:08 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 20:10:08 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 20:10:08 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 20:10:08 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 20:10:08 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 20:10:08 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:10:08 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 20:10:08 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 20:10:08 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 20:10:08 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 20:10:08 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 20:10:08 | DEBUG    | managers.workflow_manager:execute_workflow:173 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)), 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:10:08 | ERROR    | managers.workflow_manager:execute_workflow:185 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:10:08 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:10:08 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:10:08 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:10:40 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 20:10:40 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 20:10:40 | INFO     | api.app:initialize_game:634 - Generated session ID: 3cc449d8-8646-4b49-b42a-598946f96eef
2024-12-25 20:10:40 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 20:10:40 | DEBUG    | managers.agent_manager:initialize:298 - AgentManager already initialized
2024-12-25 20:10:40 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 20:10:40 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 20:10:40 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 20:10:40 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 20:10:40 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 20:10:40 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 20:10:40 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 20:10:40 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 20:10:40 | INFO     | managers.workflow_manager:initialize_workflow:279 - Initializing workflow
2024-12-25 20:10:40 | DEBUG    | managers.workflow_manager:initialize_workflow:280 - Initial state: session_id='3cc449d8-8646-4b49-b42a-598946f96eef' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 20:10:40 | DEBUG    | managers.workflow_manager:initialize_workflow:283 - Saving initial state
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:40 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:40 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:40 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:10:40 | INFO     | managers.workflow_manager:initialize_workflow:286 - Workflow initialization completed
2024-12-25 20:10:40 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 20:10:40 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='3cc449d8-8646-4b49-b42a-598946f96eef' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 20:10:40 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 20:10:40 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 20:10:40 | INFO     | managers.workflow_manager:start_workflow:198 - Starting workflow node
2024-12-25 20:10:40 | DEBUG    | managers.workflow_manager:start_workflow:218 - Created initial state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 20:10:40 | ERROR    | managers.workflow_manager:start_workflow:230 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:40 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:40 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\section_1.json
2024-12-25 20:10:40 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:10:40 | DEBUG    | managers.workflow_manager:execute_workflow:173 - Workflow execution result: {'node_start': {'session_id': '7e9035a1-acea-4862-81bd-8a75ec516536', 'error': "'dict' object has no attribute 'session_id'", 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:10:40 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 20:10:40 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 20:10:40 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 20:10:40 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 20:10:40 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 20:10:40 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 20:10:40 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 20:10:40 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 20:10:40 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 20:10:40 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 20:10:40 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 20:10:40 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 20:10:40 | DEBUG    | managers.cache_manager:get_cached_data:200 - Found in memory cache
2024-12-25 20:10:40 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 20:10:40 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 20:10:40 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 20:10:40 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 20:10:40 | DEBUG    | managers.workflow_manager:execute_workflow:173 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)), 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:10:40 | DEBUG    | managers.workflow_manager:execute_workflow:173 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=1, content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaisseau spatial. Après avoir vérifié le système de sécurité, vous examinez attentivement le tableau de bord. \n\nIl ne présente aucune complexité : une simple console d'ordinateur reliée à un terminal de liaison et quelques écrans. Le circuit micro-électronique du système alpha ziridium est profondément enfoui dans les entrailles du vaisseau, et vous n'aurez jamais à vous en préoccuper le moins du monde. Si une panne quelconque venait à se déclarer, ou s'il se produisait le moindre incident, votre ingénieur robot interviendrait sur-le-champ.\n\nLa préprogrammation de votre voyage a été établie pour vous mener en premier lieu sur Tropos. Vous entamez les procédures de départ : interrogations de l'ordinateur concernant tous les points vitaux du vaisseau. Une voix impersonnelle se fait entendre aussitôt : « Vérifications effectuées. Fonctionnement optimal. » \n\nPuis vous passez à la deuxième opération : contact avec la tour de contrôle. Paré au décollage ! Vous appuyez sur un bouton... et c'est le grand voyage. \n\nAu bout de quelques minutes, les malaises dus à l'accélération s'estompent : vous quittez l'exosphère terrienne et pénétrez dans la nuit spatiale, aussi noire que de l'encre. Le générateur gravitationnel est automatiquement enclenché de sorte que la pesanteur normale est maintenue dans votre vaisseau, ce qui vous permet, ainsi qu'à vos robots, de vous déplacer librement. \n\nVous allumez l'écran de vision rétrospective pour observer une dernière fois la Terre qui rétrécit et s'éloigne. Des bancs de nuages glissent paresseusement et le soleil se réfléchit sur les glaces polaires du cercle arctique. Bien que l'occasion vous ait été donnée à maintes reprises de contempler ce spectacle au cours de vos voyages vers Vénus ou vers Mercure, vous ressentez toujours, à sa vue, un petit pincement au cœur et une émotion nostalgique. \n\nReverrez-vous jamais la Terre ? D'un haussement d'épaules, vous chassez ces pensées car seul, compte, désormais, votre mission. Des heures s'écoulent, uniformes et lentes. \n\nPuis votre écran revient soudain à la vie. L'ordinateur de bord vous avertit qu'un autre vaisseau spatial suit la même trajectoire que vous tout en maintenant soigneusement un écart constant. Cela ressemble à s'y méprendre à une filature. \n\nAllez-vous donner l'ordre à votre ordinateur d'engager la procédure d'évasion (rendez-vous au [[48]]) ou préférez-vous continuer votre route (rendez-vous au [[398]]) ?", source_type=<SourceType.RAW: 'raw'>, error=None, timestamp=datetime.datetime(2024, 12, 25, 20, 10, 40, 908354), last_update=datetime.datetime(2024, 12, 25, 20, 10, 40, 908387)), 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:10:40 | ERROR    | managers.workflow_manager:execute_workflow:185 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:10:40 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:10:40 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:10:40 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:25:15 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:25:15 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:25:15 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:25:15 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 20:25:15 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 20:25:15 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 20:25:15 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\current_state.json
2024-12-25 20:25:15 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\current_state.json
2024-12-25 20:25:15 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc18246c-13d8-4002-aac1-6901c8102307\states\current_state.json
2024-12-25 20:25:15 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:25:15 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 20:25:15 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 20:25:15 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 20:25:15 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:25:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:25:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:25:18 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:25:18 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:25:18 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:25:18 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:25:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:25:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:25:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:25:18 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:25:18 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:25:18 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:25:18 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:25:18 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:25:18 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:25:18 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:25:18 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:25:18 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:25:18 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:25:18 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:25:18 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:25:18 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:25:18 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:25:18 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:25:18 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:25:18 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:25:40 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:25:40 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:25:40 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:25:40 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:25:40 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:25:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:25:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:25:44 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:25:44 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:25:44 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:25:44 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:25:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:25:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:25:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:25:44 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:25:44 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:25:44 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:25:44 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:25:44 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:25:44 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:25:44 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:25:44 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:25:44 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:25:44 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:25:44 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:25:44 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:25:44 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:25:45 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:25:45 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:25:45 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:25:45 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:25:51 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 20:25:51 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 20:25:51 | INFO     | api.app:initialize_game:634 - Generated session ID: c05a8c6f-4621-4cd1-b0eb-35de66a7e502
2024-12-25 20:25:51 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 20:25:51 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 20:25:51 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 20:25:51 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 20:25:51 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 20:25:51 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3
2024-12-25 20:25:51 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\states
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\traces
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\characters
2024-12-25 20:25:51 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3
2024-12-25 20:25:51 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 20:25:51 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 20:25:51 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 20:25:51 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 20:25:51 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 20:25:51 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 20:25:51 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 20:25:51 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 20:25:51 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 20:25:51 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 20:25:51 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='c05a8c6f-4621-4cd1-b0eb-35de66a7e502' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 20:25:51 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\states\section_1.json
2024-12-25 20:25:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\states\section_1.json
2024-12-25 20:25:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\states\section_1.json
2024-12-25 20:25:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:25:51 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 20:25:51 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 20:25:51 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='c05a8c6f-4621-4cd1-b0eb-35de66a7e502' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 20:25:51 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 20:25:51 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 20:25:51 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 20:25:51 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 20:25:51 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\states\section_1.json
2024-12-25 20:25:51 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\states\section_1.json
2024-12-25 20:25:51 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\states\section_1.json
2024-12-25 20:25:51 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:25:51 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '6728b6a3-3d15-4441-ae88-8ddc5e969de0', 'error': "'dict' object has no attribute 'session_id'"}}
2024-12-25 20:25:51 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 20:25:51 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 20:25:51 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 20:25:51 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 20:25:51 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 20:25:51 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 20:25:51 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 20:25:51 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 20:25:51 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 20:25:51 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 20:25:51 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 20:25:51 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 20:25:51 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 20:25:51 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 20:25:51 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 20:25:51 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:25:51 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 20:25:51 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 20:25:51 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 20:25:51 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 20:25:51 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 20:25:51 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)), 'section_number': 1, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:25:51 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:25:51 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:25:51 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:25:51 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:48:34 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:48:34 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:48:34 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:48:34 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 20:48:34 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 20:48:34 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 20:48:34 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\states\current_state.json
2024-12-25 20:48:34 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\states\current_state.json
2024-12-25 20:48:34 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2bfe2586-06d5-4935-9c9d-5ee85f3ad8b3\states\current_state.json
2024-12-25 20:48:34 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:48:34 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 20:48:34 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 20:48:34 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 20:48:34 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:48:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:48:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:48:39 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:48:39 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:48:39 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:48:39 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:48:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:48:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:48:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:48:39 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:48:39 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:48:39 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:48:39 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:48:39 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:48:39 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:48:39 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:48:39 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:48:39 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:48:39 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:48:39 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:48:39 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:48:39 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:48:40 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:48:40 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:48:40 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:48:40 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:49:03 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:49:03 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:49:03 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:49:03 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:49:03 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:49:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:49:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:49:06 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:49:06 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:49:06 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:49:06 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:49:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:49:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:49:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:49:06 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:49:06 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:49:06 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:49:06 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:49:06 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:49:06 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:49:06 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:49:06 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:49:06 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:49:06 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:49:06 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:49:06 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:49:06 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:49:07 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:49:07 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:49:07 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:49:07 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:49:16 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 20:49:16 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 20:49:16 | INFO     | api.app:initialize_game:634 - Generated session ID: 0869e2b8-f5dd-4fe5-b235-72f33ea4d802
2024-12-25 20:49:16 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 20:49:16 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 20:49:16 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 20:49:16 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 20:49:16 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 20:49:16 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 759e3df3-b3b4-42fd-9250-e668ed1431f5
2024-12-25 20:49:16 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 759e3df3-b3b4-42fd-9250-e668ed1431f5
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\states
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\traces
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\characters
2024-12-25 20:49:16 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 759e3df3-b3b4-42fd-9250-e668ed1431f5
2024-12-25 20:49:16 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 20:49:16 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 20:49:16 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 20:49:16 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 20:49:16 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 20:49:16 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 20:49:16 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 20:49:16 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 20:49:16 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 20:49:16 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 20:49:16 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='0869e2b8-f5dd-4fe5-b235-72f33ea4d802' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 20:49:16 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\states\section_1.json
2024-12-25 20:49:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\states\section_1.json
2024-12-25 20:49:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\states\section_1.json
2024-12-25 20:49:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:49:16 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 20:49:16 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 20:49:16 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='0869e2b8-f5dd-4fe5-b235-72f33ea4d802' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 20:49:16 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 20:49:16 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 20:49:16 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 20:49:16 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'section_number': 1, 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 20:49:16 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\states\section_1.json
2024-12-25 20:49:16 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\states\section_1.json
2024-12-25 20:49:16 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\states\section_1.json
2024-12-25 20:49:16 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:49:16 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '5bde190a-3a54-414d-8107-b1c5aa12fe5b', 'section_number': 1, 'error': "'dict' object has no attribute 'session_id'"}}
2024-12-25 20:49:16 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 20:49:16 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 20:49:16 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 20:49:16 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 20:49:16 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 20:49:16 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 20:49:16 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 20:49:16 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 20:49:16 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 20:49:16 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 20:49:16 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 20:49:16 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 20:49:16 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 20:49:16 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 20:49:16 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 20:49:16 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:49:16 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 20:49:16 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 20:49:16 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 20:49:16 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 20:49:16 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 20:49:16 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'section_number': 1, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)), 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:49:16 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:49:16 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:49:16 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:49:16 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:49:57 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:49:57 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:49:57 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:49:57 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 20:49:57 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 20:49:57 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 20:49:57 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\states\current_state.json
2024-12-25 20:49:57 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\states\current_state.json
2024-12-25 20:49:57 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\759e3df3-b3b4-42fd-9250-e668ed1431f5\states\current_state.json
2024-12-25 20:49:57 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:49:57 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 20:49:57 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 20:49:57 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 20:49:57 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:49:58 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:50:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:50:02 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:50:02 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:50:02 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:50:02 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:50:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:50:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:50:02 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:50:02 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:50:02 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:50:02 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:50:02 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:50:02 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:50:02 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:50:02 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:50:02 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:50:02 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:50:02 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:50:02 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:50:02 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:50:02 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:50:03 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:50:03 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:50:03 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:50:03 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:50:09 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:50:09 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:50:09 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:50:09 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:50:09 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:50:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:50:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:50:13 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:50:13 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:50:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:50:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:50:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:50:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:50:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:50:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:50:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:50:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:50:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:50:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:50:13 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:50:13 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:50:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:50:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:50:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:50:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:50:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:50:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:50:14 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:50:14 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:50:14 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:50:14 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:50:44 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:50:44 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:50:44 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:50:44 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:50:44 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:50:45 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:50:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:50:48 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:50:48 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:50:48 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:50:48 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:50:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:50:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:50:48 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:50:48 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:50:48 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:50:48 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:50:48 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:50:48 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:50:48 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:50:48 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:50:48 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:50:48 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:50:48 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:50:48 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:50:48 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:50:48 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:50:49 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:50:49 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:50:49 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:50:49 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:50:49 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 20:50:49 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 20:50:49 | INFO     | api.app:initialize_game:634 - Generated session ID: 908be993-406f-4b61-9f5e-20f6c52d907b
2024-12-25 20:50:49 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 20:50:49 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 20:50:49 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 20:50:49 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 20:50:49 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 20:50:49 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: f53ed236-7ee2-41cd-9731-33396d91c42c
2024-12-25 20:50:49 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: f53ed236-7ee2-41cd-9731-33396d91c42c
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\states
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\traces
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\characters
2024-12-25 20:50:49 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: f53ed236-7ee2-41cd-9731-33396d91c42c
2024-12-25 20:50:49 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 20:50:49 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 20:50:49 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 20:50:49 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 20:50:49 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 20:50:49 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 20:50:49 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 20:50:49 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 20:50:49 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 20:50:49 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 20:50:49 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='908be993-406f-4b61-9f5e-20f6c52d907b' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 20:50:49 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\states\section_1.json
2024-12-25 20:50:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\states\section_1.json
2024-12-25 20:50:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\states\section_1.json
2024-12-25 20:50:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:50:49 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 20:50:49 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 20:50:49 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='908be993-406f-4b61-9f5e-20f6c52d907b' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 20:50:49 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 20:50:49 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 20:50:49 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 20:50:49 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'section_number': 1, 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 20:50:49 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\states\section_1.json
2024-12-25 20:50:49 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\states\section_1.json
2024-12-25 20:50:49 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\states\section_1.json
2024-12-25 20:50:49 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:50:49 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '078387d4-a11a-40ba-a54d-477fada4a0a6', 'section_number': 1, 'error': "'dict' object has no attribute 'session_id'"}}
2024-12-25 20:50:49 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 20:50:49 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 20:50:49 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 20:50:49 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 20:50:49 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 20:50:49 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 20:50:49 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 20:50:49 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 20:50:49 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:50:49 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 20:50:49 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 20:50:49 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 20:50:49 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 20:50:49 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 20:50:49 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 20:50:49 | ERROR    | agents.story_graph:_process_rules:115 - Error processing rules: 'RulesModel' object has no attribute 'section_number'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1672)
                                      │           └ <function spawn_main at 0x00000279C6CC0860>
                                      └ <function spawn_main at 0x00000279C6CC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 628
               │     └ 3
               └ <function _main at 0x00000279C6CC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 628
           │    └ <function BaseProcess._bootstrap at 0x00000279C6C06A20>
           └ <SpawnProcess name='SpawnProcess-118' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000279C6C05F80>
    └ <SpawnProcess name='SpawnProcess-118' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000279CCA14D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-118' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-118' parent=39512 started>
    │    └ <function subprocess_started at 0x00000279CCA0EF20>
    └ <SpawnProcess name='SpawnProcess-118' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=864, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000279CCA14EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=864, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000279CCA0E200>
           │       │   └ <uvicorn.server.Server object at 0x00000279CCA14EC0>
           │       └ <function run at 0x00000279C71063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000279CCA09A80>
           │      └ <function Runner.run at 0x00000279C71704A0>
           └ <asyncio.runners.Runner object at 0x00000279CCA15940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000279C7169E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000279CCA15940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000279C7169DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000279C716BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000279C70ED3A0>
    └ <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 103, in _process_rules
    output = GameState(
             └ <class 'models.game_state.GameState'>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     │    │                      │               │                   └ GameState(session_id='', section_number=1, narrative=None, rules=RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=Tru...
                     │    │                      │               └ {'session_id': '', 'rules': RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_act...
                     │    │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
                     │    └ SchemaValidator(title="GameState", validator=FunctionAfter(
                     │          FunctionAfterValidator {
                     │              validator: FunctionAfter(
                     │        ...
                     └ GameState(session_id='', section_number=1, narrative=None, rules=RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=Tru...

  File "C:\Users\erpes\Desktop\casys-rpg\models\game_state.py", line 80, in validate_section_numbers
    if self.rules and self.rules.section_number != self.section_number:
       │    │         │    │                       │    └ 1
       │    │         │    │                       └ GameState(session_id='', section_number=1, narrative=None, rules=RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=Tru...
       │    │         │    └ RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions...
       │    │         └ GameState(session_id='', section_number=1, narrative=None, rules=RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=Tru...
       │    └ RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions...
       └ GameState(session_id='', section_number=1, narrative=None, rules=RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=Tru...

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'section_number'
                                 └ RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions...

AttributeError: 'RulesModel' object has no attribute 'section_number'
2024-12-25 20:50:50 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 20:50:50 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:50:50 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 20:50:50 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 20:50:50 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 20:50:50 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 20:50:50 | ERROR    | agents.story_graph:_process_narrative:151 - Error processing narrative: 'NarratorModel' object has no attribute 'section_number'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1672)
                                      │           └ <function spawn_main at 0x00000279C6CC0860>
                                      └ <function spawn_main at 0x00000279C6CC0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 628
               │     └ 3
               └ <function _main at 0x00000279C6CC0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 628
           │    └ <function BaseProcess._bootstrap at 0x00000279C6C06A20>
           └ <SpawnProcess name='SpawnProcess-118' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000279C6C05F80>
    └ <SpawnProcess name='SpawnProcess-118' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000279CCA14D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-118' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-118' parent=39512 started>
    │    └ <function subprocess_started at 0x00000279CCA0EF20>
    └ <SpawnProcess name='SpawnProcess-118' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=864, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000279CCA14EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=864, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000279CCA0E200>
           │       │   └ <uvicorn.server.Server object at 0x00000279CCA14EC0>
           │       └ <function run at 0x00000279C71063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000279CCA09A80>
           │      └ <function Runner.run at 0x00000279C71704A0>
           └ <asyncio.runners.Runner object at 0x00000279CCA15940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000279C7169E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000279CCA15940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000279C7169DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000279C716BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000279C70ED3A0>
    └ <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 139, in _process_narrative
    output = GameState(
             └ <class 'models.game_state.GameState'>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     │    │                      │               │                   └ GameState(session_id='', section_number=1, narrative=NarratorModel(content="Vous vous enfoncez confortablement dans le siège ...
                     │    │                      │               └ {'session_id': '', 'narrative': NarratorModel(content="Vous vous enfoncez confortablement dans le siège antigravitationnel, f...
                     │    │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
                     │    └ SchemaValidator(title="GameState", validator=FunctionAfter(
                     │          FunctionAfterValidator {
                     │              validator: FunctionAfter(
                     │        ...
                     └ GameState(session_id='', section_number=1, narrative=NarratorModel(content="Vous vous enfoncez confortablement dans le siège ...

  File "C:\Users\erpes\Desktop\casys-rpg\models\game_state.py", line 74, in validate_section_numbers
    if self.narrative and self.narrative.section_number != self.section_number:
       │    │             │    │                           │    └ 1
       │    │             │    │                           └ GameState(session_id='', section_number=1, narrative=NarratorModel(content="Vous vous enfoncez confortablement dans le siège ...
       │    │             │    └ NarratorModel(content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaiss...
       │    │             └ GameState(session_id='', section_number=1, narrative=NarratorModel(content="Vous vous enfoncez confortablement dans le siège ...
       │    └ NarratorModel(content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaiss...
       └ GameState(session_id='', section_number=1, narrative=NarratorModel(content="Vous vous enfoncez confortablement dans le siège ...

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 892, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
                                 │                                          └ 'section_number'
                                 └ NarratorModel(content="Vous vous enfoncez confortablement dans le siège antigravitationnel, face aux commandes de votre vaiss...

AttributeError: 'NarratorModel' object has no attribute 'section_number'
2024-12-25 20:50:50 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'section_number': 1, 'error': "'RulesModel' object has no attribute 'section_number'", 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:50:50 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:50:50 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:50:50 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:50:50 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:52:05 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:52:05 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:52:05 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:52:05 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 20:52:05 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 20:52:05 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 20:52:05 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\states\current_state.json
2024-12-25 20:52:05 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\states\current_state.json
2024-12-25 20:52:05 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f53ed236-7ee2-41cd-9731-33396d91c42c\states\current_state.json
2024-12-25 20:52:05 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:52:05 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 20:52:05 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 20:52:05 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 20:52:05 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:52:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:52:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:52:09 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:52:09 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:52:09 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:52:09 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:52:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:52:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:52:09 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:52:09 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:09 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:52:09 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:52:09 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:09 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:52:09 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:52:09 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:52:09 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:52:09 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:52:09 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:52:09 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:52:09 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:52:10 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:52:10 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:52:10 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:52:10 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:52:24 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:52:24 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:52:24 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:52:24 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:52:24 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:52:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:52:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:52:28 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:52:28 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:52:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:52:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:52:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:52:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:52:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:52:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:52:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:52:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:28 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:52:28 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:52:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:52:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:52:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:52:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:52:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:52:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:52:29 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:52:29 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:52:29 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:52:29 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:52:37 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:52:37 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:52:37 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:52:37 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:52:37 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:52:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:52:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:52:40 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:52:40 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:52:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:52:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:52:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:52:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:52:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:52:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:52:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:52:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:40 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:52:40 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:52:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:52:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:52:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:52:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:52:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:52:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:52:41 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:52:41 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:52:41 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:52:41 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:52:45 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:52:45 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:52:45 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:52:45 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:52:45 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:52:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:52:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:52:50 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:52:50 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:52:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:52:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:52:50 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:52:50 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:52:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:52:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:52:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:52:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:52:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:52:50 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:52:50 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:52:50 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:52:50 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:52:50 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 20:52:50 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 20:52:50 | INFO     | api.app:initialize_game:634 - Generated session ID: b00be575-c689-4590-b368-d5b41e828422
2024-12-25 20:52:50 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 20:52:50 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 20:52:50 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 20:52:50 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 20:52:50 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 20:52:50 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 35072502-fb4d-4b40-88f5-6f278ddc5b0d
2024-12-25 20:52:50 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 35072502-fb4d-4b40-88f5-6f278ddc5b0d
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\states
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\traces
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\characters
2024-12-25 20:52:50 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 35072502-fb4d-4b40-88f5-6f278ddc5b0d
2024-12-25 20:52:50 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 20:52:50 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 20:52:50 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 20:52:50 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 20:52:50 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 20:52:50 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 20:52:50 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 20:52:50 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 20:52:50 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 20:52:50 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 20:52:50 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='b00be575-c689-4590-b368-d5b41e828422' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 20:52:50 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\states\section_1.json
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\states\section_1.json
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\states\section_1.json
2024-12-25 20:52:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:52:50 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 20:52:50 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 20:52:50 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='b00be575-c689-4590-b368-d5b41e828422' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 20:52:50 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 20:52:50 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 20:52:50 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 20:52:50 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'section_number': 1, 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 20:52:50 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\states\section_1.json
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\states\section_1.json
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\states\section_1.json
2024-12-25 20:52:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:52:50 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '730e4639-051f-4b6f-8858-9e395f5c41c3', 'section_number': 1, 'error': "'dict' object has no attribute 'session_id'"}}
2024-12-25 20:52:50 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 20:52:50 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 20:52:50 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 20:52:50 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 1
2024-12-25 20:52:50 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 20:52:50 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 20:52:50 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 20:52:50 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 20:52:50 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 20:52:50 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 20:52:50 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 20:52:50 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 1
2024-12-25 20:52:50 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:52:50 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 20:52:50 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 20:52:50 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 20:52:50 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 20:52:50 | DEBUG    | agents.story_graph:_process_narrative:145 - Narrative processing completed for section 1
2024-12-25 20:52:50 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'section_number': 1, 'rules': RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)), 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:52:50 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:52:50 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:52:50 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:52:50 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:53:31 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:53:31 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:53:31 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:53:31 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 20:53:31 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 20:53:31 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 20:53:31 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\states\current_state.json
2024-12-25 20:53:31 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\states\current_state.json
2024-12-25 20:53:31 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\35072502-fb4d-4b40-88f5-6f278ddc5b0d\states\current_state.json
2024-12-25 20:53:31 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:53:31 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 20:53:31 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 20:53:31 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 20:53:31 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:53:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:53:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:53:36 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:53:36 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:53:36 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:53:36 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:53:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:53:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:53:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:53:36 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:53:36 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:53:36 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:53:36 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:53:36 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:53:36 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:53:36 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:53:36 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:53:36 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:53:36 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:53:36 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:53:36 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:53:36 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:53:37 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:53:37 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:53:37 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:53:37 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:53:43 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:53:43 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:53:43 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:53:43 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:53:43 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:53:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:53:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:53:47 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:53:47 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:53:47 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:53:47 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:53:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:53:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:53:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:53:47 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:53:47 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:53:47 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:53:47 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:53:47 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:53:47 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:53:47 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:53:47 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:53:47 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:53:47 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:53:47 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:53:47 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:53:47 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:53:47 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:53:47 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:53:47 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:53:47 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:53:48 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 20:53:48 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 20:53:48 | INFO     | api.app:initialize_game:634 - Generated session ID: a04e3e24-372b-49bb-a5e1-81d5a56024c5
2024-12-25 20:53:48 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 20:53:48 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 20:53:48 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 20:53:48 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 20:53:48 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 20:53:48 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 3fa35caf-883d-4e38-94b0-07c2e3522f04
2024-12-25 20:53:48 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 3fa35caf-883d-4e38-94b0-07c2e3522f04
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\states
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\traces
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\characters
2024-12-25 20:53:48 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 3fa35caf-883d-4e38-94b0-07c2e3522f04
2024-12-25 20:53:48 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 20:53:48 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 20:53:48 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 20:53:48 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 20:53:48 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 20:53:48 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 20:53:48 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 20:53:48 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 20:53:48 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 20:53:48 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 20:53:48 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='a04e3e24-372b-49bb-a5e1-81d5a56024c5' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 20:53:48 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\states\section_1.json
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\states\section_1.json
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\states\section_1.json
2024-12-25 20:53:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:53:48 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 20:53:48 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 20:53:48 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='a04e3e24-372b-49bb-a5e1-81d5a56024c5' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 20:53:48 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 20:53:48 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 20:53:48 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 20:53:48 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'section_number': 1, 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 20:53:48 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\states\section_1.json
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\states\section_1.json
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\states\section_1.json
2024-12-25 20:53:48 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:53:48 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': 'a257debc-8386-4d99-a518-44c25b17c8e9', 'section_number': 1, 'error': "'dict' object has no attribute 'session_id'"}}
2024-12-25 20:53:48 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 2
2024-12-25 20:53:48 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 2
2024-12-25 20:53:48 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 2
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2_rules in namespace rules
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:53:48 | DEBUG    | managers.rules_manager:get_cached_rules:45 - No rules found in cache for section 2
2024-12-25 20:53:48 | DEBUG    | agents.rules_agent:process_section_rules:57 - No content provided, fetching raw content
2024-12-25 20:53:48 | INFO     | managers.rules_manager:get_raw_content:65 - Getting raw content for section 2
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:53:48 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 2
2024-12-25 20:53:48 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 2
2024-12-25 20:53:48 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 2
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2 in namespace sections
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:53:48 | DEBUG    | managers.narrator_manager:get_cached_content:43 - No content found in cache for section 2
2024-12-25 20:53:48 | DEBUG    | agents.narrator_agent:process_section:58 - No raw content provided, fetching from manager
2024-12-25 20:53:48 | INFO     | managers.narrator_manager:get_raw_content:63 - Getting raw content for section 2
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:53:48 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 20:53:48 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 20:53:48 | DEBUG    | managers.rules_manager:get_raw_content:84 - Found raw content for section 2
2024-12-25 20:53:48 | INFO     | agents.rules_agent:process_section_rules:69 - Analyzing rules for section 2 with LLM
2024-12-25 20:53:48 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:102 - Starting LLM extraction for section 2
2024-12-25 20:53:49 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 20:53:49 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:53:49 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 20:53:49 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 20:53:49 | DEBUG    | managers.narrator_manager:get_raw_content:83 - Found raw content for section 2
2024-12-25 20:53:49 | INFO     | agents.narrator_agent:process_section:66 - Processing content for section 2 with LLM
2024-12-25 20:53:49 | DEBUG    | agents.narrator_agent:_process_content:98 - Starting content processing with LLM
2024-12-25 20:53:49 | DEBUG    | agents.narrator_agent:_process_content:99 - Preparing messages for LLM with section 2 and content length 658
2024-12-25 20:53:49 | DEBUG    | agents.narrator_agent:_process_content:106 - Sending request to LLM
2024-12-25 20:53:52 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:181 - Processed choices: [{'text': 'Engage in combat with the Arcadian guard.', 'type': 'dice', 'target_section': None, 'conditions': [], 'dice_type': 'combat', 'dice_results': {'4': 263, '5-6': 34}}]
2024-12-25 20:53:52 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:185 - Created RulesModel: dice_type=<DiceType.COMBAT: 'combat'> needs_dice=True needs_user_response=True next_action='dice_first' conditions=[] choices=[Choice(text='Engage in combat with the Arcadian guard.', type=<ChoiceType.DICE: 'dice'>, target_section=None, conditions=[], dice_type=<DiceType.COMBAT: 'combat'>, dice_results={'4': 263, '5-6': 34})] rules_summary='You must engage in combat with the Arcadian guard. If you defeat him in four assaults, go to section 263. If you fail after four assaults, go to section 34.' error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2024, 12, 25, 20, 53, 52, 484274)
2024-12-25 20:53:52 | DEBUG    | agents.rules_agent:process_section_rules:74 - Analysis successful, saving to cache
2024-12-25 20:53:52 | ERROR    | agents.rules_agent:process_section_rules:84 - Error processing rules: 'RulesModel' object has no attribute 'section_number'
2024-12-25 20:53:52 | DEBUG    | agents.story_graph:_process_rules:109 - Rules processing completed for section 2
2024-12-25 20:53:52 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'section_number': 2, 'rules': RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=False, next_action=None, conditions=[], choices=[], rules_summary='', error="'RulesModel' object has no attribute 'section_number'", source='error', source_type=<SourceType.RAW: 'raw'>, last_update=datetime.datetime(2024, 12, 25, 20, 53, 52, 486487)), 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:53:52 | DEBUG    | agents.narrator_agent:_process_content:108 - Received response from LLM: {
    "content": "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défend...
2024-12-25 20:53:52 | DEBUG    | agents.narrator_agent:_process_content:125 - Parsing JSON response
2024-12-25 20:53:52 | DEBUG    | agents.narrator_agent:_process_content:127 - Parsed JSON data: {'content': "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage.\n\nVous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \nHabileté : 6  \nEndurance : 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]].", 'source_type': 'processed', 'error': None}
2024-12-25 20:53:52 | DEBUG    | agents.narrator_agent:_process_content:145 - Creating NarratorModel
2024-12-25 20:53:52 | DEBUG    | agents.narrator_agent:_process_content:152 - Successfully created NarratorModel: content="# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage.\n\nVous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \nHabileté : 6  \nEndurance : 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]]." source_type=<SourceType.PROCESSED: 'processed'> error=None timestamp=datetime.datetime(2024, 12, 25, 20, 53, 52, 533400) last_update=datetime.datetime(2024, 12, 25, 20, 53, 52, 533403)
2024-12-25 20:53:52 | ERROR    | agents.narrator_agent:process_section:81 - Error processing section 2: 'NarratorModel' object has no attribute 'section_number'
2024-12-25 20:53:52 | ERROR    | agents.story_graph:_process_narrative:151 - Error processing narrative: 'NarratorModel' object has no attribute 'section_number'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1672)
                                      │           └ <function spawn_main at 0x000001E10A6C0860>
                                      └ <function spawn_main at 0x000001E10A6C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 636
               │     └ 3
               └ <function _main at 0x000001E10A6C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 636
           │    └ <function BaseProcess._bootstrap at 0x000001E10A606A20>
           └ <SpawnProcess name='SpawnProcess-124' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001E10A605F80>
    └ <SpawnProcess name='SpawnProcess-124' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001E110600D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-124' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-124' parent=39512 started>
    │    └ <function subprocess_started at 0x000001E1103FEFC0>
    └ <SpawnProcess name='SpawnProcess-124' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=868, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001E110600EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=868, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001E1103FE2A0>
           │       │   └ <uvicorn.server.Server object at 0x000001E110600EC0>
           │       └ <function run at 0x000001E10AB063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001E1103F99A0>
           │      └ <function Runner.run at 0x000001E10AB704A0>
           └ <asyncio.runners.Runner object at 0x000001E110601940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001E10AB69E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001E110601940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001E10AB69DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001E10AB6BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001E10AAED3A0>
    └ <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 137, in _process_narrative
    raise narrator_result
          └ NarratorError("'NarratorModel' object has no attribute 'section_number'")

models.errors_model.NarratorError: 'NarratorModel' object has no attribute 'section_number'
2024-12-25 20:53:52 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'section_number': 1, 'error': "'NarratorModel' object has no attribute 'section_number'", 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:53:52 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'effects': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:53:52 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'effects': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:53:52 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'effects': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:53:52 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'effects': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:54:39 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:54:39 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:54:39 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:54:39 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 20:54:39 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 20:54:39 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 20:54:39 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\states\current_state.json
2024-12-25 20:54:39 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\states\current_state.json
2024-12-25 20:54:39 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\3fa35caf-883d-4e38-94b0-07c2e3522f04\states\current_state.json
2024-12-25 20:54:39 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:54:39 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 20:54:39 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 20:54:39 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 20:54:39 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:54:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:54:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:54:44 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:54:44 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:54:44 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:54:44 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:54:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:54:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:54:44 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:54:45 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:54:45 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:54:45 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:54:45 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:54:45 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:54:45 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:54:45 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:54:45 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:54:45 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:54:45 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:54:45 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:54:45 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:54:45 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:54:46 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:54:46 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:54:46 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:54:46 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:54:46 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:54:46 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:54:46 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:54:46 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:54:46 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:54:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:54:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:54:50 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:54:50 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:54:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:54:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:54:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:54:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:54:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:54:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:54:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:54:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:54:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:54:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:54:50 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:54:50 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:54:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:54:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:54:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:54:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:54:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:54:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:54:51 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:54:51 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:54:51 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:54:51 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:55:02 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:55:02 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:55:02 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:55:02 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:55:02 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:55:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:55:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:55:06 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:55:06 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:55:06 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:55:06 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:55:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:55:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:55:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:55:06 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:55:06 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:55:06 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:55:06 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:55:06 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:55:06 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:55:06 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:55:06 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:55:06 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:55:06 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:55:06 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:55:06 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:55:06 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:55:07 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:55:07 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:55:07 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:55:07 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:57:25 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 20:57:25 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 20:57:25 | INFO     | api.app:initialize_game:634 - Generated session ID: fa342eea-d226-4311-981d-5626154a6c33
2024-12-25 20:57:25 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 20:57:25 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 20:57:25 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 20:57:25 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 20:57:25 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 20:57:25 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 757fc0e4-ed7d-4bf2-a437-3e85c43a9871
2024-12-25 20:57:25 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 757fc0e4-ed7d-4bf2-a437-3e85c43a9871
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\states
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\traces
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\characters
2024-12-25 20:57:25 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 757fc0e4-ed7d-4bf2-a437-3e85c43a9871
2024-12-25 20:57:25 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 20:57:25 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 20:57:25 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 20:57:25 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 20:57:25 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 20:57:25 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 20:57:25 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 20:57:25 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 20:57:25 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 20:57:25 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 20:57:25 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='fa342eea-d226-4311-981d-5626154a6c33' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>
2024-12-25 20:57:25 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\states\section_1.json
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\states\section_1.json
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\states\section_1.json
2024-12-25 20:57:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:57:25 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 20:57:25 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 20:57:25 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='fa342eea-d226-4311-981d-5626154a6c33' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None effects={} flags={} source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 20:57:25 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 20:57:25 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 20:57:25 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 20:57:25 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'section_number': 1, 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'player_input': None, 'content': None, 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 20:57:25 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\states\section_1.json
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\states\section_1.json
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\states\section_1.json
2024-12-25 20:57:25 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 20:57:25 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '6ace8ffe-7091-4027-81dc-e2187523448a', 'section_number': 1, 'error': "'dict' object has no attribute 'session_id'"}}
2024-12-25 20:57:25 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 2
2024-12-25 20:57:25 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 2
2024-12-25 20:57:25 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 2
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2_rules in namespace rules
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:57:25 | DEBUG    | managers.rules_manager:get_cached_rules:45 - No rules found in cache for section 2
2024-12-25 20:57:25 | DEBUG    | agents.rules_agent:process_section_rules:57 - No content provided, fetching raw content
2024-12-25 20:57:25 | INFO     | managers.rules_manager:get_raw_content:65 - Getting raw content for section 2
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:57:25 | INFO     | agents.story_graph:_process_narrative:112 - Processing narrative for section 2
2024-12-25 20:57:25 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 2
2024-12-25 20:57:25 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 2
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2 in namespace sections
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:57:25 | DEBUG    | managers.narrator_manager:get_cached_content:43 - No content found in cache for section 2
2024-12-25 20:57:25 | DEBUG    | agents.narrator_agent:process_section:58 - No raw content provided, fetching from manager
2024-12-25 20:57:25 | INFO     | managers.narrator_manager:get_raw_content:63 - Getting raw content for section 2
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 20:57:25 | DEBUG    | managers.rules_manager:get_raw_content:84 - Found raw content for section 2
2024-12-25 20:57:25 | INFO     | agents.rules_agent:process_section_rules:68 - Analyzing rules for section 2 with LLM
2024-12-25 20:57:25 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:101 - Starting LLM extraction for section 2
2024-12-25 20:57:25 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 20:57:25 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 20:57:25 | DEBUG    | managers.narrator_manager:get_raw_content:83 - Found raw content for section 2
2024-12-25 20:57:25 | INFO     | agents.narrator_agent:process_section:66 - Processing content for section 2 with LLM
2024-12-25 20:57:25 | DEBUG    | agents.narrator_agent:_process_content:97 - Starting content processing with LLM
2024-12-25 20:57:25 | DEBUG    | agents.narrator_agent:_process_content:98 - Preparing messages for LLM with content length 658
2024-12-25 20:57:25 | DEBUG    | agents.narrator_agent:_process_content:105 - Sending request to LLM
2024-12-25 20:57:29 | DEBUG    | agents.narrator_agent:_process_content:107 - Received response from LLM: {
    "content": "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défend...
2024-12-25 20:57:29 | DEBUG    | agents.narrator_agent:_process_content:124 - Parsing JSON response
2024-12-25 20:57:29 | DEBUG    | agents.narrator_agent:_process_content:126 - Parsed JSON data: {'content': "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage. Vous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \n**HABILETÉ :** 6  \n**ENDURANCE :** 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]].", 'source_type': 'processed', 'error': None}
2024-12-25 20:57:29 | DEBUG    | agents.narrator_agent:_process_content:144 - Creating NarratorModel
2024-12-25 20:57:29 | DEBUG    | agents.narrator_agent:_process_content:150 - Successfully created NarratorModel: content="# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage. Vous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \n**HABILETÉ :** 6  \n**ENDURANCE :** 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]]." source_type=<SourceType.PROCESSED: 'processed'> error=None timestamp=datetime.datetime(2024, 12, 25, 20, 57, 29, 111194) last_update=datetime.datetime(2024, 12, 25, 20, 57, 29, 111194)
2024-12-25 20:57:29 | ERROR    | agents.narrator_agent:process_section:81 - Error processing section 2: 'NarratorModel' object has no attribute 'section_number'
2024-12-25 20:57:29 | ERROR    | agents.story_graph:_process_narrative:126 - Error processing narrative: 'NarratorModel' object has no attribute 'section_number'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1904)
                                      │           └ <function spawn_main at 0x000002A6C07C0860>
                                      └ <function spawn_main at 0x000002A6C07C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 612
               │     └ 3
               └ <function _main at 0x000002A6C07C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 612
           │    └ <function BaseProcess._bootstrap at 0x000002A6C0706A20>
           └ <SpawnProcess name='SpawnProcess-127' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000002A6C0705F80>
    └ <SpawnProcess name='SpawnProcess-127' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000002A6C6510AD0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-127' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-127' parent=39512 started>
    │    └ <function subprocess_started at 0x000002A6C64FEFC0>
    └ <SpawnProcess name='SpawnProcess-127' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000002A6C6510C20>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket [closed] fd=-1, family=2, type=1, proto=6>]
           │       │   │    └ <function Server.serve at 0x000002A6C64FE2A0>
           │       │   └ <uvicorn.server.Server object at 0x000002A6C6510C20>
           │       └ <function run at 0x000002A6C0C063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000002A6C64F99A0>
           │      └ <function Runner.run at 0x000002A6C0C704A0>
           └ <asyncio.runners.Runner object at 0x000002A6C65116A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000002A6C0C69E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000002A6C65116A0>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000002A6C0C69DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000002A6C0C6BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000002A6C0BED3A0>
    └ <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 118, in _process_narrative
    error=str(e)
              └ NarratorError("'NarratorModel' object has no attribute 'section_number'")

models.errors_model.NarratorError: 'NarratorModel' object has no attribute 'section_number'
2024-12-25 20:57:29 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'section_number': 1, 'error': "'NarratorModel' object has no attribute 'section_number'", 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:57:30 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:180 - Processed choices: [{'text': 'Vaincre le garde Arcadien', 'type': 'dice', 'target_section': 263, 'dice_type': 'combat', 'dice_results': {'4': 263, '5-6': 34}, 'conditions': []}]
2024-12-25 20:57:30 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:184 - Created RulesModel: dice_type=<DiceType.COMBAT: 'combat'> needs_dice=True needs_user_response=True next_action='dice_first' conditions=[] choices=[Choice(text='Vaincre le garde Arcadien', type=<ChoiceType.DICE: 'dice'>, target_section=263, conditions=[], dice_type=<DiceType.COMBAT: 'combat'>, dice_results={'4': 263, '5-6': 34})] rules_summary='You must defeat the Arcadian guard in combat. If you win within four assaults, go to section 263; if not, go to section 34.' error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2024, 12, 25, 20, 57, 30, 23674)
2024-12-25 20:57:30 | DEBUG    | agents.rules_agent:process_section_rules:73 - Analysis successful, saving to cache
2024-12-25 20:57:30 | ERROR    | agents.rules_agent:process_section_rules:83 - Error processing rules: 'RulesModel' object has no attribute 'section_number'
2024-12-25 20:57:30 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'section_number': 2, 'rules': RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=False, next_action=None, conditions=[], choices=[], rules_summary='', error="'RulesModel' object has no attribute 'section_number'", source='error', source_type=<SourceType.RAW: 'raw'>, last_update=datetime.datetime(2024, 12, 25, 20, 57, 30, 38938)), 'effects': {}, 'flags': {}, 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 20:57:30 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'effects': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:57:30 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'effects': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:57:30 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'effects': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:57:30 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'effects': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 20:57:30 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:57:30 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:57:30 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:57:30 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 20:57:30 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 20:57:30 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 20:57:30 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\states\current_state.json
2024-12-25 20:57:30 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\states\current_state.json
2024-12-25 20:57:30 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\757fc0e4-ed7d-4bf2-a437-3e85c43a9871\states\current_state.json
2024-12-25 20:57:30 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 20:57:30 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 20:57:30 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 20:57:30 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 20:57:30 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:57:30 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:57:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:57:32 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:57:32 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:57:32 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:57:32 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:57:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:57:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:57:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:57:32 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:57:32 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:57:32 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:57:32 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:57:32 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:57:32 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:57:32 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:57:32 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:57:32 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:57:32 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:57:32 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:57:32 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:57:32 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:57:33 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:57:33 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:57:33 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:57:33 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:59:11 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 20:59:11 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 20:59:11 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 20:59:11 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 20:59:11 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 20:59:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:59:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:59:18 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:59:18 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:59:18 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:59:18 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:59:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:59:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:59:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:59:18 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:59:18 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:59:18 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:59:18 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:59:18 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:59:18 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:59:18 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:59:18 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:59:18 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:59:18 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:59:18 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:59:18 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:59:18 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:59:19 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:59:19 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:59:19 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:59:19 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 20:59:19 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:59:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 20:59:22 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 20:59:22 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 20:59:22 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 20:59:22 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:59:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 20:59:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 20:59:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 20:59:22 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 20:59:22 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:59:22 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 20:59:22 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 20:59:22 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 20:59:22 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 20:59:22 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 20:59:22 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 20:59:22 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 20:59:22 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 20:59:22 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 20:59:22 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 20:59:22 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 20:59:23 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 20:59:23 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 20:59:23 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 20:59:23 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:00:11 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:00:11 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:00:11 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:00:11 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:00:11 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:00:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:00:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:00:18 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:00:18 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:00:18 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:00:18 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:00:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:00:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:00:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:00:18 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:00:18 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:00:18 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:00:18 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:00:18 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:00:18 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:00:18 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:00:18 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:00:18 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:00:18 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:00:18 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:00:18 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:00:18 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:00:18 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:00:18 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:00:18 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:00:18 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:00:41 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:00:41 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:00:41 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:00:41 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:00:41 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:00:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:00:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:00:47 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:00:47 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:00:47 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:00:47 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:00:47 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:00:47 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:00:47 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:00:47 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:00:47 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:00:47 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:00:47 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:00:47 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:00:47 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:00:47 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:00:47 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:00:47 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:00:47 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:00:47 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:00:47 | INFO     | api.app:initialize_game:634 - Generated session ID: b69f6c1a-4195-49e3-9946-b8d6615f1101
2024-12-25 21:00:47 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:00:47 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:00:47 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:00:47 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:00:47 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:00:47 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: a7c1914e-a6fa-4308-9f55-baf9fbc3d762
2024-12-25 21:00:47 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: a7c1914e-a6fa-4308-9f55-baf9fbc3d762
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\states
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\traces
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\characters
2024-12-25 21:00:47 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: a7c1914e-a6fa-4308-9f55-baf9fbc3d762
2024-12-25 21:00:47 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:00:47 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:00:47 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:00:47 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:00:47 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:00:47 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:00:47 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:00:47 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:00:47 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:00:47 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 21:00:47 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='b69f6c1a-4195-49e3-9946-b8d6615f1101' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:00:47 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\states\section_1.json
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\states\section_1.json
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\states\section_1.json
2024-12-25 21:00:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:00:47 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 21:00:47 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:00:47 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='b69f6c1a-4195-49e3-9946-b8d6615f1101' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:00:47 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:00:47 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:00:47 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:00:47 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'section_number': 1, 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 21:00:47 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\states\section_1.json
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\states\section_1.json
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\states\section_1.json
2024-12-25 21:00:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:00:47 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '8ad607e9-529f-4126-bc0f-60207054f4d5', 'section_number': 1, 'error': "'dict' object has no attribute 'session_id'"}}
2024-12-25 21:00:47 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 2
2024-12-25 21:00:47 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 2
2024-12-25 21:00:47 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 2
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2_rules in namespace rules
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:00:47 | DEBUG    | managers.rules_manager:get_cached_rules:45 - No rules found in cache for section 2
2024-12-25 21:00:47 | DEBUG    | agents.rules_agent:process_section_rules:57 - No content provided, fetching raw content
2024-12-25 21:00:47 | INFO     | managers.rules_manager:get_raw_content:65 - Getting raw content for section 2
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:00:47 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:00:47 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:00:47 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 2
2024-12-25 21:00:48 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 2
2024-12-25 21:00:48 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 2
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2 in namespace sections
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 21:00:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 21:00:48 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:00:48 | DEBUG    | managers.narrator_manager:get_cached_content:43 - No content found in cache for section 2
2024-12-25 21:00:48 | DEBUG    | agents.narrator_agent:process_section:58 - No raw content provided, fetching from manager
2024-12-25 21:00:48 | INFO     | managers.narrator_manager:get_raw_content:63 - Getting raw content for section 2
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:00:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:00:48 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:00:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:00:48 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:00:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:00:48 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:00:48 | DEBUG    | managers.rules_manager:get_raw_content:84 - Found raw content for section 2
2024-12-25 21:00:48 | INFO     | agents.rules_agent:process_section_rules:68 - Analyzing rules for section 2 with LLM
2024-12-25 21:00:48 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:99 - Starting LLM extraction for section 2
2024-12-25 21:00:48 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:00:48 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:00:48 | DEBUG    | managers.narrator_manager:get_raw_content:83 - Found raw content for section 2
2024-12-25 21:00:48 | INFO     | agents.narrator_agent:process_section:66 - Processing content for section 2 with LLM
2024-12-25 21:00:48 | DEBUG    | agents.narrator_agent:_process_content:96 - Starting content processing with LLM
2024-12-25 21:00:48 | DEBUG    | agents.narrator_agent:_process_content:97 - Preparing messages for LLM with content length 658
2024-12-25 21:00:48 | DEBUG    | agents.narrator_agent:_process_content:104 - Sending request to LLM
2024-12-25 21:00:52 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:178 - Processed choices: [{'text': 'Engage in combat with the Arcadian guard.', 'type': 'dice', 'target_section': None, 'conditions': [], 'dice_type': 'combat', 'dice_results': {'4-6': 263, '1-3': 34}}]
2024-12-25 21:00:52 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:182 - Created RulesModel: dice_type=<DiceType.COMBAT: 'combat'> needs_dice=True needs_user_response=True next_action='dice_first' conditions=[] choices=[Choice(text='Engage in combat with the Arcadian guard.', type=<ChoiceType.DICE: 'dice'>, target_section=None, conditions=[], dice_type=<DiceType.COMBAT: 'combat'>, dice_results={'4-6': 263, '1-3': 34})] rules_summary='You must engage in combat with the Arcadian guard. If you defeat him in four assaults, go to section 263; if not, go to section 34.' error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2024, 12, 25, 21, 0, 52, 300882)
2024-12-25 21:00:52 | DEBUG    | agents.rules_agent:process_section_rules:73 - Analysis successful, saving to cache
2024-12-25 21:00:52 | ERROR    | agents.rules_agent:process_section_rules:83 - Error processing rules: 'RulesModel' object has no attribute 'section_number'
2024-12-25 21:00:52 | ERROR    | agents.story_graph:_process_rules:115 - Error processing rules: 1 validation error for GameState
rules
  Input should be a valid dictionary or instance of RulesModel [type=model_type, input_value=RulesError("'RulesModel' ...ibute 'section_number'"), input_type=RulesError]
    For further information visit https://errors.pydantic.dev/2.10/v/model_type
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1664)
                                      │           └ <function spawn_main at 0x000001EEA61C0860>
                                      └ <function spawn_main at 0x000001EEA61C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 564
               │     └ 3
               └ <function _main at 0x000001EEA61C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 564
           │    └ <function BaseProcess._bootstrap at 0x000001EEA6106A20>
           └ <SpawnProcess name='SpawnProcess-132' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001EEA6105F80>
    └ <SpawnProcess name='SpawnProcess-132' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001EEABF00D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-132' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-132' parent=39512 started>
    │    └ <function subprocess_started at 0x000001EEABEFEFC0>
    └ <SpawnProcess name='SpawnProcess-132' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=848, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001EEABF00EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=848, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001EEABEFE2A0>
           │       │   └ <uvicorn.server.Server object at 0x000001EEABF00EC0>
           │       └ <function run at 0x000001EEA66063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001EEABEF9620>
           │      └ <function Runner.run at 0x000001EEA66704A0>
           └ <asyncio.runners.Runner object at 0x000001EEABF01940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001EEA6669E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001EEABF01940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001EEA6669DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001EEA666BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001EEA65ED3A0>
    └ <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 103, in _process_rules
    output = GameState(
             └ <class 'models.game_state.GameState'>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     │    │                      │               │                   └ GameState()
                     │    │                      │               └ {'session_id': '', 'rules': RulesError("'RulesModel' object has no attribute 'section_number'"), 'narrative_content': None, '...
                     │    │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
                     │    └ SchemaValidator(title="GameState", validator=FunctionAfter(
                     │          FunctionAfterValidator {
                     │              validator: FunctionAfter(
                     │        ...
                     └ GameState()

pydantic_core._pydantic_core.ValidationError: 1 validation error for GameState
rules
  Input should be a valid dictionary or instance of RulesModel [type=model_type, input_value=RulesError("'RulesModel' ...ibute 'section_number'"), input_type=RulesError]
    For further information visit https://errors.pydantic.dev/2.10/v/model_type
2024-12-25 21:00:52 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'section_number': 1, 'error': '1 validation error for GameState\nrules\n  Input should be a valid dictionary or instance of RulesModel [type=model_type, input_value=RulesError("\'RulesModel\' ...ibute \'section_number\'"), input_type=RulesError]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_type', 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 21:00:53 | DEBUG    | agents.narrator_agent:_process_content:106 - Received response from LLM: {
    "content": "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défend...
2024-12-25 21:00:53 | DEBUG    | agents.narrator_agent:_process_content:123 - Parsing JSON response
2024-12-25 21:00:53 | DEBUG    | agents.narrator_agent:_process_content:125 - Parsed JSON data: {'content': "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage.\n\nVous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \nHabileté : 6  \nEndurance : 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]].", 'source_type': 'processed', 'error': None}
2024-12-25 21:00:53 | DEBUG    | agents.narrator_agent:_process_content:143 - Creating NarratorModel
2024-12-25 21:00:53 | DEBUG    | agents.narrator_agent:_process_content:149 - Successfully created NarratorModel: content="# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage.\n\nVous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \nHabileté : 6  \nEndurance : 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]]." source_type=<SourceType.PROCESSED: 'processed'> error=None timestamp=datetime.datetime(2024, 12, 25, 21, 0, 53, 538139) last_update=datetime.datetime(2024, 12, 25, 21, 0, 53, 538143)
2024-12-25 21:00:53 | ERROR    | agents.narrator_agent:process_section:81 - Error processing section 2: 'NarratorModel' object has no attribute 'section_number'
2024-12-25 21:00:53 | ERROR    | agents.story_graph:_process_narrative:151 - Error processing narrative: 'NarratorModel' object has no attribute 'section_number'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1664)
                                      │           └ <function spawn_main at 0x000001EEA61C0860>
                                      └ <function spawn_main at 0x000001EEA61C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 564
               │     └ 3
               └ <function _main at 0x000001EEA61C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 564
           │    └ <function BaseProcess._bootstrap at 0x000001EEA6106A20>
           └ <SpawnProcess name='SpawnProcess-132' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x000001EEA6105F80>
    └ <SpawnProcess name='SpawnProcess-132' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x000001EEABF00D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-132' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-132' parent=39512 started>
    │    └ <function subprocess_started at 0x000001EEABEFEFC0>
    └ <SpawnProcess name='SpawnProcess-132' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=848, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x000001EEABF00EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=848, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x000001EEABEFE2A0>
           │       │   └ <uvicorn.server.Server object at 0x000001EEABF00EC0>
           │       └ <function run at 0x000001EEA66063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x000001EEABEF9620>
           │      └ <function Runner.run at 0x000001EEA66704A0>
           └ <asyncio.runners.Runner object at 0x000001EEABF01940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x000001EEA6669E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x000001EEABF01940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x000001EEA6669DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x000001EEA666BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x000001EEA65ED3A0>
    └ <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 137, in _process_narrative
    raise narrator_result
          └ NarratorError("'NarratorModel' object has no attribute 'section_number'")

models.errors_model.NarratorError: 'NarratorModel' object has no attribute 'section_number'
2024-12-25 21:00:53 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'section_number': 1, 'error': "'NarratorModel' object has no attribute 'section_number'", 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 21:00:53 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'error': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:00:53 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'error': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:00:53 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'error': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:00:53 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'error': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:01:48 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:01:48 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:01:48 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:01:48 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 21:01:48 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 21:01:48 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 21:01:48 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\states\current_state.json
2024-12-25 21:01:48 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\states\current_state.json
2024-12-25 21:01:48 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a7c1914e-a6fa-4308-9f55-baf9fbc3d762\states\current_state.json
2024-12-25 21:01:48 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:01:48 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 21:01:48 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 21:01:48 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 21:01:48 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:01:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:01:53 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:01:53 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:01:53 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:01:53 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:01:53 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:01:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:01:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:01:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:01:53 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:01:53 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:01:53 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:01:53 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:01:53 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:01:53 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:01:53 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:01:53 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:01:53 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:01:53 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:01:53 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:01:53 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:01:53 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:01:54 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:01:54 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:01:54 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:01:54 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:02:02 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:02:02 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:02:02 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:02:02 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:02:02 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:02:03 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:02:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:02:06 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:02:06 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:02:06 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:02:06 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:02:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:02:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:02:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:02:06 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:02:06 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:02:06 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:02:06 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:02:06 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:02:06 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:02:06 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:02:06 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:02:06 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:02:06 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:02:06 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:02:06 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:02:06 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:02:07 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:02:07 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:02:07 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:02:07 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:02:12 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:02:12 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:02:12 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:02:12 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:02:12 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:02:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:02:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:02:16 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:02:16 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:02:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:02:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:02:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:02:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:02:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:02:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:02:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:02:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:02:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:02:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:02:16 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:02:16 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:02:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:02:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:02:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:02:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:02:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:02:16 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:02:16 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:02:16 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:02:16 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:02:16 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:02:19 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:02:19 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:02:19 | INFO     | api.app:initialize_game:634 - Generated session ID: 2f3b9f3d-ba83-42a6-a31c-b54693033f66
2024-12-25 21:02:19 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:02:19 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:02:19 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:02:19 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:02:19 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:02:19 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 66b060d0-844f-4433-b883-357927c3ca4c
2024-12-25 21:02:19 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 66b060d0-844f-4433-b883-357927c3ca4c
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\states
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\traces
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\characters
2024-12-25 21:02:19 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 66b060d0-844f-4433-b883-357927c3ca4c
2024-12-25 21:02:19 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:02:19 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:02:19 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:02:19 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:02:19 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:02:19 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:02:19 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:02:19 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:02:19 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:02:19 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 21:02:19 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='2f3b9f3d-ba83-42a6-a31c-b54693033f66' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:02:19 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\states\section_1.json
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\states\section_1.json
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\states\section_1.json
2024-12-25 21:02:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:02:19 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 21:02:19 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:02:19 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='2f3b9f3d-ba83-42a6-a31c-b54693033f66' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:02:19 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:02:19 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:02:19 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:02:19 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'section_number': 1, 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 21:02:19 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\states\section_1.json
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\states\section_1.json
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\states\section_1.json
2024-12-25 21:02:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:02:19 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '21ad4523-1586-414c-8460-a544ea478054', 'section_number': 1, 'error': "'dict' object has no attribute 'session_id'"}}
2024-12-25 21:02:19 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 2
2024-12-25 21:02:19 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 2
2024-12-25 21:02:19 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 2
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2_rules in namespace rules
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:02:19 | DEBUG    | managers.rules_manager:get_cached_rules:45 - No rules found in cache for section 2
2024-12-25 21:02:19 | DEBUG    | agents.rules_agent:process_section_rules:57 - No content provided, fetching raw content
2024-12-25 21:02:19 | INFO     | managers.rules_manager:get_raw_content:65 - Getting raw content for section 2
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:02:19 | INFO     | agents.story_graph:_process_narrative:124 - Processing narrative for section 2
2024-12-25 21:02:19 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 2
2024-12-25 21:02:19 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 2
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2 in namespace sections
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:02:19 | DEBUG    | managers.narrator_manager:get_cached_content:43 - No content found in cache for section 2
2024-12-25 21:02:19 | DEBUG    | agents.narrator_agent:process_section:58 - No raw content provided, fetching from manager
2024-12-25 21:02:19 | INFO     | managers.narrator_manager:get_raw_content:63 - Getting raw content for section 2
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:02:19 | DEBUG    | managers.rules_manager:get_raw_content:84 - Found raw content for section 2
2024-12-25 21:02:19 | INFO     | agents.rules_agent:process_section_rules:68 - Analyzing rules for section 2 with LLM
2024-12-25 21:02:19 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:99 - Starting LLM extraction for section 2
2024-12-25 21:02:19 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:02:19 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:02:19 | DEBUG    | managers.narrator_manager:get_raw_content:83 - Found raw content for section 2
2024-12-25 21:02:19 | INFO     | agents.narrator_agent:process_section:66 - Processing content for section 2 with LLM
2024-12-25 21:02:19 | DEBUG    | agents.narrator_agent:_process_content:96 - Starting content processing with LLM
2024-12-25 21:02:19 | DEBUG    | agents.narrator_agent:_process_content:97 - Preparing messages for LLM with content length 658
2024-12-25 21:02:19 | DEBUG    | agents.narrator_agent:_process_content:104 - Sending request to LLM
2024-12-25 21:02:22 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:178 - Processed choices: [{'text': 'Engage in combat with the Arcadian guard.', 'type': 'dice', 'target_section': None, 'conditions': [], 'dice_type': 'combat', 'dice_results': {'4-6': 263, '1-3': 34}}]
2024-12-25 21:02:22 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:182 - Created RulesModel: dice_type=<DiceType.COMBAT: 'combat'> needs_dice=True needs_user_response=True next_action='dice_first' conditions=[] choices=[Choice(text='Engage in combat with the Arcadian guard.', type=<ChoiceType.DICE: 'dice'>, target_section=None, conditions=[], dice_type=<DiceType.COMBAT: 'combat'>, dice_results={'4-6': 263, '1-3': 34})] rules_summary='You must engage in combat with the Arcadian guard. If you defeat him in four assaults, go to section 263; if not, go to section 34.' error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2024, 12, 25, 21, 2, 22, 915332)
2024-12-25 21:02:22 | DEBUG    | agents.rules_agent:process_section_rules:73 - Analysis successful, saving to cache
2024-12-25 21:02:22 | ERROR    | agents.rules_agent:process_section_rules:83 - Error processing rules: 'RulesModel' object has no attribute 'section_number'
2024-12-25 21:02:22 | ERROR    | agents.story_graph:_process_rules:115 - Error processing rules: 1 validation error for GameState
rules
  Input should be a valid dictionary or instance of RulesModel [type=model_type, input_value=RulesError("'RulesModel' ...ibute 'section_number'"), input_type=RulesError]
    For further information visit https://errors.pydantic.dev/2.10/v/model_type
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1664)
                                      │           └ <function spawn_main at 0x00000257E09C0860>
                                      └ <function spawn_main at 0x00000257E09C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 620
               │     └ 3
               └ <function _main at 0x00000257E09C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 620
           │    └ <function BaseProcess._bootstrap at 0x00000257E0906A20>
           └ <SpawnProcess name='SpawnProcess-135' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000257E0905F80>
    └ <SpawnProcess name='SpawnProcess-135' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000257E6700D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-135' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-135' parent=39512 started>
    │    └ <function subprocess_started at 0x00000257E66FEFC0>
    └ <SpawnProcess name='SpawnProcess-135' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=800, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000257E6700EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=800, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000257E66FE2A0>
           │       │   └ <uvicorn.server.Server object at 0x00000257E6700EC0>
           │       └ <function run at 0x00000257E0E063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000257E66F9620>
           │      └ <function Runner.run at 0x00000257E0E704A0>
           └ <asyncio.runners.Runner object at 0x00000257E6701940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000257E0E69E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000257E6701940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000257E0E69DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000257E0E6BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000257E0DED3A0>
    └ <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 103, in _process_rules
    output = GameState(
             └ <class 'models.game_state.GameState'>

  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\pydantic\main.py", line 214, in __init__
    validated_self = self.__pydantic_validator__.validate_python(data, self_instance=self)
                     │    │                      │               │                   └ GameState()
                     │    │                      │               └ {'session_id': '', 'rules': RulesError("'RulesModel' object has no attribute 'section_number'"), 'narrative_content': None, '...
                     │    │                      └ <method 'validate_python' of 'pydantic_core._pydantic_core.SchemaValidator' objects>
                     │    └ SchemaValidator(title="GameState", validator=FunctionAfter(
                     │          FunctionAfterValidator {
                     │              validator: FunctionAfter(
                     │        ...
                     └ GameState()

pydantic_core._pydantic_core.ValidationError: 1 validation error for GameState
rules
  Input should be a valid dictionary or instance of RulesModel [type=model_type, input_value=RulesError("'RulesModel' ...ibute 'section_number'"), input_type=RulesError]
    For further information visit https://errors.pydantic.dev/2.10/v/model_type
2024-12-25 21:02:22 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'section_number': 1, 'error': '1 validation error for GameState\nrules\n  Input should be a valid dictionary or instance of RulesModel [type=model_type, input_value=RulesError("\'RulesModel\' ...ibute \'section_number\'"), input_type=RulesError]\n    For further information visit https://errors.pydantic.dev/2.10/v/model_type', 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 21:02:23 | DEBUG    | agents.narrator_agent:_process_content:106 - Received response from LLM: {
    "content": "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défend...
2024-12-25 21:02:23 | DEBUG    | agents.narrator_agent:_process_content:123 - Parsing JSON response
2024-12-25 21:02:23 | DEBUG    | agents.narrator_agent:_process_content:125 - Parsed JSON data: {'content': "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage. Vous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \n**HABILETÉ :** 6  \n**ENDURANCE :** 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]].", 'source_type': 'processed', 'error': None}
2024-12-25 21:02:23 | DEBUG    | agents.narrator_agent:_process_content:143 - Creating NarratorModel
2024-12-25 21:02:23 | DEBUG    | agents.narrator_agent:_process_content:149 - Successfully created NarratorModel: content="# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage. Vous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \n**HABILETÉ :** 6  \n**ENDURANCE :** 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]]." source_type=<SourceType.PROCESSED: 'processed'> error=None timestamp=datetime.datetime(2024, 12, 25, 21, 2, 23, 409355) last_update=datetime.datetime(2024, 12, 25, 21, 2, 23, 409356)
2024-12-25 21:02:23 | ERROR    | agents.narrator_agent:process_section:81 - Error processing section 2: 'NarratorModel' object has no attribute 'section_number'
2024-12-25 21:02:23 | ERROR    | agents.story_graph:_process_narrative:151 - Error processing narrative: 'NarratorModel' object has no attribute 'section_number'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1664)
                                      │           └ <function spawn_main at 0x00000257E09C0860>
                                      └ <function spawn_main at 0x00000257E09C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 620
               │     └ 3
               └ <function _main at 0x00000257E09C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 620
           │    └ <function BaseProcess._bootstrap at 0x00000257E0906A20>
           └ <SpawnProcess name='SpawnProcess-135' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000257E0905F80>
    └ <SpawnProcess name='SpawnProcess-135' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000257E6700D70>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-135' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-135' parent=39512 started>
    │    └ <function subprocess_started at 0x00000257E66FEFC0>
    └ <SpawnProcess name='SpawnProcess-135' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=800, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000257E6700EC0>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=800, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000257E66FE2A0>
           │       │   └ <uvicorn.server.Server object at 0x00000257E6700EC0>
           │       └ <function run at 0x00000257E0E063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000257E66F9620>
           │      └ <function Runner.run at 0x00000257E0E704A0>
           └ <asyncio.runners.Runner object at 0x00000257E6701940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000257E0E69E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000257E6701940>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000257E0E69DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000257E0E6BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000257E0DED3A0>
    └ <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 137, in _process_narrative
    raise narrator_result
          └ NarratorError("'NarratorModel' object has no attribute 'section_number'")

models.errors_model.NarratorError: 'NarratorModel' object has no attribute 'section_number'
2024-12-25 21:02:23 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'section_number': 1, 'error': "'NarratorModel' object has no attribute 'section_number'", 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 21:02:23 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:02:23 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:02:23 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:02:23 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:03:05 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:03:05 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:03:05 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:03:05 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 21:03:05 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 21:03:05 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 21:03:05 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\states\current_state.json
2024-12-25 21:03:05 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\states\current_state.json
2024-12-25 21:03:05 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66b060d0-844f-4433-b883-357927c3ca4c\states\current_state.json
2024-12-25 21:03:05 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:03:05 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 21:03:05 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 21:03:05 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 21:03:05 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:03:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:03:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:03:09 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:03:09 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:03:09 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:03:09 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:03:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:03:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:03:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:03:09 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:03:09 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:03:09 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:03:09 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:03:09 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:03:09 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:03:09 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:03:09 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:03:09 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:03:09 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:03:09 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:03:09 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:03:09 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:03:10 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:03:10 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:03:10 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:03:10 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:03:11 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:03:11 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:03:11 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:03:11 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:03:11 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:03:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:03:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:03:16 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:03:16 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:03:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:03:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:03:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:03:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:03:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:03:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:03:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:03:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:03:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:03:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:03:16 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:03:16 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:03:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:03:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:03:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:03:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:03:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:03:16 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:03:17 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:03:17 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:03:17 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:03:17 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:06:09 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:06:09 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:06:09 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:06:09 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:06:09 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:06:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:06:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:06:16 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:06:16 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:06:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:06:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:06:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:06:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:06:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:06:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:06:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:06:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:06:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:06:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:06:16 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:06:16 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:06:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:06:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:06:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:06:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:06:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:06:16 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:06:18 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:06:18 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:06:18 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:06:18 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:06:24 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:06:24 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:06:24 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:06:24 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:06:24 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:06:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:06:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:06:28 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:06:28 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:06:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:06:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:06:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:06:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:06:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:06:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:06:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:06:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:06:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:06:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:06:28 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:06:28 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:06:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:06:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:06:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:06:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:06:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:06:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:06:29 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:06:29 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:06:29 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:06:29 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:06:40 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:06:40 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:06:40 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:06:40 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:06:40 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:06:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:06:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:06:46 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:06:46 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:06:46 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:06:46 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:06:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:06:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:06:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:06:46 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:06:46 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:06:46 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:06:46 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:06:46 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:06:46 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:06:46 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:06:46 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:06:46 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:06:46 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:06:46 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:06:46 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:06:46 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:06:46 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:06:46 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:06:46 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:06:46 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:09:13 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:09:13 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:09:13 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:09:13 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:09:13 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:09:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:09:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:09:18 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:09:18 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:09:18 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:09:18 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:09:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:09:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:09:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:09:18 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:09:18 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:09:18 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:09:18 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:09:18 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:09:18 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:09:18 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:09:18 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:09:18 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:09:18 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:09:18 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:09:18 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:09:18 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:09:19 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:09:19 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:09:19 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:09:19 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:10:17 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:10:17 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:10:17 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:10:17 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:10:17 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:10:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:10:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:10:21 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:10:21 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:10:21 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:10:21 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:10:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:10:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:10:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:10:21 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:10:21 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:10:21 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:10:21 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:10:21 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:10:21 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:10:21 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:10:21 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:10:21 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:10:21 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:10:21 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:10:21 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:10:21 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:10:22 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:10:22 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:10:22 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:10:22 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:10:24 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:10:24 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:10:24 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:10:24 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:10:24 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:10:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:10:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:10:28 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:10:28 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:10:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:10:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:10:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:10:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:10:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:10:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:10:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:10:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:10:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:10:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:10:28 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:10:28 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:10:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:10:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:10:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:10:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:10:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:10:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:10:29 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:10:29 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:10:29 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:10:29 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:11:03 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:11:03 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:11:03 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:11:03 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:11:03 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:11:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:11:08 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:11:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:11:11 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:11:11 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:11:11 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:11:11 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:11:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:11:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:11:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:11:11 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:11:11 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:11:11 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:11:11 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:11:11 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:11:11 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:11:11 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:11:11 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:11:11 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:11:11 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:11:11 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:11:11 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:11:11 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:11:11 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:11:11 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:11:11 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:11:11 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:13:11 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:13:11 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:13:11 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:13:11 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:13:11 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:13:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:13:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:13:14 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:13:14 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:13:14 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:13:14 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:13:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:13:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:13:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:13:14 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:13:14 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:13:14 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:13:14 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:13:14 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:13:14 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:13:14 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:13:14 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:13:14 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:13:14 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:13:14 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:13:14 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:13:14 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:13:15 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:13:15 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:13:15 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:13:15 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:14:22 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:14:22 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:14:22 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:14:22 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:14:22 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:14:23 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:14:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:14:28 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:14:28 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:14:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:14:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:14:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:14:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:14:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:14:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:14:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:14:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:14:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:14:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:14:28 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:14:28 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:14:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:14:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:14:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:14:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:14:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:14:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:14:29 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:14:29 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:14:29 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:14:29 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:14:32 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:14:32 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:14:32 | INFO     | api.app:initialize_game:634 - Generated session ID: 54781cbd-b145-4297-b956-85a288ccf1db
2024-12-25 21:14:32 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:14:32 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:14:32 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:14:32 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:14:32 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:14:32 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: b6567358-46e2-4ea1-a2a0-7b1fa407386d
2024-12-25 21:14:32 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: b6567358-46e2-4ea1-a2a0-7b1fa407386d
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\states
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\traces
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\characters
2024-12-25 21:14:32 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: b6567358-46e2-4ea1-a2a0-7b1fa407386d
2024-12-25 21:14:32 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:14:32 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:14:32 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:14:32 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:14:32 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:14:32 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:14:32 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:14:32 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:14:32 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:14:32 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 21:14:32 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='54781cbd-b145-4297-b956-85a288ccf1db' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:14:32 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\states\section_1.json
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\states\section_1.json
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\states\section_1.json
2024-12-25 21:14:32 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:14:32 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 21:14:32 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:14:32 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='54781cbd-b145-4297-b956-85a288ccf1db' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:14:32 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:14:32 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:14:32 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:14:32 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'section_number': 1, 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 21:14:32 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\states\section_1.json
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\states\section_1.json
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\states\section_1.json
2024-12-25 21:14:32 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:14:32 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': 'a1e395a3-3f11-4d90-9eeb-77405b7b3901', 'section_number': 1, 'error': "'dict' object has no attribute 'session_id'"}}
2024-12-25 21:14:32 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 2
2024-12-25 21:14:32 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 2
2024-12-25 21:14:32 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 2
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2_rules in namespace rules
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:14:32 | DEBUG    | managers.rules_manager:get_cached_rules:45 - No rules found in cache for section 2
2024-12-25 21:14:32 | DEBUG    | agents.rules_agent:process_section_rules:57 - No content provided, fetching raw content
2024-12-25 21:14:32 | INFO     | managers.rules_manager:get_raw_content:65 - Getting raw content for section 2
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:14:32 | INFO     | agents.story_graph:_process_narrative:127 - Processing narrative for section 2
2024-12-25 21:14:32 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 2
2024-12-25 21:14:32 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 2
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2 in namespace sections
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:14:32 | DEBUG    | managers.narrator_manager:get_cached_content:43 - No content found in cache for section 2
2024-12-25 21:14:32 | DEBUG    | agents.narrator_agent:process_section:58 - No raw content provided, fetching from manager
2024-12-25 21:14:32 | INFO     | managers.narrator_manager:get_raw_content:63 - Getting raw content for section 2
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-25 21:14:32 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:14:32 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:14:32 | DEBUG    | managers.rules_manager:get_raw_content:84 - Found raw content for section 2
2024-12-25 21:14:32 | INFO     | agents.rules_agent:process_section_rules:69 - Analyzing rules for section 2 with LLM
2024-12-25 21:14:32 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:102 - Starting LLM extraction for section 2
2024-12-25 21:14:33 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-25 21:14:33 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:14:33 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-25 21:14:33 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-25 21:14:33 | DEBUG    | managers.narrator_manager:get_raw_content:83 - Found raw content for section 2
2024-12-25 21:14:33 | INFO     | agents.narrator_agent:process_section:66 - Processing content for section 2 with LLM
2024-12-25 21:14:33 | DEBUG    | agents.narrator_agent:_process_content:97 - Starting content processing with LLM
2024-12-25 21:14:33 | DEBUG    | agents.narrator_agent:_process_content:98 - Preparing messages for LLM with content length 658
2024-12-25 21:14:33 | DEBUG    | agents.narrator_agent:_process_content:105 - Sending request to LLM
2024-12-25 21:14:37 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:181 - Processed choices: [{'text': 'Engage in combat with the Arcadian guard.', 'type': 'dice', 'target_section': None, 'conditions': [], 'dice_type': 'combat', 'dice_results': {'4': 263, '5-6': 34}}]
2024-12-25 21:14:37 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:185 - Created RulesModel: dice_type=<DiceType.COMBAT: 'combat'> needs_dice=True needs_user_response=True next_action='dice_first' conditions=[] choices=[Choice(text='Engage in combat with the Arcadian guard.', type=<ChoiceType.DICE: 'dice'>, target_section=None, conditions=[], dice_type=<DiceType.COMBAT: 'combat'>, dice_results={'4': 263, '5-6': 34})] rules_summary='You must engage in combat with the Arcadian guard. If you defeat him in four assaults, go to section 263; if not, go to section 34.' error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2024, 12, 25, 21, 14, 37, 828667)
2024-12-25 21:14:37 | DEBUG    | agents.rules_agent:process_section_rules:74 - Analysis successful, saving to cache
2024-12-25 21:14:37 | ERROR    | agents.rules_agent:process_section_rules:84 - Error processing rules: 'RulesModel' object has no attribute 'section_number'
2024-12-25 21:14:37 | DEBUG    | agents.story_graph:_process_rules:112 - Rules processing completed for section 2
2024-12-25 21:14:37 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'section_number': 2, 'rules': RulesModel(dice_type=<DiceType.NONE: 'none'>, needs_dice=False, needs_user_response=False, next_action=None, conditions=[], choices=[], rules_summary='', error="'RulesModel' object has no attribute 'section_number'", source='error', source_type=<SourceType.RAW: 'raw'>, last_update=datetime.datetime(2024, 12, 25, 21, 14, 37, 831232)), 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 21:14:38 | DEBUG    | agents.narrator_agent:_process_content:107 - Received response from LLM: {
    "content": "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défend...
2024-12-25 21:14:38 | DEBUG    | agents.narrator_agent:_process_content:124 - Parsing JSON response
2024-12-25 21:14:38 | DEBUG    | agents.narrator_agent:_process_content:126 - Parsed JSON data: {'content': "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage. Vous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \n**HABILETÉ** : 6  \n**ENDURANCE** : 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]].", 'source_type': 'processed', 'error': None}
2024-12-25 21:14:38 | DEBUG    | agents.narrator_agent:_process_content:144 - Creating NarratorModel
2024-12-25 21:14:38 | DEBUG    | agents.narrator_agent:_process_content:151 - Successfully created NarratorModel: content="# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage. Vous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \n**HABILETÉ** : 6  \n**ENDURANCE** : 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]]." source_type=<SourceType.PROCESSED: 'processed'> error=None timestamp=datetime.datetime(2024, 12, 25, 21, 14, 38, 568737) last_update=datetime.datetime(2024, 12, 25, 21, 14, 38, 568740)
2024-12-25 21:14:38 | ERROR    | agents.narrator_agent:process_section:81 - Error processing section 2: 'NarratorModel' object has no attribute 'section_number'
2024-12-25 21:14:38 | ERROR    | agents.story_graph:_process_narrative:154 - Error processing narrative: 'NarratorModel' object has no attribute 'section_number'
Traceback (most recent call last):

  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(parent_pid=39512, pipe_handle=1688)
                                      │           └ <function spawn_main at 0x00000198D43C0860>
                                      └ <function spawn_main at 0x00000198D43C0860>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
               │     │   └ 632
               │     └ 3
               └ <function _main at 0x00000198D43C0900>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\spawn.py", line 135, in _main
    return self._bootstrap(parent_sentinel)
           │    │          └ 632
           │    └ <function BaseProcess._bootstrap at 0x00000198D4306A20>
           └ <SpawnProcess name='SpawnProcess-147' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 313, in _bootstrap
    self.run()
    │    └ <function BaseProcess.run at 0x00000198D4305F80>
    └ <SpawnProcess name='SpawnProcess-147' parent=39512 started>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\multiprocessing\process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {'config': <uvicorn.config.Config object at 0x00000198DA400EC0>, 'target': <bound method Server.run of <uvicorn.server.Server...
    │    │        │    │        └ <SpawnProcess name='SpawnProcess-147' parent=39512 started>
    │    │        │    └ ()
    │    │        └ <SpawnProcess name='SpawnProcess-147' parent=39512 started>
    │    └ <function subprocess_started at 0x00000198DA1FF060>
    └ <SpawnProcess name='SpawnProcess-147' parent=39512 started>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    │              └ [<socket.socket fd=840, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
    └ <bound method Server.run of <uvicorn.server.Server object at 0x00000198DA401010>>
  File "C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\server.py", line 66, in run
    return asyncio.run(self.serve(sockets=sockets))
           │       │   │    │             └ [<socket.socket fd=840, family=2, type=1, proto=6, laddr=('127.0.0.1', 8000)>]
           │       │   │    └ <function Server.serve at 0x00000198DA1FE340>
           │       │   └ <uvicorn.server.Server object at 0x00000198DA401010>
           │       └ <function run at 0x00000198D49063E0>
           └ <module 'asyncio' from 'C:\\Program Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\\L...
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 194, in run
    return runner.run(main)
           │      │   └ <coroutine object Server.serve at 0x00000198DA1F9620>
           │      └ <function Runner.run at 0x00000198D49704A0>
           └ <asyncio.runners.Runner object at 0x00000198DA401A90>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           │    │     │                  └ <Task pending name='Task-1' coro=<Server.serve() running at C:\Users\erpes\Desktop\casys-rpg\.venv\Lib\site-packages\uvicorn\...
           │    │     └ <function BaseEventLoop.run_until_complete at 0x00000198D4969E40>
           │    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
           └ <asyncio.runners.Runner object at 0x00000198DA401A90>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 707, in run_until_complete
    self.run_forever()
    │    └ <function BaseEventLoop.run_forever at 0x00000198D4969DA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 678, in run_forever
    self._run_once()
    │    └ <function BaseEventLoop._run_once at 0x00000198D496BBA0>
    └ <_WindowsSelectorEventLoop running=True closed=False debug=False>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\base_events.py", line 2033, in _run_once
    handle._run()
    │      └ <function Handle._run at 0x00000198D48ED3A0>
    └ <Handle Task.task_wakeup()>
  File "C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.13_3.13.496.0_x64__qbz5n2kfra8p0\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    │    │            │    │           │    └ <member '_args' of 'Handle' objects>
    │    │            │    │           └ <Handle Task.task_wakeup()>
    │    │            │    └ <member '_callback' of 'Handle' objects>
    │    │            └ <Handle Task.task_wakeup()>
    │    └ <member '_context' of 'Handle' objects>
    └ <Handle Task.task_wakeup()>

> File "C:\Users\erpes\Desktop\casys-rpg\agents\story_graph.py", line 140, in _process_narrative
    raise narrator_result
          └ NarratorError("'NarratorModel' object has no attribute 'section_number'")

models.errors_model.NarratorError: 'NarratorModel' object has no attribute 'section_number'
2024-12-25 21:14:38 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'section_number': 1, 'error': "'NarratorModel' object has no attribute 'section_number'", 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 21:14:38 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:14:38 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:14:38 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:14:38 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:17:08 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:17:08 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:17:08 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:17:08 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 21:17:08 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 21:17:08 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 21:17:08 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\states\current_state.json
2024-12-25 21:17:08 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\states\current_state.json
2024-12-25 21:17:08 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b6567358-46e2-4ea1-a2a0-7b1fa407386d\states\current_state.json
2024-12-25 21:17:08 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:17:08 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 21:17:08 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 21:17:08 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 21:17:08 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:17:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:17:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:17:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:17:17 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:17:17 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:17:17 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:17:17 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:17:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:17:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:17:17 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:17:17 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:17 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:17:17 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:17:17 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:17 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:17:17 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:17:17 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:17:17 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:17:17 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:17:17 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:17:17 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:17:17 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:17:18 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:17:18 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:17:18 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:17:18 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:17:33 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:17:33 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:17:33 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:17:33 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:17:33 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:17:34 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:17:38 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:17:38 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:17:38 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:17:38 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:17:38 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:17:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:17:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:17:38 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:17:38 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:38 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:17:38 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:17:38 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:38 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:17:38 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:17:38 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:17:38 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:17:38 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:17:38 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:17:38 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:17:38 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:17:39 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:17:39 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:17:39 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:17:39 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:17:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:17:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:17:43 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:17:43 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:17:43 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:17:43 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:17:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:17:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:17:43 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:17:43 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:43 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:17:43 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:17:43 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:43 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:17:43 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:17:43 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:17:43 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:17:43 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:17:43 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:17:43 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:17:43 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:17:43 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:17:43 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:17:43 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:17:43 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:17:46 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:17:46 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:17:46 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:17:46 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:17:46 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:17:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:17:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:17:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:17:56 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:17:56 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:17:56 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:17:56 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:17:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:17:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:17:56 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:17:56 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:56 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:17:56 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:17:56 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:17:56 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:17:56 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:17:56 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:17:56 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:17:56 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:17:56 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:17:56 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:17:56 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:17:56 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:17:56 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:17:56 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:17:56 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:18:35 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:18:35 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:18:35 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:18:35 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:18:35 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:18:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:18:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:18:39 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:18:39 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:18:39 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:18:39 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:18:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:18:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:18:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:18:39 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:18:39 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:18:39 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:18:39 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:18:39 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:18:39 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:18:39 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:18:39 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:18:39 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:18:39 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:18:39 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:18:39 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:18:39 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:18:40 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:18:40 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:18:40 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:18:40 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:18:43 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:18:43 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:18:43 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:18:43 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:18:43 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:18:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:18:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:18:46 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:18:46 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:18:46 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:18:46 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:18:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:18:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:18:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:18:46 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:18:46 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:18:46 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:18:46 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:18:46 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:18:46 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:18:46 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:18:46 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:18:46 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:18:46 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:18:46 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:18:46 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:18:46 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:18:47 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:18:47 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:18:47 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:18:47 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:18:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:18:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:18:49 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:18:49 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:18:49 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:18:49 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:18:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:18:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:18:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:18:49 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:18:49 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:18:49 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:18:49 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:18:49 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:18:49 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:18:49 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:18:49 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:18:49 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:18:49 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:18:49 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:18:49 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:18:49 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:18:50 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:18:50 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:18:50 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:18:50 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:19:13 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:19:13 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:19:13 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:19:13 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:19:13 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:19:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:19:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:19:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:19:22 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:19:22 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:19:22 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:19:22 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:19:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:19:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:19:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:19:22 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:19:22 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:19:22 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:19:22 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:19:22 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:19:22 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:19:22 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:19:22 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:19:22 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:19:22 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:19:22 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:19:22 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:19:22 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:19:23 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:19:23 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:19:23 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:19:23 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:19:40 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:19:40 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:19:40 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:19:40 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:19:40 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:19:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:19:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:19:43 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:19:43 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:19:43 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:19:43 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:19:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:19:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:19:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:19:43 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:19:43 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:19:43 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:19:43 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:19:43 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:19:43 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:19:43 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:19:43 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:19:43 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:19:43 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:19:43 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:19:43 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:19:43 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:19:44 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:19:44 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:19:44 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:19:44 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:20:18 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:20:18 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:20:18 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:20:18 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:20:18 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:20:19 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:20:23 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:20:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:20:27 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:20:27 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:20:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:20:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:20:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:20:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:20:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:20:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:20:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:20:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:20:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:20:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:20:27 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:20:27 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:20:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:20:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:20:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:20:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:20:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:20:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:20:28 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:20:28 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:20:28 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:20:28 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:20:29 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:20:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:20:32 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:20:32 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:20:32 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:20:32 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:20:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:20:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:20:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:20:32 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:20:32 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:20:32 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:20:32 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:20:32 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:20:32 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:20:32 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:20:32 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:20:32 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:20:32 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:20:32 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:20:32 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:20:32 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:20:33 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:20:33 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:20:33 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:20:33 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:45:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:45:51 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-25 21:45:51 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-25 21:45:51 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-25 21:45:51 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-25 21:45:51 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-25 21:45:51 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-25 21:45:51 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-25 21:45:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:45:53 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:45:53 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:45:53 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:45:53 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:45:53 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:45:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:45:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:45:53 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:45:53 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:45:53 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:45:53 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:45:53 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:45:53 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:45:53 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:45:53 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:45:53 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:45:53 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:45:53 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:45:53 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:45:53 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:45:53 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:45:54 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:45:54 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:45:54 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:45:54 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:45:58 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:45:58 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:45:58 | INFO     | api.app:initialize_game:634 - Generated session ID: 9b994e07-22b5-4db8-b420-35d14848fedd
2024-12-25 21:45:58 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:45:58 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:45:58 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:45:58 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:45:58 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:45:58 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: b53952d9-f956-4a8a-b827-2155bdd05347
2024-12-25 21:45:58 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: b53952d9-f956-4a8a-b827-2155bdd05347
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\states
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\traces
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\characters
2024-12-25 21:45:58 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: b53952d9-f956-4a8a-b827-2155bdd05347
2024-12-25 21:45:58 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:45:58 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:45:58 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:45:58 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:45:58 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:45:58 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:45:58 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:45:58 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:45:58 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:45:58 | INFO     | managers.workflow_manager:initialize_workflow:283 - Initializing workflow
2024-12-25 21:45:58 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Initial state: session_id='9b994e07-22b5-4db8-b420-35d14848fedd' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:45:58 | DEBUG    | managers.workflow_manager:initialize_workflow:287 - Saving initial state
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\states\section_1.json
2024-12-25 21:45:58 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\states\section_1.json
2024-12-25 21:45:58 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\states\section_1.json
2024-12-25 21:45:58 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:45:58 | INFO     | managers.workflow_manager:initialize_workflow:290 - Workflow initialization completed
2024-12-25 21:45:58 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:45:58 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='9b994e07-22b5-4db8-b420-35d14848fedd' section_number=1 narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:45:58 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:45:58 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:45:58 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:45:58 | DEBUG    | managers.workflow_manager:start_workflow:222 - Created initial state: {'session_id': '', 'section_number': 1, 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:45:58 | ERROR    | managers.workflow_manager:start_workflow:234 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\states\section_1.json
2024-12-25 21:45:58 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\states\section_1.json
2024-12-25 21:45:58 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\states\section_1.json
2024-12-25 21:45:58 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:45:58 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': '62752b6d-8e76-43cd-8eaa-e9aa48144f78', 'section_number': 1, 'error': "'dict' object has no attribute 'session_id'", 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 21:45:58 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 1
2024-12-25 21:45:58 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 1
2024-12-25 21:45:58 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 1
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1_rules in namespace rules
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 21:45:58 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md
2024-12-25 21:45:58 | INFO     | agents.story_graph:_process_narrative:127 - Processing narrative for section 1
2024-12-25 21:45:58 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 1
2024-12-25 21:45:58 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 1
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_1 in namespace sections
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 21:45:58 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md
2024-12-25 21:45:58 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_1_rules.md (590 characters)
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 1
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-25T01:42:40.178394', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'none', 'needs_user_response': 'True', 'next_action': 'user_first', 'conditions': 'None', 'target_sections': '48, 398'}
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engager la procédure d'évasion'
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 48
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engager la procédure d'évasion'
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Continuer votre route'
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: none
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_parse_choices:234 - Parsed target section: 398
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Continuer votre route'
2024-12-25 21:45:58 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 2 choices
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 2 choices
2024-12-25 21:45:58 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 1, 'dice_type': <DiceType.NONE: 'none'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'user_first', 'conditions': [], 'choices_count': 2, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-25 21:45:58 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 1
2024-12-25 21:45:58 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 1 from cache
2024-12-25 21:45:58 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 1
2024-12-25 21:45:58 | DEBUG    | agents.story_graph:_process_rules:112 - Rules processing completed for section 1
2024-12-25 21:45:58 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_1.md (2547 characters)
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-25 21:45:58 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-25 21:45:58 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 1
2024-12-25 21:45:58 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 1
2024-12-25 21:45:58 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 1
2024-12-25 21:45:58 | DEBUG    | agents.story_graph:_process_narrative:148 - Narrative processing completed for section 1
2024-12-25 21:45:58 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'section_number': 1, 'rules': RulesModel(section_number=1, dice_type=<DiceType.NONE: 'none'>, needs_dice=True, needs_user_response=True, next_action='user_first', conditions=[], choices=[Choice(text="Engager la procédure d'évasion", type=<ChoiceType.DIRECT: 'direct'>, target_section=48, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={}), Choice(text='Continuer votre route', type=<ChoiceType.DIRECT: 'direct'>, target_section=398, conditions=[], dice_type=<DiceType.NONE: 'none'>, dice_results={})], rules_summary="Le joueur doit choisir entre engager la procédure d'évasion ou continuer sa route, sans lancer de dés.", error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 25, 1, 42, 40, 178394)), 'source': <SourceType.RAW: 'raw'>}}
2024-12-25 21:45:58 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:45:58 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:45:58 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:45:58 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: At key 'section_number': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-25 21:46:52 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:46:52 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:46:52 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:46:52 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 21:46:52 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 21:46:52 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 21:46:52 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\states\current_state.json
2024-12-25 21:46:52 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\states\current_state.json
2024-12-25 21:46:52 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b53952d9-f956-4a8a-b827-2155bdd05347\states\current_state.json
2024-12-25 21:46:52 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:46:52 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 21:46:52 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 21:46:52 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 21:46:52 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:46:53 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:46:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:46:56 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:46:56 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:46:56 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:46:56 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:46:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:46:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:46:56 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:46:56 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:46:56 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:46:56 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:46:56 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:46:56 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:46:56 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:46:56 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:46:56 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:46:56 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:46:56 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:46:56 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:46:56 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:46:56 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:46:57 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:46:57 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:46:57 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:46:57 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:46:59 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:46:59 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:46:59 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:46:59 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:46:59 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:46:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:47:03 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:47:03 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:47:03 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:47:03 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:47:03 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:47:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:47:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:47:03 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:47:03 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:47:03 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:47:03 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:47:03 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:47:03 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:47:03 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:47:03 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:47:03 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:47:03 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:47:03 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:47:03 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:47:03 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:47:03 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:47:03 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:47:03 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:47:03 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:47:03 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:47:08 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:47:08 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:47:08 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:47:08 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:47:08 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:47:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:47:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:47:13 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:47:13 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:47:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:47:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:47:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:47:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:47:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:47:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:47:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:47:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:47:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:47:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:47:13 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:47:13 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:47:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:47:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:47:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:47:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:47:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:47:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:47:14 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:47:14 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:47:14 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:47:14 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:47:14 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:47:14 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:47:14 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:47:14 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:47:14 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:47:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:47:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:47:18 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:47:18 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:47:18 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:47:18 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:47:18 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:47:18 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:47:18 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:47:18 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:47:18 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:47:18 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:47:18 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:47:18 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:47:18 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:47:18 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:47:18 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:47:18 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:47:18 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:47:18 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:47:18 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:48:35 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:48:35 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:48:35 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:48:35 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:48:35 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:48:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:48:38 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:48:38 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:48:38 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:48:38 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:48:38 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:48:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:48:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:48:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:48:38 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:48:38 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:48:38 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:48:38 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:48:38 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:48:38 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:48:38 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:48:38 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:48:38 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:48:38 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:48:38 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:48:38 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:48:38 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:48:39 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:48:39 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:48:39 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:48:39 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:48:39 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:48:39 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:48:39 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:48:39 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:48:39 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:48:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:48:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:48:43 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:48:43 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:48:43 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:48:43 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:48:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:48:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:48:43 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:48:43 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:48:43 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:48:43 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:48:43 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:48:43 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:48:43 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:48:43 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:48:43 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:48:43 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:48:43 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:48:43 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:48:43 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:48:43 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:48:43 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:48:43 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:48:43 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:48:43 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:48:47 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:48:47 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:48:47 | INFO     | api.app:initialize_game:634 - Generated session ID: 2f3175f5-5269-4919-be5d-761038491955
2024-12-25 21:48:47 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:48:47 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:48:47 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:48:47 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:48:47 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:48:47 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 1bcea528-fe4e-4684-912c-ecf29092f396
2024-12-25 21:48:47 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 1bcea528-fe4e-4684-912c-ecf29092f396
2024-12-25 21:48:47 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\states
2024-12-25 21:48:47 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\traces
2024-12-25 21:48:47 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\characters
2024-12-25 21:48:47 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 1bcea528-fe4e-4684-912c-ecf29092f396
2024-12-25 21:48:47 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:48:47 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:48:47 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:48:47 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:48:47 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:48:47 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:48:47 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:48:47 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:48:47 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:48:47 | INFO     | managers.workflow_manager:initialize_workflow:297 - Initializing workflow
2024-12-25 21:48:47 | DEBUG    | managers.workflow_manager:initialize_workflow:298 - Initial state: session_id='2f3175f5-5269-4919-be5d-761038491955' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:48:47 | DEBUG    | managers.workflow_manager:initialize_workflow:301 - Saving initial state
2024-12-25 21:48:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:48:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:48:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:48:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\states\section_1.json
2024-12-25 21:48:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\states\section_1.json
2024-12-25 21:48:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\states\section_1.json
2024-12-25 21:48:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:48:47 | INFO     | managers.workflow_manager:initialize_workflow:304 - Workflow initialization completed
2024-12-25 21:48:47 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:48:47 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='2f3175f5-5269-4919-be5d-761038491955' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:48:47 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:48:47 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:48:47 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:48:47 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:48:47 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:48:47 | DEBUG    | managers.workflow_manager:start_workflow:235 - Created or retrieved initial state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:48:47 | ERROR    | managers.workflow_manager:start_workflow:247 - Error in start node: 'dict' object has no attribute 'session_id'
2024-12-25 21:48:47 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:48:47 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:48:47 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:48:47 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\states\section_1.json
2024-12-25 21:48:47 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\states\section_1.json
2024-12-25 21:48:47 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\states\section_1.json
2024-12-25 21:48:47 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:48:47 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:48:47 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:48:47 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:48:47 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:49:00 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:49:00 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:49:00 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:49:00 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 21:49:00 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 21:49:00 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 21:49:00 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\states\current_state.json
2024-12-25 21:49:00 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\states\current_state.json
2024-12-25 21:49:00 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1bcea528-fe4e-4684-912c-ecf29092f396\states\current_state.json
2024-12-25 21:49:00 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:49:00 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 21:49:00 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 21:49:00 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 21:49:00 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:50:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:50:06 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-25 21:50:06 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-25 21:50:06 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-25 21:50:06 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-25 21:50:06 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-25 21:50:06 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-25 21:50:06 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-25 21:50:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:50:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:50:09 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:50:09 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:50:09 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:50:09 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:50:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:50:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:50:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:50:09 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:50:09 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:50:09 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:50:09 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:50:09 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:50:09 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:50:09 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:50:09 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:50:09 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:50:09 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:50:09 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:50:09 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:50:09 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:50:09 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:50:09 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:50:09 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:50:09 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:50:13 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:50:13 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:50:13 | INFO     | api.app:initialize_game:634 - Generated session ID: e4b5717b-4fce-4fcb-8fcf-4cdf8116a47c
2024-12-25 21:50:13 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:50:13 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:50:13 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:50:13 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:50:13 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:50:13 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 826afcc1-bbcc-4e09-acc2-f9d52ab41541
2024-12-25 21:50:13 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 826afcc1-bbcc-4e09-acc2-f9d52ab41541
2024-12-25 21:50:13 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\states
2024-12-25 21:50:13 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\traces
2024-12-25 21:50:13 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\characters
2024-12-25 21:50:13 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 826afcc1-bbcc-4e09-acc2-f9d52ab41541
2024-12-25 21:50:13 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:50:13 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:50:13 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:50:13 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:50:13 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:50:13 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:50:13 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:50:13 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:50:13 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:50:13 | INFO     | managers.workflow_manager:initialize_workflow:303 - Initializing workflow
2024-12-25 21:50:13 | DEBUG    | managers.workflow_manager:initialize_workflow:304 - Initial state: session_id='e4b5717b-4fce-4fcb-8fcf-4cdf8116a47c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:50:13 | DEBUG    | managers.workflow_manager:initialize_workflow:307 - Saving initial state
2024-12-25 21:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\states\section_1.json
2024-12-25 21:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\states\section_1.json
2024-12-25 21:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\states\section_1.json
2024-12-25 21:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:50:13 | INFO     | managers.workflow_manager:initialize_workflow:310 - Workflow initialization completed
2024-12-25 21:50:13 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:50:13 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='e4b5717b-4fce-4fcb-8fcf-4cdf8116a47c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:50:13 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:50:13 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:50:13 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:50:13 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:50:13 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:50:13 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:50:13 | ERROR    | managers.workflow_manager:start_workflow:252 - Error in start node: State is missing a valid session_id.
2024-12-25 21:50:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:50:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:50:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:50:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\states\section_1.json
2024-12-25 21:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\states\section_1.json
2024-12-25 21:50:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\states\section_1.json
2024-12-25 21:50:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:50:13 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:50:13 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:50:13 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:50:13 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:50:55 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:50:55 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:50:55 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:50:55 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 21:50:55 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 21:50:55 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 21:50:55 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\states\current_state.json
2024-12-25 21:50:55 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\states\current_state.json
2024-12-25 21:50:55 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\826afcc1-bbcc-4e09-acc2-f9d52ab41541\states\current_state.json
2024-12-25 21:50:55 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:50:55 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 21:50:55 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 21:50:55 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 21:50:55 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:50:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:50:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:50:59 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:50:59 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:50:59 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:50:59 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:50:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:50:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:50:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:50:59 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:50:59 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:50:59 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:50:59 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:50:59 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:50:59 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:50:59 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:50:59 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:50:59 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:50:59 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:50:59 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:50:59 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:50:59 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:50:59 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:50:59 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:50:59 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:50:59 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:50:59 | INFO     | api.app:initialize_game:634 - Generated session ID: 0d2ff713-383a-456c-b1e2-a5c9388a0d2c
2024-12-25 21:50:59 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:50:59 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:50:59 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:50:59 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:50:59 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:50:59 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: b98666cd-a16a-4094-99ee-475ec9ead331
2024-12-25 21:50:59 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: b98666cd-a16a-4094-99ee-475ec9ead331
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\states
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\traces
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\characters
2024-12-25 21:50:59 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: b98666cd-a16a-4094-99ee-475ec9ead331
2024-12-25 21:50:59 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:50:59 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:50:59 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:50:59 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:50:59 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:50:59 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:50:59 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:50:59 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:50:59 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:50:59 | INFO     | managers.workflow_manager:initialize_workflow:302 - Initializing workflow
2024-12-25 21:50:59 | DEBUG    | managers.workflow_manager:initialize_workflow:303 - Initial state: session_id='0d2ff713-383a-456c-b1e2-a5c9388a0d2c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:50:59 | DEBUG    | managers.workflow_manager:initialize_workflow:306 - Saving initial state
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\states\section_1.json
2024-12-25 21:50:59 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\states\section_1.json
2024-12-25 21:50:59 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\states\section_1.json
2024-12-25 21:50:59 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:50:59 | INFO     | managers.workflow_manager:initialize_workflow:309 - Workflow initialization completed
2024-12-25 21:50:59 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:50:59 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='0d2ff713-383a-456c-b1e2-a5c9388a0d2c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:50:59 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:50:59 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:50:59 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:50:59 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:50:59 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:50:59 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:50:59 | ERROR    | managers.workflow_manager:start_workflow:251 - Error in start node: State is missing a valid session_id.
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:50:59 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\states\section_1.json
2024-12-25 21:50:59 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\states\section_1.json
2024-12-25 21:50:59 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\states\section_1.json
2024-12-25 21:50:59 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:50:59 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:50:59 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:50:59 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:50:59 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:51:14 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:51:14 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:51:14 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:51:14 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 21:51:14 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 21:51:14 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 21:51:14 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\states\current_state.json
2024-12-25 21:51:14 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\states\current_state.json
2024-12-25 21:51:14 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\b98666cd-a16a-4094-99ee-475ec9ead331\states\current_state.json
2024-12-25 21:51:14 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:51:14 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 21:51:14 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 21:51:14 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 21:51:14 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:51:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:51:19 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:51:19 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:51:19 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:51:19 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:51:19 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:51:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:51:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:51:19 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:51:19 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:51:19 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:51:19 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:51:19 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:51:19 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:51:19 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:51:19 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:51:19 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:51:19 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:51:19 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:51:19 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:51:19 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:51:19 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:51:20 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:51:20 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:51:20 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:51:20 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:51:35 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:51:35 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:51:35 | INFO     | api.app:initialize_game:634 - Generated session ID: 8c3e4dbd-d76b-4a70-9cfd-08aa246f34c3
2024-12-25 21:51:35 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:51:35 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:51:35 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:51:35 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:51:35 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:51:35 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d
2024-12-25 21:51:35 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d
2024-12-25 21:51:35 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\states
2024-12-25 21:51:35 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\traces
2024-12-25 21:51:35 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\characters
2024-12-25 21:51:35 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d
2024-12-25 21:51:35 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:51:35 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:51:35 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:51:35 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:51:35 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:51:35 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:51:35 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:51:35 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:51:35 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:51:35 | INFO     | managers.workflow_manager:initialize_workflow:301 - Initializing workflow
2024-12-25 21:51:35 | DEBUG    | managers.workflow_manager:initialize_workflow:302 - Initial state: session_id='8c3e4dbd-d76b-4a70-9cfd-08aa246f34c3' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:51:35 | DEBUG    | managers.workflow_manager:initialize_workflow:305 - Saving initial state
2024-12-25 21:51:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:51:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:51:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:51:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\states\section_1.json
2024-12-25 21:51:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\states\section_1.json
2024-12-25 21:51:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\states\section_1.json
2024-12-25 21:51:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:51:35 | INFO     | managers.workflow_manager:initialize_workflow:308 - Workflow initialization completed
2024-12-25 21:51:35 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:51:35 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='8c3e4dbd-d76b-4a70-9cfd-08aa246f34c3' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:51:35 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:51:35 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:51:35 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:51:35 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:51:35 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:51:35 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:51:35 | ERROR    | managers.workflow_manager:start_workflow:251 - Error in start node: State is missing a valid session_id.
2024-12-25 21:51:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:51:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:51:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:51:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\states\section_1.json
2024-12-25 21:51:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\states\section_1.json
2024-12-25 21:51:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\states\section_1.json
2024-12-25 21:51:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:51:35 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:51:35 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:51:35 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:51:35 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:54:12 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:54:12 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:54:12 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:54:12 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 21:54:12 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 21:54:12 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 21:54:12 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\states\current_state.json
2024-12-25 21:54:12 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\states\current_state.json
2024-12-25 21:54:12 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6b07e57a-99ae-4ec2-8e3a-2b3751c51f5d\states\current_state.json
2024-12-25 21:54:12 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:54:12 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 21:54:12 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 21:54:12 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 21:54:12 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:54:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:54:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:54:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:54:21 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:54:21 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:54:21 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:54:21 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:54:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:54:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:54:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:54:21 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:54:21 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:54:21 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:54:21 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:54:21 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:54:21 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:54:21 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:54:21 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:54:21 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:54:21 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:54:21 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:54:21 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:54:21 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:54:22 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:54:22 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:54:22 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:54:22 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:54:23 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:54:23 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:54:23 | INFO     | api.app:initialize_game:634 - Generated session ID: ad177b07-99fa-43df-b53f-0ef1411f037b
2024-12-25 21:54:23 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:54:23 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:54:23 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:54:23 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:54:23 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:54:23 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: fe94f67b-d74d-444e-a75f-0c8c676482c9
2024-12-25 21:54:23 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: fe94f67b-d74d-444e-a75f-0c8c676482c9
2024-12-25 21:54:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\states
2024-12-25 21:54:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\traces
2024-12-25 21:54:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\characters
2024-12-25 21:54:23 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: fe94f67b-d74d-444e-a75f-0c8c676482c9
2024-12-25 21:54:23 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:54:23 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:54:23 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:54:23 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:54:23 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:54:23 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:54:23 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:54:23 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:54:23 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:54:23 | INFO     | managers.workflow_manager:initialize_workflow:309 - Initializing workflow
2024-12-25 21:54:23 | DEBUG    | managers.workflow_manager:initialize_workflow:310 - Initial state: session_id='ad177b07-99fa-43df-b53f-0ef1411f037b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:54:23 | DEBUG    | managers.workflow_manager:initialize_workflow:313 - Saving initial state
2024-12-25 21:54:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:54:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:54:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:54:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\states\section_1.json
2024-12-25 21:54:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\states\section_1.json
2024-12-25 21:54:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\states\section_1.json
2024-12-25 21:54:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:54:23 | INFO     | managers.workflow_manager:initialize_workflow:316 - Workflow initialization completed
2024-12-25 21:54:23 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:54:23 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='ad177b07-99fa-43df-b53f-0ef1411f037b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:54:23 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:54:23 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:54:23 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:54:23 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:54:23 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:54:23 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:54:23 | ERROR    | managers.workflow_manager:start_workflow:256 - Error in start node: State is missing a valid session_id.
2024-12-25 21:54:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:54:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:54:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:54:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\states\section_1.json
2024-12-25 21:54:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\states\section_1.json
2024-12-25 21:54:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\states\section_1.json
2024-12-25 21:54:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:54:23 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 21:54:23 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 21:54:23 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 21:54:23 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 21:55:36 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:55:36 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:55:36 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:55:36 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 21:55:36 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 21:55:36 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 21:55:36 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\states\current_state.json
2024-12-25 21:55:36 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\states\current_state.json
2024-12-25 21:55:36 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe94f67b-d74d-444e-a75f-0c8c676482c9\states\current_state.json
2024-12-25 21:55:36 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:55:36 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 21:55:36 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 21:55:36 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 21:55:36 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:55:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:55:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:55:40 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:55:40 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:55:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:55:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:55:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:55:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:55:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:55:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:55:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:55:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:55:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:55:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:55:40 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:55:40 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:55:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:55:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:55:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:55:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:55:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:55:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:55:41 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:55:41 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:55:41 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:55:41 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:55:53 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:55:53 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:55:53 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:55:53 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:55:53 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:55:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:56:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:56:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:56:17 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:56:17 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:56:17 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:56:17 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:56:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:56:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:56:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:56:17 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:56:17 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:56:17 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:56:17 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:56:17 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:56:17 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:56:17 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:56:17 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:56:17 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:56:17 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:56:17 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:56:17 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:56:17 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:56:17 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:56:17 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:56:17 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:56:17 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:56:18 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:56:18 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:56:18 | INFO     | api.app:initialize_game:634 - Generated session ID: 197833d2-c0e7-41f4-ac21-f78373974e16
2024-12-25 21:56:18 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:56:18 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:56:18 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:56:18 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:56:18 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:56:18 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: bfe08ab2-3ca4-4096-9243-a21288a929aa
2024-12-25 21:56:18 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: bfe08ab2-3ca4-4096-9243-a21288a929aa
2024-12-25 21:56:18 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\states
2024-12-25 21:56:18 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\traces
2024-12-25 21:56:18 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\characters
2024-12-25 21:56:18 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: bfe08ab2-3ca4-4096-9243-a21288a929aa
2024-12-25 21:56:18 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:56:18 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:56:18 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:56:18 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:56:18 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:56:18 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:56:18 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:56:18 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:56:18 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:56:18 | INFO     | managers.workflow_manager:initialize_workflow:307 - Initializing workflow
2024-12-25 21:56:18 | DEBUG    | managers.workflow_manager:initialize_workflow:308 - Initial state: session_id='197833d2-c0e7-41f4-ac21-f78373974e16' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:56:18 | DEBUG    | managers.workflow_manager:initialize_workflow:311 - Saving initial state
2024-12-25 21:56:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:56:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:56:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:56:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\states\section_1.json
2024-12-25 21:56:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\states\section_1.json
2024-12-25 21:56:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\states\section_1.json
2024-12-25 21:56:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:56:18 | INFO     | managers.workflow_manager:initialize_workflow:314 - Workflow initialization completed
2024-12-25 21:56:18 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:56:18 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='197833d2-c0e7-41f4-ac21-f78373974e16' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:56:18 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:56:18 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:56:18 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:56:18 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:56:18 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:56:18 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:56:18 | ERROR    | managers.workflow_manager:start_workflow:254 - Error in start node: State is missing a valid session_id.
2024-12-25 21:56:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:56:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:56:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:56:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\states\section_1.json
2024-12-25 21:56:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\states\section_1.json
2024-12-25 21:56:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\states\section_1.json
2024-12-25 21:56:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:56:18 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 21:56:18 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 21:56:18 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 21:56:18 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 21:57:12 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:57:12 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:57:12 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:57:12 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 21:57:12 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 21:57:12 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 21:57:12 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\states\current_state.json
2024-12-25 21:57:12 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\states\current_state.json
2024-12-25 21:57:12 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bfe08ab2-3ca4-4096-9243-a21288a929aa\states\current_state.json
2024-12-25 21:57:12 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:57:12 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 21:57:12 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 21:57:12 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 21:57:12 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:57:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:57:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:57:16 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:57:16 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:57:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:57:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:57:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:57:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:57:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:57:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:57:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:57:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:57:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:57:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:57:16 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:57:16 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:57:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:57:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:57:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:57:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:57:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:57:16 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:57:16 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:57:16 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:57:16 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:57:16 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:57:19 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:57:19 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:57:19 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:57:19 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:57:19 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:57:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:57:23 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:57:23 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:57:23 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:57:23 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:57:23 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:57:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:57:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:57:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:57:23 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:57:23 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:57:23 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:57:23 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:57:23 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:57:23 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:57:23 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:57:23 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:57:23 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:57:23 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:57:23 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:57:23 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:57:23 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:57:24 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:57:24 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:57:24 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:57:24 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:57:24 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:57:24 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:57:24 | INFO     | api.app:initialize_game:634 - Generated session ID: 67001f22-24ac-462d-99a9-e9aa0f2a92af
2024-12-25 21:57:24 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:57:24 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:57:24 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:57:24 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:57:24 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:57:24 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 091619e5-cf02-4a20-8be5-48ea76d5ae06
2024-12-25 21:57:24 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 091619e5-cf02-4a20-8be5-48ea76d5ae06
2024-12-25 21:57:24 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\states
2024-12-25 21:57:24 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\traces
2024-12-25 21:57:24 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\characters
2024-12-25 21:57:24 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 091619e5-cf02-4a20-8be5-48ea76d5ae06
2024-12-25 21:57:24 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:57:24 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:57:24 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:57:24 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:57:24 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:57:24 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:57:24 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:57:24 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:57:24 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:57:24 | INFO     | managers.workflow_manager:initialize_workflow:312 - Initializing workflow
2024-12-25 21:57:24 | DEBUG    | managers.workflow_manager:initialize_workflow:313 - Initial state: session_id='67001f22-24ac-462d-99a9-e9aa0f2a92af' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:57:24 | DEBUG    | managers.workflow_manager:initialize_workflow:316 - Saving initial state
2024-12-25 21:57:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:57:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:57:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:57:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\states\section_1.json
2024-12-25 21:57:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\states\section_1.json
2024-12-25 21:57:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\states\section_1.json
2024-12-25 21:57:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:57:24 | INFO     | managers.workflow_manager:initialize_workflow:319 - Workflow initialization completed
2024-12-25 21:57:24 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:57:24 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='67001f22-24ac-462d-99a9-e9aa0f2a92af' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:57:24 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:57:24 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:57:24 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:57:24 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:57:24 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:57:24 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:57:24 | ERROR    | managers.workflow_manager:start_workflow:256 - Error in start node: State is missing a valid session_id.
2024-12-25 21:57:24 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:57:24 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:57:24 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:57:24 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\states\section_1.json
2024-12-25 21:57:24 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\states\section_1.json
2024-12-25 21:57:24 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\states\section_1.json
2024-12-25 21:57:24 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:57:24 | DEBUG    | managers.workflow_manager:start_workflow:260 - Removing duplicate 'error' key from error_state_data
2024-12-25 21:57:24 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:57:24 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:57:24 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:57:24 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'session_id'
2024-12-25 21:58:17 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:58:17 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:58:17 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:58:17 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 21:58:17 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 21:58:17 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 21:58:17 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\states\current_state.json
2024-12-25 21:58:17 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\states\current_state.json
2024-12-25 21:58:17 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\091619e5-cf02-4a20-8be5-48ea76d5ae06\states\current_state.json
2024-12-25 21:58:17 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 21:58:17 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 21:58:17 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 21:58:17 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 21:58:17 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:58:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:58:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:58:21 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:58:21 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:58:21 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:58:21 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:58:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:58:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:58:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:58:21 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:58:21 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:58:21 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:58:21 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:58:21 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:58:21 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:58:21 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:58:21 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:58:21 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:58:21 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:58:21 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:58:21 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:58:21 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:58:21 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:58:21 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:58:21 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:58:21 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:58:27 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:58:27 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:58:27 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:58:27 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:58:27 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:58:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:58:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:58:36 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:58:36 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:58:36 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:58:36 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:58:36 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:58:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:58:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:58:36 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:58:36 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:58:36 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:58:36 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:58:36 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:58:36 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:58:36 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:58:36 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:58:36 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:58:36 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:58:36 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:58:36 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:58:36 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:58:36 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:58:37 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:58:37 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:58:37 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:58:37 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:58:44 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 21:58:44 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 21:58:44 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 21:58:44 | DEBUG    | managers.agent_manager:stop_game:516 - No game ID set, nothing to save
2024-12-25 21:58:44 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 21:58:45 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:58:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 21:58:49 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 21:58:49 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 21:58:49 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 21:58:49 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:58:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 21:58:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 21:58:49 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 21:58:49 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 21:58:49 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:58:49 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 21:58:49 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 21:58:49 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 21:58:49 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 21:58:49 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 21:58:49 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 21:58:49 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 21:58:49 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 21:58:49 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 21:58:49 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 21:58:49 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 21:58:49 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 21:58:49 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 21:58:49 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 21:58:49 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 21:58:53 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 21:58:53 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 21:58:53 | INFO     | api.app:initialize_game:634 - Generated session ID: 10037e6f-46b8-4944-905a-aeed44a5cb8c
2024-12-25 21:58:53 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 21:58:53 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 21:58:53 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 21:58:53 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 21:58:53 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 21:58:53 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: abf6af3f-8d55-4f48-b32b-dacdafe2b1a7
2024-12-25 21:58:53 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: abf6af3f-8d55-4f48-b32b-dacdafe2b1a7
2024-12-25 21:58:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\states
2024-12-25 21:58:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\traces
2024-12-25 21:58:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\characters
2024-12-25 21:58:53 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: abf6af3f-8d55-4f48-b32b-dacdafe2b1a7
2024-12-25 21:58:53 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 21:58:53 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 21:58:53 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 21:58:53 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 21:58:53 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 21:58:53 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 21:58:53 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 21:58:53 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 21:58:53 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 21:58:53 | INFO     | managers.workflow_manager:initialize_workflow:305 - Initializing workflow
2024-12-25 21:58:53 | DEBUG    | managers.workflow_manager:initialize_workflow:306 - Initial state: session_id='10037e6f-46b8-4944-905a-aeed44a5cb8c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:58:53 | DEBUG    | managers.workflow_manager:initialize_workflow:309 - Saving initial state
2024-12-25 21:58:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:58:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:58:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:58:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\states\section_1.json
2024-12-25 21:58:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\states\section_1.json
2024-12-25 21:58:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\states\section_1.json
2024-12-25 21:58:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:58:53 | INFO     | managers.workflow_manager:initialize_workflow:312 - Workflow initialization completed
2024-12-25 21:58:53 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 21:58:53 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='10037e6f-46b8-4944-905a-aeed44a5cb8c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 21:58:53 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 21:58:53 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 21:58:53 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 21:58:53 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 21:58:53 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:58:53 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 21:58:53 | ERROR    | managers.workflow_manager:start_workflow:253 - Error in start node: State is missing a valid session_id.
2024-12-25 21:58:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 21:58:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 21:58:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 21:58:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\states\section_1.json
2024-12-25 21:58:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\states\section_1.json
2024-12-25 21:58:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\states\section_1.json
2024-12-25 21:58:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 21:58:53 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 21:58:53 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 21:58:53 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 21:58:53 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:06:22 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:06:22 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:06:22 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 22:06:22 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 22:06:22 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 22:06:22 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 22:06:22 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\states\current_state.json
2024-12-25 22:06:22 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\states\current_state.json
2024-12-25 22:06:22 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\abf6af3f-8d55-4f48-b32b-dacdafe2b1a7\states\current_state.json
2024-12-25 22:06:22 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 22:06:22 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 22:06:22 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 22:06:22 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 22:06:22 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:06:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:06:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:06:25 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:06:25 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:06:25 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:06:25 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:06:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:06:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:06:25 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:06:25 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:06:25 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:06:25 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:06:25 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:06:25 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:06:25 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:06:25 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:06:25 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:06:25 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:06:25 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:06:25 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:06:25 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:06:25 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:06:26 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:06:26 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:06:26 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:06:26 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:06:26 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 22:06:26 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 22:06:26 | INFO     | api.app:initialize_game:634 - Generated session ID: 1bcfccb0-8108-43c5-a005-08edb891e1f5
2024-12-25 22:06:26 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 22:06:26 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 22:06:26 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 22:06:26 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 22:06:26 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 22:06:26 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: c44c366d-075a-4593-8889-2996c80aad71
2024-12-25 22:06:26 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: c44c366d-075a-4593-8889-2996c80aad71
2024-12-25 22:06:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\states
2024-12-25 22:06:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\traces
2024-12-25 22:06:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\characters
2024-12-25 22:06:26 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: c44c366d-075a-4593-8889-2996c80aad71
2024-12-25 22:06:26 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 22:06:26 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 22:06:26 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 22:06:26 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:06:26 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 22:06:26 | DEBUG    | managers.agent_manager:_configure_story_graph:562 - Configuring story graph
2024-12-25 22:06:26 | DEBUG    | managers.agent_manager:_configure_story_graph:571 - Story graph configured successfully
2024-12-25 22:06:26 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 22:06:26 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 22:06:26 | INFO     | managers.workflow_manager:initialize_workflow:305 - Initializing workflow
2024-12-25 22:06:26 | DEBUG    | managers.workflow_manager:initialize_workflow:306 - Initial state: session_id='1bcfccb0-8108-43c5-a005-08edb891e1f5' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:06:26 | DEBUG    | managers.workflow_manager:initialize_workflow:309 - Saving initial state
2024-12-25 22:06:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:06:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:06:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:06:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\states\section_1.json
2024-12-25 22:06:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\states\section_1.json
2024-12-25 22:06:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\states\section_1.json
2024-12-25 22:06:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:06:26 | INFO     | managers.workflow_manager:initialize_workflow:312 - Workflow initialization completed
2024-12-25 22:06:26 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 22:06:26 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='1bcfccb0-8108-43c5-a005-08edb891e1f5' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 22:06:26 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 22:06:26 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 22:06:26 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 22:06:26 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:06:26 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:06:26 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:06:26 | ERROR    | managers.workflow_manager:start_workflow:253 - Error in start node: State is missing a valid session_id.
2024-12-25 22:06:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:06:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:06:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:06:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\states\section_1.json
2024-12-25 22:06:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\states\section_1.json
2024-12-25 22:06:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\states\section_1.json
2024-12-25 22:06:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:06:26 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:06:26 | ERROR    | managers.agent_manager:initialize_game:374 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:06:26 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:06:26 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:08:32 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:08:32 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:08:32 | INFO     | managers.agent_manager:stop_game:511 - Stopping game...
2024-12-25 22:08:32 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 22:08:32 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 22:08:32 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 22:08:32 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\states\current_state.json
2024-12-25 22:08:32 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\states\current_state.json
2024-12-25 22:08:32 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\c44c366d-075a-4593-8889-2996c80aad71\states\current_state.json
2024-12-25 22:08:32 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 22:08:32 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 22:08:32 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 22:08:32 | INFO     | managers.agent_manager:stop_game:525 - Game stopped successfully
2024-12-25 22:08:32 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:08:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:09:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:09:08 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:09:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:09:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:09:24 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:09:24 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:09:24 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:09:24 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:09:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:09:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:09:24 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:09:24 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:09:24 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:09:24 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:09:24 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:09:24 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:09:24 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:09:24 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:09:24 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:09:24 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:09:24 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:09:24 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:09:24 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:09:24 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:09:25 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:09:25 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:09:25 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:09:25 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:09:26 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 22:09:26 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 22:09:26 | INFO     | api.app:initialize_game:634 - Generated session ID: 17b4f55f-ef87-414f-918a-a21bc33d1061
2024-12-25 22:09:26 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 22:09:26 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 22:09:26 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 22:09:26 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 22:09:26 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 22:09:26 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: a5d95d47-7e38-4f2f-be47-ff7cb7c5b619
2024-12-25 22:09:26 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: a5d95d47-7e38-4f2f-be47-ff7cb7c5b619
2024-12-25 22:09:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\states
2024-12-25 22:09:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\traces
2024-12-25 22:09:26 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\characters
2024-12-25 22:09:26 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: a5d95d47-7e38-4f2f-be47-ff7cb7c5b619
2024-12-25 22:09:26 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 22:09:26 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 22:09:26 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 22:09:26 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:09:26 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 22:09:26 | DEBUG    | managers.agent_manager:_configure_story_graph:564 - Configuring story graph
2024-12-25 22:09:26 | DEBUG    | managers.agent_manager:_configure_story_graph:573 - Story graph configured successfully
2024-12-25 22:09:26 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 22:09:26 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 22:09:26 | DEBUG    | managers.agent_manager:initialize_game:362 - Initial state created: session_id='17b4f55f-ef87-414f-918a-a21bc33d1061' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:09:26 | INFO     | managers.workflow_manager:initialize_workflow:306 - Initializing workflow
2024-12-25 22:09:26 | DEBUG    | managers.workflow_manager:initialize_workflow:307 - Initial state: session_id='17b4f55f-ef87-414f-918a-a21bc33d1061' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:09:26 | DEBUG    | managers.workflow_manager:initialize_workflow:310 - Saving initial state
2024-12-25 22:09:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:09:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:09:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:09:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\states\section_1.json
2024-12-25 22:09:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\states\section_1.json
2024-12-25 22:09:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\states\section_1.json
2024-12-25 22:09:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:09:26 | INFO     | managers.workflow_manager:initialize_workflow:313 - Workflow initialization completed
2024-12-25 22:09:26 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 22:09:26 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='17b4f55f-ef87-414f-918a-a21bc33d1061' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 22:09:26 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 22:09:26 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 22:09:26 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 22:09:26 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:09:26 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:09:26 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:09:26 | ERROR    | managers.workflow_manager:start_workflow:254 - Error in start node: State is missing a valid session_id.
2024-12-25 22:09:26 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:09:26 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:09:26 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:09:26 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\states\section_1.json
2024-12-25 22:09:26 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\states\section_1.json
2024-12-25 22:09:26 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\states\section_1.json
2024-12-25 22:09:26 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:09:26 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:09:26 | ERROR    | managers.agent_manager:initialize_game:376 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:09:26 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:09:26 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:09:54 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:09:54 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:09:54 | INFO     | managers.agent_manager:stop_game:513 - Stopping game...
2024-12-25 22:09:54 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 22:09:54 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 22:09:54 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 22:09:54 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\states\current_state.json
2024-12-25 22:09:54 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\states\current_state.json
2024-12-25 22:09:54 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a5d95d47-7e38-4f2f-be47-ff7cb7c5b619\states\current_state.json
2024-12-25 22:09:54 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 22:09:54 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 22:09:54 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 22:09:54 | INFO     | managers.agent_manager:stop_game:527 - Game stopped successfully
2024-12-25 22:09:54 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:09:55 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:09:58 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:09:58 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:09:58 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:09:58 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:09:58 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:09:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:09:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:09:58 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:09:58 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:09:58 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:09:58 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:09:58 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:09:58 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:09:58 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:09:58 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:09:58 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:09:58 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:09:58 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:09:58 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:09:58 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:09:58 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:09:59 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:09:59 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:09:59 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:09:59 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:10:00 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 22:10:00 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 22:10:00 | INFO     | api.app:initialize_game:634 - Generated session ID: 27639235-cba6-490f-bcff-d08ef93fd84d
2024-12-25 22:10:00 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 22:10:00 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 22:10:00 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 22:10:00 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 22:10:00 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 22:10:00 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: a95ee98e-e68b-43ef-b0a4-408cba5bfead
2024-12-25 22:10:00 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: a95ee98e-e68b-43ef-b0a4-408cba5bfead
2024-12-25 22:10:00 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\states
2024-12-25 22:10:00 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\traces
2024-12-25 22:10:00 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\characters
2024-12-25 22:10:00 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: a95ee98e-e68b-43ef-b0a4-408cba5bfead
2024-12-25 22:10:00 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 22:10:00 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 22:10:00 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 22:10:00 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:10:00 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 22:10:00 | DEBUG    | managers.agent_manager:_configure_story_graph:564 - Configuring story graph
2024-12-25 22:10:00 | DEBUG    | managers.agent_manager:_configure_story_graph:573 - Story graph configured successfully
2024-12-25 22:10:00 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 22:10:00 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 22:10:00 | DEBUG    | managers.agent_manager:initialize_game:362 - Initial state created: session_id='27639235-cba6-490f-bcff-d08ef93fd84d' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:10:00 | INFO     | managers.workflow_manager:initialize_workflow:306 - Initializing workflow
2024-12-25 22:10:00 | DEBUG    | managers.workflow_manager:initialize_workflow:307 - Initial state: session_id='27639235-cba6-490f-bcff-d08ef93fd84d' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:10:00 | DEBUG    | managers.workflow_manager:initialize_workflow:310 - Saving initial state
2024-12-25 22:10:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:10:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:10:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:10:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\states\section_1.json
2024-12-25 22:10:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\states\section_1.json
2024-12-25 22:10:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\states\section_1.json
2024-12-25 22:10:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:10:00 | INFO     | managers.workflow_manager:initialize_workflow:313 - Workflow initialization completed
2024-12-25 22:10:00 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 22:10:00 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='27639235-cba6-490f-bcff-d08ef93fd84d' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 22:10:00 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 22:10:00 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 22:10:00 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 22:10:00 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:10:00 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:10:00 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:10:00 | ERROR    | managers.workflow_manager:start_workflow:254 - Error in start node: State is missing a valid session_id.
2024-12-25 22:10:00 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:10:00 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:10:00 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:10:00 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\states\section_1.json
2024-12-25 22:10:00 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\states\section_1.json
2024-12-25 22:10:00 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\states\section_1.json
2024-12-25 22:10:00 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:10:00 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:10:00 | ERROR    | managers.agent_manager:initialize_game:376 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:10:00 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:10:00 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:12:04 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:12:04 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:12:04 | INFO     | managers.agent_manager:stop_game:513 - Stopping game...
2024-12-25 22:12:04 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 22:12:04 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 22:12:04 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 22:12:04 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\states\current_state.json
2024-12-25 22:12:04 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\states\current_state.json
2024-12-25 22:12:04 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a95ee98e-e68b-43ef-b0a4-408cba5bfead\states\current_state.json
2024-12-25 22:12:04 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 22:12:04 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 22:12:04 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 22:12:04 | INFO     | managers.agent_manager:stop_game:527 - Game stopped successfully
2024-12-25 22:12:04 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:12:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:12:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:12:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:12:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:12:15 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:12:15 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:12:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:12:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:12:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:12:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:12:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:12:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:12:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:12:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:12:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:12:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:12:15 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:12:15 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:12:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:12:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:12:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:12:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:12:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:12:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:12:16 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:12:16 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:12:16 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:12:16 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:12:17 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:12:17 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:12:17 | INFO     | managers.agent_manager:stop_game:513 - Stopping game...
2024-12-25 22:12:17 | DEBUG    | managers.agent_manager:stop_game:518 - No game ID set, nothing to save
2024-12-25 22:12:17 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:12:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:12:22 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:12:22 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:12:22 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:12:22 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:12:22 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:12:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:12:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:12:22 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:12:22 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:12:22 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:12:22 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:12:22 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:12:22 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:12:22 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:12:22 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:12:22 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:12:22 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:12:22 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:12:22 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:12:22 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:12:22 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:12:23 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:12:23 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:12:23 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:12:23 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:12:23 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:12:26 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:12:26 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:12:26 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:12:26 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:12:26 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:12:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:12:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:12:26 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:12:26 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:12:26 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:12:26 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:12:26 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:12:26 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:12:26 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:12:26 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:12:26 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:12:26 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:12:26 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:12:26 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:12:26 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:12:26 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:12:27 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:12:27 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:12:27 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:12:27 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:12:30 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 22:12:30 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 22:12:30 | INFO     | api.app:initialize_game:634 - Generated session ID: 4b017802-abcc-4f8d-8cff-6a488b0f0afd
2024-12-25 22:12:30 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 22:12:30 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 22:12:30 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 22:12:30 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 22:12:30 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 22:12:30 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 82047a38-03e9-4786-870b-fb6799f1bd49
2024-12-25 22:12:30 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 82047a38-03e9-4786-870b-fb6799f1bd49
2024-12-25 22:12:30 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\states
2024-12-25 22:12:30 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\traces
2024-12-25 22:12:30 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\characters
2024-12-25 22:12:30 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 82047a38-03e9-4786-870b-fb6799f1bd49
2024-12-25 22:12:30 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 22:12:30 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 22:12:30 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 22:12:30 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:12:30 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 22:12:30 | DEBUG    | managers.agent_manager:_configure_story_graph:567 - Configuring story graph
2024-12-25 22:12:30 | DEBUG    | managers.agent_manager:_configure_story_graph:576 - Story graph configured successfully
2024-12-25 22:12:30 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 22:12:30 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 22:12:30 | DEBUG    | managers.agent_manager:initialize_game:355 - Session ID provided: 4b017802-abcc-4f8d-8cff-6a488b0f0afd
2024-12-25 22:12:30 | DEBUG    | managers.agent_manager:initialize_game:356 - Initial state params: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:12:30 | DEBUG    | managers.agent_manager:initialize_game:364 - Initial state created: session_id='4b017802-abcc-4f8d-8cff-6a488b0f0afd' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:12:30 | INFO     | managers.workflow_manager:initialize_workflow:306 - Initializing workflow
2024-12-25 22:12:30 | DEBUG    | managers.workflow_manager:initialize_workflow:307 - Initial state: session_id='4b017802-abcc-4f8d-8cff-6a488b0f0afd' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:12:30 | DEBUG    | managers.workflow_manager:initialize_workflow:310 - Saving initial state
2024-12-25 22:12:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:12:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:12:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:12:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\states\section_1.json
2024-12-25 22:12:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\states\section_1.json
2024-12-25 22:12:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\states\section_1.json
2024-12-25 22:12:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:12:30 | INFO     | managers.workflow_manager:initialize_workflow:313 - Workflow initialization completed
2024-12-25 22:12:30 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 22:12:30 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='4b017802-abcc-4f8d-8cff-6a488b0f0afd' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 22:12:30 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 22:12:30 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 22:12:30 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 22:12:30 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:12:30 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:12:30 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:12:30 | ERROR    | managers.workflow_manager:start_workflow:254 - Error in start node: State is missing a valid session_id.
2024-12-25 22:12:30 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:12:30 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:12:30 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:12:30 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\states\section_1.json
2024-12-25 22:12:30 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\states\section_1.json
2024-12-25 22:12:30 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\states\section_1.json
2024-12-25 22:12:30 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:12:30 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:12:30 | ERROR    | managers.agent_manager:initialize_game:379 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:12:30 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:12:30 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:15:01 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:15:01 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:15:01 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:15:01 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 22:15:01 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 22:15:01 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 22:15:01 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\states\current_state.json
2024-12-25 22:15:01 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\states\current_state.json
2024-12-25 22:15:01 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\82047a38-03e9-4786-870b-fb6799f1bd49\states\current_state.json
2024-12-25 22:15:01 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 22:15:01 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 22:15:01 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 22:15:01 | INFO     | managers.agent_manager:stop_game:530 - Game stopped successfully
2024-12-25 22:15:01 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:15:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:15:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:15:04 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:15:04 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:15:04 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:15:04 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:15:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:15:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:15:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:15:04 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:15:04 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:15:04 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:15:04 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:15:04 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:15:04 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:15:04 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:15:04 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:15:04 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:15:04 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:15:04 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:15:04 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:15:04 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:15:05 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:15:05 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:15:05 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:15:05 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:15:15 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 22:15:15 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 22:15:15 | INFO     | api.app:initialize_game:634 - Generated session ID: c460f433-80e3-42f0-88d4-c99612cec8c3
2024-12-25 22:15:15 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 22:15:15 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 22:15:15 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 22:15:15 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 22:15:15 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 22:15:15 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: fa8bdde4-8da0-426f-810e-39e4e8ecfbc4
2024-12-25 22:15:15 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: fa8bdde4-8da0-426f-810e-39e4e8ecfbc4
2024-12-25 22:15:15 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\states
2024-12-25 22:15:15 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\traces
2024-12-25 22:15:15 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\characters
2024-12-25 22:15:15 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: fa8bdde4-8da0-426f-810e-39e4e8ecfbc4
2024-12-25 22:15:15 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 22:15:15 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 22:15:15 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 22:15:15 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:15:15 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 22:15:15 | DEBUG    | managers.agent_manager:_configure_story_graph:567 - Configuring story graph
2024-12-25 22:15:15 | DEBUG    | managers.agent_manager:_configure_story_graph:576 - Story graph configured successfully
2024-12-25 22:15:15 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 22:15:15 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 22:15:15 | DEBUG    | managers.agent_manager:initialize_game:355 - Session ID provided: c460f433-80e3-42f0-88d4-c99612cec8c3
2024-12-25 22:15:15 | DEBUG    | managers.agent_manager:initialize_game:356 - Initial state params: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:15:15 | DEBUG    | managers.agent_manager:initialize_game:364 - Initial state created: session_id='c460f433-80e3-42f0-88d4-c99612cec8c3' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:15:15 | INFO     | managers.workflow_manager:initialize_workflow:306 - Initializing workflow
2024-12-25 22:15:15 | DEBUG    | managers.workflow_manager:initialize_workflow:307 - Initial state: session_id='c460f433-80e3-42f0-88d4-c99612cec8c3' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:15:15 | DEBUG    | managers.workflow_manager:initialize_workflow:310 - Saving initial state
2024-12-25 22:15:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:15:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:15:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:15:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\states\section_1.json
2024-12-25 22:15:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\states\section_1.json
2024-12-25 22:15:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\states\section_1.json
2024-12-25 22:15:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:15:15 | INFO     | managers.workflow_manager:initialize_workflow:313 - Workflow initialization completed
2024-12-25 22:15:15 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 22:15:15 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='c460f433-80e3-42f0-88d4-c99612cec8c3' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 22:15:15 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 22:15:15 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 22:15:15 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 22:15:15 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:15:15 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:15:15 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:15:15 | ERROR    | managers.workflow_manager:start_workflow:254 - Error in start node: State is missing a valid session_id.
2024-12-25 22:15:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:15:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:15:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:15:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\states\section_1.json
2024-12-25 22:15:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\states\section_1.json
2024-12-25 22:15:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\states\section_1.json
2024-12-25 22:15:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:15:15 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:15:15 | ERROR    | managers.agent_manager:initialize_game:379 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:15:15 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:15:15 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:16:22 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:16:22 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:16:22 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:16:22 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 22:16:22 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 22:16:22 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 22:16:22 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\states\current_state.json
2024-12-25 22:16:22 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\states\current_state.json
2024-12-25 22:16:22 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fa8bdde4-8da0-426f-810e-39e4e8ecfbc4\states\current_state.json
2024-12-25 22:16:22 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 22:16:22 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 22:16:22 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 22:16:22 | INFO     | managers.agent_manager:stop_game:530 - Game stopped successfully
2024-12-25 22:16:22 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:16:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:16:48 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-25 22:16:48 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-25 22:16:48 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-25 22:16:48 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-25 22:16:48 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-25 22:16:48 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-25 22:16:48 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-25 22:16:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:16:50 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:16:50 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:16:50 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:16:50 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:16:50 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:16:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:16:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:16:50 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:16:50 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:16:50 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:16:50 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:16:50 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:16:50 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:16:50 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:16:50 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:16:50 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:16:50 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:16:50 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:16:50 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:16:50 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:16:50 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:16:50 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:16:50 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:16:50 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:16:50 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:16:55 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 22:16:55 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 22:16:55 | INFO     | api.app:initialize_game:634 - Generated session ID: 91a4a7d2-355e-40ae-9b95-580a4dbca30b
2024-12-25 22:16:55 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 22:16:55 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 22:16:55 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 22:16:55 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 22:16:55 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 22:16:55 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 7751ea8f-3c08-4ec3-9e37-251a595360fb
2024-12-25 22:16:55 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 7751ea8f-3c08-4ec3-9e37-251a595360fb
2024-12-25 22:16:55 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\states
2024-12-25 22:16:55 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\traces
2024-12-25 22:16:55 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\characters
2024-12-25 22:16:55 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 7751ea8f-3c08-4ec3-9e37-251a595360fb
2024-12-25 22:16:55 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 22:16:55 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 22:16:55 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 22:16:55 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:16:55 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 22:16:55 | DEBUG    | managers.agent_manager:_configure_story_graph:567 - Configuring story graph
2024-12-25 22:16:55 | DEBUG    | managers.agent_manager:_configure_story_graph:576 - Story graph configured successfully
2024-12-25 22:16:55 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 22:16:55 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 22:16:55 | DEBUG    | managers.agent_manager:initialize_game:355 - Session ID provided: 91a4a7d2-355e-40ae-9b95-580a4dbca30b
2024-12-25 22:16:55 | DEBUG    | managers.agent_manager:initialize_game:356 - Initial state params: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:16:55 | DEBUG    | managers.agent_manager:initialize_game:364 - Initial state created: session_id='91a4a7d2-355e-40ae-9b95-580a4dbca30b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:16:55 | INFO     | managers.workflow_manager:initialize_workflow:306 - Initializing workflow
2024-12-25 22:16:55 | DEBUG    | managers.workflow_manager:initialize_workflow:307 - Initial state: session_id='91a4a7d2-355e-40ae-9b95-580a4dbca30b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:16:55 | DEBUG    | managers.workflow_manager:initialize_workflow:310 - Saving initial state
2024-12-25 22:16:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:16:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:16:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:16:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\states\section_1.json
2024-12-25 22:16:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\states\section_1.json
2024-12-25 22:16:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\states\section_1.json
2024-12-25 22:16:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:16:55 | INFO     | managers.workflow_manager:initialize_workflow:313 - Workflow initialization completed
2024-12-25 22:16:55 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 22:16:55 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='91a4a7d2-355e-40ae-9b95-580a4dbca30b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 22:16:55 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 22:16:55 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 22:16:55 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 22:16:55 | DEBUG    | managers.workflow_manager:start_workflow:205 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:16:55 | DEBUG    | managers.workflow_manager:start_workflow:219 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:16:55 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:16:55 | ERROR    | managers.workflow_manager:start_workflow:254 - Error in start node: State is missing a valid session_id.
2024-12-25 22:16:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:16:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:16:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:16:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\states\section_1.json
2024-12-25 22:16:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\states\section_1.json
2024-12-25 22:16:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\states\section_1.json
2024-12-25 22:16:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:16:55 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:16:55 | ERROR    | managers.agent_manager:initialize_game:379 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:16:55 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:16:55 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:17:45 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:17:45 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:17:45 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:17:45 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 22:17:45 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 22:17:45 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 22:17:45 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\states\current_state.json
2024-12-25 22:17:45 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\states\current_state.json
2024-12-25 22:17:45 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\7751ea8f-3c08-4ec3-9e37-251a595360fb\states\current_state.json
2024-12-25 22:17:45 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 22:17:45 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 22:17:45 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 22:17:45 | INFO     | managers.agent_manager:stop_game:530 - Game stopped successfully
2024-12-25 22:17:45 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:17:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:17:49 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:17:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:17:51 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:17:51 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:17:51 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:17:51 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:17:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:17:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:17:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:17:51 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:17:51 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:17:51 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:17:51 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:17:51 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:17:51 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:17:51 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:17:51 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:17:51 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:17:51 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:17:51 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:17:51 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:17:51 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:17:52 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:17:52 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:17:52 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:17:52 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:18:09 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:18:09 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:18:09 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:18:09 | DEBUG    | managers.agent_manager:stop_game:521 - No game ID set, nothing to save
2024-12-25 22:18:09 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:18:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:21:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:21:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:21:17 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:21:17 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:21:17 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:21:17 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:21:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:21:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:21:17 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:21:17 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:21:17 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:21:17 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:21:17 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:21:17 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:21:17 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:21:17 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:21:17 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:21:17 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:21:17 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:21:17 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:21:17 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:21:17 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:21:18 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:21:18 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:21:18 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:21:18 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:21:24 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:21:24 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:21:24 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:21:24 | DEBUG    | managers.agent_manager:stop_game:521 - No game ID set, nothing to save
2024-12-25 22:21:24 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:21:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:21:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:21:28 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:21:28 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:21:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:21:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:21:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:21:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:21:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:21:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:21:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:21:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:21:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:21:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:21:28 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:21:28 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:21:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:21:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:21:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:21:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:21:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:21:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:21:29 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:21:29 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:21:29 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:21:29 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:24:47 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:24:47 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:24:47 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:24:47 | DEBUG    | managers.agent_manager:stop_game:521 - No game ID set, nothing to save
2024-12-25 22:24:47 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:24:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:24:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:24:51 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:24:51 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:24:51 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:24:51 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:24:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:24:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:24:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:24:51 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:24:51 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:24:51 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:24:51 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:24:51 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:24:51 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:24:51 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:24:51 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:24:51 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:24:51 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:24:51 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:24:51 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:24:51 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:24:51 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:24:51 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:24:51 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:24:51 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:24:52 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:24:52 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:24:52 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:24:52 | DEBUG    | managers.agent_manager:stop_game:521 - No game ID set, nothing to save
2024-12-25 22:24:52 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:24:53 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:24:55 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:24:55 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:24:55 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:24:55 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:24:55 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:24:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:24:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:24:55 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:24:55 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:24:55 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:24:55 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:24:55 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:24:55 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:24:55 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:24:55 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:24:55 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:24:55 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:24:55 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:24:55 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:24:55 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:24:55 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:24:56 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:24:56 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:24:56 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:24:56 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:26:48 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:26:48 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:26:48 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:26:48 | DEBUG    | managers.agent_manager:stop_game:521 - No game ID set, nothing to save
2024-12-25 22:26:48 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:26:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:28:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:28:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:28:28 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:28:28 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:28:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:28:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:28:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:28:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:28:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:28:28 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:28:28 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:28:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:28:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:28:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:28:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:28:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:28:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:28:29 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:28:29 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:28:29 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:28:29 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:28:34 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:28:34 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:28:34 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:28:34 | DEBUG    | managers.agent_manager:stop_game:521 - No game ID set, nothing to save
2024-12-25 22:28:34 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:28:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:28:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:28:39 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:28:39 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:28:39 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:28:39 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:28:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:28:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:28:39 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:28:39 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:28:39 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:28:39 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:28:39 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:28:39 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:28:39 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:28:39 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:28:39 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:28:39 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:28:39 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:28:39 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:28:39 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:28:39 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:28:40 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:28:40 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:28:40 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:28:40 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:28:42 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:28:42 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:28:42 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:28:42 | DEBUG    | managers.agent_manager:stop_game:521 - No game ID set, nothing to save
2024-12-25 22:28:42 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:28:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:28:45 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:28:45 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:28:45 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:28:45 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:28:45 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:28:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:28:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:28:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:28:45 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:28:45 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:28:45 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:28:45 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:28:45 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:28:45 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:28:45 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:28:45 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:28:45 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:28:45 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:28:45 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:28:45 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:28:45 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:28:46 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:28:46 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:28:46 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:28:46 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:29:11 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:29:11 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:29:11 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:29:11 | DEBUG    | managers.agent_manager:stop_game:521 - No game ID set, nothing to save
2024-12-25 22:29:11 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:29:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:29:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:29:15 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:29:15 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:29:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:29:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:29:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:29:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:29:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:29:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:29:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:29:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:29:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:29:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:29:15 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:29:15 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:29:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:29:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:29:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:29:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:29:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:29:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:29:16 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:29:16 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:29:16 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:29:16 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:29:18 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 22:29:18 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 22:29:18 | INFO     | api.app:initialize_game:634 - Generated session ID: 232dbbb5-ffdd-46a6-8e1c-cd9a1122fbc5
2024-12-25 22:29:18 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 22:29:18 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 22:29:18 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 22:29:18 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 22:29:18 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 22:29:18 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 0c5c7724-22d7-484b-86dc-debd1e764bec
2024-12-25 22:29:18 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 0c5c7724-22d7-484b-86dc-debd1e764bec
2024-12-25 22:29:18 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states
2024-12-25 22:29:18 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\traces
2024-12-25 22:29:18 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\characters
2024-12-25 22:29:18 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 0c5c7724-22d7-484b-86dc-debd1e764bec
2024-12-25 22:29:18 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 22:29:18 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 22:29:18 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 22:29:18 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:29:18 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 22:29:18 | DEBUG    | managers.agent_manager:_configure_story_graph:567 - Configuring story graph
2024-12-25 22:29:18 | DEBUG    | managers.agent_manager:_configure_story_graph:576 - Story graph configured successfully
2024-12-25 22:29:18 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 22:29:18 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 22:29:18 | DEBUG    | managers.agent_manager:initialize_game:355 - Session ID provided: 232dbbb5-ffdd-46a6-8e1c-cd9a1122fbc5
2024-12-25 22:29:18 | DEBUG    | managers.agent_manager:initialize_game:356 - Initial state params: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:29:18 | DEBUG    | managers.agent_manager:initialize_game:364 - Initial state created: session_id='232dbbb5-ffdd-46a6-8e1c-cd9a1122fbc5' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:29:18 | INFO     | managers.workflow_manager:initialize_workflow:308 - Initializing workflow
2024-12-25 22:29:18 | DEBUG    | managers.workflow_manager:initialize_workflow:309 - Initial state: session_id='232dbbb5-ffdd-46a6-8e1c-cd9a1122fbc5' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:29:18 | DEBUG    | managers.workflow_manager:initialize_workflow:312 - Saving initial state
2024-12-25 22:29:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:29:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:29:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:29:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:29:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:29:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:29:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:29:18 | INFO     | managers.workflow_manager:initialize_workflow:315 - Workflow initialization completed
2024-12-25 22:29:18 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 22:29:18 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='232dbbb5-ffdd-46a6-8e1c-cd9a1122fbc5' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 22:29:18 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 22:29:18 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 22:29:18 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 22:29:18 | DEBUG    | managers.workflow_manager:start_workflow:205 - State received in start_workflow: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:29:18 | DEBUG    | managers.workflow_manager:start_workflow:206 - Session ID in state: 
2024-12-25 22:29:18 | DEBUG    | managers.workflow_manager:start_workflow:207 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:29:18 | DEBUG    | managers.workflow_manager:start_workflow:221 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:29:18 | DEBUG    | managers.workflow_manager:start_workflow:237 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:29:18 | ERROR    | managers.workflow_manager:start_workflow:241 - State validation failed: Missing session_id.
2024-12-25 22:29:18 | ERROR    | managers.workflow_manager:start_workflow:256 - Error in start node: State is missing a valid session_id.
2024-12-25 22:29:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:29:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:29:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:29:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:29:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:29:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:29:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:29:18 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:29:18 | ERROR    | managers.agent_manager:initialize_game:379 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:29:18 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:29:18 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:30:27 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 22:30:27 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 22:30:27 | INFO     | api.app:initialize_game:634 - Generated session ID: c245f092-ede3-4834-9b01-12f7ca10e663
2024-12-25 22:30:27 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 22:30:27 | DEBUG    | managers.agent_manager:initialize:298 - AgentManager already initialized
2024-12-25 22:30:27 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 22:30:27 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 22:30:27 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:30:27 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 22:30:27 | DEBUG    | managers.agent_manager:_configure_story_graph:567 - Configuring story graph
2024-12-25 22:30:27 | DEBUG    | managers.agent_manager:_configure_story_graph:576 - Story graph configured successfully
2024-12-25 22:30:27 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 22:30:27 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 22:30:27 | DEBUG    | managers.agent_manager:initialize_game:355 - Session ID provided: c245f092-ede3-4834-9b01-12f7ca10e663
2024-12-25 22:30:27 | DEBUG    | managers.agent_manager:initialize_game:356 - Initial state params: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:30:27 | DEBUG    | managers.agent_manager:initialize_game:364 - Initial state created: session_id='c245f092-ede3-4834-9b01-12f7ca10e663' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:30:27 | INFO     | managers.workflow_manager:initialize_workflow:308 - Initializing workflow
2024-12-25 22:30:27 | DEBUG    | managers.workflow_manager:initialize_workflow:309 - Initial state: session_id='c245f092-ede3-4834-9b01-12f7ca10e663' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:30:27 | DEBUG    | managers.workflow_manager:initialize_workflow:312 - Saving initial state
2024-12-25 22:30:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:30:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:30:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:30:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:30:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:30:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:30:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:30:27 | INFO     | managers.workflow_manager:initialize_workflow:315 - Workflow initialization completed
2024-12-25 22:30:27 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 22:30:27 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='c245f092-ede3-4834-9b01-12f7ca10e663' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 22:30:27 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 22:30:27 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 22:30:27 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 22:30:27 | DEBUG    | managers.workflow_manager:start_workflow:205 - State received in start_workflow: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:30:27 | DEBUG    | managers.workflow_manager:start_workflow:206 - Session ID in state: 
2024-12-25 22:30:27 | DEBUG    | managers.workflow_manager:start_workflow:207 - Input data type: <class 'models.game_state.GameState'>, value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:30:27 | DEBUG    | managers.workflow_manager:start_workflow:221 - Initial state extracted from input data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:30:27 | DEBUG    | managers.workflow_manager:start_workflow:237 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:30:27 | ERROR    | managers.workflow_manager:start_workflow:241 - State validation failed: Missing session_id.
2024-12-25 22:30:27 | ERROR    | managers.workflow_manager:start_workflow:256 - Error in start node: State is missing a valid session_id.
2024-12-25 22:30:27 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:30:27 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:30:27 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:30:27 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:30:27 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:30:27 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\section_1.json
2024-12-25 22:30:27 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:30:27 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:30:27 | ERROR    | managers.agent_manager:initialize_game:379 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:30:27 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:30:27 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:32:43 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:32:43 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:32:43 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:32:43 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 22:32:43 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 22:32:43 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 22:32:43 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\current_state.json
2024-12-25 22:32:43 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\current_state.json
2024-12-25 22:32:43 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\0c5c7724-22d7-484b-86dc-debd1e764bec\states\current_state.json
2024-12-25 22:32:43 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 22:32:43 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 22:32:43 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 22:32:43 | INFO     | managers.agent_manager:stop_game:530 - Game stopped successfully
2024-12-25 22:32:43 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:32:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:32:46 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:32:46 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:32:46 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:32:46 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:32:46 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:32:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:32:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:32:46 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:32:46 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:32:46 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:32:46 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:32:46 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:32:46 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:32:46 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:32:46 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:32:46 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:32:46 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:32:46 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:32:46 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:32:46 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:32:46 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:32:47 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:32:47 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:32:47 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:32:47 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:32:47 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:32:47 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:32:47 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:32:47 | DEBUG    | managers.agent_manager:stop_game:521 - No game ID set, nothing to save
2024-12-25 22:32:47 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:32:48 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:32:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:32:51 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:32:51 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:32:51 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:32:51 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:32:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:32:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:32:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:32:51 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:32:51 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:32:51 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:32:51 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:32:51 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:32:51 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:32:51 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:32:51 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:32:51 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:32:51 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:32:51 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:32:51 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:32:51 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:32:52 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:32:52 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:32:52 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:32:52 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:32:55 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 22:32:55 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 22:32:55 | INFO     | api.app:initialize_game:634 - Generated session ID: 02295724-d487-4848-bd21-9dedeabc10dc
2024-12-25 22:32:55 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 22:32:55 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 22:32:55 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 22:32:55 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 22:32:55 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 22:32:55 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: e9b6b791-fe14-4d04-a839-d9c4b11b14d1
2024-12-25 22:32:55 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: e9b6b791-fe14-4d04-a839-d9c4b11b14d1
2024-12-25 22:32:55 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\e9b6b791-fe14-4d04-a839-d9c4b11b14d1\states
2024-12-25 22:32:55 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\e9b6b791-fe14-4d04-a839-d9c4b11b14d1\traces
2024-12-25 22:32:55 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\e9b6b791-fe14-4d04-a839-d9c4b11b14d1\characters
2024-12-25 22:32:55 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: e9b6b791-fe14-4d04-a839-d9c4b11b14d1
2024-12-25 22:32:55 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 22:32:55 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 22:32:55 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 22:32:55 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:32:55 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 22:32:55 | DEBUG    | managers.agent_manager:_configure_story_graph:567 - Configuring story graph
2024-12-25 22:32:55 | DEBUG    | managers.agent_manager:_configure_story_graph:576 - Story graph configured successfully
2024-12-25 22:32:55 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 22:32:55 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 22:32:55 | DEBUG    | managers.agent_manager:initialize_game:355 - Session ID provided: 02295724-d487-4848-bd21-9dedeabc10dc
2024-12-25 22:32:55 | DEBUG    | managers.agent_manager:initialize_game:356 - Initial state params: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:32:55 | DEBUG    | managers.agent_manager:initialize_game:364 - Initial state created: session_id='02295724-d487-4848-bd21-9dedeabc10dc' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:32:55 | INFO     | managers.workflow_manager:initialize_workflow:316 - Initializing workflow
2024-12-25 22:32:55 | DEBUG    | managers.workflow_manager:initialize_workflow:317 - Initial state: session_id='02295724-d487-4848-bd21-9dedeabc10dc' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:32:55 | DEBUG    | managers.workflow_manager:initialize_workflow:320 - Saving initial state
2024-12-25 22:32:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:32:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:32:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:32:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e9b6b791-fe14-4d04-a839-d9c4b11b14d1\states\section_1.json
2024-12-25 22:32:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e9b6b791-fe14-4d04-a839-d9c4b11b14d1\states\section_1.json
2024-12-25 22:32:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e9b6b791-fe14-4d04-a839-d9c4b11b14d1\states\section_1.json
2024-12-25 22:32:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:32:55 | INFO     | managers.workflow_manager:initialize_workflow:323 - Workflow initialization completed
2024-12-25 22:32:55 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 22:32:55 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='02295724-d487-4848-bd21-9dedeabc10dc' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 22:32:55 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 22:32:55 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 22:32:55 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 22:32:55 | DEBUG    | managers.workflow_manager:start_workflow:203 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:32:55 | DEBUG    | managers.workflow_manager:start_workflow:217 - Session ID in input_data: 
2024-12-25 22:32:55 | DEBUG    | managers.workflow_manager:start_workflow:221 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:32:55 | DEBUG    | managers.workflow_manager:start_workflow:238 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:32:55 | ERROR    | managers.workflow_manager:start_workflow:242 - State validation failed: Missing session_id.
2024-12-25 22:32:55 | ERROR    | managers.workflow_manager:start_workflow:259 - Error in start node: State is missing a valid session_id.
2024-12-25 22:32:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:32:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:32:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:32:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e9b6b791-fe14-4d04-a839-d9c4b11b14d1\states\section_1.json
2024-12-25 22:32:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e9b6b791-fe14-4d04-a839-d9c4b11b14d1\states\section_1.json
2024-12-25 22:32:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e9b6b791-fe14-4d04-a839-d9c4b11b14d1\states\section_1.json
2024-12-25 22:32:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:32:55 | DEBUG    | managers.workflow_manager:start_workflow:265 - Error state generated: {'session_id': '6439953e-588e-4601-8faa-33146b3bd37b', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': 'State is missing a valid session_id.', 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 22:32:55 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:32:55 | ERROR    | managers.agent_manager:initialize_game:379 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:32:55 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:32:55 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:51:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:51:27 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-25 22:51:27 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-25 22:51:27 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-25 22:51:27 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-25 22:51:27 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-25 22:51:27 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-25 22:51:27 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-25 22:51:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:51:29 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:51:29 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:51:29 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:51:29 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:51:29 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:51:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:51:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:51:29 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:51:29 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:51:29 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:51:29 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:51:29 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:51:29 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:51:29 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:51:29 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:51:29 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:51:29 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:51:29 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:51:29 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:51:29 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:51:29 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:51:30 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:51:30 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:51:30 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:51:30 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:51:35 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 22:51:35 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 22:51:35 | INFO     | api.app:initialize_game:634 - Generated session ID: 8e9195ce-d5ff-43a0-b059-a3f62ffd694c
2024-12-25 22:51:35 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 22:51:35 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 22:51:35 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 22:51:35 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 22:51:35 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 22:51:35 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: db448ba5-30d7-4068-82d6-04f020119d57
2024-12-25 22:51:35 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: db448ba5-30d7-4068-82d6-04f020119d57
2024-12-25 22:51:35 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\states
2024-12-25 22:51:35 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\traces
2024-12-25 22:51:35 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\characters
2024-12-25 22:51:35 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: db448ba5-30d7-4068-82d6-04f020119d57
2024-12-25 22:51:35 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 22:51:35 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 22:51:35 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 22:51:35 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:51:35 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 22:51:35 | DEBUG    | managers.agent_manager:_configure_story_graph:567 - Configuring story graph
2024-12-25 22:51:35 | DEBUG    | managers.agent_manager:_configure_story_graph:576 - Story graph configured successfully
2024-12-25 22:51:35 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 22:51:35 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 22:51:35 | DEBUG    | managers.agent_manager:initialize_game:355 - Session ID provided: 8e9195ce-d5ff-43a0-b059-a3f62ffd694c
2024-12-25 22:51:35 | DEBUG    | managers.agent_manager:initialize_game:356 - Initial state params: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:51:35 | DEBUG    | managers.agent_manager:initialize_game:364 - Initial state created: session_id='8e9195ce-d5ff-43a0-b059-a3f62ffd694c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:51:35 | INFO     | managers.workflow_manager:initialize_workflow:316 - Initializing workflow
2024-12-25 22:51:35 | DEBUG    | managers.workflow_manager:initialize_workflow:317 - Initial state: session_id='8e9195ce-d5ff-43a0-b059-a3f62ffd694c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:51:35 | DEBUG    | managers.workflow_manager:initialize_workflow:320 - Saving initial state
2024-12-25 22:51:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:51:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:51:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:51:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\states\section_1.json
2024-12-25 22:51:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\states\section_1.json
2024-12-25 22:51:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\states\section_1.json
2024-12-25 22:51:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:51:35 | INFO     | managers.workflow_manager:initialize_workflow:323 - Workflow initialization completed
2024-12-25 22:51:35 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 22:51:35 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='8e9195ce-d5ff-43a0-b059-a3f62ffd694c' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 22:51:35 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 22:51:35 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 22:51:35 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 22:51:35 | DEBUG    | managers.workflow_manager:start_workflow:203 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:51:35 | DEBUG    | managers.workflow_manager:start_workflow:217 - Session ID in input_data: 
2024-12-25 22:51:35 | DEBUG    | managers.workflow_manager:start_workflow:221 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:51:35 | DEBUG    | managers.workflow_manager:start_workflow:238 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:51:35 | ERROR    | managers.workflow_manager:start_workflow:242 - State validation failed: Missing session_id.
2024-12-25 22:51:35 | ERROR    | managers.workflow_manager:start_workflow:259 - Error in start node: State is missing a valid session_id.
2024-12-25 22:51:35 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:51:35 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:51:35 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:51:35 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\states\section_1.json
2024-12-25 22:51:35 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\states\section_1.json
2024-12-25 22:51:35 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\states\section_1.json
2024-12-25 22:51:35 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:51:35 | DEBUG    | managers.workflow_manager:start_workflow:265 - Error state generated: {'session_id': 'fd17dda8-8e84-4dd4-ad9b-fa6230a005cf', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': 'State is missing a valid session_id.', 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 22:51:35 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:51:35 | ERROR    | managers.agent_manager:initialize_game:379 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:51:35 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:51:35 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:53:36 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 22:53:36 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 22:53:36 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 22:53:36 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 22:53:36 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 22:53:36 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 22:53:36 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\states\current_state.json
2024-12-25 22:53:36 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\states\current_state.json
2024-12-25 22:53:36 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\db448ba5-30d7-4068-82d6-04f020119d57\states\current_state.json
2024-12-25 22:53:36 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 22:53:36 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 22:53:36 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 22:53:36 | INFO     | managers.agent_manager:stop_game:530 - Game stopped successfully
2024-12-25 22:53:36 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 22:53:37 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:53:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 22:53:40 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 22:53:40 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 22:53:40 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 22:53:40 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:53:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 22:53:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 22:53:40 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 22:53:40 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 22:53:40 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:53:40 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 22:53:40 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 22:53:40 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 22:53:40 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 22:53:40 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 22:53:40 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 22:53:40 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 22:53:40 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 22:53:40 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 22:53:40 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 22:53:40 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 22:53:40 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 22:53:40 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 22:53:40 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 22:53:40 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 22:53:43 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 22:53:43 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 22:53:43 | INFO     | api.app:initialize_game:634 - Generated session ID: e0cf38c5-ee4c-4050-8ed3-81215a5ed20f
2024-12-25 22:53:43 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 22:53:43 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 22:53:43 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 22:53:43 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 22:53:43 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 22:53:43 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 662a2b60-be79-4483-98d3-3e2048d9c8f8
2024-12-25 22:53:43 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 662a2b60-be79-4483-98d3-3e2048d9c8f8
2024-12-25 22:53:43 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\states
2024-12-25 22:53:43 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\traces
2024-12-25 22:53:43 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\characters
2024-12-25 22:53:43 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 662a2b60-be79-4483-98d3-3e2048d9c8f8
2024-12-25 22:53:43 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 22:53:43 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 22:53:43 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 22:53:43 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:53:43 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 22:53:43 | DEBUG    | managers.agent_manager:_configure_story_graph:567 - Configuring story graph
2024-12-25 22:53:43 | DEBUG    | managers.agent_manager:_configure_story_graph:576 - Story graph configured successfully
2024-12-25 22:53:43 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 22:53:43 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 22:53:43 | DEBUG    | managers.agent_manager:initialize_game:355 - Session ID provided: e0cf38c5-ee4c-4050-8ed3-81215a5ed20f
2024-12-25 22:53:43 | DEBUG    | managers.agent_manager:initialize_game:356 - Initial state params: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 22:53:43 | DEBUG    | managers.agent_manager:initialize_game:364 - Initial state created: session_id='e0cf38c5-ee4c-4050-8ed3-81215a5ed20f' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:53:43 | INFO     | managers.workflow_manager:initialize_workflow:316 - Initializing workflow
2024-12-25 22:53:43 | DEBUG    | managers.workflow_manager:initialize_workflow:317 - Initial state: session_id='e0cf38c5-ee4c-4050-8ed3-81215a5ed20f' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:53:43 | DEBUG    | managers.workflow_manager:initialize_workflow:320 - Saving initial state
2024-12-25 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:53:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\states\section_1.json
2024-12-25 22:53:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\states\section_1.json
2024-12-25 22:53:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\states\section_1.json
2024-12-25 22:53:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:53:43 | INFO     | managers.workflow_manager:initialize_workflow:323 - Workflow initialization completed
2024-12-25 22:53:43 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 22:53:43 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='e0cf38c5-ee4c-4050-8ed3-81215a5ed20f' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 22:53:43 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 22:53:43 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 22:53:43 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 22:53:43 | DEBUG    | managers.workflow_manager:start_workflow:203 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 22:53:43 | DEBUG    | managers.workflow_manager:start_workflow:217 - Session ID in input_data: 
2024-12-25 22:53:43 | DEBUG    | managers.workflow_manager:start_workflow:221 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:53:43 | DEBUG    | managers.workflow_manager:start_workflow:238 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 22:53:43 | ERROR    | managers.workflow_manager:start_workflow:242 - State validation failed: Missing session_id.
2024-12-25 22:53:43 | ERROR    | managers.workflow_manager:start_workflow:259 - Error in start node: State is missing a valid session_id.
2024-12-25 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 22:53:43 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 22:53:43 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\states\section_1.json
2024-12-25 22:53:43 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\states\section_1.json
2024-12-25 22:53:43 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\states\section_1.json
2024-12-25 22:53:43 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 22:53:43 | DEBUG    | managers.workflow_manager:start_workflow:265 - Error state generated: {'session_id': 'b28c44fb-7fae-43d4-9e80-5029f726a350', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': 'State is missing a valid session_id.', 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 22:53:43 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:53:43 | ERROR    | managers.agent_manager:initialize_game:379 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:53:43 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 22:53:43 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 23:15:05 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-25 23:15:05 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-25 23:15:05 | INFO     | managers.agent_manager:stop_game:516 - Stopping game...
2024-12-25 23:15:05 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-25 23:15:05 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-25 23:15:06 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-25 23:15:06 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\states\current_state.json
2024-12-25 23:15:06 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\states\current_state.json
2024-12-25 23:15:06 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\662a2b60-be79-4483-98d3-3e2048d9c8f8\states\current_state.json
2024-12-25 23:15:06 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-25 23:15:06 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-25 23:15:06 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-25 23:15:06 | INFO     | managers.agent_manager:stop_game:530 - Game stopped successfully
2024-12-25 23:15:06 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-25 23:15:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 23:15:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 23:15:10 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 23:15:10 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 23:15:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 23:15:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 23:15:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 23:15:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 23:15:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 23:15:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 23:15:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 23:15:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 23:15:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 23:15:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 23:15:10 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 23:15:10 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 23:15:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 23:15:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 23:15:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 23:15:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 23:15:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 23:15:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 23:15:11 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 23:15:11 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 23:15:11 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 23:15:11 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 23:31:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 23:31:25 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-25 23:31:25 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-25 23:31:25 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-25 23:31:25 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-25 23:31:25 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-25 23:31:25 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-25 23:31:25 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-25 23:31:25 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 23:31:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 23:31:28 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 23:31:28 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 23:31:28 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 23:31:28 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 23:31:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 23:31:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 23:31:28 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 23:31:28 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 23:31:28 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 23:31:28 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 23:31:28 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 23:31:28 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 23:31:28 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 23:31:28 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 23:31:28 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 23:31:28 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 23:31:28 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 23:31:28 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 23:31:28 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 23:31:28 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 23:31:29 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 23:31:29 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 23:31:29 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 23:31:29 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 23:31:40 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 23:31:40 | INFO     | api.app:initialize_game:621 - Starting new game initialization
2024-12-25 23:31:40 | INFO     | api.app:initialize_game:634 - Generated session ID: a5ac3fee-25ca-4ecd-8f51-eb87c8639f07
2024-12-25 23:31:40 | DEBUG    | api.app:initialize_game:638 - Initializing game components
2024-12-25 23:31:40 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-25 23:31:40 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-25 23:31:40 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-25 23:31:40 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-25 23:31:40 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 66c3ed0a-7a9b-42e3-a690-9291b50d13d2
2024-12-25 23:31:40 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 66c3ed0a-7a9b-42e3-a690-9291b50d13d2
2024-12-25 23:31:40 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\66c3ed0a-7a9b-42e3-a690-9291b50d13d2\states
2024-12-25 23:31:40 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\66c3ed0a-7a9b-42e3-a690-9291b50d13d2\traces
2024-12-25 23:31:40 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\66c3ed0a-7a9b-42e3-a690-9291b50d13d2\characters
2024-12-25 23:31:40 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 66c3ed0a-7a9b-42e3-a690-9291b50d13d2
2024-12-25 23:31:40 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-25 23:31:40 | DEBUG    | api.app:initialize_game:640 - Game components initialized successfully
2024-12-25 23:31:40 | DEBUG    | api.app:initialize_game:643 - Processing initialization request
2024-12-25 23:31:40 | DEBUG    | api.app:initialize_game:648 - Processed init parameters: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 23:31:40 | DEBUG    | api.app:initialize_game:651 - Creating initial game state
2024-12-25 23:31:40 | DEBUG    | managers.agent_manager:_configure_story_graph:567 - Configuring story graph
2024-12-25 23:31:40 | DEBUG    | managers.agent_manager:_configure_story_graph:576 - Story graph configured successfully
2024-12-25 23:31:40 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-25 23:31:40 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-25 23:31:40 | DEBUG    | managers.agent_manager:initialize_game:355 - Session ID provided: a5ac3fee-25ca-4ecd-8f51-eb87c8639f07
2024-12-25 23:31:40 | DEBUG    | managers.agent_manager:initialize_game:356 - Initial state params: {'game_id': 'string', 'player_id': 'string', 'settings': {}}
2024-12-25 23:31:40 | DEBUG    | managers.agent_manager:initialize_game:364 - Initial state created: session_id='a5ac3fee-25ca-4ecd-8f51-eb87c8639f07' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 23:31:40 | INFO     | managers.workflow_manager:initialize_workflow:316 - Initializing workflow
2024-12-25 23:31:40 | DEBUG    | managers.workflow_manager:initialize_workflow:317 - Initial state: session_id='a5ac3fee-25ca-4ecd-8f51-eb87c8639f07' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 23:31:40 | DEBUG    | managers.workflow_manager:initialize_workflow:320 - Saving initial state
2024-12-25 23:31:40 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 23:31:40 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 23:31:40 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 23:31:40 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66c3ed0a-7a9b-42e3-a690-9291b50d13d2\states\section_1.json
2024-12-25 23:31:40 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66c3ed0a-7a9b-42e3-a690-9291b50d13d2\states\section_1.json
2024-12-25 23:31:40 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66c3ed0a-7a9b-42e3-a690-9291b50d13d2\states\section_1.json
2024-12-25 23:31:40 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 23:31:40 | INFO     | managers.workflow_manager:initialize_workflow:323 - Workflow initialization completed
2024-12-25 23:31:40 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-25 23:31:40 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='a5ac3fee-25ca-4ecd-8f51-eb87c8639f07' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-25 23:31:40 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-25 23:31:40 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-25 23:31:40 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-25 23:31:40 | DEBUG    | managers.workflow_manager:start_workflow:203 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-25 23:31:40 | DEBUG    | managers.workflow_manager:start_workflow:217 - Session ID in input_data: 
2024-12-25 23:31:40 | DEBUG    | managers.workflow_manager:start_workflow:221 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 23:31:40 | DEBUG    | managers.workflow_manager:start_workflow:238 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-25 23:31:40 | ERROR    | managers.workflow_manager:start_workflow:242 - State validation failed: Missing session_id.
2024-12-25 23:31:40 | ERROR    | managers.workflow_manager:start_workflow:259 - Error in start node: State is missing a valid session_id.
2024-12-25 23:31:40 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-25 23:31:40 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-25 23:31:40 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-25 23:31:40 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66c3ed0a-7a9b-42e3-a690-9291b50d13d2\states\section_1.json
2024-12-25 23:31:40 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66c3ed0a-7a9b-42e3-a690-9291b50d13d2\states\section_1.json
2024-12-25 23:31:40 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\66c3ed0a-7a9b-42e3-a690-9291b50d13d2\states\section_1.json
2024-12-25 23:31:40 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-25 23:31:40 | DEBUG    | managers.workflow_manager:start_workflow:265 - Error state generated: {'session_id': 'bab115cb-6c5a-431b-8a27-5f68c3d0ab4c', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': 'State is missing a valid session_id.', 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-25 23:31:40 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 23:31:40 | ERROR    | managers.agent_manager:initialize_game:379 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 23:31:40 | ERROR    | api.app:initialize_game:668 - Error during game initialization: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 23:31:40 | ERROR    | api.app:initialize_game:678 - Game error during initialization: Game initialization failed: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-25 23:58:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 23:58:55 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-25 23:58:55 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-25 23:58:55 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-25 23:58:55 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-25 23:58:55 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-25 23:58:55 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-25 23:58:55 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-25 23:58:55 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 23:58:57 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-25 23:58:57 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-25 23:58:57 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-25 23:58:57 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-25 23:58:57 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 23:58:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-25 23:58:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-25 23:58:57 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-25 23:58:57 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-25 23:58:57 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 23:58:57 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-25 23:58:57 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-25 23:58:57 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-25 23:58:57 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-25 23:58:57 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-25 23:58:57 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-25 23:58:57 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-25 23:58:57 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-25 23:58:57 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-25 23:58:57 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-25 23:58:57 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-25 23:58:57 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-25 23:58:57 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-25 23:58:57 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-25 23:58:57 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-25 23:59:02 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-25 23:59:02 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-25 23:59:02 | ERROR    | api.app:initialize_game:626 - Error initializing game: 'AgentManager' object has no attribute 'initialize_game'
2024-12-26 00:00:24 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 00:00:24 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 00:00:24 | INFO     | managers.agent_manager:stop_game:507 - Stopping game...
2024-12-26 00:00:24 | DEBUG    | managers.agent_manager:stop_game:512 - No game ID set, nothing to save
2024-12-26 00:00:24 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 00:00:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:00:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:00:27 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 00:00:27 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 00:00:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 00:00:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:00:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 00:00:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 00:00:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 00:00:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 00:00:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:00:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 00:00:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 00:00:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:00:27 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 00:00:27 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-26 00:00:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 00:00:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 00:00:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 00:00:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 00:00:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 00:00:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 00:00:27 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 00:00:27 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 00:00:27 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 00:00:27 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 00:00:36 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 00:00:36 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 00:00:36 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 00:00:36 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 00:00:36 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 00:00:36 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-26 00:00:36 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 2db841a8-e53d-4094-bdca-45e08d4d5a47
2024-12-26 00:00:36 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 2db841a8-e53d-4094-bdca-45e08d4d5a47
2024-12-26 00:00:36 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\states
2024-12-26 00:00:36 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\traces
2024-12-26 00:00:36 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\characters
2024-12-26 00:00:36 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 2db841a8-e53d-4094-bdca-45e08d4d5a47
2024-12-26 00:00:36 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 00:00:36 | INFO     | managers.agent_manager:initialize_game:339 - Generated session ID: c0008102-a6a8-453c-9acd-c8dbe912377b
2024-12-26 00:00:36 | DEBUG    | managers.agent_manager:_configure_story_graph:556 - Configuring story graph
2024-12-26 00:00:36 | DEBUG    | managers.agent_manager:_configure_story_graph:565 - Story graph configured successfully
2024-12-26 00:00:36 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 00:00:36 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 00:00:36 | INFO     | managers.agent_manager:initialize_game:354 - Initial game state created: session_id='c0008102-a6a8-453c-9acd-c8dbe912377b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 00:00:36 | INFO     | managers.workflow_manager:initialize_workflow:316 - Initializing workflow
2024-12-26 00:00:36 | DEBUG    | managers.workflow_manager:initialize_workflow:317 - Initial state: session_id='c0008102-a6a8-453c-9acd-c8dbe912377b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 00:00:36 | DEBUG    | managers.workflow_manager:initialize_workflow:320 - Saving initial state
2024-12-26 00:00:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 00:00:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 00:00:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 00:00:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\states\section_1.json
2024-12-26 00:00:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\states\section_1.json
2024-12-26 00:00:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\states\section_1.json
2024-12-26 00:00:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 00:00:36 | INFO     | managers.workflow_manager:initialize_workflow:323 - Workflow initialization completed
2024-12-26 00:00:36 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 00:00:36 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='c0008102-a6a8-453c-9acd-c8dbe912377b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 00:00:36 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 00:00:36 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-26 00:00:36 | INFO     | managers.workflow_manager:start_workflow:202 - Starting workflow node
2024-12-26 00:00:36 | DEBUG    | managers.workflow_manager:start_workflow:203 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 00:00:36 | DEBUG    | managers.workflow_manager:start_workflow:217 - Session ID in input_data: 
2024-12-26 00:00:36 | DEBUG    | managers.workflow_manager:start_workflow:221 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-26 00:00:36 | DEBUG    | managers.workflow_manager:start_workflow:238 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>, 'state': {...}}
2024-12-26 00:00:36 | ERROR    | managers.workflow_manager:start_workflow:242 - State validation failed: Missing session_id.
2024-12-26 00:00:36 | ERROR    | managers.workflow_manager:start_workflow:259 - Error in start node: State is missing a valid session_id.
2024-12-26 00:00:36 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 00:00:36 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 00:00:36 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 00:00:36 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\states\section_1.json
2024-12-26 00:00:36 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\states\section_1.json
2024-12-26 00:00:36 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\states\section_1.json
2024-12-26 00:00:36 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 00:00:36 | DEBUG    | managers.workflow_manager:start_workflow:265 - Error state generated: {'session_id': 'fea3e00d-27e8-4497-a3e1-c2c6c1234576', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': 'State is missing a valid session_id.', 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 00:00:36 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-26 00:00:36 | ERROR    | managers.agent_manager:initialize_game:368 - Error during game initialization: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-26 00:00:36 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: models.game_state.GameState() got multiple values for keyword argument 'error'
2024-12-26 00:07:18 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 00:07:18 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 00:07:18 | INFO     | managers.agent_manager:stop_game:505 - Stopping game...
2024-12-26 00:07:18 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 00:07:18 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-26 00:07:18 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 00:07:18 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\states\current_state.json
2024-12-26 00:07:18 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\states\current_state.json
2024-12-26 00:07:18 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2db841a8-e53d-4094-bdca-45e08d4d5a47\states\current_state.json
2024-12-26 00:07:18 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 00:07:18 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-26 00:07:18 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 00:07:18 | INFO     | managers.agent_manager:stop_game:519 - Game stopped successfully
2024-12-26 00:07:18 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 00:07:19 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:07:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:07:21 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 00:07:21 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 00:07:21 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 00:07:21 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:07:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 00:07:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 00:07:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 00:07:21 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 00:07:21 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:07:21 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 00:07:21 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 00:07:21 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:07:21 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 00:07:21 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-26 00:07:21 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 00:07:21 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 00:07:21 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 00:07:21 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 00:07:21 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 00:07:21 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 00:07:21 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 00:07:21 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 00:07:21 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 00:07:21 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 00:12:11 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 00:12:11 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 00:12:11 | INFO     | managers.agent_manager:stop_game:505 - Stopping game...
2024-12-26 00:12:11 | DEBUG    | managers.agent_manager:stop_game:510 - No game ID set, nothing to save
2024-12-26 00:12:11 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 00:12:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:12:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:12:14 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 00:12:14 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 00:12:14 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 00:12:14 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:12:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 00:12:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 00:12:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 00:12:14 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 00:12:14 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:12:14 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 00:12:14 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 00:12:14 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:12:14 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 00:12:14 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-26 00:12:14 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 00:12:14 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 00:12:14 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 00:12:14 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 00:12:14 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 00:12:14 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 00:12:15 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 00:12:15 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 00:12:15 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 00:12:15 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 00:15:06 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 00:15:06 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 00:15:06 | INFO     | managers.agent_manager:stop_game:503 - Stopping game...
2024-12-26 00:15:06 | DEBUG    | managers.agent_manager:stop_game:508 - No game ID set, nothing to save
2024-12-26 00:15:06 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 00:15:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:15:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:15:09 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 00:15:09 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 00:15:09 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 00:15:09 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:15:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 00:15:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 00:15:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 00:15:09 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 00:15:09 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:15:09 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 00:15:09 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 00:15:09 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:15:09 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 00:15:09 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-26 00:15:09 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 00:15:09 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 00:15:09 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 00:15:09 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 00:15:09 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 00:15:09 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 00:15:09 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 00:15:09 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 00:15:09 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 00:15:09 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 00:21:06 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 00:21:06 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 00:21:06 | INFO     | managers.agent_manager:stop_game:503 - Stopping game...
2024-12-26 00:21:06 | DEBUG    | managers.agent_manager:stop_game:508 - No game ID set, nothing to save
2024-12-26 00:21:06 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 00:21:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:21:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:21:10 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 00:21:10 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 00:21:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 00:21:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:21:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 00:21:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 00:21:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 00:21:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 00:21:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:21:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 00:21:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 00:21:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:21:10 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 00:21:10 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-26 00:21:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 00:21:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 00:21:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 00:21:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 00:21:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 00:21:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 00:21:11 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 00:21:11 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 00:21:11 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 00:21:11 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 00:25:05 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 00:25:05 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 00:25:05 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 00:25:05 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 00:25:05 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 00:25:05 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-26 00:25:05 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: a50248e8-6abe-4605-bf91-0847a40db3c2
2024-12-26 00:25:05 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: a50248e8-6abe-4605-bf91-0847a40db3c2
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\states
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\traces
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\characters
2024-12-26 00:25:05 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: a50248e8-6abe-4605-bf91-0847a40db3c2
2024-12-26 00:25:05 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 00:25:05 | INFO     | managers.agent_manager:initialize_game:336 - Initializing the game session...
2024-12-26 00:25:05 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session '8fc0fa1d-9936-4d47-8272-4e2c937f7cd6'
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\characters\current.json
2024-12-26 00:25:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\characters\current.json
2024-12-26 00:25:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\characters\current.json
2024-12-26 00:25:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 00:25:05 | DEBUG    | managers.state_manager:create_initial_state:295 - Parameters for GameState: {'section_number': 1, 'session_id': '8fc0fa1d-9936-4d47-8272-4e2c937f7cd6', 'last_update': '2024-12-26T00:25:05.645010', 'character_id': 'current'}
2024-12-26 00:25:05 | DEBUG    | managers.state_manager:create_initial_state:299 - Initial state created: section=1, session=8fc0fa1d-9936-4d47-8272-4e2c937f7cd6
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\states\section_1.json
2024-12-26 00:25:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\states\section_1.json
2024-12-26 00:25:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\states\section_1.json
2024-12-26 00:25:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 00:25:05 | INFO     | managers.agent_manager:initialize_game:342 - Initial state created: session_id='8fc0fa1d-9936-4d47-8272-4e2c937f7cd6' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 00:25:05 | INFO     | managers.workflow_manager:initialize_workflow:296 - Initializing workflow
2024-12-26 00:25:05 | DEBUG    | managers.workflow_manager:initialize_workflow:297 - Initial state: session_id='8fc0fa1d-9936-4d47-8272-4e2c937f7cd6' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 00:25:05 | DEBUG    | managers.workflow_manager:initialize_workflow:300 - Saving initial state
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 00:25:05 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\states\section_1.json
2024-12-26 00:25:05 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\states\section_1.json
2024-12-26 00:25:05 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\states\section_1.json
2024-12-26 00:25:05 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 00:25:05 | INFO     | managers.workflow_manager:initialize_workflow:303 - Workflow initialization completed
2024-12-26 00:25:05 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 00:25:05 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='8fc0fa1d-9936-4d47-8272-4e2c937f7cd6' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 00:25:05 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: No story graph provided
2024-12-26 00:25:05 | ERROR    | managers.agent_manager:initialize_game:353 - Error during game initialization: Failed to execute workflow: No story graph provided
2024-12-26 00:25:05 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: No story graph provided
2024-12-26 00:34:19 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 00:34:19 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 00:34:19 | INFO     | managers.agent_manager:stop_game:490 - Stopping game...
2024-12-26 00:34:19 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 00:34:19 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-26 00:34:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 00:34:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\states\current_state.json
2024-12-26 00:34:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\states\current_state.json
2024-12-26 00:34:19 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a50248e8-6abe-4605-bf91-0847a40db3c2\states\current_state.json
2024-12-26 00:34:19 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 00:34:19 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-26 00:34:19 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 00:34:19 | INFO     | managers.agent_manager:stop_game:504 - Game stopped successfully
2024-12-26 00:34:19 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 00:34:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:34:23 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 00:34:23 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 00:34:23 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 00:34:23 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 00:34:23 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 00:34:23 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 00:34:23 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-26 00:34:23 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 00:34:23 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 00:34:23 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 00:34:23 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 00:34:23 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 00:34:23 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 00:34:23 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 00:34:23 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 00:34:23 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 00:34:23 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 00:34:23 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 00:34:23 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 00:34:23 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 00:34:23 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 00:34:23 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 00:34:23 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-26 00:34:23 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 91e69e99-bd95-44d8-86db-3b6f1afb92c2
2024-12-26 00:34:23 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 91e69e99-bd95-44d8-86db-3b6f1afb92c2
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\states
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\traces
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\characters
2024-12-26 00:34:23 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 91e69e99-bd95-44d8-86db-3b6f1afb92c2
2024-12-26 00:34:23 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 00:34:23 | DEBUG    | managers.agent_manager:_configure_story_graph:545 - Configuring story graph
2024-12-26 00:34:23 | DEBUG    | managers.agent_manager:_configure_story_graph:554 - Story graph configured successfully
2024-12-26 00:34:23 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 00:34:23 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 00:34:23 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session 'e3b120ae-6855-44db-9380-c88e5a58288b'
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\characters\current.json
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\characters\current.json
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\characters\current.json
2024-12-26 00:34:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 00:34:23 | DEBUG    | managers.state_manager:create_initial_state:295 - Parameters for GameState: {'section_number': 1, 'session_id': 'e3b120ae-6855-44db-9380-c88e5a58288b', 'last_update': '2024-12-26T00:34:23.879538', 'character_id': 'current'}
2024-12-26 00:34:23 | DEBUG    | managers.state_manager:create_initial_state:299 - Initial state created: section=1, session=e3b120ae-6855-44db-9380-c88e5a58288b
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\states\section_1.json
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\states\section_1.json
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\states\section_1.json
2024-12-26 00:34:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 00:34:23 | INFO     | managers.agent_manager:initialize_game:346 - Initial state created: session_id='e3b120ae-6855-44db-9380-c88e5a58288b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 00:34:23 | INFO     | managers.workflow_manager:initialize_workflow:296 - Initializing workflow
2024-12-26 00:34:23 | DEBUG    | managers.workflow_manager:initialize_workflow:297 - Initial state: session_id='e3b120ae-6855-44db-9380-c88e5a58288b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 00:34:23 | DEBUG    | managers.workflow_manager:initialize_workflow:300 - Saving initial state
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 00:34:23 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\states\section_1.json
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\states\section_1.json
2024-12-26 00:34:23 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\91e69e99-bd95-44d8-86db-3b6f1afb92c2\states\section_1.json
2024-12-26 00:34:23 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 00:34:23 | INFO     | managers.workflow_manager:initialize_workflow:303 - Workflow initialization completed
2024-12-26 00:34:23 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 00:34:23 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='e3b120ae-6855-44db-9380-c88e5a58288b' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 00:34:23 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 00:34:23 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-26 00:34:23 | INFO     | managers.workflow_manager:start_workflow:203 - Starting workflow node
2024-12-26 00:34:23 | DEBUG    | managers.workflow_manager:start_workflow:204 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 00:34:23 | DEBUG    | managers.workflow_manager:start_workflow:218 - Session ID in input_data: 
2024-12-26 00:34:23 | DEBUG    | managers.workflow_manager:start_workflow:222 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 00:34:23 | DEBUG    | managers.workflow_manager:start_workflow:232 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 00:34:23 | ERROR    | managers.workflow_manager:start_workflow:236 - State validation failed: Missing session_id.
2024-12-26 00:34:23 | ERROR    | managers.workflow_manager:start_workflow:252 - Error during start_workflow: State is missing a valid session_id.
2024-12-26 00:34:23 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: Failed to start workflow: State is missing a valid session_id.
2024-12-26 00:34:23 | ERROR    | managers.agent_manager:initialize_game:357 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State is missing a valid session_id.
2024-12-26 00:34:23 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State is missing a valid session_id.
2024-12-26 01:29:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:29:08 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-26 01:29:08 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-26 01:29:08 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-26 01:29:08 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-26 01:29:08 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-26 01:29:08 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-26 01:29:08 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-26 01:29:08 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:29:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:29:10 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 01:29:10 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 01:29:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 01:29:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:29:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 01:29:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 01:29:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 01:29:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 01:29:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:29:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 01:29:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 01:29:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:29:10 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 01:29:10 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-26 01:29:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 01:29:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 01:29:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 01:29:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 01:29:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 01:29:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 01:29:11 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 01:29:11 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 01:29:11 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 01:29:11 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 01:29:18 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 01:29:18 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 01:29:18 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 01:29:18 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 01:29:18 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 01:29:18 | INFO     | managers.state_manager:initialize:50 - Initializing StateManager
2024-12-26 01:29:18 | DEBUG    | managers.state_manager:initialize:52 - Generated game ID: 237a9111-39d6-4495-b5af-8945372b1916
2024-12-26 01:29:18 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 237a9111-39d6-4495-b5af-8945372b1916
2024-12-26 01:29:18 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\states
2024-12-26 01:29:18 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\traces
2024-12-26 01:29:18 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\characters
2024-12-26 01:29:18 | INFO     | managers.state_manager:initialize:55 - Initialized state manager with game ID: 237a9111-39d6-4495-b5af-8945372b1916
2024-12-26 01:29:18 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 01:29:18 | DEBUG    | managers.agent_manager:_configure_story_graph:558 - Configuring story graph
2024-12-26 01:29:18 | DEBUG    | managers.agent_manager:_configure_story_graph:567 - Story graph configured successfully
2024-12-26 01:29:18 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 01:29:18 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 01:29:18 | INFO     | managers.state_manager:create_initial_state:269 - Creating initial state for session 'f2b33bf0-0602-45c0-a600-10c530c2b636'
2024-12-26 01:29:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 01:29:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 01:29:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 01:29:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\characters\current.json
2024-12-26 01:29:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\characters\current.json
2024-12-26 01:29:18 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\characters\current.json
2024-12-26 01:29:18 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 01:29:18 | DEBUG    | managers.state_manager:create_initial_state:295 - Parameters for GameState: {'section_number': 1, 'session_id': 'f2b33bf0-0602-45c0-a600-10c530c2b636', 'last_update': '2024-12-26T01:29:18.994759', 'character_id': 'current'}
2024-12-26 01:29:18 | DEBUG    | managers.state_manager:create_initial_state:299 - Initial state created: section=1, session=f2b33bf0-0602-45c0-a600-10c530c2b636
2024-12-26 01:29:18 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 01:29:18 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 01:29:18 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 01:29:18 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\states\section_1.json
2024-12-26 01:29:18 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\states\section_1.json
2024-12-26 01:29:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\states\section_1.json
2024-12-26 01:29:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 01:29:19 | INFO     | managers.agent_manager:initialize_game:359 - Initial state created: session_id='f2b33bf0-0602-45c0-a600-10c530c2b636' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 01:29:19 | INFO     | managers.workflow_manager:initialize_workflow:296 - Initializing workflow
2024-12-26 01:29:19 | DEBUG    | managers.workflow_manager:initialize_workflow:297 - Initial state: session_id='f2b33bf0-0602-45c0-a600-10c530c2b636' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 01:29:19 | DEBUG    | managers.workflow_manager:initialize_workflow:300 - Saving initial state
2024-12-26 01:29:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 01:29:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 01:29:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 01:29:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\states\section_1.json
2024-12-26 01:29:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\states\section_1.json
2024-12-26 01:29:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\states\section_1.json
2024-12-26 01:29:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 01:29:19 | INFO     | managers.workflow_manager:initialize_workflow:303 - Workflow initialization completed
2024-12-26 01:29:19 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 01:29:19 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='f2b33bf0-0602-45c0-a600-10c530c2b636' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 01:29:19 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 01:29:19 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-26 01:29:19 | INFO     | managers.workflow_manager:start_workflow:203 - Starting workflow node
2024-12-26 01:29:19 | DEBUG    | managers.workflow_manager:start_workflow:204 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 01:29:19 | DEBUG    | managers.workflow_manager:start_workflow:218 - Session ID in input_data: 
2024-12-26 01:29:19 | DEBUG    | managers.workflow_manager:start_workflow:222 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 01:29:19 | DEBUG    | managers.workflow_manager:start_workflow:232 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 01:29:19 | ERROR    | managers.workflow_manager:start_workflow:236 - State validation failed: Missing session_id.
2024-12-26 01:29:19 | ERROR    | managers.workflow_manager:start_workflow:252 - Error during start_workflow: State is missing a valid session_id.
2024-12-26 01:29:19 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: Failed to start workflow: State is missing a valid session_id.
2024-12-26 01:29:19 | ERROR    | managers.agent_manager:initialize_game:370 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State is missing a valid session_id.
2024-12-26 01:29:19 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State is missing a valid session_id.
2024-12-26 01:38:16 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 01:38:16 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 01:38:16 | INFO     | managers.agent_manager:stop_game:507 - Stopping game...
2024-12-26 01:38:16 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 01:38:16 | DEBUG    | managers.state_manager:get_current_state:225 - Getting current state
2024-12-26 01:38:16 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 01:38:16 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\states\current_state.json
2024-12-26 01:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\states\current_state.json
2024-12-26 01:38:16 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\237a9111-39d6-4495-b5af-8945372b1916\states\current_state.json
2024-12-26 01:38:16 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 01:38:16 | DEBUG    | managers.state_manager:get_current_state:237 - No current state found
2024-12-26 01:38:16 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 01:38:16 | INFO     | managers.agent_manager:stop_game:521 - Game stopped successfully
2024-12-26 01:38:16 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 01:38:17 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:38:20 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:38:20 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 01:38:20 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 01:38:20 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 01:38:20 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:38:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 01:38:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 01:38:20 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 01:38:20 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 01:38:20 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:38:20 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 01:38:20 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 01:38:20 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:38:20 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 01:38:20 | INFO     | managers.state_manager:__init__:37 - Initializing StateManager
2024-12-26 01:38:20 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 01:38:20 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 01:38:20 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 01:38:20 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 01:38:20 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 01:38:20 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 01:38:20 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 01:38:20 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 01:38:20 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 01:38:20 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 01:42:26 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 01:42:26 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 01:42:27 | INFO     | managers.agent_manager:stop_game:507 - Stopping game...
2024-12-26 01:42:27 | DEBUG    | managers.agent_manager:stop_game:512 - No game ID set, nothing to save
2024-12-26 01:42:27 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 01:42:29 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:42:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:42:32 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 01:42:32 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 01:42:32 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 01:42:32 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:42:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 01:42:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 01:42:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 01:42:32 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 01:42:32 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:42:32 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 01:42:32 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 01:42:32 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:42:32 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 01:42:32 | INFO     | managers.state_manager:__init__:42 - Initializing StateManager
2024-12-26 01:42:32 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 01:42:32 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 01:42:32 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 01:42:32 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 01:42:32 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 01:42:32 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 01:42:33 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 01:42:33 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 01:42:33 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 01:42:33 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 01:43:14 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 01:43:14 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 01:43:14 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 01:43:14 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 01:43:14 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 01:43:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:43:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:43:21 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 01:43:21 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 01:43:21 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 01:43:21 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:43:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 01:43:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 01:43:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 01:43:21 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 01:43:21 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:43:21 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 01:43:21 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 01:43:21 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:43:21 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 01:43:21 | INFO     | managers.state_manager:__init__:42 - Initializing StateManager
2024-12-26 01:43:21 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 01:43:21 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 01:43:21 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 01:43:21 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 01:43:21 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 01:43:21 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 01:43:22 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 01:43:22 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 01:43:22 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 01:43:22 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 01:48:10 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 01:48:10 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 01:48:10 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 01:48:10 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 01:48:10 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 01:48:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:48:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:48:16 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 01:48:16 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 01:48:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 01:48:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:48:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 01:48:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 01:48:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 01:48:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 01:48:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:48:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 01:48:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 01:48:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:48:16 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 01:48:16 | INFO     | managers.state_manager:__init__:42 - Initializing StateManager
2024-12-26 01:48:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 01:48:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 01:48:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 01:48:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 01:48:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 01:48:16 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 01:48:17 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 01:48:17 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 01:48:17 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 01:48:17 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 01:48:43 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 01:48:43 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 01:48:43 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 01:48:43 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 01:48:43 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 01:48:43 | INFO     | managers.state_manager:initialize:55 - Initializing StateManager
2024-12-26 01:48:43 | DEBUG    | managers.state_manager:initialize:57 - Generated game ID: fe74d173-fb64-4f12-b9ec-b4581cf5e1f6
2024-12-26 01:48:43 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: fe74d173-fb64-4f12-b9ec-b4581cf5e1f6
2024-12-26 01:48:43 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\fe74d173-fb64-4f12-b9ec-b4581cf5e1f6\states
2024-12-26 01:48:43 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\fe74d173-fb64-4f12-b9ec-b4581cf5e1f6\traces
2024-12-26 01:48:43 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\fe74d173-fb64-4f12-b9ec-b4581cf5e1f6\characters
2024-12-26 01:48:43 | INFO     | managers.state_manager:initialize:60 - Initialized state manager with game ID: fe74d173-fb64-4f12-b9ec-b4581cf5e1f6
2024-12-26 01:48:43 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 01:48:43 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 01:48:43 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 01:48:43 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 01:48:43 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 01:48:43 | ERROR    | managers.state_manager:create_initial_state:304 - Failed to create initial state: 'StateManager' object has no attribute 'generate_session_id'
2024-12-26 01:48:43 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to create initial state: 'StateManager' object has no attribute 'generate_session_id'
2024-12-26 01:48:43 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to create initial state: 'StateManager' object has no attribute 'generate_session_id'
2024-12-26 01:50:42 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 01:50:42 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 01:50:42 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 01:50:42 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 01:50:42 | DEBUG    | managers.state_manager:get_current_state:230 - Getting current state
2024-12-26 01:50:42 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 01:50:42 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe74d173-fb64-4f12-b9ec-b4581cf5e1f6\states\current_state.json
2024-12-26 01:50:42 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe74d173-fb64-4f12-b9ec-b4581cf5e1f6\states\current_state.json
2024-12-26 01:50:42 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\fe74d173-fb64-4f12-b9ec-b4581cf5e1f6\states\current_state.json
2024-12-26 01:50:42 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 01:50:42 | DEBUG    | managers.state_manager:get_current_state:242 - No current state found
2024-12-26 01:50:42 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 01:50:42 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 01:50:42 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 01:50:44 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:50:51 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:50:51 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 01:50:51 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 01:50:51 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 01:50:51 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:50:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 01:50:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 01:50:51 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 01:50:51 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 01:50:51 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:50:51 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 01:50:51 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 01:50:51 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:50:51 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 01:50:51 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 01:50:51 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 01:50:51 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 01:50:51 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 01:50:51 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 01:50:51 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 01:50:51 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 01:50:51 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 01:50:51 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 01:50:51 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 01:50:51 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 01:52:00 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 01:52:00 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 01:52:00 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 01:52:00 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 01:52:00 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 01:52:05 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:52:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:52:11 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 01:52:11 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 01:52:11 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 01:52:11 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:52:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 01:52:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 01:52:11 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 01:52:11 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 01:52:11 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:52:11 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 01:52:11 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 01:52:11 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:52:11 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 01:52:11 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 01:52:11 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 01:52:11 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 01:52:11 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 01:52:11 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 01:52:11 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 01:52:11 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 01:52:12 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 01:52:12 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 01:52:12 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 01:52:12 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 01:52:38 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 01:52:38 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 01:52:38 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 01:52:38 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 01:52:38 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 01:52:38 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 01:52:38 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: d12cbc10-3ebc-4d8c-a752-469e7b74f907
2024-12-26 01:52:38 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: d12cbc10-3ebc-4d8c-a752-469e7b74f907
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\states
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\traces
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\characters
2024-12-26 01:52:38 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: d12cbc10-3ebc-4d8c-a752-469e7b74f907
2024-12-26 01:52:38 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 01:52:38 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 01:52:38 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 01:52:38 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 01:52:38 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 01:52:38 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: 48f955e7-8856-4e57-8826-b35634354d11
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\characters\current.json
2024-12-26 01:52:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\characters\current.json
2024-12-26 01:52:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\characters\current.json
2024-12-26 01:52:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 01:52:38 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': '48f955e7-8856-4e57-8826-b35634354d11', 'last_update': '2024-12-26T01:52:38.484453', 'character_id': 'current'}
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\states\section_1.json
2024-12-26 01:52:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\states\section_1.json
2024-12-26 01:52:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\states\section_1.json
2024-12-26 01:52:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 01:52:38 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='48f955e7-8856-4e57-8826-b35634354d11' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 01:52:38 | INFO     | managers.workflow_manager:initialize_workflow:298 - Initializing workflow
2024-12-26 01:52:38 | DEBUG    | managers.workflow_manager:initialize_workflow:299 - Initial state: session_id='48f955e7-8856-4e57-8826-b35634354d11' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 01:52:38 | DEBUG    | managers.workflow_manager:initialize_workflow:302 - Saving initial state
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 01:52:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\states\section_1.json
2024-12-26 01:52:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\states\section_1.json
2024-12-26 01:52:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\states\section_1.json
2024-12-26 01:52:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 01:52:38 | INFO     | managers.workflow_manager:initialize_workflow:305 - Workflow initialization completed
2024-12-26 01:52:38 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 01:52:38 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='48f955e7-8856-4e57-8826-b35634354d11' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 01:52:38 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 01:52:38 | DEBUG    | managers.workflow_manager:execute_workflow:170 - Executing workflow
2024-12-26 01:52:38 | INFO     | managers.workflow_manager:start_workflow:206 - Starting workflow node
2024-12-26 01:52:38 | DEBUG    | managers.workflow_manager:start_workflow:207 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 01:52:38 | DEBUG    | managers.workflow_manager:start_workflow:222 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 01:52:38 | DEBUG    | managers.workflow_manager:start_workflow:234 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 01:52:38 | ERROR    | managers.workflow_manager:start_workflow:254 - Error during start_workflow: State validation failed: Missing session_id
2024-12-26 01:52:38 | ERROR    | managers.workflow_manager:execute_workflow:189 - Error executing workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 01:52:38 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 01:52:38 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 01:54:16 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 01:54:16 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 01:54:16 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 01:54:16 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 01:54:16 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 01:54:16 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 01:54:16 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\states\current_state.json
2024-12-26 01:54:16 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\states\current_state.json
2024-12-26 01:54:16 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d12cbc10-3ebc-4d8c-a752-469e7b74f907\states\current_state.json
2024-12-26 01:54:16 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 01:54:16 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 01:54:16 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 01:54:16 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 01:54:16 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 01:54:18 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:54:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:54:21 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 01:54:21 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 01:54:21 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 01:54:21 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:54:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 01:54:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 01:54:21 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 01:54:21 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 01:54:21 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:54:21 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 01:54:21 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 01:54:21 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:54:21 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 01:54:21 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 01:54:21 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 01:54:21 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 01:54:21 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 01:54:21 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 01:54:21 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 01:54:21 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 01:54:22 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 01:54:22 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 01:54:22 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 01:54:22 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 01:56:05 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 01:56:05 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 01:56:05 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 01:56:05 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 01:56:05 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 01:56:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:56:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:56:10 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 01:56:10 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 01:56:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 01:56:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:56:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 01:56:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 01:56:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 01:56:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 01:56:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:56:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 01:56:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 01:56:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:56:10 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 01:56:10 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 01:56:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 01:56:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 01:56:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 01:56:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 01:56:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 01:56:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 01:56:11 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 01:56:11 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 01:56:11 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 01:56:11 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 01:57:08 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 01:57:08 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 01:57:08 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 01:57:08 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 01:57:08 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 01:57:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:57:15 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:57:15 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 01:57:15 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 01:57:15 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 01:57:15 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:57:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 01:57:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 01:57:15 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 01:57:15 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 01:57:15 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:57:15 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 01:57:15 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 01:57:15 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:57:15 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 01:57:15 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 01:57:15 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 01:57:15 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 01:57:15 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 01:57:15 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 01:57:15 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 01:57:15 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 01:57:17 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 01:57:17 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 01:57:17 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 01:57:17 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 01:57:46 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 01:57:46 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 01:57:46 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 01:57:46 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 01:57:46 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 01:57:54 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:58:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 01:58:01 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 01:58:01 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 01:58:01 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 01:58:01 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:58:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 01:58:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 01:58:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 01:58:01 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 01:58:01 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:58:01 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 01:58:01 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 01:58:01 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 01:58:01 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 01:58:01 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 01:58:01 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 01:58:01 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 01:58:01 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 01:58:01 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 01:58:01 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 01:58:01 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 01:58:02 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 01:58:02 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 01:58:02 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 01:58:02 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:06:23 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:06:23 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:06:23 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:06:23 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 02:06:23 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:06:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:06:32 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:06:32 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:06:32 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:06:32 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:06:32 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:06:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:06:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:06:32 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:06:32 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:06:32 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:06:32 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:06:32 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:06:32 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:06:32 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:06:32 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:06:32 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:06:32 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:06:32 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:06:32 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:06:32 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:06:32 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:06:33 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:06:33 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:06:33 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:06:33 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:06:40 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:06:40 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:06:40 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:06:40 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 02:06:40 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:06:41 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:06:52 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:06:52 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:06:52 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:06:52 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:06:52 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:06:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:06:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:06:52 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:06:52 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:06:52 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:06:52 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:06:52 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:06:52 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:06:52 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:06:52 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:06:52 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:06:52 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:06:52 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:06:52 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:06:52 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:06:52 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:06:54 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:06:54 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:06:54 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:06:54 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:06:54 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:06:54 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:06:54 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:06:54 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:06:54 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:06:54 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:06:54 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: cb755183-c161-43a9-aedb-ab30f7e93e20
2024-12-26 02:06:54 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: cb755183-c161-43a9-aedb-ab30f7e93e20
2024-12-26 02:06:54 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\states
2024-12-26 02:06:54 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\traces
2024-12-26 02:06:54 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\characters
2024-12-26 02:06:54 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: cb755183-c161-43a9-aedb-ab30f7e93e20
2024-12-26 02:06:54 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:06:54 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:06:54 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:06:54 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:06:54 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:06:54 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: dd373aee-b76b-4274-b56a-b5964fdad633
2024-12-26 02:06:54 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:06:54 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:06:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:06:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\characters\current.json
2024-12-26 02:06:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\characters\current.json
2024-12-26 02:06:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\characters\current.json
2024-12-26 02:06:54 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:06:54 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'dd373aee-b76b-4274-b56a-b5964fdad633', 'last_update': '2024-12-26T02:06:54.182398', 'character_id': 'current'}
2024-12-26 02:06:54 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:06:54 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:06:54 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:06:54 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\states\section_1.json
2024-12-26 02:06:54 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\states\section_1.json
2024-12-26 02:06:54 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\states\section_1.json
2024-12-26 02:06:54 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:06:54 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='dd373aee-b76b-4274-b56a-b5964fdad633' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:06:55 | INFO     | managers.workflow_manager:initialize_workflow:299 - Initializing workflow
2024-12-26 02:06:55 | DEBUG    | managers.workflow_manager:initialize_workflow:300 - Initial state: session_id='dd373aee-b76b-4274-b56a-b5964fdad633' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:06:55 | DEBUG    | managers.workflow_manager:initialize_workflow:303 - Saving initial state
2024-12-26 02:06:55 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:06:55 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:06:55 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:06:55 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\states\section_1.json
2024-12-26 02:06:55 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\states\section_1.json
2024-12-26 02:06:55 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\states\section_1.json
2024-12-26 02:06:55 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:06:55 | INFO     | managers.workflow_manager:initialize_workflow:306 - Workflow initialization completed
2024-12-26 02:06:55 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:06:55 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='dd373aee-b76b-4274-b56a-b5964fdad633' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 02:06:55 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:06:55 | DEBUG    | managers.workflow_manager:execute_workflow:171 - Executing workflow
2024-12-26 02:06:55 | INFO     | managers.workflow_manager:start_workflow:207 - Starting workflow node
2024-12-26 02:06:55 | DEBUG    | managers.workflow_manager:start_workflow:208 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:06:55 | DEBUG    | managers.workflow_manager:start_workflow:223 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:06:55 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:06:55 | ERROR    | managers.workflow_manager:start_workflow:255 - Error during start_workflow: State validation failed: Missing session_id
2024-12-26 02:06:55 | ERROR    | managers.workflow_manager:execute_workflow:190 - Error executing workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:06:55 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:06:55 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:07:18 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:07:18 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:07:18 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:07:18 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 02:07:18 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 02:07:18 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 02:07:18 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\states\current_state.json
2024-12-26 02:07:18 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\states\current_state.json
2024-12-26 02:07:18 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cb755183-c161-43a9-aedb-ab30f7e93e20\states\current_state.json
2024-12-26 02:07:18 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:07:18 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 02:07:18 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 02:07:18 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 02:07:18 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:07:24 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:07:30 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-26 02:07:30 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-26 02:07:30 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-26 02:07:30 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-26 02:07:30 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-26 02:07:30 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-26 02:07:30 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-26 02:07:30 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:07:33 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:07:33 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:07:33 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:07:33 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:07:33 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:07:33 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:07:33 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:07:33 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:07:33 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:07:33 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:07:33 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:07:33 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:07:33 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:07:33 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:07:33 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:07:33 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:07:33 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:07:33 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:07:33 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:07:33 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:07:33 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:07:33 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:07:33 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:07:33 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:07:33 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:08:07 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:08:07 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:08:07 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:08:07 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:08:07 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:08:07 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:08:07 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e
2024-12-26 02:08:07 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\states
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\traces
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\characters
2024-12-26 02:08:07 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e
2024-12-26 02:08:07 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:08:07 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:08:07 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:08:07 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:08:07 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:08:07 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: c07ec59c-bfa6-4baf-a762-417f709f33f0
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\characters\current.json
2024-12-26 02:08:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\characters\current.json
2024-12-26 02:08:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\characters\current.json
2024-12-26 02:08:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:08:07 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'c07ec59c-bfa6-4baf-a762-417f709f33f0', 'last_update': '2024-12-26T02:08:07.831885', 'character_id': 'current'}
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\states\section_1.json
2024-12-26 02:08:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\states\section_1.json
2024-12-26 02:08:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\states\section_1.json
2024-12-26 02:08:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:08:07 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='c07ec59c-bfa6-4baf-a762-417f709f33f0' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:08:07 | INFO     | managers.workflow_manager:initialize_workflow:299 - Initializing workflow
2024-12-26 02:08:07 | DEBUG    | managers.workflow_manager:initialize_workflow:300 - Initial state: session_id='c07ec59c-bfa6-4baf-a762-417f709f33f0' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:08:07 | DEBUG    | managers.workflow_manager:initialize_workflow:303 - Saving initial state
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:08:07 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\states\section_1.json
2024-12-26 02:08:07 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\states\section_1.json
2024-12-26 02:08:07 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\states\section_1.json
2024-12-26 02:08:07 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:08:07 | INFO     | managers.workflow_manager:initialize_workflow:306 - Workflow initialization completed
2024-12-26 02:08:07 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:08:07 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='c07ec59c-bfa6-4baf-a762-417f709f33f0' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 02:08:07 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:08:07 | DEBUG    | managers.workflow_manager:execute_workflow:171 - Executing workflow
2024-12-26 02:08:07 | INFO     | managers.workflow_manager:start_workflow:207 - Starting workflow node
2024-12-26 02:08:07 | DEBUG    | managers.workflow_manager:start_workflow:208 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:08:07 | DEBUG    | managers.workflow_manager:start_workflow:223 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:08:07 | DEBUG    | managers.workflow_manager:start_workflow:235 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:08:07 | ERROR    | managers.workflow_manager:start_workflow:255 - Error during start_workflow: State validation failed: Missing session_id
2024-12-26 02:08:07 | ERROR    | managers.workflow_manager:execute_workflow:190 - Error executing workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:08:07 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:08:07 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:22:53 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:22:53 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:22:53 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:22:53 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 02:22:53 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 02:22:53 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 02:22:53 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\states\current_state.json
2024-12-26 02:22:53 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\states\current_state.json
2024-12-26 02:22:53 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\a0ce1957-e6f9-4a4f-a0eb-ed7e8660491e\states\current_state.json
2024-12-26 02:22:53 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:22:53 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 02:22:53 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 02:22:53 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 02:22:53 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:22:55 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:23:01 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:23:01 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:23:01 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:23:01 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:23:01 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:23:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:23:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:23:01 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:23:01 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:23:01 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:23:01 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:23:01 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:23:01 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:23:01 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:23:01 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:23:01 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:23:01 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:23:01 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:23:01 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:23:01 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:23:01 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:23:01 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:23:01 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:23:01 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:23:01 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:23:05 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:23:05 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:23:05 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:23:05 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 02:23:05 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:23:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:23:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:23:10 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:23:10 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:23:10 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:23:10 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:23:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:23:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:23:10 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:23:10 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:23:10 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:23:10 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:23:10 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:23:10 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:23:10 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:23:10 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:23:10 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:23:10 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:23:10 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:23:10 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:23:10 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:23:10 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:23:10 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:23:10 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:23:11 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:23:11 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:26:40 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:26:40 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:26:40 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:26:41 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 02:26:41 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:26:43 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:26:47 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:26:47 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:26:47 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:26:47 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:26:47 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:26:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:26:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:26:47 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:26:47 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:26:47 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:26:47 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:26:47 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:26:47 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:26:47 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:26:47 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:26:47 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:26:47 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:26:47 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:26:47 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:26:47 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:26:47 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:26:48 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:26:48 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:26:48 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:26:48 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:26:55 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:26:55 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:26:55 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:26:55 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 02:26:55 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:26:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:26:59 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:26:59 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:26:59 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:26:59 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:26:59 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:26:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:26:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:26:59 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:26:59 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:26:59 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:26:59 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:26:59 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:26:59 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:26:59 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:26:59 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:26:59 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:26:59 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:26:59 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:26:59 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:26:59 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:26:59 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:26:59 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:26:59 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:26:59 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:26:59 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:27:50 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:27:50 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:27:50 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:27:50 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:27:50 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:27:50 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:27:50 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: d70f1c70-01ef-40bb-a719-192522702c66
2024-12-26 02:27:50 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: d70f1c70-01ef-40bb-a719-192522702c66
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\states
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\traces
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\characters
2024-12-26 02:27:50 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: d70f1c70-01ef-40bb-a719-192522702c66
2024-12-26 02:27:50 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:27:50 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:27:50 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:27:50 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:27:50 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:27:50 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: 95106416-0314-4ec1-8a59-23979c35bbdd
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\characters\current.json
2024-12-26 02:27:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\characters\current.json
2024-12-26 02:27:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\characters\current.json
2024-12-26 02:27:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:27:50 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': '95106416-0314-4ec1-8a59-23979c35bbdd', 'last_update': '2024-12-26T02:27:50.410053', 'character_id': 'current'}
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\states\section_1.json
2024-12-26 02:27:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\states\section_1.json
2024-12-26 02:27:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\states\section_1.json
2024-12-26 02:27:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:27:50 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='95106416-0314-4ec1-8a59-23979c35bbdd' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:27:50 | INFO     | managers.workflow_manager:initialize_workflow:297 - Initializing workflow
2024-12-26 02:27:50 | DEBUG    | managers.workflow_manager:initialize_workflow:298 - Initial state: session_id='95106416-0314-4ec1-8a59-23979c35bbdd' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:27:50 | DEBUG    | managers.workflow_manager:initialize_workflow:301 - Saving initial state
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:27:50 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\states\section_1.json
2024-12-26 02:27:50 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\states\section_1.json
2024-12-26 02:27:50 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\states\section_1.json
2024-12-26 02:27:50 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:27:50 | INFO     | managers.workflow_manager:initialize_workflow:304 - Workflow initialization completed
2024-12-26 02:27:50 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:27:50 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='95106416-0314-4ec1-8a59-23979c35bbdd' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 02:27:50 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:27:50 | DEBUG    | managers.workflow_manager:execute_workflow:169 - Executing workflow
2024-12-26 02:27:50 | INFO     | managers.workflow_manager:start_workflow:205 - Starting workflow node
2024-12-26 02:27:50 | DEBUG    | managers.workflow_manager:start_workflow:206 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:27:50 | DEBUG    | managers.workflow_manager:start_workflow:221 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:27:50 | DEBUG    | managers.workflow_manager:start_workflow:233 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:27:50 | ERROR    | managers.workflow_manager:start_workflow:253 - Error during start_workflow: State validation failed: Missing session_id
2024-12-26 02:27:50 | ERROR    | managers.workflow_manager:execute_workflow:188 - Error executing workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:27:50 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:27:50 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:28:00 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:28:00 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:28:00 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:28:00 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 02:28:00 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 02:28:00 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 02:28:00 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\states\current_state.json
2024-12-26 02:28:00 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\states\current_state.json
2024-12-26 02:28:00 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d70f1c70-01ef-40bb-a719-192522702c66\states\current_state.json
2024-12-26 02:28:00 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:28:00 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 02:28:00 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 02:28:00 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 02:28:00 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:28:07 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:28:10 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-26 02:28:10 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-26 02:28:10 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-26 02:28:10 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-26 02:28:10 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-26 02:28:10 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-26 02:28:10 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-26 02:28:10 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:28:13 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:28:13 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:28:13 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:28:13 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:28:13 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:28:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:28:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:28:13 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:28:13 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:28:13 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:28:13 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:28:13 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:28:13 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:28:13 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:28:13 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:28:13 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:28:13 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:28:13 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:28:13 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:28:13 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:28:13 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:28:14 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:28:14 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:28:14 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:28:14 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:28:38 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:28:38 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:28:38 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:28:38 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:28:38 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:28:38 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:28:38 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: 1ccebba4-d512-4f05-9694-532f97cb271d
2024-12-26 02:28:38 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 1ccebba4-d512-4f05-9694-532f97cb271d
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\states
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\traces
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\characters
2024-12-26 02:28:38 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: 1ccebba4-d512-4f05-9694-532f97cb271d
2024-12-26 02:28:38 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:28:38 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:28:38 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:28:38 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:28:38 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:28:38 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: fd13c2fa-3bbd-4c22-adb9-e68a01789855
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\characters\current.json
2024-12-26 02:28:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\characters\current.json
2024-12-26 02:28:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\characters\current.json
2024-12-26 02:28:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:28:38 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'fd13c2fa-3bbd-4c22-adb9-e68a01789855', 'last_update': '2024-12-26T02:28:38.337485', 'character_id': 'current'}
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\states\section_1.json
2024-12-26 02:28:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\states\section_1.json
2024-12-26 02:28:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\states\section_1.json
2024-12-26 02:28:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:28:38 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='fd13c2fa-3bbd-4c22-adb9-e68a01789855' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:28:38 | INFO     | managers.workflow_manager:initialize_workflow:297 - Initializing workflow
2024-12-26 02:28:38 | DEBUG    | managers.workflow_manager:initialize_workflow:298 - Initial state: session_id='fd13c2fa-3bbd-4c22-adb9-e68a01789855' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:28:38 | DEBUG    | managers.workflow_manager:initialize_workflow:301 - Saving initial state
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:28:38 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\states\section_1.json
2024-12-26 02:28:38 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\states\section_1.json
2024-12-26 02:28:38 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\states\section_1.json
2024-12-26 02:28:38 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:28:38 | INFO     | managers.workflow_manager:initialize_workflow:304 - Workflow initialization completed
2024-12-26 02:28:38 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:28:38 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='fd13c2fa-3bbd-4c22-adb9-e68a01789855' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 02:28:38 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:28:38 | DEBUG    | managers.workflow_manager:execute_workflow:169 - Executing workflow
2024-12-26 02:28:38 | INFO     | managers.workflow_manager:start_workflow:205 - Starting workflow node
2024-12-26 02:28:38 | DEBUG    | managers.workflow_manager:start_workflow:206 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:28:38 | DEBUG    | managers.workflow_manager:start_workflow:221 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:28:38 | DEBUG    | managers.workflow_manager:start_workflow:233 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:28:38 | ERROR    | managers.workflow_manager:start_workflow:253 - Error during start_workflow: State validation failed: Missing session_id
2024-12-26 02:28:38 | ERROR    | managers.workflow_manager:execute_workflow:188 - Error executing workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:28:38 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:28:38 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:30:27 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:30:27 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:30:27 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:30:27 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 02:30:27 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 02:30:27 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 02:30:27 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\states\current_state.json
2024-12-26 02:30:27 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\states\current_state.json
2024-12-26 02:30:27 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1ccebba4-d512-4f05-9694-532f97cb271d\states\current_state.json
2024-12-26 02:30:27 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:30:27 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 02:30:27 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 02:30:27 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 02:30:27 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:30:29 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:30:34 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:30:34 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:30:34 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:30:34 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:30:34 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:30:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:30:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:30:34 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:30:34 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:30:34 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:30:34 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:30:34 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:30:34 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:30:34 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:30:34 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:30:34 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:30:34 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:30:34 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:30:34 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:30:34 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:30:34 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:30:34 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:30:34 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:30:34 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:30:34 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:32:32 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:32:32 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:32:32 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:32:32 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 02:32:32 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:32:34 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:32:38 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:32:38 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:32:38 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:32:38 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:32:38 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:32:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:32:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:32:38 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:32:38 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:32:38 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:32:38 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:32:38 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:32:38 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:32:38 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:32:38 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:32:38 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:32:38 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:32:38 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:32:38 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:32:38 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:32:38 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:32:40 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:32:40 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:32:40 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:32:40 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:33:12 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:33:12 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:33:12 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:33:12 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:33:12 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:33:12 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:33:12 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: 1786ba87-735e-4e71-8e74-00032aa20866
2024-12-26 02:33:12 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 1786ba87-735e-4e71-8e74-00032aa20866
2024-12-26 02:33:12 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\states
2024-12-26 02:33:12 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\traces
2024-12-26 02:33:12 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\characters
2024-12-26 02:33:12 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: 1786ba87-735e-4e71-8e74-00032aa20866
2024-12-26 02:33:12 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:33:12 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:33:12 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:33:12 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:33:13 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:33:13 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: b0a86568-d213-4097-b5e6-718a53ace034
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\characters\current.json
2024-12-26 02:33:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\characters\current.json
2024-12-26 02:33:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\characters\current.json
2024-12-26 02:33:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:33:13 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'b0a86568-d213-4097-b5e6-718a53ace034', 'last_update': '2024-12-26T02:33:13.056127', 'character_id': 'current'}
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\states\section_1.json
2024-12-26 02:33:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\states\section_1.json
2024-12-26 02:33:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\states\section_1.json
2024-12-26 02:33:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:33:13 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='b0a86568-d213-4097-b5e6-718a53ace034' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:33:13 | INFO     | managers.workflow_manager:initialize_workflow:292 - Initializing workflow
2024-12-26 02:33:13 | DEBUG    | managers.workflow_manager:initialize_workflow:293 - Initial state: session_id='b0a86568-d213-4097-b5e6-718a53ace034' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:33:13 | DEBUG    | managers.workflow_manager:initialize_workflow:296 - Saving initial state
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:33:13 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\states\section_1.json
2024-12-26 02:33:13 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\states\section_1.json
2024-12-26 02:33:13 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\1786ba87-735e-4e71-8e74-00032aa20866\states\section_1.json
2024-12-26 02:33:13 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:33:13 | INFO     | managers.workflow_manager:initialize_workflow:299 - Workflow initialization completed
2024-12-26 02:33:13 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:33:13 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='b0a86568-d213-4097-b5e6-718a53ace034' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 02:33:13 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:33:13 | DEBUG    | managers.workflow_manager:execute_workflow:169 - Executing workflow
2024-12-26 02:33:13 | INFO     | managers.workflow_manager:start_workflow:200 - Starting workflow node
2024-12-26 02:33:13 | DEBUG    | managers.workflow_manager:start_workflow:201 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:33:13 | DEBUG    | managers.workflow_manager:start_workflow:216 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:33:13 | DEBUG    | managers.workflow_manager:start_workflow:228 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:33:13 | ERROR    | managers.workflow_manager:start_workflow:248 - Error during start_workflow: State validation failed: Missing session_id
2024-12-26 02:33:13 | ERROR    | managers.workflow_manager:execute_workflow:183 - Error executing workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:33:13 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:33:13 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:34:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:34:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:34:16 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:34:16 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:34:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:34:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:34:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:34:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:34:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:34:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:34:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:34:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:34:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:34:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:34:16 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:34:16 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:34:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:34:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:34:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:34:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:34:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:34:16 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:34:17 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:34:17 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:34:17 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:34:17 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:34:19 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:34:19 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:34:19 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:34:19 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:34:19 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:34:19 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:34:19 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: d11cd82e-8949-4a1d-b4db-312e9db570fe
2024-12-26 02:34:19 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: d11cd82e-8949-4a1d-b4db-312e9db570fe
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\states
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\traces
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\characters
2024-12-26 02:34:19 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: d11cd82e-8949-4a1d-b4db-312e9db570fe
2024-12-26 02:34:19 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:34:19 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:34:19 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:34:19 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:34:19 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:34:19 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: ca1880b1-7e4e-4b51-9cab-e4065a8dae01
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\characters\current.json
2024-12-26 02:34:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\characters\current.json
2024-12-26 02:34:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\characters\current.json
2024-12-26 02:34:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:34:19 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ca1880b1-7e4e-4b51-9cab-e4065a8dae01', 'last_update': '2024-12-26T02:34:19.648624', 'character_id': 'current'}
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\states\section_1.json
2024-12-26 02:34:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\states\section_1.json
2024-12-26 02:34:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\states\section_1.json
2024-12-26 02:34:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:34:19 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='ca1880b1-7e4e-4b51-9cab-e4065a8dae01' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:34:19 | INFO     | managers.workflow_manager:initialize_workflow:288 - Initializing workflow
2024-12-26 02:34:19 | DEBUG    | managers.workflow_manager:initialize_workflow:289 - Initial state: session_id='ca1880b1-7e4e-4b51-9cab-e4065a8dae01' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:34:19 | DEBUG    | managers.workflow_manager:initialize_workflow:292 - Saving initial state
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:34:19 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\states\section_1.json
2024-12-26 02:34:19 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\states\section_1.json
2024-12-26 02:34:19 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\states\section_1.json
2024-12-26 02:34:19 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:34:19 | INFO     | managers.workflow_manager:initialize_workflow:295 - Workflow initialization completed
2024-12-26 02:34:19 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:34:19 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='ca1880b1-7e4e-4b51-9cab-e4065a8dae01' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 02:34:19 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:34:19 | DEBUG    | managers.workflow_manager:execute_workflow:169 - Executing workflow
2024-12-26 02:34:19 | INFO     | managers.workflow_manager:start_workflow:200 - Starting workflow node
2024-12-26 02:34:19 | DEBUG    | managers.workflow_manager:start_workflow:201 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:34:19 | DEBUG    | managers.workflow_manager:start_workflow:216 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:34:19 | DEBUG    | managers.workflow_manager:start_workflow:228 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:34:19 | ERROR    | managers.workflow_manager:start_workflow:244 - Error during start_workflow: State validation failed: Missing session_id
2024-12-26 02:34:19 | ERROR    | managers.workflow_manager:execute_workflow:183 - Error executing workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:34:19 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:34:19 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:34:25 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:34:25 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:34:25 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:34:25 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 02:34:25 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 02:34:25 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 02:34:25 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\states\current_state.json
2024-12-26 02:34:25 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\states\current_state.json
2024-12-26 02:34:25 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\d11cd82e-8949-4a1d-b4db-312e9db570fe\states\current_state.json
2024-12-26 02:34:25 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:34:25 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 02:34:25 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 02:34:25 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 02:34:25 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:35:38 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:35:40 | DEBUG    | __main__:<module>:28 - Loading .env from: C:\Users\erpes\Desktop\casys-rpg\.env
2024-12-26 02:35:40 | DEBUG    | config.logging_config:log_env_variables:80 - Environment variables:
2024-12-26 02:35:40 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_HOST: None
2024-12-26 02:35:40 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_PORT: 8000
2024-12-26 02:35:40 | DEBUG    | config.logging_config:log_env_variables:83 - CASYS_RELOAD: None
2024-12-26 02:35:40 | DEBUG    | config.logging_config:log_env_variables:83 - LOG_LEVEL: DEBUG
2024-12-26 02:35:40 | INFO     | __main__:<module>:39 - Démarrage du serveur sur 127.0.0.1:8000
2024-12-26 02:35:40 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:35:42 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:35:42 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:35:42 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:35:42 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:35:42 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:35:42 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:35:42 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:35:42 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:35:42 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:35:42 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:35:42 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:35:42 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:35:42 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:35:42 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:35:42 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:35:42 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:35:42 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:35:42 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:35:42 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:35:42 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:35:42 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:35:43 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:35:43 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:35:43 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:35:43 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:35:46 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:35:46 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:35:46 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:35:46 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:35:46 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:35:46 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:35:46 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: bc14dc40-c2fd-4f91-ae60-0a079a89e7b5
2024-12-26 02:35:46 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: bc14dc40-c2fd-4f91-ae60-0a079a89e7b5
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\states
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\traces
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\characters
2024-12-26 02:35:46 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: bc14dc40-c2fd-4f91-ae60-0a079a89e7b5
2024-12-26 02:35:46 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:35:46 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:35:46 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:35:46 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:35:46 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:35:46 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: deff1451-0809-4292-83d6-f20e7526afde
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\characters\current.json
2024-12-26 02:35:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\characters\current.json
2024-12-26 02:35:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\characters\current.json
2024-12-26 02:35:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:35:46 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'deff1451-0809-4292-83d6-f20e7526afde', 'last_update': '2024-12-26T02:35:46.170658', 'character_id': 'current'}
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\states\section_1.json
2024-12-26 02:35:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\states\section_1.json
2024-12-26 02:35:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\states\section_1.json
2024-12-26 02:35:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:35:46 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='deff1451-0809-4292-83d6-f20e7526afde' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:35:46 | INFO     | managers.workflow_manager:initialize_workflow:296 - Initializing workflow
2024-12-26 02:35:46 | DEBUG    | managers.workflow_manager:initialize_workflow:297 - Initial state: session_id='deff1451-0809-4292-83d6-f20e7526afde' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:35:46 | DEBUG    | managers.workflow_manager:initialize_workflow:300 - Saving initial state
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:35:46 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\states\section_1.json
2024-12-26 02:35:46 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\states\section_1.json
2024-12-26 02:35:46 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\states\section_1.json
2024-12-26 02:35:46 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:35:46 | INFO     | managers.workflow_manager:initialize_workflow:303 - Workflow initialization completed
2024-12-26 02:35:46 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:35:46 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='deff1451-0809-4292-83d6-f20e7526afde' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 02:35:46 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:35:46 | DEBUG    | managers.workflow_manager:execute_workflow:169 - Executing workflow
2024-12-26 02:35:46 | ERROR    | managers.workflow_manager:execute_workflow:191 - Error executing workflow: 1 validation error for GameState
section_number
  Input should be greater than or equal to 1 [type=greater_than_equal, input_value=0, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/greater_than_equal
2024-12-26 02:35:46 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: 1 validation error for GameState
section_number
  Input should be greater than or equal to 1 [type=greater_than_equal, input_value=0, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/greater_than_equal
2024-12-26 02:35:46 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: 1 validation error for GameState
section_number
  Input should be greater than or equal to 1 [type=greater_than_equal, input_value=0, input_type=int]
    For further information visit https://errors.pydantic.dev/2.10/v/greater_than_equal
2024-12-26 02:41:59 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:41:59 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:41:59 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:41:59 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 02:41:59 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 02:41:59 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 02:41:59 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\states\current_state.json
2024-12-26 02:41:59 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\states\current_state.json
2024-12-26 02:41:59 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\bc14dc40-c2fd-4f91-ae60-0a079a89e7b5\states\current_state.json
2024-12-26 02:41:59 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:41:59 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 02:41:59 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 02:41:59 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 02:41:59 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:42:02 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:42:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:42:09 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:42:09 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:42:09 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:42:09 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:42:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:42:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:42:09 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:42:09 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:42:09 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:42:09 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:42:09 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:42:09 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:42:09 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:42:09 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:42:09 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:42:09 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:42:09 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:42:09 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:42:09 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:42:09 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:42:11 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:42:11 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:42:11 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:42:11 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:42:11 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:42:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:42:14 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:42:14 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:42:14 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:42:14 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:42:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:42:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:42:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:42:14 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:42:14 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:42:14 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:42:14 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:42:14 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:42:14 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:42:14 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:42:14 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:42:14 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:42:14 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:42:14 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:42:14 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:42:14 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:42:16 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:42:16 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:42:16 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:42:16 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:42:26 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:42:26 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:42:26 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:42:26 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 02:42:26 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:42:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:42:35 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:42:35 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:42:35 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:42:35 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:42:35 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:42:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:42:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:42:35 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:42:35 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:42:35 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:42:35 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:42:35 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:42:35 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:42:35 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:42:35 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:42:35 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:42:35 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:42:35 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:42:35 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:42:35 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:42:35 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:42:37 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:42:37 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:42:37 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:42:37 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:42:41 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:42:41 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:42:41 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:42:41 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:42:41 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:42:41 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:42:41 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: cf8aaa71-5229-4be6-a6ac-75d589d5166c
2024-12-26 02:42:41 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: cf8aaa71-5229-4be6-a6ac-75d589d5166c
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\states
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\traces
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\characters
2024-12-26 02:42:41 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: cf8aaa71-5229-4be6-a6ac-75d589d5166c
2024-12-26 02:42:41 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:42:41 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:42:41 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:42:41 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:42:41 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:42:41 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: d4d68e21-3a74-4555-9014-8345798ab27a
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\characters\current.json
2024-12-26 02:42:41 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\characters\current.json
2024-12-26 02:42:41 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\characters\current.json
2024-12-26 02:42:41 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:42:41 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd4d68e21-3a74-4555-9014-8345798ab27a', 'last_update': '2024-12-26T02:42:41.848304', 'character_id': 'current'}
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\states\section_1.json
2024-12-26 02:42:41 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\states\section_1.json
2024-12-26 02:42:41 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\states\section_1.json
2024-12-26 02:42:41 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:42:41 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='d4d68e21-3a74-4555-9014-8345798ab27a' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:42:41 | INFO     | managers.workflow_manager:initialize_workflow:290 - Initializing workflow
2024-12-26 02:42:41 | DEBUG    | managers.workflow_manager:initialize_workflow:291 - Initial state: session_id='d4d68e21-3a74-4555-9014-8345798ab27a' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:42:41 | DEBUG    | managers.workflow_manager:initialize_workflow:294 - Saving initial state
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:42:41 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\states\section_1.json
2024-12-26 02:42:41 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\states\section_1.json
2024-12-26 02:42:41 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\states\section_1.json
2024-12-26 02:42:41 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:42:41 | INFO     | managers.workflow_manager:initialize_workflow:297 - Workflow initialization completed
2024-12-26 02:42:41 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:42:41 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='d4d68e21-3a74-4555-9014-8345798ab27a' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 02:42:41 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:42:41 | DEBUG    | managers.workflow_manager:execute_workflow:169 - Executing workflow
2024-12-26 02:42:41 | INFO     | managers.workflow_manager:start_workflow:201 - Starting workflow node
2024-12-26 02:42:41 | DEBUG    | managers.workflow_manager:start_workflow:202 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:42:41 | DEBUG    | managers.workflow_manager:start_workflow:217 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:42:41 | DEBUG    | managers.workflow_manager:start_workflow:229 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:42:41 | ERROR    | managers.workflow_manager:start_workflow:246 - Error during start_workflow: State validation failed: Missing session_id
2024-12-26 02:42:41 | ERROR    | managers.workflow_manager:execute_workflow:184 - Error executing workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:42:41 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:42:41 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:43:26 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:43:26 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:43:26 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:43:26 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 02:43:26 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 02:43:26 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 02:43:26 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\states\current_state.json
2024-12-26 02:43:26 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\states\current_state.json
2024-12-26 02:43:26 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\cf8aaa71-5229-4be6-a6ac-75d589d5166c\states\current_state.json
2024-12-26 02:43:26 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:43:26 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 02:43:26 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 02:43:26 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 02:43:26 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:43:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:43:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:43:31 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:43:31 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:43:31 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:43:31 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:43:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:43:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:43:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:43:31 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:43:31 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:43:31 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:43:31 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:43:31 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:43:31 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:43:31 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:43:31 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:43:31 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:43:31 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:43:31 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:43:31 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:43:31 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:43:31 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:43:31 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:43:31 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:43:31 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:43:33 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:43:33 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:43:33 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:43:33 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:43:33 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:43:33 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:43:33 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: 2fa0374f-78ea-4e0c-9e0a-66467947b2b0
2024-12-26 02:43:33 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 2fa0374f-78ea-4e0c-9e0a-66467947b2b0
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\states
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\traces
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\characters
2024-12-26 02:43:33 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: 2fa0374f-78ea-4e0c-9e0a-66467947b2b0
2024-12-26 02:43:33 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:43:33 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:43:33 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:43:33 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:43:33 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:43:33 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: 45e5f88c-a21f-4ddf-a54a-ef6829e4feec
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\characters\current.json
2024-12-26 02:43:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\characters\current.json
2024-12-26 02:43:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\characters\current.json
2024-12-26 02:43:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:43:33 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': '45e5f88c-a21f-4ddf-a54a-ef6829e4feec', 'last_update': '2024-12-26T02:43:33.043479', 'character_id': 'current'}
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\states\section_1.json
2024-12-26 02:43:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\states\section_1.json
2024-12-26 02:43:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\states\section_1.json
2024-12-26 02:43:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:43:33 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='45e5f88c-a21f-4ddf-a54a-ef6829e4feec' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:43:33 | INFO     | managers.workflow_manager:initialize_workflow:290 - Initializing workflow
2024-12-26 02:43:33 | DEBUG    | managers.workflow_manager:initialize_workflow:291 - Initial state: session_id='45e5f88c-a21f-4ddf-a54a-ef6829e4feec' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:43:33 | DEBUG    | managers.workflow_manager:initialize_workflow:294 - Saving initial state
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:43:33 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\states\section_1.json
2024-12-26 02:43:33 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\states\section_1.json
2024-12-26 02:43:33 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\states\section_1.json
2024-12-26 02:43:33 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:43:33 | INFO     | managers.workflow_manager:initialize_workflow:297 - Workflow initialization completed
2024-12-26 02:43:33 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:43:33 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='45e5f88c-a21f-4ddf-a54a-ef6829e4feec' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 02:43:33 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:43:33 | DEBUG    | managers.workflow_manager:execute_workflow:169 - Executing workflow
2024-12-26 02:43:33 | INFO     | managers.workflow_manager:start_workflow:201 - Starting workflow node
2024-12-26 02:43:33 | DEBUG    | managers.workflow_manager:start_workflow:202 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:43:33 | DEBUG    | managers.workflow_manager:start_workflow:217 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:43:33 | DEBUG    | managers.workflow_manager:start_workflow:229 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:43:33 | ERROR    | managers.workflow_manager:start_workflow:246 - Error during start_workflow: State validation failed: Missing session_id
2024-12-26 02:43:33 | ERROR    | managers.workflow_manager:execute_workflow:184 - Error executing workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:43:33 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:43:33 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:43:54 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:43:54 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:43:54 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:43:54 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 02:43:54 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 02:43:54 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 02:43:54 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\states\current_state.json
2024-12-26 02:43:54 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\states\current_state.json
2024-12-26 02:43:54 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\2fa0374f-78ea-4e0c-9e0a-66467947b2b0\states\current_state.json
2024-12-26 02:43:54 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:43:54 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 02:43:54 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 02:43:54 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 02:43:54 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:43:56 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:44:06 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:44:06 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:44:06 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:44:06 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:44:06 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:44:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:44:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:44:06 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:44:06 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:44:06 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:44:06 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:44:06 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:44:06 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:44:06 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:44:06 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:44:06 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:44:06 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:44:06 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:44:06 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:44:06 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:44:06 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:44:08 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:44:08 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:44:08 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:44:08 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:45:26 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:45:26 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:45:26 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:45:26 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 02:45:26 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:45:28 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:45:31 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:45:31 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:45:31 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:45:31 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:45:31 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:45:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:45:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:45:31 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:45:31 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:45:31 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:45:31 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:45:31 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:45:31 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:45:31 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:45:31 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:45:31 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:45:31 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:45:31 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:45:31 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:45:31 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:45:31 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:45:31 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:45:31 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:45:31 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:45:31 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:45:44 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:45:44 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:45:44 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:45:44 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:45:44 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:45:44 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:45:44 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: 6cb94882-f328-4588-81ea-e2cbcdaa091d
2024-12-26 02:45:44 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: 6cb94882-f328-4588-81ea-e2cbcdaa091d
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\states
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\traces
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\characters
2024-12-26 02:45:44 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: 6cb94882-f328-4588-81ea-e2cbcdaa091d
2024-12-26 02:45:44 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:45:44 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:45:44 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:45:44 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:45:44 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:45:44 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: a3e441da-7319-4f53-9ee2-eb6046562572
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\characters\current.json
2024-12-26 02:45:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\characters\current.json
2024-12-26 02:45:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\characters\current.json
2024-12-26 02:45:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:45:44 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'a3e441da-7319-4f53-9ee2-eb6046562572', 'last_update': '2024-12-26T02:45:44.960794', 'character_id': 'current'}
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\states\section_1.json
2024-12-26 02:45:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\states\section_1.json
2024-12-26 02:45:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\states\section_1.json
2024-12-26 02:45:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:45:44 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='a3e441da-7319-4f53-9ee2-eb6046562572' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:45:44 | INFO     | managers.workflow_manager:initialize_workflow:290 - Initializing workflow
2024-12-26 02:45:44 | DEBUG    | managers.workflow_manager:initialize_workflow:291 - Initial state: session_id='a3e441da-7319-4f53-9ee2-eb6046562572' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:45:44 | DEBUG    | managers.workflow_manager:initialize_workflow:294 - Saving initial state
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:45:44 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\states\section_1.json
2024-12-26 02:45:44 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\states\section_1.json
2024-12-26 02:45:44 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\states\section_1.json
2024-12-26 02:45:44 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:45:44 | INFO     | managers.workflow_manager:initialize_workflow:297 - Workflow initialization completed
2024-12-26 02:45:44 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:45:44 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='a3e441da-7319-4f53-9ee2-eb6046562572' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 02:45:44 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:45:44 | DEBUG    | managers.workflow_manager:execute_workflow:169 - Executing workflow
2024-12-26 02:45:44 | INFO     | managers.workflow_manager:start_workflow:201 - Starting workflow node
2024-12-26 02:45:44 | DEBUG    | managers.workflow_manager:start_workflow:202 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:45:44 | DEBUG    | managers.workflow_manager:start_workflow:217 - Extracted state from input_data: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:45:44 | DEBUG    | managers.workflow_manager:start_workflow:229 - Using existing state: {'session_id': '', 'narrative': None, 'rules': None, 'trace': None, 'character': None, 'dice_roll': None, 'decision': None, 'error': None, 'narrative_content': None, 'current_rules': None, 'current_decision': None, 'section_number': 1, 'player_input': None, 'content': None, 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:45:44 | ERROR    | managers.workflow_manager:start_workflow:246 - Error during start_workflow: State validation failed: Missing session_id
2024-12-26 02:45:44 | ERROR    | managers.workflow_manager:execute_workflow:184 - Error executing workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:45:44 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:45:44 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: Failed to start workflow: State validation failed: Missing session_id
2024-12-26 02:46:19 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:46:19 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:46:19 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:46:19 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 02:46:19 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 02:46:19 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 02:46:19 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\states\current_state.json
2024-12-26 02:46:19 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\states\current_state.json
2024-12-26 02:46:19 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\6cb94882-f328-4588-81ea-e2cbcdaa091d\states\current_state.json
2024-12-26 02:46:19 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:46:19 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 02:46:19 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 02:46:19 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 02:46:19 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:46:21 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:46:27 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:46:27 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:46:27 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:46:27 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:46:27 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:46:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:46:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:46:27 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:46:27 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:46:27 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:46:27 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:46:27 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:46:27 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:46:27 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:46:27 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:46:27 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:46:27 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:46:27 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:46:27 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:46:27 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:46:27 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:46:28 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:46:28 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:46:28 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:46:28 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:47:08 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:47:08 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:47:08 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:47:08 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 02:47:08 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:47:09 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:47:14 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:47:14 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:47:14 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:47:14 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:47:14 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:47:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:47:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:47:14 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:47:14 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:47:14 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:47:14 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:47:14 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:47:14 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:47:14 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:47:14 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:47:14 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:47:14 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:47:14 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:47:14 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:47:14 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:47:14 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:47:15 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:47:15 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:47:15 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:47:15 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:47:15 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:47:15 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:47:15 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:47:15 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:47:15 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:47:15 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:47:15 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: e103d9d6-8095-49a3-bf6d-26768e68b9e5
2024-12-26 02:47:15 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: e103d9d6-8095-49a3-bf6d-26768e68b9e5
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\traces
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\characters
2024-12-26 02:47:15 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: e103d9d6-8095-49a3-bf6d-26768e68b9e5
2024-12-26 02:47:15 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:47:15 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:47:15 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:47:15 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:47:15 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:47:15 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: 7dcd846f-a41a-4b8c-99d9-d1f65860d4a3
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\characters\current.json
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\characters\current.json
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\characters\current.json
2024-12-26 02:47:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:47:15 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': '7dcd846f-a41a-4b8c-99d9-d1f65860d4a3', 'last_update': '2024-12-26T02:47:15.601906', 'character_id': 'current'}
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\section_1.json
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\section_1.json
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\section_1.json
2024-12-26 02:47:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:47:15 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='7dcd846f-a41a-4b8c-99d9-d1f65860d4a3' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:47:15 | INFO     | managers.workflow_manager:initialize_workflow:280 - Initializing workflow
2024-12-26 02:47:15 | DEBUG    | managers.workflow_manager:initialize_workflow:281 - Initial state: session_id='7dcd846f-a41a-4b8c-99d9-d1f65860d4a3' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:47:15 | DEBUG    | managers.workflow_manager:initialize_workflow:284 - Saving initial state
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\section_1.json
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\section_1.json
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\section_1.json
2024-12-26 02:47:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:47:15 | INFO     | managers.workflow_manager:initialize_workflow:287 - Workflow initialization completed
2024-12-26 02:47:15 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:47:15 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='7dcd846f-a41a-4b8c-99d9-d1f65860d4a3' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>, User input: None
2024-12-26 02:47:15 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:47:15 | DEBUG    | managers.workflow_manager:execute_workflow:169 - Executing workflow
2024-12-26 02:47:15 | INFO     | managers.workflow_manager:start_workflow:201 - Starting workflow node
2024-12-26 02:47:15 | DEBUG    | managers.workflow_manager:start_workflow:202 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None section_number=1 player_input=None content=None source=<SourceType.RAW: 'raw'>
2024-12-26 02:47:15 | DEBUG    | managers.workflow_manager:start_workflow:213 - Input data is already a GameState
2024-12-26 02:47:15 | DEBUG    | managers.workflow_manager:start_workflow:220 - Creating initial state with session_id
2024-12-26 02:47:15 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: d3b0a1f6-4ff8-4f12-abed-74fe470947fe
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\characters\current.json
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\characters\current.json
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\characters\current.json
2024-12-26 02:47:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:47:15 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'd3b0a1f6-4ff8-4f12-abed-74fe470947fe', 'last_update': '2024-12-26T02:47:15.637791', 'character_id': 'current', 'source': <SourceType.RAW: 'raw'>}
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\section_1.json
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\section_1.json
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\section_1.json
2024-12-26 02:47:15 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:47:15 | DEBUG    | managers.workflow_manager:start_workflow:224 - Validated state session_id: d3b0a1f6-4ff8-4f12-abed-74fe470947fe
2024-12-26 02:47:15 | INFO     | managers.workflow_manager:start_workflow:232 - Successfully created output with session_id: d3b0a1f6-4ff8-4f12-abed-74fe470947fe
2024-12-26 02:47:15 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': 'd3b0a1f6-4ff8-4f12-abed-74fe470947fe', 'section_number': 1, 'source': <SourceType.RAW: 'raw'>}}
2024-12-26 02:47:15 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 2
2024-12-26 02:47:15 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 2
2024-12-26 02:47:15 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 2
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2_rules in namespace rules
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:47:15 | DEBUG    | managers.rules_manager:get_cached_rules:45 - No rules found in cache for section 2
2024-12-26 02:47:15 | DEBUG    | agents.rules_agent:process_section_rules:57 - No content provided, fetching raw content
2024-12-26 02:47:15 | INFO     | managers.rules_manager:get_raw_content:65 - Getting raw content for section 2
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-26 02:47:15 | INFO     | agents.story_graph:_process_narrative:127 - Processing narrative for section 2
2024-12-26 02:47:15 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 2
2024-12-26 02:47:15 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 2
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2 in namespace sections
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:47:15 | DEBUG    | managers.narrator_manager:get_cached_content:43 - No content found in cache for section 2
2024-12-26 02:47:15 | DEBUG    | agents.narrator_agent:process_section:58 - No raw content provided, fetching from manager
2024-12-26 02:47:15 | INFO     | managers.narrator_manager:get_raw_content:63 - Getting raw content for section 2
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key 2 in namespace raw_content
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md
2024-12-26 02:47:15 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-26 02:47:15 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-26 02:47:15 | DEBUG    | managers.rules_manager:get_raw_content:84 - Found raw content for section 2
2024-12-26 02:47:15 | INFO     | agents.rules_agent:process_section_rules:69 - Analyzing rules for section 2 with LLM
2024-12-26 02:47:15 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:102 - Starting LLM extraction for section 2
2024-12-26 02:47:16 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\sections\2.md (658 characters)
2024-12-26 02:47:16 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-26 02:47:16 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace raw_content with format StorageFormat.MARKDOWN
2024-12-26 02:47:16 | DEBUG    | managers.cache_manager:load_raw_content:311 - Content found in cache for raw_content/2
2024-12-26 02:47:16 | DEBUG    | managers.narrator_manager:get_raw_content:83 - Found raw content for section 2
2024-12-26 02:47:16 | INFO     | agents.narrator_agent:process_section:66 - Processing content for section 2 with LLM
2024-12-26 02:47:16 | DEBUG    | agents.narrator_agent:_process_content:98 - Starting content processing with LLM
2024-12-26 02:47:16 | DEBUG    | agents.narrator_agent:_process_content:99 - Preparing messages for LLM with section 2 and content length 658
2024-12-26 02:47:16 | DEBUG    | agents.narrator_agent:_process_content:106 - Sending request to LLM
2024-12-26 02:47:20 | DEBUG    | agents.narrator_agent:_process_content:108 - Received response from LLM: {
    "content": "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défend...
2024-12-26 02:47:20 | DEBUG    | agents.narrator_agent:_process_content:125 - Parsing JSON response
2024-12-26 02:47:20 | DEBUG    | agents.narrator_agent:_process_content:127 - Parsed JSON data: {'content': "# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage. Vous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \n**HABILETÉ :** 6  \n**ENDURANCE :** 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]].", 'source_type': 'processed', 'error': None}
2024-12-26 02:47:20 | DEBUG    | agents.narrator_agent:_process_content:145 - Creating NarratorModel
2024-12-26 02:47:20 | DEBUG    | agents.narrator_agent:_process_content:152 - Successfully created NarratorModel: section_number=2 content="# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage. Vous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \n**HABILETÉ :** 6  \n**ENDURANCE :** 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]]." source_type=<SourceType.PROCESSED: 'processed'> error=None timestamp=datetime.datetime(2024, 12, 26, 2, 47, 20, 337482) last_update=datetime.datetime(2024, 12, 26, 2, 47, 20, 337483)
2024-12-26 02:47:20 | INFO     | managers.narrator_manager:save_content:108 - Saving content for section 2
2024-12-26 02:47:20 | DEBUG    | managers.narrator_manager:_narrator_to_markdown:183 - Converting NarratorModel to markdown for section 2
2024-12-26 02:47:20 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_2 in namespace sections
2024-12-26 02:47:20 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:47:20 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-26 02:47:20 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-26 02:47:20 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-26 02:47:20 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-26 02:47:20 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for sections/section_2
2024-12-26 02:47:20 | DEBUG    | managers.narrator_manager:save_content:125 - Content saved successfully for section 2
2024-12-26 02:47:20 | DEBUG    | agents.story_graph:_process_narrative:148 - Narrative processing completed for section 2
2024-12-26 02:47:20 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_narrator': {'session_id': '', 'narrative': NarratorModel(section_number=2, content="# Section 2\n\nVotre seule chance est d'essayer de franchir l'une des entrées en fonçant au milieu des gardes. Vous choisissez la porte est car ils sont moins nombreux pour la défendre. Votre tentative les prend complètement au dépourvu : vous avez, en effet, attendu que leur attention soit attirée dans une autre direction avant de forcer le passage. Vous en éliminez deux d'un coup, ce qui vous laisse en tête à tête avec un petit Arcadien méridional.\n\n**GARDE ARCADIEN**  \n**HABILETÉ :** 6  \n**ENDURANCE :** 8  \n\nSi vous êtes vainqueur en quatre Assauts, rendez-vous au [[263]].  \nSi, après le quatrième Assaut, vous n'êtes pas venu à bout du garde, rendez-vous au [[34]].", source_type=<SourceType.PROCESSED: 'processed'>, error=None, timestamp=datetime.datetime(2024, 12, 26, 2, 47, 20, 337482), last_update=datetime.datetime(2024, 12, 26, 2, 47, 20, 337483)), 'section_number': 2, 'source': <SourceType.RAW: 'raw'>}}
2024-12-26 02:47:21 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:181 - Processed choices: [{'text': 'Engage in combat with the Arcadian guard.', 'type': 'dice', 'target_section': None, 'conditions': [], 'dice_type': 'combat', 'dice_results': {'4': 263, '5-6': 34}}]
2024-12-26 02:47:21 | DEBUG    | agents.rules_agent:_extract_rules_with_llm:185 - Created RulesModel: section_number=2 dice_type=<DiceType.COMBAT: 'combat'> needs_dice=True needs_user_response=True next_action='dice_first' conditions=[] choices=[Choice(text='Engage in combat with the Arcadian guard.', type=<ChoiceType.DICE: 'dice'>, target_section=None, conditions=[], dice_type=<DiceType.COMBAT: 'combat'>, dice_results={'4': 263, '5-6': 34})] rules_summary='You must engage in combat with the Arcadian guard. If you defeat him in four assaults, go to section 263. If you fail to defeat him after four assaults, go to section 34.' error=None source='llm_analysis' source_type=<SourceType.PROCESSED: 'processed'> last_update=datetime.datetime(2024, 12, 26, 2, 47, 21, 13779)
2024-12-26 02:47:21 | DEBUG    | agents.rules_agent:process_section_rules:74 - Analysis successful, saving to cache
2024-12-26 02:47:21 | INFO     | managers.rules_manager:save_rules:108 - Saving rules for section 2
2024-12-26 02:47:21 | DEBUG    | managers.rules_manager:_rules_to_markdown:136 - Converting rules to markdown for section 2
2024-12-26 02:47:21 | DEBUG    | managers.rules_manager:_format_choices:171 - Formatting 1 choices
2024-12-26 02:47:21 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_2_rules in namespace rules
2024-12-26 02:47:21 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:47:21 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-26 02:47:21 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-26 02:47:21 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-26 02:47:21 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-26 02:47:21 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for rules/section_2_rules
2024-12-26 02:47:21 | DEBUG    | managers.rules_manager:save_rules:117 - Rules saved successfully for section 2
2024-12-26 02:47:21 | INFO     | agents.rules_agent:process_section_rules:79 - Rules saved successfully
2024-12-26 02:47:21 | DEBUG    | agents.story_graph:_process_rules:112 - Rules processing completed for section 2
2024-12-26 02:47:21 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=2, dice_type=<DiceType.COMBAT: 'combat'>, needs_dice=True, needs_user_response=True, next_action='dice_first', conditions=[], choices=[Choice(text='Engage in combat with the Arcadian guard.', type=<ChoiceType.DICE: 'dice'>, target_section=None, conditions=[], dice_type=<DiceType.COMBAT: 'combat'>, dice_results={'4': 263, '5-6': 34})], rules_summary='You must engage in combat with the Arcadian guard. If you defeat him in four assaults, go to section 263. If you fail to defeat him after four assaults, go to section 34.', error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 26, 2, 47, 21, 13779)), 'section_number': 2, 'source': <SourceType.RAW: 'raw'>}}
2024-12-26 02:47:21 | ERROR    | managers.workflow_manager:execute_workflow:184 - Error executing workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-26 02:47:21 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-26 02:47:21 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-26 02:53:01 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:53:01 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:53:01 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:53:01 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 02:53:01 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 02:53:01 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 02:53:01 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\current_state.json
2024-12-26 02:53:01 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\current_state.json
2024-12-26 02:53:01 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\e103d9d6-8095-49a3-bf6d-26768e68b9e5\states\current_state.json
2024-12-26 02:53:01 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:53:01 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 02:53:01 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 02:53:01 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 02:53:01 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:53:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:53:12 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:53:16 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:53:16 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:53:16 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:53:16 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:53:16 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:53:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:53:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:53:16 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:53:16 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:53:16 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:53:16 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:53:16 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:53:16 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:53:16 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:53:16 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:53:16 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:53:16 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:53:16 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:53:16 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:53:16 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:53:16 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:53:17 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:53:17 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:53:17 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:53:17 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:53:53 | DEBUG    | api.app:get_agent_manager:112 - Returning existing AgentManager instance
2024-12-26 02:53:53 | INFO     | api.app:initialize_game:614 - Initializing a new game session
2024-12-26 02:53:53 | INFO     | managers.agent_manager:initialize:302 - Starting AgentManager initialization
2024-12-26 02:53:53 | INFO     | managers.agent_manager:_initialize_components:286 - Initializing manager components
2024-12-26 02:53:53 | DEBUG    | managers.agent_manager:_initialize_components:292 - Initializing state_manager
2024-12-26 02:53:53 | INFO     | managers.state_manager:initialize:53 - Initializing StateManager
2024-12-26 02:53:53 | DEBUG    | managers.state_manager:initialize:55 - Generated game ID: f244e987-b126-4298-8cd7-8013ad50fc5c
2024-12-26 02:53:53 | INFO     | managers.cache_manager:update_game_id:356 - Updating game ID to: f244e987-b126-4298-8cd7-8013ad50fc5c
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for state: data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for trace: data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\traces
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:update_game_id:366 - Creating per-game directory for characters: data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\characters
2024-12-26 02:53:53 | INFO     | managers.state_manager:initialize:58 - Initialized state manager with game ID: f244e987-b126-4298-8cd7-8013ad50fc5c
2024-12-26 02:53:53 | INFO     | managers.agent_manager:initialize:308 - AgentManager initialization completed successfully
2024-12-26 02:53:53 | DEBUG    | managers.agent_manager:_configure_story_graph:557 - Configuring story graph
2024-12-26 02:53:53 | DEBUG    | managers.agent_manager:_configure_story_graph:566 - Story graph configured successfully
2024-12-26 02:53:53 | INFO     | agents.story_graph:_setup_workflow:55 - Setting up LangGraph workflow with parallel processing
2024-12-26 02:53:53 | SUCCESS  | agents.story_graph:_setup_workflow:80 - Workflow setup completed
2024-12-26 02:53:53 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: 7f76284d-0a7e-4280-b276-a26cbc743e02
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\characters\current.json
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\characters\current.json
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\characters\current.json
2024-12-26 02:53:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:53:53 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': '7f76284d-0a7e-4280-b276-a26cbc743e02', 'last_update': '2024-12-26T02:53:53.300202', 'character_id': 'current'}
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\section_1.json
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\section_1.json
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\section_1.json
2024-12-26 02:53:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:53:53 | INFO     | managers.agent_manager:initialize_game:358 - Initial state created: session_id='7f76284d-0a7e-4280-b276-a26cbc743e02' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None source=<SourceType.RAW: 'raw'> section_number=1 player_input=None content=None
2024-12-26 02:53:53 | INFO     | managers.workflow_manager:initialize_workflow:278 - Initializing workflow
2024-12-26 02:53:53 | DEBUG    | managers.workflow_manager:initialize_workflow:279 - Initial state: session_id='7f76284d-0a7e-4280-b276-a26cbc743e02' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None source=<SourceType.RAW: 'raw'> section_number=1 player_input=None content=None
2024-12-26 02:53:53 | DEBUG    | managers.workflow_manager:initialize_workflow:282 - Saving initial state
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\section_1.json
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\section_1.json
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\section_1.json
2024-12-26 02:53:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:53:53 | INFO     | managers.workflow_manager:initialize_workflow:285 - Workflow initialization completed
2024-12-26 02:53:53 | INFO     | managers.workflow_manager:execute_workflow:146 - Starting workflow execution
2024-12-26 02:53:53 | DEBUG    | managers.workflow_manager:execute_workflow:147 - Input state: session_id='7f76284d-0a7e-4280-b276-a26cbc743e02' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None source=<SourceType.RAW: 'raw'> section_number=1 player_input=None content=None, User input: None
2024-12-26 02:53:53 | DEBUG    | managers.workflow_manager:execute_workflow:158 - Setting up and compiling workflow
2024-12-26 02:53:53 | DEBUG    | managers.workflow_manager:execute_workflow:169 - Executing workflow
2024-12-26 02:53:53 | INFO     | managers.workflow_manager:start_workflow:201 - Starting workflow node
2024-12-26 02:53:53 | DEBUG    | managers.workflow_manager:start_workflow:202 - Input data received: Type: <class 'models.game_state.GameState'>, Value: session_id='' narrative=None rules=None trace=None character=None dice_roll=None decision=None error=None narrative_content=None current_rules=None current_decision=None source=<SourceType.RAW: 'raw'> section_number=1 player_input=None content=None
2024-12-26 02:53:53 | DEBUG    | managers.workflow_manager:start_workflow:213 - Input data is already a GameState
2024-12-26 02:53:53 | DEBUG    | managers.workflow_manager:start_workflow:220 - Creating initial state with session_id
2024-12-26 02:53:53 | INFO     | managers.state_manager:create_initial_state:271 - Creating initial state with session_id: ed727781-581b-4e15-8463-d641fed98164
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key current in namespace characters
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace characters with format StorageFormat.JSON
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\characters\current.json
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\characters\current.json
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\characters\current.json
2024-12-26 02:53:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for characters/current
2024-12-26 02:53:53 | DEBUG    | managers.state_manager:create_initial_state:297 - Parameters for initial GameState: {'section_number': 1, 'session_id': 'ed727781-581b-4e15-8463-d641fed98164', 'last_update': '2024-12-26T02:53:53.335817', 'character_id': 'current'}
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:148 - Saving data for key section_1 in namespace state
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:167 - Serializing data for storage
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:_serialize_data:72 - Serializing data for namespace state with format StorageFormat.JSON
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:save_cached_data:170 - Saving to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\section_1.json
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:write_file_async:67 - Writing to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\section_1.json
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:write_file_async:82 - Successfully wrote to file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\section_1.json
2024-12-26 02:53:53 | INFO     | managers.cache_manager:save_cached_data:172 - Successfully saved data for state/section_1
2024-12-26 02:53:53 | DEBUG    | managers.workflow_manager:start_workflow:222 - Validated state session_id: ed727781-581b-4e15-8463-d641fed98164
2024-12-26 02:53:53 | INFO     | managers.workflow_manager:start_workflow:230 - Successfully created output with session_id: ed727781-581b-4e15-8463-d641fed98164
2024-12-26 02:53:53 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_start': {'session_id': 'ed727781-581b-4e15-8463-d641fed98164', 'source': <SourceType.RAW: 'raw'>, 'section_number': 1}}
2024-12-26 02:53:53 | INFO     | agents.story_graph:_process_rules:91 - Processing rules for section 2
2024-12-26 02:53:53 | DEBUG    | agents.rules_agent:process_section_rules:47 - Starting process_section_rules for section 2
2024-12-26 02:53:53 | INFO     | managers.rules_manager:get_cached_rules:37 - Getting cached rules for section 2
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2_rules in namespace rules
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md
2024-12-26 02:53:53 | INFO     | agents.story_graph:_process_narrative:127 - Processing narrative for section 2
2024-12-26 02:53:53 | DEBUG    | agents.narrator_agent:process_section:48 - Starting process_section for section 2
2024-12-26 02:53:53 | INFO     | managers.narrator_manager:get_cached_content:35 - Getting cached content for section 2
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key section_2 in namespace sections
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules\section_2_rules.md (602 characters)
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace rules with format StorageFormat.MARKDOWN
2024-12-26 02:53:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:259 - Parsing markdown content for section 2
2024-12-26 02:53:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:278 - Parsed sections: ['Metadata', 'Analysis', 'Choices', 'Summary', 'Error']
2024-12-26 02:53:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:297 - Parsed metadata: {'last_update': '2024-12-26T02:47:21.013779', 'source': 'llm_analysis', 'source_type': 'processed'}
2024-12-26 02:53:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:317 - Parsed analysis: {'needs_dice': 'True', 'dice_type': 'combat', 'needs_user_response': 'True', 'next_action': 'dice_first', 'conditions': 'None', 'target_sections': 'None'}
2024-12-26 02:53:53 | DEBUG    | managers.rules_manager:_parse_choices:191 - Parsing choices from content
2024-12-26 02:53:53 | DEBUG    | managers.rules_manager:_parse_choices:201 - Parsing choice: 'Engage in combat with the Arcadian guard.'
2024-12-26 02:53:53 | DEBUG    | managers.rules_manager:_parse_choices:217 - Parsed dice type: combat
2024-12-26 02:53:53 | DEBUG    | managers.rules_manager:_parse_choices:226 - Parsed dice results: {'4': 263, '5-6': 34}
2024-12-26 02:53:53 | DEBUG    | managers.rules_manager:_parse_choices:249 - Choice parsed successfully: 'Engage in combat with the Arcadian guard.'
2024-12-26 02:53:53 | INFO     | managers.rules_manager:_parse_choices:254 - Successfully parsed 1 choices
2024-12-26 02:53:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:327 - Parsed 1 choices
2024-12-26 02:53:53 | DEBUG    | managers.rules_manager:_markdown_to_rules:372 - Creating RulesModel with data: {'section_number': 2, 'dice_type': <DiceType.COMBAT: 'combat'>, 'needs_dice': True, 'needs_user_response': True, 'next_action': 'dice_first', 'conditions': [], 'choices_count': 1, 'source': 'llm_analysis', 'source_type': <SourceType.PROCESSED: 'processed'>}
2024-12-26 02:53:53 | INFO     | managers.rules_manager:_markdown_to_rules:384 - Successfully created RulesModel for section 2
2024-12-26 02:53:53 | INFO     | managers.rules_manager:get_cached_rules:50 - Successfully retrieved rules for section 2 from cache
2024-12-26 02:53:53 | INFO     | agents.rules_agent:process_section_rules:52 - Rules found in cache for section 2
2024-12-26 02:53:53 | DEBUG    | agents.story_graph:_process_rules:112 - Rules processing completed for section 2
2024-12-26 02:53:53 | DEBUG    | managers.filesystem_adapter:read_file_async:117 - Successfully read from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections\section_2.md (674 characters)
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:get_cached_data:210 - Found in persistent storage
2024-12-26 02:53:53 | DEBUG    | managers.cache_manager:_deserialize_data:104 - Deserializing data for namespace sections with format StorageFormat.MARKDOWN
2024-12-26 02:53:53 | DEBUG    | managers.narrator_manager:_markdown_to_narrator:151 - Converting markdown to NarratorModel for section 2
2024-12-26 02:53:53 | DEBUG    | managers.narrator_manager:get_cached_content:48 - Successfully parsed cached content for section 2
2024-12-26 02:53:53 | INFO     | agents.narrator_agent:process_section:53 - Content found in cache for section 2
2024-12-26 02:53:53 | DEBUG    | agents.story_graph:_process_narrative:148 - Narrative processing completed for section 2
2024-12-26 02:53:53 | DEBUG    | managers.workflow_manager:execute_workflow:172 - Workflow execution result: {'node_rules': {'session_id': '', 'rules': RulesModel(section_number=2, dice_type=<DiceType.COMBAT: 'combat'>, needs_dice=True, needs_user_response=True, next_action='dice_first', conditions=[], choices=[Choice(text='Engage in combat with the Arcadian guard.', type=<ChoiceType.DICE: 'dice'>, target_section=None, conditions=[], dice_type=<DiceType.COMBAT: 'combat'>, dice_results={'4': 263, '5-6': 34})], rules_summary='You must engage in combat with the Arcadian guard. If you defeat him in four assaults, go to section 263. If you fail to defeat him after four assaults, go to section 34.', error=None, source='llm_analysis', source_type=<SourceType.PROCESSED: 'processed'>, last_update=datetime.datetime(2024, 12, 26, 2, 47, 21, 13779)), 'source': <SourceType.RAW: 'raw'>, 'section_number': 2}}
2024-12-26 02:53:53 | ERROR    | managers.workflow_manager:execute_workflow:184 - Error executing workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-26 02:53:53 | ERROR    | managers.agent_manager:initialize_game:369 - Error during game initialization: Failed to execute workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-26 02:53:53 | ERROR    | api.app:initialize_game:626 - Error initializing game: Failed to initialize game: Failed to execute workflow: At key 'source': Can receive only one value per step. Use an Annotated key to handle multiple values.
For troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_CONCURRENT_GRAPH_UPDATE
2024-12-26 02:53:59 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:53:59 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:53:59 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:53:59 | DEBUG    | managers.agent_manager:get_state:317 - Fetching current game state
2024-12-26 02:53:59 | DEBUG    | managers.state_manager:get_current_state:233 - Getting current state
2024-12-26 02:53:59 | DEBUG    | managers.cache_manager:get_cached_data:181 - Getting data for key current_state in namespace state
2024-12-26 02:53:59 | DEBUG    | managers.cache_manager:get_cached_data:205 - Looking for file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\current_state.json
2024-12-26 02:53:59 | DEBUG    | managers.filesystem_adapter:read_file_async:100 - Reading from file: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\current_state.json
2024-12-26 02:53:59 | DEBUG    | managers.filesystem_adapter:read_file_async:108 - File does not exist: C:\Users\erpes\Desktop\casys-rpg\data\cache\games\f244e987-b126-4298-8cd7-8013ad50fc5c\states\current_state.json
2024-12-26 02:53:59 | DEBUG    | managers.cache_manager:get_cached_data:224 - Data not found in cache or storage
2024-12-26 02:53:59 | DEBUG    | managers.state_manager:get_current_state:245 - No current state found
2024-12-26 02:53:59 | DEBUG    | managers.agent_manager:get_state:324 - Current state: None
2024-12-26 02:53:59 | INFO     | managers.agent_manager:stop_game:520 - Game stopped successfully
2024-12-26 02:53:59 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:54:00 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:54:04 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:54:04 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:54:04 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:54:04 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:54:04 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:54:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:54:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:54:04 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:54:04 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:54:04 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:54:04 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:54:04 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:54:04 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:54:04 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:54:04 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:54:04 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:54:04 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:54:04 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:54:04 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:54:04 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:54:04 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:54:06 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:54:06 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:54:06 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:54:06 | INFO     | api.app:startup_event:223 - API started successfully
2024-12-26 02:54:35 | INFO     | api.app:lifespan:145 - Shutting down...
2024-12-26 02:54:35 | DEBUG    | api.app:shutdown_event:124 - Cleaning up AgentManager
2024-12-26 02:54:35 | INFO     | managers.agent_manager:stop_game:506 - Stopping game...
2024-12-26 02:54:35 | DEBUG    | managers.agent_manager:stop_game:511 - No game ID set, nothing to save
2024-12-26 02:54:35 | INFO     | api.app:shutdown_event:132 - API shutdown successfully
2024-12-26 02:54:39 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:54:45 | SUCCESS  | config.logging_config:setup_logging:61 - Logging configured successfully
2024-12-26 02:54:45 | INFO     | api.app:lifespan:141 - Starting up...
2024-12-26 02:54:45 | DEBUG    | api.app:startup_event:207 - Initializing GameFactory
2024-12-26 02:54:45 | INFO     | managers.filesystem_adapter:__init__:27 - Initializing FileSystemAdapter
2024-12-26 02:54:45 | DEBUG    | managers.filesystem_adapter:__init__:32 - Creating base directory: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:54:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for raw_content: C:\Users\erpes\Desktop\casys-rpg\data\sections
2024-12-26 02:54:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for rules: C:\Users\erpes\Desktop\casys-rpg\data\cache\rules
2024-12-26 02:54:45 | DEBUG    | managers.filesystem_adapter:__init__:39 - Creating namespace directory for sections: C:\Users\erpes\Desktop\casys-rpg\data\cache\sections
2024-12-26 02:54:45 | INFO     | managers.filesystem_adapter:__init__:42 - FileSystemAdapter initialized successfully
2024-12-26 02:54:45 | DEBUG    | managers.filesystem_adapter:__init__:43 - Base path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:54:45 | DEBUG    | managers.filesystem_adapter:__init__:44 - Encoding: utf-8
2024-12-26 02:54:45 | DEBUG    | managers.cache_manager:__init__:53 - CacheManager initialized with config: StorageConfig
2024-12-26 02:54:45 | DEBUG    | managers.cache_manager:__init__:54 - Base storage path: C:\Users\erpes\Desktop\casys-rpg\data
2024-12-26 02:54:45 | DEBUG    | api.app:startup_event:211 - Creating game components
2024-12-26 02:54:45 | INFO     | managers.state_manager:__init__:40 - Initializing StateManager
2024-12-26 02:54:45 | INFO     | managers.rules_manager:__init__:29 - Initializing RulesManager
2024-12-26 02:54:45 | DEBUG    | managers.rules_manager:__init__:33 - RulesManager initialized with config: StorageConfig
2024-12-26 02:54:45 | INFO     | managers.narrator_manager:__init__:28 - Initializing NarratorManager
2024-12-26 02:54:45 | DEBUG    | managers.narrator_manager:__init__:31 - NarratorManager initialized with config: StorageConfig
2024-12-26 02:54:45 | INFO     | managers.workflow_manager:__init__:32 - Initializing WorkflowManager
2024-12-26 02:54:45 | DEBUG    | managers.workflow_manager:__init__:35 - WorkflowManager initialized with state_manager: StateManager, rules_manager: RulesManager
2024-12-26 02:54:45 | DEBUG    | api.app:startup_event:216 - Initializing AgentManager
2024-12-26 02:54:45 | INFO     | managers.agent_manager:__init__:147 - Initializing AgentManager
2024-12-26 02:54:45 | INFO     | managers.agent_manager:__init__:162 - AgentManager initialization completed
2024-12-26 02:54:45 | INFO     | api.app:startup_event:223 - API started successfully
